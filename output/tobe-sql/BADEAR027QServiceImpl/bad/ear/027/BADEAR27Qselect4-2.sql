SELECT /*소계*/ (SELECT AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */
FROM TBDCMACM015M WHERE INST_CD = DE04.CMO_INST_CD) AS COMPTAUTH_NM , NVL(SUM(1),0) AS SUM_CNT , NVL(SUM(CASE WHEN (MAIN.DSPS_RQT_KDCD = '110' OR SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '3') THEN NVL(DE04.PNRT_PRSRV_AMT,0) ELSE 0 END),0) AS SUM_PNL_DRIN_PSVT_AM , NVL(SUM(CASE WHEN SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '3' THEN NVL(DE04.RMBR_AMT,0)+NVL(DE04.SPLP_AMT,0) ELSE 0 END),0) AS SUM_RSTORTN_SPLP_AM , NVL(SUM(CASE WHEN SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) != '5' THEN NVL(DE04.TPOF_NOPE,0) ELSE 0 END),0) AS SUM_NOP_CNT , NVL(SUM(CASE WHEN MAIN.DSPS_RQT_KDCD = '110' THEN 1 ELSE 0 END),0) AS CNT1 , NVL(SUM(CASE WHEN MAIN.DSPS_RQT_KDCD = '110' THEN NVL(DE04.PNRT_PRSRV_AMT,0) ELSE 0 END),0) AS PNL_DRIN_PSVT_AM1 , NVL(SUM(CASE WHEN MAIN.DSPS_RQT_KDCD = '110' THEN NVL(DE04.TPOF_NOPE, 0) ELSE 0 END), 0) AS NOP_CNT01 /* 2023.05.10 변상판정 인원 추가*/ , NVL(SUM(CASE WHEN MAIN.DSPS_RQT_KDCD = '210' THEN 1 ELSE 0 END),0) AS CNT2 , NVL(SUM(CASE WHEN MAIN.DSPS_RQT_KDCD = '210' THEN NVL(DE04.TPOF_NOPE,0) ELSE 0 END),0) AS NOP_CNT1 , NVL(SUM(CASE WHEN SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '3' THEN 1 ELSE 0 END),0) AS CNT3 , NVL(SUM(CASE WHEN SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '3' THEN NVL(DE04.PNRT_PRSRV_AMT,0) ELSE 0 END),0) AS PNL_DRIN_PSVT_AM2 , NVL(SUM(CASE WHEN SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '3' THEN (NVL(DE04.RMBR_AMT,0)+NVL(DE04.SPLP_AMT,0)) ELSE 0 END),0) AS RSTORTN_SPLP_AM1 , NVL(SUM(CASE WHEN SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '3' THEN NVL(DE04.TPOF_NOPE, 0) ELSE 0 END), 0) AS NOP_CNT001 /* 2023.05.10 시정 인원 추가*/ , NVL(SUM(CASE WHEN SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '5' THEN 1 ELSE 0 END),0) AS CNT4 /*기한미경과*/ /* 20140618일자는 화면 집행기준일자를 셋팅*/ , NVL(SUM(CASE WHEN DE04.PRCS_TERM_YMD > #strHndlDdlnDt# THEN 1 ELSE 0 END),0) AS SUM_CNT1 , NVL(SUM(CASE WHEN DE04.PRCS_TERM_YMD > #strHndlDdlnDt# AND (MAIN.DSPS_RQT_KDCD = '110' OR SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '3') THEN NVL(DE04.PNRT_PRSRV_AMT,0) ELSE 0 END),0) AS SUM_PNL_DRIN_PSVT_AM1 , NVL(SUM(CASE WHEN DE04.PRCS_TERM_YMD > #strHndlDdlnDt# AND SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '3' THEN NVL(DE04.RMBR_AMT,0)+NVL(DE04.SPLP_AMT,0) ELSE 0 END),0) AS SUM_RSTORTN_SPLP_AM1 , NVL(SUM(CASE WHEN DE04.PRCS_TERM_YMD > #strHndlDdlnDt# AND SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) != '5' THEN NVL(DE04.TPOF_NOPE,0) ELSE 0 END),0) AS SUM_NOP_CNT1 , NVL(SUM(CASE WHEN MAIN.DSPS_RQT_KDCD = '110' AND DE04.PRCS_TERM_YMD > #strHndlDdlnDt# THEN 1 ELSE 0 END),0) AS CNT5 , NVL(SUM(CASE WHEN MAIN.DSPS_RQT_KDCD = '110' AND DE04.PRCS_TERM_YMD > #strHndlDdlnDt# THEN NVL(DE04.PNRT_PRSRV_AMT,0) ELSE 0 END),0) AS PNL_DRIN_PSVT_AM3 , NVL(SUM(CASE WHEN MAIN.DSPS_RQT_KDCD = '110' AND DE04.PRCS_TERM_YMD > #strHndlDdlnDt# THEN NVL(DE04.TPOF_NOPE, 0) ELSE 0 END), 0) AS NOP_CNT02 /* 2023.05.10 변상판정 인원 추가*/ , NVL(SUM(CASE WHEN MAIN.DSPS_RQT_KDCD = '210' AND DE04.PRCS_TERM_YMD > #strHndlDdlnDt# THEN 1 ELSE 0 END),0) AS CNT6 , NVL(SUM(CASE WHEN MAIN.DSPS_RQT_KDCD = '210' AND DE04.PRCS_TERM_YMD > #strHndlDdlnDt# THEN NVL(DE04.TPOF_NOPE,0) ELSE 0 END),0) AS NOP_CNT2 , NVL(SUM(CASE WHEN SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '3' AND DE04.PRCS_TERM_YMD > #strHndlDdlnDt# THEN 1 ELSE 0 END),0) AS CNT7 , NVL(SUM(CASE WHEN SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '3' AND DE04.PRCS_TERM_YMD > #strHndlDdlnDt# THEN NVL(DE04.PNRT_PRSRV_AMT,0) ELSE 0 END),0) AS PNL_DRIN_PSVT_AM4 , NVL(SUM(CASE WHEN SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '3' AND DE04.PRCS_TERM_YMD > #strHndlDdlnDt# THEN (NVL(DE04.RMBR_AMT,0)+NVL(DE04.SPLP_AMT,0)) ELSE 0 END),0) AS RSTORTN_SPLP_AM2 , NVL(SUM(CASE WHEN SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '3' AND DE04.PRCS_TERM_YMD > #strHndlDdlnDt# THEN NVL(DE04.TPOF_NOPE, 0) ELSE 0 END), 0) AS NOP_CNT002 /* 2023.05.10 시정 인원 추가*/ , NVL(SUM(CASE WHEN SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) = '5' AND DE04.PRCS_TERM_YMD > #strHndlDdlnDt# THEN 1 ELSE 0 END),0) AS CNT8 /*집행중*/ , NVL(SUM(CASE WHEN DE04.PRCS_TERM_YMD AND MAIN.INST_SECD = '10' AND MAIN.INST_SECD IN ('21', '22') AND MAIN.INST_SECD = '30' AND (MAIN.INST_SECD NOT IN ('10', '21', '22', '30') OR MASTER.INST_SECD IS NULL) AND ((DE04.CFMTN_STTS_SECD != '2') OR (DE04.CFMTN_STTS_SECD = '2' AND DE04.IMPL_WHLS_CFMTN_YMD > #strHndlDdlnDt#)) /*화면 집행기준일자*/ AND ((SUBSTR(MAIN.DSPS_RQT_KDCD,1,1) IN ('2','3','5')) OR (MAIN.DSPS_RQT_KDCD = '110')) GROUP BY DE04.CMO_INST_CD ORDER BY 1