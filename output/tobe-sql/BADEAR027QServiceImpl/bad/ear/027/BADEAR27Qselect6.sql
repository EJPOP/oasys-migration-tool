SELECT F_MNG_KND_AUDYRNO(T1.ADT_YR, T1.ADT_NO, T1.ADT_KDCD, '-') || '-' || TO_CHAR(MAIN.DSPS_RQT_SQNO) AS ADT_CLSF_NO /* 감사분류번호 */,
    T1.ADT_MTTR_NM AS ADT_MTTR_NM /* 감사사항명 */,
    DE04.ENFC_YMD AS ENFC_YMD /* 시행일자 */,
    DE04.IMPL_MNG_JRSD_DEPT_CD AS IMPL_MNG_JRSD_DEPT_CD /* 집행관리소관부서코드 */,
    F_DPT_INFO(DE04.IMPL_MNG_JRSD_DEPT_CD,'1') AS F_DPT_INFO,
    MAIN.DSPS_RQT_NM AS DSPS_RQT_NM /* 처분요구명 */,
    F_CODE_NM('1000011',RPSN.ACTN_RQT_KDCD) AS F_CODE_NM,
    F_CODE_NM('1000003',ADET.IMPL_TPCD) AS F_CODE_NM,
    F_ORG_INFO(DE04.CMO_INST_CD,'1') AS F_ORG_INFO,
    F_ORG_INFO(RPSN.REL_INST_CD,'1') AS REL_INST_NM /* 관계기관명 */,
    F_CODE_NM('1000057', RPSN.OCPT_SECD) AS OCPT_NM /* 직종명 */,
    F_CODE_NM('1000058', RPSN.JBGD_SECD) AS JBGD_NM /* 직급명 */,
    RPSN.RRNO_SCRTY AS RRNO_SCRTY /* 주민등록번호보안 */,
    RPSN.RLPR_NM AS RLPR_NM /* 관계자명 */,
    NVL(RPSN.CPLT_YN,'N') AS CPLT_YN /* 완결여부 */,
    CASE WHEN DE04.CFMTN_YN IN ('9','Y') THEN 'Y' ELSE 'N' END AS CFMTN_YN /* 확정여부 */,
    CASE WHEN DE04.CFMTN_STTS_SECD = '2' THEN 'Y' ELSE 'N' END AS CFMTN_STTS_SECD /* 확정상태구분코드 */
FROM TB_BADEAR001M MAIN ,TB_BADEAR002D DE04 ,TB_BADEAR007M RPSN ,TB_BADDED001M T1 ,(SELECT B.ADT_YR /* 감사년도 */,
    B.ADT_NO /* 감사번호 */,
    B.DSPS_RQT_SQNO /* 처분요구순번 */,
    B.REL_INST_CD /* 관계기관코드 */,
    B.RLPR_SQNO /* 관계자순번 */,
    B.IMPL_TPCD /* 집행유형코드 */
FROM (SELECT CVLCPT_ADT_YR /* 민원감사년도 */,
    ADT_NO /* 감사번호 */,
    DSPS_RQT_SQNO /* 처분요구순번 */,
    SRECS_REL_INST_CD /* 심사재심의관계기관코드 */,
    RLPR_SQNO /* 관계자순번 */,
    MAX(IMPL_SQNO) AS IMPL_SQNO /* 집행순번 */
FROM TBBADFRE008M /* 관계자집행전말 */ WHERE 1=1 GROUP BY CVLCPT_ADT_YR ,ADT_NO ,DSPS_RQT_SQNO ,SRECS_REL_INST_CD ,RLPR_SQNO) A ,TBBADFRE008M B WHERE A.CVLCPT_ADT_YR = B.CVLCPT_ADT_YR AND A.ADT_NO = B.ADT_NO AND A.DSPS_RQT_SQNO = B.DSPS_RQT_SQNO AND A.SRECS_REL_INST_CD = B.SRECS_REL_INST_CD AND A.RLPR_SQNO = B.RLPR_SQNO AND A.IMPL_SQNO = B.IMPL_SQNO) ADET WHERE 1=1 AND MAIN.ADT_YR = DE04.ADT_YR AND MAIN.ADT_NO = DE04.ADT_NO AND MAIN.ADT_YR = T1.ADT_YR AND MAIN.ADT_NO = T1.ADT_NO AND MAIN.DSPS_RQT_SQNO = DE04.DSPS_RQT_SQNO AND MAIN.ADT_YR = RPSN.ADT_YR AND MAIN.ADT_NO = RPSN.ADT_NO AND MAIN.DSPS_RQT_SQNO = RPSN.DSPS_RQT_SQNO AND RPSN.ADT_YR = ADET.CVLCPT_ADT_YR(+) AND RPSN.ADT_NO = ADET.ADT_NO(+) AND RPSN.DSPS_RQT_SQNO = ADET.DSPS_RQT_SQNO(+) AND RPSN.REL_INST_CD = ADET.SRECS_REL_INST_CD(+) AND RPSN.RLPR_SQNO = ADET.RLPR_SQNO(+) AND DE04.CFMTN_STTS_SECD != '0' AND DE04.ENFC_YMD BETWEEN #strStartFromDt# AND #strStartToDt# AND MAIN.DSPS_RQT_KDCD = '210' ORDER BY 1