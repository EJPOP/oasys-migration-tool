SELECT UNLAW_HIGH_GB,
    UNLAW_HIGH_GB_NM,
    UNLAW_LOW_GB,
    UNLAW_LOW_GB_NM,
    C1+C3+C5+C7+C8+C9+C10+C12 AS C1 /* 합계건수 */,
    C2+C6+C16 AS C2 /* 합계금액_상 */,
    C4+C11+C13 AS C4 /* 합계인원 */,
    C14+C15+C17 AS C14 /* 합계금액_하 */,
    C1 /* 변상판정 건수 */,
    C2 /* 변상판정 금액_상 */,
    C3 /* 징계문책 건수 */,
    C4 /* 징계문책 인원 */,
    C5 /* 시정 건수 */,
    C6 /* 시정 금액_상 */,
    C7 /* 주의 건수 */,
    C8 /* 개선 건수 */,
    C9 /* 권고 건수 */,
    C10 /* 통보 건수 */,
    C11 /* 통보 인원 */,
    C16 /* 통보 금액 상 */,
    C17 /* 통보 금액 하 */,
    C12 /* 고발 건수 */,
    C13 /* 고발 인원 */,
    C14 /* 변상판정 금액_하 */,
    C15 /* 시정 금액_하 */
FROM ( SELECT SUBSTR(DETAIL.VIOL_TPCD,1,1) AS SUBSTR,
    ETCCD1.CD_NM,
    CASE WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '2' THEN '01'||SUBSTR(DETAIL.VIOL_TPCD,4,1) ELSE (CASE WHEN SUBSTR(DETAIL.VIOL_TPCD,1,4) IN ('1023','1024') THEN '022' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,4) = '1026' THEN '025' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,4) IN ('1063','1064') THEN '062' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,4) = '1066' THEN '065' ELSE SUBSTR(DETAIL.VIOL_TPCD,2,3) END) END AS SUBSTR,
    ETCCD2.CD_NM,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD = '110' THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD = '110' THEN NVL(DETAIL.PNRT_PRSRV_AMT,0) ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD = '210' THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD = '210' THEN NVL(DETAIL.TPOF_NOPE,0) ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN SUBSTR(MASTER.DSPS_RQT_KDCD,1,1) = '3' THEN 1 ELSE 0 END) AS SUBSTR /* 시정 건수 */,
    SUM(CASE WHEN SUBSTR(MASTER.DSPS_RQT_KDCD,1,1) = '3' THEN NVL(DETAIL.PNRT_PRSRV_AMT,0) ELSE 0 END) AS SUBSTR /* 시정 금액 */,
    SUM(CASE WHEN SUBSTR(MASTER.DSPS_RQT_KDCD,1,1) = '4' THEN 1 ELSE 0 END) AS SUBSTR /* 주의 건수 */,
    SUM(CASE WHEN SUBSTR(MASTER.DSPS_RQT_KDCD,1,1) = '5' THEN 1 ELSE 0 END) AS SUBSTR /* 개선 건수 */,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD = '611' THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD IN ('610','620','621','623','630','625') THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD IN ('620','621','623') THEN NVL(DETAIL.TPOF_NOPE,0) ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD IN ('610','620','621','623','630','625') THEN NVL(DETAIL.PNRT_PRSRV_AMT,0) ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD IN ('610','620','621','623','630','625') THEN NVL(DETAIL.RMBR_AMT,0) + NVL(DETAIL.SPLP_AMT,0) ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD IN ('710','720','730' ) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD IN ('710','720','730' ) THEN NVL(DETAIL.TPOF_NOPE,0) ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD = '110' THEN NVL(DETAIL.RMBR_AMT,0)+NVL(DETAIL.SPLP_AMT,0) ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN MASTER.DSPS_RQT_KDCD IN ('310','320','390','391','395','396') THEN NVL(DETAIL.RMBR_AMT,0)+NVL(DETAIL.SPLP_AMT,0) ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */
FROM TBBADEAR001M MASTER ,TBBADEAR002D DETAIL ,TBDCMACM013C ETCCD1 ,TBDCMACM013C ETCCD2 WHERE 1=1 AND MASTER.CVLCPT_ADT_YR = DETAIL.CVLCPT_ADT_YR AND MASTER.ADT_NO = DETAIL.ADT_NO AND MASTER.DSPS_RQT_SQNO = DETAIL.DSPS_RQT_SQNO AND EXISTS (SELECT 1
FROM TBBADEAR008M WHERE 1=1 AND SRECS_REL_INST_CD BETWEEN NVL(#strRltnOrgCdF#,'000')||'000000000' AND NVL(#strRltnOrgCdT#,'ZZZ') ||'000000000' AND MASTER.CVLCPT_ADT_YR = CVLCPT_ADT_YR AND MASTER.ADT_NO = ADT_NO AND MASTER.DSPS_RQT_SQNO = DSPS_RQT_SQNO ) AND MASTER.INST_SECD = '10' AND MASTER.INST_SECD IN ('21', '22') AND MASTER.INST_SECD = '30' AND (MASTER.INST_SECD NOT IN ('10', '21', '22', '30') OR MASTER.INST_SECD IS NULL) AND SUBSTR(DETAIL.VIOL_TPCD,1,1)||'00000000' = ETCCD1.CD AND ETCCD1.CMM_CD_DVSN_CD = '1000121' AND SUBSTR(DETAIL.VIOL_TPCD,1,1)|| (CASE WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '2' THEN '01'||SUBSTR(DETAIL.VIOL_TPCD,4,1) ELSE (CASE WHEN SUBSTR(DETAIL.VIOL_TPCD,1,4) IN ('1023','1024') THEN '022' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,4) = '1026' THEN '025' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,4) IN ('1063','1064') THEN '062' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,4) = '1066' THEN '065' ELSE SUBSTR(DETAIL.VIOL_TPCD,2,3) END) END)||'00000' = ETCCD2.CD AND ETCCD2.CMM_CD_DVSN_CD = '1000121' AND SUBSTR(DETAIL.VIOL_TPCD,1,1) IN('1', '2') AND DETAIL.ENFC_YMD BETWEEN #ENFC_YMD# AND #strStartToDt# /*화면 시행기간범위 FROM~ TO*/ AND MASTER.DSPS_RQT_KDCD = SUBSTR(#ENFC_YMD#,1,4)||'01' /*화면 시행기간범위 FROM*/ AND SUBSTR(DETAIL.ENFC_YMD, 1, 6) = #ENFC_YMD# /*화면 시행기간범위 FROM*/ AND DETAIL.ENFC_YMD = #ENFC_YMD# /*화면 시행기간범위 FROM*/ AND DETAIL.ENFC_YMD <= #strStartToDt# /*화면 시행기간범위 TO*/ ) ) ) ) GROUP BY SUBSTR(DETAIL.VIOL_TPCD,1,1) ,ETCCD1.CD_NM ,CASE WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '2' THEN '01'||SUBSTR(DETAIL.VIOL_TPCD,4,1) ELSE (CASE WHEN SUBSTR(DETAIL.VIOL_TPCD,1,4) IN ('1023','1024') THEN '022' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,4) = '1026' THEN '025' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,4) IN ('1063','1064') THEN '062' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,4) = '1066' THEN '065' ELSE SUBSTR(DETAIL.VIOL_TPCD,2,3) END) END ,ETCCD2.CD_NM ) order by UNLAW_HIGH_GB