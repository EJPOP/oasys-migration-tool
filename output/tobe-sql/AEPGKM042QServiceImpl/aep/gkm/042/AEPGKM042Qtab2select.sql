SELECT A.CRE_USER_ID,
    A.CRE_USER_NAME,
    NVL(A.QST_SC, 0) AS QST_SC,
    NVL(A.ANS_SC, 0) AS ANS_SC,
    NVL(A.CMT_SC, 0) AS CMT_SC,
    NVL(B.DBT_SC, 0) AS DBT_SC,
    NVL(B.REG_SC, 0) AS REG_SC,
    NVL(B.PTC_SC, 0) AS PTC_SC,
    (NVL(A.QST_SC, 0) + NVL(A.ANS_SC, 0) + NVL(A.CMT_SC, 0) + NVL(B.DBT_SC, 0) + NVL(B.REG_SC, 0) + NVL(B.PTC_SC, 0)) AS QST_SC
FROM ( SELECT A.CRE_USER_ID,
    A.CRE_USER_NAME,
    A.BOARD_ID,
    SUM(CASE WHEN PARENT_POST_SEQ IS NULL THEN 1 ELSE 0 END) AS PARENT_POST_SEQ,
    SUM(CASE WHEN PARENT_POST_SEQ IS NOT NULL THEN 1 ELSE 0 END) AS PARENT_POST_SEQ,
    SUM(CASE WHEN CMMT_SEQ IS NOT NULL THEN 1 ELSE 0 END) AS CMMT_SEQ
FROM ( SELECT A.CRE_USER_DEPT_CD,
    A.CRE_USER_DEPT_NAME,
    A.CRE_USER_ID,
    A.CRE_USER_NAME,
    A.BOARD_ID,
    A.POST_SEQ,
    A.PARENT_POST_SEQ,
    A.LAST_UPDATE,
    B.EVL_YR,
    B.EVL_DVSN_CD
FROM CTT_POST AS A ,TBAEPGKM011M AS B WHERE 1=1 AND A.LAST_UPDATE >= TO_DATE(B.EVL_ACTV_STR_DT) AND A.LAST_UPDATE = TO_DATE(B.EVL_ACTV_STR_DT) AND TO_DATE(A.PROF_RBPRSN_CRT_YMD, 'YYYYMMDDHH24MISS') B.EVL_YR = #EVL_YR# B.EVL_DVSN_CD = #EVL_DVSN_CD# AND A.BOARD_ID = #C_BOARD_ID# ) AS C WHERE A.CRE_USER_ID = B.USER_ID AND A.CRE_USER_ID = C.CRE_USER_ID (+) AND A.BOARD_ID = C.BOARD_ID (+) AND A.POST_SEQ = C.POST_SEQ (+) A.CRE_USER_NAME LIKE #USR_NM# || '%' GROUP BY A.CRE_USER_ID, A.CRE_USER_NAME, A.BOARD_ID ) AS A, ( SELECT A.CRE_USER_ID,
    A.CRE_USER_NAME,
    A.BOARD_ID,
    SUM(CASE WHEN PARENT_POST_SEQ IS NULL THEN 1 ELSE 0 END) AS PARENT_POST_SEQ,
    SUM(CASE WHEN PARENT_POST_SEQ IS NOT NULL THEN 1 ELSE 0 END) AS PARENT_POST_SEQ,
    SUM(CASE WHEN CMMT_SEQ IS NOT NULL THEN 1 ELSE 0 END) AS CMMT_SEQ
FROM ( SELECT A.CRE_USER_DEPT_CD,
    A.CRE_USER_DEPT_NAME,
    A.CRE_USER_ID,
    A.CRE_USER_NAME,
    A.BOARD_ID,
    A.POST_SEQ,
    A.PARENT_POST_SEQ,
    A.LAST_UPDATE,
    B.EVL_YR,
    B.EVL_DVSN_CD
FROM CTT_POST AS A ,TBAEPGKM011M AS B WHERE 1=1 AND A.LAST_UPDATE >= TO_DATE(B.EVL_ACTV_STR_DT) AND A.LAST_UPDATE = TO_DATE(B.EVL_ACTV_STR_DT) AND TO_DATE(A.PROF_RBPRSN_CRT_YMD, 'YYYYMMDDHH24MISS') B.EVL_YR = #EVL_YR# B.EVL_DVSN_CD = #EVL_DVSN_CD# AND A.BOARD_ID = #D_BOARD_ID# ) AS C WHERE A.CRE_USER_ID = B.USER_ID AND A.CRE_USER_ID = C.CRE_USER_ID (+) AND A.BOARD_ID = C.BOARD_ID (+) AND A.POST_SEQ = C.POST_SEQ (+) A.CRE_USER_NAME LIKE #USR_NM# || '%' GROUP BY A.CRE_USER_ID, A.CRE_USER_NAME, A.BOARD_ID ) AS B WHERE A.CRE_USER_ID = B.CRE_USER_ID(+) AND A.CRE_USER_NAME = B.CRE_USER_NAME(+) ORDER BY F_USR_INFO_BY_ID(A.CRE_USER_ID, '1')