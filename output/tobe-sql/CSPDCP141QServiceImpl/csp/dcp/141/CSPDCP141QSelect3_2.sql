WITH DATA AS ( SELECT NVL(D3.TPOF_PRCS_DEPT_CD, D1.TPOF_RCPT_DEPT_CD) AS ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    D2.SLCT_PRCS_PRCS /* 청탁처리구분코드 */,
    D1.TPOF_STTS_SECD /* 제보상태구분코드 */,
    D4.TPOF_OPM_ATRZ_STTS_SECD /* 제보시행문결재상태구분코드 */
FROM TB_CSPDCP101M D1 ,( SELECT D4.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    D4.TPOF_RCPT_NO /* 제보접수번호 */,
    D4.TPOF_RCPT_YR /* 제보접수년도 */,
    D4.TPOF_PRCS_SECD /* 제보처리구분코드 */
FROM TBCSPDCP205L D4 WHERE ( D4.CVLCPT_CLM_SECD, D4.TPOF_RCPT_YR, D4.TPOF_RCPT_NO, D4.FRS_MDM_SQNO ) IN ( SELECT CLM_SECD /* 청구구분코드 */,
    CVLCPT_RCPT_YR /* 민원접수년도 */,
    CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    MIN(FRS_MDM_SQNO) AS FRS_MDM_SQNO /* 포렌식매체순번 */
FROM TBCSPDCP205L GROUP BY CLM_SECD, CVLCPT_RCPT_YR, CVLCPT_RCPT_RCPT ) ) D2 , TB_CSPDCP201M D3 , TB_CSPDCP301M D4 WHERE 1=1 AND D1.CLM_SECD = D2.CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D2.CVLCPT_RCPT_RCPT(+) AND D1.CVLCPT_RCPT_YR = D2.CVLCPT_RCPT_YR(+) AND D1.CLM_SECD = D3.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D3.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D3.TPOF_RCPT_YR(+) AND D1.CLM_SECD = 1 AND D1.CRU_PRCS_PRCS_STTS NOT IN ('10') AND D1.CLM_SECD = D4.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D4.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D4.TPOF_RCPT_YR(+) AND D4.TPOF_AVTSMT_SECD(+) = 'C' AND D1.TPOF_ACTL_RCPT_NO IS NOT NULL AND D1.CRU_KDCD IN ( SELECT CD
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000047' AND CD != '000000000' AND USR_DFN_TXT_1 = '1' ) AND TO_CHAR(D1.CRU_RCPT_DT, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT# AND TO_CHAR(D3.TPOF_LAST_PRCS_DT, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT# ), PRE_DATA AS ( SELECT NVL(D3.TPOF_PRCS_DEPT_CD, D1.TPOF_RCPT_DEPT_CD) AS ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    D2.SLCT_PRCS_PRCS /* 청탁처리구분코드 */,
    D1.TPOF_STTS_SECD /* 제보상태구분코드 */,
    D4.TPOF_OPM_ATRZ_STTS_SECD /* 제보시행문결재상태구분코드 */
FROM TB_CSPDCP101M D1 ,( SELECT D4.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    D4.TPOF_RCPT_NO /* 제보접수번호 */,
    D4.TPOF_RCPT_YR /* 제보접수년도 */,
    D4.TPOF_PRCS_SECD /* 제보처리구분코드 */
FROM TBCSPDCP205L D4 WHERE ( D4.CVLCPT_CLM_SECD, D4.TPOF_RCPT_YR, D4.TPOF_RCPT_NO, D4.FRS_MDM_SQNO ) IN ( SELECT CLM_SECD /* 청구구분코드 */,
    CVLCPT_RCPT_YR /* 민원접수년도 */,
    CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    MIN(FRS_MDM_SQNO) AS FRS_MDM_SQNO /* 포렌식매체순번 */
FROM TBCSPDCP205L GROUP BY CLM_SECD, CVLCPT_RCPT_YR, CVLCPT_RCPT_RCPT ) ) D2 ,TB_CSPDCP201M D3 ,TB_CSPDCP301M D4 WHERE 1=1 AND D1.CLM_SECD = D2.CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D2.CVLCPT_RCPT_RCPT(+) AND D1.CVLCPT_RCPT_YR = D2.CVLCPT_RCPT_YR(+) AND D1.CLM_SECD = D3.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D3.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D3.TPOF_RCPT_YR(+) AND D1.CLM_SECD = 1 AND D1.CRU_PRCS_PRCS_STTS NOT IN ('10') AND D1.TPOF_ACTL_RCPT_NO IS NOT NULL AND D1.CLM_SECD = D4.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D4.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D4.TPOF_RCPT_YR(+) AND D4.TPOF_AVTSMT_SECD(+) = 'C' AND D1.CRU_KDCD IN ( SELECT CD
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000047' AND CD != '000000000' AND USR_DFN_TXT_1 = '1' ) AND TO_CHAR(D1.CRU_RCPT_DT, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(D3.TPOF_LAST_PRCS_DT, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') ) SELECT NULL AS SRECS_DEPT_CD,
    '합계' AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    COUNT(1) AS 1,
    CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1)/COUNT(1)) * 100 END AS 1,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS IN ( '11', '12','13', '14' )) OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS IN( '11', '12', '13','14')) OR (CRU_PRCS_PRCS_STTS = '70' AND (CVLCPT_ATRZ_PRCS_STTS_SECD IS NULL OR CVLCPT_ATRZ_PRCS_STTS_SECD != '30')) THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '11') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '11') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '12') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '12') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '13') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '13') OR (CRU_PRCS_PRCS_STTS = '70' AND (CVLCPT_ATRZ_PRCS_STTS_SECD IS NULL OR CVLCPT_ATRZ_PRCS_STTS_SECD != '30')) THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '14') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '14') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '20') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '20') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '30') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '30') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN CRU_PRCS_PRCS_STTS = '80' THEN 1 ELSE 0 END),0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    /*재분류*/ NVL(SUM(CASE WHEN CRU_PRCS_PRCS_STTS NOT IN ('60','70','10','80') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */
FROM DATA UNION ALL SELECT D3.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    D3.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    NVL(D4.CNT, 0) AS CNT,
    CASE WHEN D4.CNTALL = 0 THEN 0 ELSE NVL(ROUND((D4.CNT/D4.CNTALL) * 100, 2), 0) END AS CNTALL,
    NVL(D4.CVPT_HNDL_DVSN_CNT1, 0) AS CVPT_HNDL_DVSN_CNT1,
    NVL(D4.CVPT_HNDL_DVSN_CNT1_1, 0) AS CVPT_HNDL_DVSN_CNT1_1,
    NVL(D4.CVPT_HNDL_DVSN_CNT1_2, 0) AS CVPT_HNDL_DVSN_CNT1_2,
    NVL(D4.CVPT_HNDL_DVSN_CNT1_3, 0) AS CVPT_HNDL_DVSN_CNT1_3,
    NVL(D4.CVPT_HNDL_DVSN_CNT1_4, 0) AS CVPT_HNDL_DVSN_CNT1_4,
    NVL(D4.CVPT_HNDL_DVSN_CNT2, 0) AS CVPT_HNDL_DVSN_CNT2,
    NVL(D4.CVPT_HNDL_DVSN_CNT3, 0) AS CVPT_HNDL_DVSN_CNT3,
    NVL(D4.CVPT_HNDL_DVSN_CNT5, 0) AS CVPT_HNDL_DVSN_CNT5,
    NVL(D4.CVPT_HNDL_DVSN_CNT4, 0) AS CVPT_HNDL_DVSN_CNT4
FROM (SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */,
    CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */
FROM TBDCMACM002M WHERE HIRK_DPT_CD = '071000' AND USE_YN = 'Y' AND DEPT_TPCD = 'S' ) D3, (SELECT D1.ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    COUNT(1) AS 1,
    (SELECT COUNT(1)
FROM DATA S1 WHERE 1=1) AS CNTALL , NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS IN ( '11', '12','13', '14' )) OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS IN( '11', '12', '13','14')) OR (CRU_PRCS_PRCS_STTS = '70' AND (CVLCPT_ATRZ_PRCS_STTS_SECD IS NULL OR CVLCPT_ATRZ_PRCS_STTS_SECD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1 /*직접조사-소계*/, NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '11') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '11') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_1 /*직접조사-즉시시정*/, NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '12') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '12') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_2 /*직접조사-즉시해소*/, NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '13') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '13') OR (CRU_PRCS_PRCS_STTS = '70' AND (CVLCPT_ATRZ_PRCS_STTS_SECD IS NULL OR CVLCPT_ATRZ_PRCS_STTS_SECD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_3 /*직접조사-즉시종결*/, NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '14') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '14') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_4 /*직접조사-실지감사*/, NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '20') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '20') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT2 /*위탁조사*/, NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '30') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '30') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT3 /*감사참고자료*/, NVL(SUM(CASE WHEN CRU_PRCS_PRCS_STTS = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT5, /*재분류*/ NVL(SUM(CASE WHEN CRU_PRCS_PRCS_STTS NOT IN ('60','70','10','80') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT4 /*처리중*/ FROM DATA D1 GROUP BY D1.ETC_LBSVC_MNG_DEPT_CD ) D4 WHERE D3.SRECS_DEPT_CD = D4.ETC_LBSVC_MNG_DEPT_CD(+) UNION ALL SELECT NULL AS SRECS_DEPT_CD,
    '전년 동기간 증감' AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    D5.CNT-D6.CNT AS CNT,
    NVL(D5.PER-D6.PER, 0) AS PER,
    D5.CVPT_HNDL_DVSN_CNT1-D6.CVPT_HNDL_DVSN_CNT1 AS CVPT_HNDL_DVSN_CNT1,
    D5.CVPT_HNDL_DVSN_CNT1_1-D6.CVPT_HNDL_DVSN_CNT1_1 AS CVPT_HNDL_DVSN_CNT1_1,
    D5.CVPT_HNDL_DVSN_CNT1_2-D6.CVPT_HNDL_DVSN_CNT1_2 AS CVPT_HNDL_DVSN_CNT1_2,
    D5.CVPT_HNDL_DVSN_CNT1_3-D6.CVPT_HNDL_DVSN_CNT1_3 AS CVPT_HNDL_DVSN_CNT1_3,
    D5.CVPT_HNDL_DVSN_CNT1_4-D6.CVPT_HNDL_DVSN_CNT1_4 AS CVPT_HNDL_DVSN_CNT1_4,
    D5.CVPT_HNDL_DVSN_CNT2-D6.CVPT_HNDL_DVSN_CNT2 AS CVPT_HNDL_DVSN_CNT2,
    D5.CVPT_HNDL_DVSN_CNT3-D6.CVPT_HNDL_DVSN_CNT3 AS CVPT_HNDL_DVSN_CNT3,
    D5.CVPT_HNDL_DVSN_CNT5-D6.CVPT_HNDL_DVSN_CNT5 AS CVPT_HNDL_DVSN_CNT5,
    D5.CVPT_HNDL_DVSN_CNT4-D6.CVPT_HNDL_DVSN_CNT4 AS CVPT_HNDL_DVSN_CNT4
FROM (SELECT 'A' AS PK,
    COUNT(1) AS 1,
    CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1) / COUNT(1)) * 100 END AS 1,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS IN ( '11', '12','13', '14' )) OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS IN( '11', '12', '13','14')) OR (CRU_PRCS_PRCS_STTS = '70' AND (CVLCPT_ATRZ_PRCS_STTS_SECD IS NULL OR CVLCPT_ATRZ_PRCS_STTS_SECD != '30')) THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '11') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '11') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '12') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '12') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '13') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '13') OR (CRU_PRCS_PRCS_STTS = '70' AND (CVLCPT_ATRZ_PRCS_STTS_SECD IS NULL OR CVLCPT_ATRZ_PRCS_STTS_SECD != '30')) THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '14') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '14') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '20') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '20') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '30') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '30') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN CRU_PRCS_PRCS_STTS = '80' THEN 1 ELSE 0 END),0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    /*재분류*/ NVL(SUM(CASE WHEN CRU_PRCS_PRCS_STTS NOT IN ('60','70','10','80') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */
FROM DATA ) D5 , (SELECT 'A' AS PK,
    COUNT(1) AS 1,
    CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1) / COUNT(1)) * 100 END AS 1,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS IN ( '11', '12','13', '14' )) OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS IN( '11', '12','13', '14')) THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '11') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '11') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '12') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '12') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '13') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '13') OR (CRU_PRCS_PRCS_STTS = '70' AND (CVLCPT_ATRZ_PRCS_STTS_SECD IS NULL OR CVLCPT_ATRZ_PRCS_STTS_SECD != '30')) THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '14') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '14') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '20') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '20') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN (CRU_PRCS_PRCS_STTS = '60' AND SLCT_PRCS_PRCS = '30') OR (CRU_PRCS_PRCS_STTS = '70' AND CVLCPT_ATRZ_PRCS_STTS_SECD = '30' AND SLCT_PRCS_PRCS = '30') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    NVL(SUM(CASE WHEN CRU_PRCS_PRCS_STTS = '80' THEN 1 ELSE 0 END),0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    /*재분류*/ NVL(SUM(CASE WHEN CRU_PRCS_PRCS_STTS NOT IN ('60','70','10','80') THEN 1 ELSE 0 END), 0) AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */
FROM PRE_DATA ) D6 WHERE D5.PK = D6.PK(+)