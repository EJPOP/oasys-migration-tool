WITH /* CSPDCP411ReportCSPDCP1415RSelect */ RCP_DATA AS ( SELECT D1.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    D1.TPOF_RCPT_YR /* 제보접수년도 */,
    D1.TPOF_RCPT_NO /* 제보접수번호 */,
    D1.TPOF_STTS_SECD /* 제보상태구분코드 */,
    ROUND(SYSDATE - D1.TPOF_RCPT_DT) AS ROUND,
    ( SELECT AS USR_DFN_TXT_1
FROM TBDCMACM013C D3 WHERE D3.CMM_CD_DVSN_CD = '1000047' AND D3.CD = D1.CRU_KDCD ) AS TPOF_KND_SECD , DECODE( D1.CRU_PRCS_PRCS_STTS, '20', D1.CRU_RCPT_DEPT_CD, D2.TPOF_PRCS_DEPT_CD ) AS SRECS_DEPT_CD FROM TB_CSPDCP101M D1 , TB_CSPDCP201M D2 WHERE D1.CLM_SECD = D2.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_YR = D2.TPOF_RCPT_YR(+) AND D1.CVLCPT_RCPT_RCPT = D2.TPOF_RCPT_NO(+) AND D1.CLM_SECD = '1' AND D1.CRU_PRCS_PRCS_STTS NOT IN ( '10', '20', '21', '30', '60', '70' ) /* 처리중인 것만 계산 */ AND D1.CRU_RCPT_DT BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS') AND D2.TPOF_LAST_PRCS_DT BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS') ) SELECT '합계' AS GUBUN,
    COUNT(D5.CVLCPT_RCPT_RCPT) AS CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    NVL(SUM(DECODE(D5.TPOF_KND_SECD, '1', 1, 0)),0) AS TPOF_KND_SECD /* 제보종류구분코드 */,
    NVL(SUM(DECODE(D5.TPOF_KND_SECD, '2', 1, 0)),0) AS TPOF_KND_SECD /* 제보종류구분코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071100' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071100' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071100' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071110' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071110' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071110' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071300' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071300' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071300' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071130' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071130' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071130' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071120' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071120' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071120' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071140' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071140' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071140' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071200' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071200' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071200' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM RCP_DATA D5 UNION ALL SELECT '10일 이하 경과' AS GUBUN,
    COUNT(D5.CVLCPT_RCPT_RCPT) AS CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    NVL(SUM(DECODE(D5.TPOF_KND_SECD, '1', 1, 0)),0) AS TPOF_KND_SECD /* 제보종류구분코드 */,
    NVL(SUM(DECODE(D5.TPOF_KND_SECD, '2', 1, 0)),0) AS TPOF_KND_SECD /* 제보종류구분코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071100' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071100' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071100' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071110' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071110' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071110' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071300' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071300' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071300' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071130' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071130' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071130' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071120' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071120' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071120' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071140' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071140' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071140' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071200' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071200' AND D5.TPOF_KND_SECD = '1' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(SUM(CASE WHEN D5.SRECS_DEPT_CD = '071200' AND D5.TPOF_KND_SECD = '2' THEN 1 ELSE 0 END),0) AS SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM RCP_DATA D5 WHERE D5.TERM 365