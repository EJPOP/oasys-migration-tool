WITH DATA AS ( SELECT D9.CLM_SECD /* 청구구분코드 */,
    D9.CVLCPT_RCPT_YR /* 민원접수년도 */,
    D9.CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    D9.ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    D9.SLCT_PRCS_PRCS /* 청탁처리구분코드 */,
    D9.TPOF_CYCL /* 제보차수 */,
    D9.CVLCPT_ADT_YR /* 민원감사년도 */,
    D9.ADT_NO /* 감사번호 */,
    D9.DSPS_RQT_SQNO /* 처분요구순번 */,
    D10.DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(D11.DSPS_RQT_AMT),0) AS DSPS_RQT_AMT /* 처분요구금액 */,
    COUNT(D11.RLPR_SQNO) AS RLPR_SQNO /* 관계자순번 */
FROM ( SELECT D1.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    D1.TPOF_RCPT_YR /* 제보접수년도 */,
    D1.TPOF_RCPT_NO /* 제보접수번호 */,
    D2.TPOF_PRCS_DEPT_CD /* 제보처리부서코드 */,
    D3.SLCT_PRCS_PRCS /* 청탁처리구분코드 */,
    D7.TPOF_CYCL /* 제보차수 */,
    D8.TPOF_RCPT_YR /* 제보접수년도 */,
    D8.TPOF_ADT_NO /* 제보감사번호 */,
    D8.TPOF_DSPS_RQT_SQNO /* 제보처분요구순번 */
FROM TBCSPDCP101M D1 , TBCSPDCP201M D2 , ( SELECT *
FROM TBCSPDCP205L D4 WHERE D4.CLM_SECD = '1' AND ( D4.CLM_SECD, D4.CVLCPT_RCPT_YR, D4.CVLCPT_RCPT_RCPT, D4.FRS_MDM_SQNO ) IN ( SELECT CLM_SECD /* 청구구분코드 */,
    CVLCPT_RCPT_YR /* 민원접수년도 */,
    CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    MIN(FRS_MDM_SQNO) AS FRS_MDM_SQNO /* 포렌식매체순번 */
FROM TBCSPDCP205L GROUP BY CLM_SECD, CVLCPT_RCPT_YR, CVLCPT_RCPT_RCPT ) AND D4.SLCT_PRCS_PRCS = '14' ) D3 , ( SELECT *
FROM TBCSPDCP402L D5 WHERE ( D5.CLM_SECD, D5.CVLCPT_RCPT_YR, D5.CVLCPT_RCPT_RCPT, D5.TPOF_CYCL ) IN ( SELECT D6.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    D6.TPOF_RCPT_YR /* 제보접수년도 */,
    D6.TPOF_RCPT_NO /* 제보접수번호 */,
    MIN(D6.TPOF_CYCL) AS TPOF_CYCL /* 제보차수 */
FROM TBCSPDCP401H D6 GROUP BY D6.CLM_SECD, D6.CVLCPT_RCPT_YR, D6.CVLCPT_RCPT_RCPT ) AND D5.CVLCPT_RSLT_RPTP_PRCS_RSLT_SECD = '10' ) D7 , TBCSPDCP403L D8 WHERE D1.CLM_SECD = D2.CLM_SECD AND D1.CVLCPT_RCPT_YR = D2.CVLCPT_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = D2.CVLCPT_RCPT_RCPT AND D2.CLM_SECD = D3.CLM_SECD AND D2.CVLCPT_RCPT_YR = D3.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D3.CVLCPT_RCPT_RCPT AND D1.CLM_SECD = D7.CLM_SECD AND D1.CVLCPT_RCPT_YR = D7.CVLCPT_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = D7.CVLCPT_RCPT_RCPT AND D7.CLM_SECD = D8.CLM_SECD AND D7.CVLCPT_RCPT_YR = D8.CVLCPT_RCPT_YR AND D7.CVLCPT_RCPT_RCPT = D8.CVLCPT_RCPT_RCPT AND D7.TPOF_CYCL = D8.TPOF_CYCL AND D1.CLM_SECD = '1' AND D1.CRU_PRCS_PRCS_STTS = '60' AND TO_CHAR(D1.CRU_RCPT_DT, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT# AND TO_CHAR(D3.TPOF_LAST_PRCS_DT, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT# ) D9 , TB_BADEAR001M D10 , TB_BADEAR007M D11 WHERE D9.CVLCPT_ADT_YR = D10.ADT_YR AND D9.ADT_NO = D10.ADT_NO AND D9.DSPS_RQT_SQNO = D10.DSPS_RQT_SQNO AND D10.ADT_YR = D11.ADT_YR(+) AND D10.ADT_NO = D11.ADT_NO(+) AND D10.DSPS_RQT_SQNO = D11.DSPS_RQT_SQNO(+) GROUP BY D9.CLM_SECD , D9.CVLCPT_RCPT_YR , D9.CVLCPT_RCPT_RCPT , D9.ETC_LBSVC_MNG_DEPT_CD , D9.SLCT_PRCS_PRCS , D9.TPOF_CYCL , D9.CVLCPT_ADT_YR , D9.ADT_NO , D9.DSPS_RQT_SQNO , D10.DSPS_RQT_KDCD ) , PRE_DATA AS ( SELECT D9.CLM_SECD /* 청구구분코드 */,
    D9.CVLCPT_RCPT_YR /* 민원접수년도 */,
    D9.CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    D9.ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    D9.SLCT_PRCS_PRCS /* 청탁처리구분코드 */,
    D9.TPOF_CYCL /* 제보차수 */,
    D9.CVLCPT_ADT_YR /* 민원감사년도 */,
    D9.ADT_NO /* 감사번호 */,
    D9.DSPS_RQT_SQNO /* 처분요구순번 */,
    D10.DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(D11.DSPS_RQT_AMT),0) AS DSPS_RQT_AMT /* 처분요구금액 */,
    COUNT(D11.RLPR_SQNO) AS RLPR_SQNO /* 관계자순번 */
FROM ( SELECT D1.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    D1.TPOF_RCPT_YR /* 제보접수년도 */,
    D1.TPOF_RCPT_NO /* 제보접수번호 */,
    D2.TPOF_PRCS_DEPT_CD /* 제보처리부서코드 */,
    D3.SLCT_PRCS_PRCS /* 청탁처리구분코드 */,
    D7.TPOF_CYCL /* 제보차수 */,
    D8.TPOF_RCPT_YR /* 제보접수년도 */,
    D8.TPOF_ADT_NO /* 제보감사번호 */,
    D8.TPOF_DSPS_RQT_SQNO /* 제보처분요구순번 */
FROM TBCSPDCP101M D1 , TBCSPDCP201M D2 , ( SELECT *
FROM TBCSPDCP205L D4 WHERE D4.CLM_SECD = '1' AND ( D4.CLM_SECD, D4.CVLCPT_RCPT_YR, D4.CVLCPT_RCPT_RCPT, D4.FRS_MDM_SQNO ) IN ( SELECT CLM_SECD /* 청구구분코드 */,
    CVLCPT_RCPT_YR /* 민원접수년도 */,
    CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    MIN(FRS_MDM_SQNO) AS FRS_MDM_SQNO /* 포렌식매체순번 */
FROM TBCSPDCP205L GROUP BY CLM_SECD, CVLCPT_RCPT_YR, CVLCPT_RCPT_RCPT ) AND D4.SLCT_PRCS_PRCS = '14' ) D3 , ( SELECT *
FROM TBCSPDCP402L D5 WHERE ( D5.CLM_SECD, D5.CVLCPT_RCPT_YR, D5.CVLCPT_RCPT_RCPT, D5.TPOF_CYCL ) IN ( SELECT D6.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    D6.TPOF_RCPT_YR /* 제보접수년도 */,
    D6.TPOF_RCPT_NO /* 제보접수번호 */,
    MIN(D6.TPOF_CYCL) AS TPOF_CYCL /* 제보차수 */
FROM TBCSPDCP401H D6 GROUP BY D6.CLM_SECD, D6.CVLCPT_RCPT_YR, D6.CVLCPT_RCPT_RCPT ) AND D5.CVLCPT_RSLT_RPTP_PRCS_RSLT_SECD = '10' ) D7 , TBCSPDCP403L D8 WHERE D1.CLM_SECD = D2.CLM_SECD AND D1.CVLCPT_RCPT_YR = D2.CVLCPT_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = D2.CVLCPT_RCPT_RCPT AND D2.CLM_SECD = D3.CLM_SECD AND D2.CVLCPT_RCPT_YR = D3.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D3.CVLCPT_RCPT_RCPT AND D1.CLM_SECD = D7.CLM_SECD AND D1.CVLCPT_RCPT_YR = D7.CVLCPT_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = D7.CVLCPT_RCPT_RCPT AND D7.CLM_SECD = D8.CLM_SECD AND D7.CVLCPT_RCPT_YR = D8.CVLCPT_RCPT_YR AND D7.CVLCPT_RCPT_RCPT = D8.CVLCPT_RCPT_RCPT AND D7.TPOF_CYCL = D8.TPOF_CYCL AND D1.CLM_SECD = '1' AND D1.CRU_PRCS_PRCS_STTS = '60' AND TO_CHAR(D1.CRU_RCPT_DT, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(D3.TPOF_LAST_PRCS_DT, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') ) D9 , TB_BADEAR001M D10 , TB_BADEAR007M D11 WHERE D9.CVLCPT_ADT_YR = D10.ADT_YR AND D9.ADT_NO = D10.ADT_NO AND D9.DSPS_RQT_SQNO = D10.DSPS_RQT_SQNO AND D10.ADT_YR = D11.ADT_YR(+) AND D10.ADT_NO = D11.ADT_NO(+) AND D10.DSPS_RQT_SQNO = D11.DSPS_RQT_SQNO(+) GROUP BY D9.CLM_SECD , D9.CVLCPT_RCPT_YR , D9.CVLCPT_RCPT_RCPT , D9.ETC_LBSVC_MNG_DEPT_CD , D9.SLCT_PRCS_PRCS , D9.TPOF_CYCL , D9.CVLCPT_ADT_YR , D9.ADT_NO , D9.DSPS_RQT_SQNO , D10.DSPS_RQT_KDCD ) SELECT NULL AS SRECS_DEPT_CD,
    '합계' AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    NULL,
    NULL,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120', '210', '310', '320', '410', '510', '520', '530', '611', '610', '630', '620', '621', '623', '810', '820', '830', '840', '850', '916', '390', '391', '490', '710', '720', '730') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120') THEN DSPS_RQT_AMT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120') THEN CNT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('210') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('210') THEN CNT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('310', '320') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('310', '320') THEN DSPS_RQT_AMT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('410') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('410') THEN CNT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('510', '520', '530') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('611') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('610', '630') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('620', '621', '623') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('810', '820', '830', '840', '850') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('916') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('390', '391') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('490') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('710', '720') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('730') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */
FROM DATA UNION ALL SELECT T1.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    T1.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    T1.CD,
    T1.CD_NM,
    (NVL(T2.COLUMN1, 0)+NVL(T2.COLUMN2, 0)+NVL(T2.COLUMN3, 0)+NVL(T2.COLUMN4, 0)+ NVL(T2.COLUMN5, 0)+NVL(T2.COLUMN6, 0)+NVL(T2.COLUMN7, 0)+NVL(T2.COLUMN7_1, 0)+NVL(T2.COLUMN8, 0)+NVL(T2.COLUMN9, 0)+NVL(T2.COLUMN10, 0)+NVL(T2.COLUMN11, 0)+NVL(T2.COLUMN12, 0)) AS COLUMN1,
    NVL(T2.COLUMN1, 0) AS COLUMN1,
    NVL(T2.COLUMN1_AM, 0) AS COLUMN1_AM,
    NVL(T2.COLUMN1_CNT, 0) AS COLUMN1_CNT,
    NVL(T2.COLUMN2, 0) AS COLUMN2,
    NVL(T2.COLUMN2_CNT, 0) AS COLUMN2_CNT,
    NVL(T2.COLUMN3, 0) AS COLUMN3,
    NVL(T2.COLUMN3_AM, 0) AS COLUMN3_AM,
    NVL(T2.COLUMN4, 0) AS COLUMN4,
    NVL(T2.COLUMN4_CNT, 0) AS COLUMN4_CNT,
    NVL(T2.COLUMN5, 0) AS COLUMN5,
    NVL(T2.COLUMN6, 0) AS COLUMN6,
    NVL(T2.COLUMN7, 0) AS COLUMN7,
    NVL(T2.COLUMN7_1, 0) AS COLUMN7_1,
    NVL(T2.COLUMN7_2, 0) AS COLUMN7_2,
    NVL(T2.COLUMN8, 0) AS COLUMN8,
    NVL(T2.COLUMN9, 0) AS COLUMN9,
    NVL(T2.COLUMN10, 0) AS COLUMN10,
    NVL(T2.COLUMN11, 0) AS COLUMN11,
    NVL(T2.COLUMN12, 0) AS COLUMN12
FROM ( SELECT DISTINCT AS SRECS_DEPT_CD,
    CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    CD,
    CD_NM
FROM ( SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */,
    CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    'A' AS PKKEY
FROM TBDCMACM002M WHERE HIRK_DPT_CD = '071000' AND USE_YN = 'Y' AND DEPT_TPCD = 'S' ) D1, ( SELECT '10' AS CD,
    '직접조사(A)' AS CD_NM,
    'A' AS PKKEY
FROM DUAL UNION ALL SELECT '20' AS CD,
    '위탁조사(B)' AS CD_NM,
    'A' AS PKKEY
FROM DUAL /* UNION ALL SELECT '30' AS CD ,'조사종결(C)' AS CD_NM , 'A' AS PKKEY FROM DUAL */ )D2 WHERE D1.PKKEY = D2.PKKEY ORDER BY SRECS_DEPT_CD ) T1, ( SELECT ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    SLCT_PRCS_PRCS /* 청탁처리구분코드 */,
    COUNT(1) AS 1,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120') THEN DSPS_RQT_AMT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120') THEN CNT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('210') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('210') THEN CNT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('310', '320') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('310', '320') THEN DSPS_RQT_AMT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('410') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('410') THEN CNT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('510', '520', '530') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('611') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('610', '630') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('620', '621', '623') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('810', '820', '830', '840', '850') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('916') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('390', '391') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('490') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('710', '720') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('730') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */
FROM DATA GROUP BY ETC_LBSVC_MNG_DEPT_CD, SLCT_PRCS_PRCS )T2 WHERE T1.SRECS_DEPT_CD = T2.ETC_LBSVC_MNG_DEPT_CD(+) AND T1.CD = T2.SLCT_PRCS_PRCS(+) UNION ALL SELECT NULL AS SRECS_DEPT_CD,
    '전년동기간 증감' AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    T1.CD,
    T1.CD_NM,
    NVL(T2.TOTAL, 0) AS TOTAL,
    NVL(T2.COLUMN1, 0) AS COLUMN1,
    NVL(T2.COLUMN1_AM, 0) AS COLUMN1_AM,
    NVL(T2.COLUMN1_CNT, 0) AS COLUMN1_CNT,
    NVL(T2.COLUMN2, 0) AS COLUMN2,
    NVL(T2.COLUMN2_CNT, 0) AS COLUMN2_CNT,
    NVL(T2.COLUMN3, 0) AS COLUMN3,
    NVL(T2.COLUMN3_AM, 0) AS COLUMN3_AM,
    NVL(T2.COLUMN4, 0) AS COLUMN4,
    NVL(T2.COLUMN4_CNT, 0) AS COLUMN4_CNT,
    NVL(T2.COLUMN5, 0) AS COLUMN5,
    NVL(T2.COLUMN6, 0) AS COLUMN6,
    NVL(T2.COLUMN7, 0) AS COLUMN7,
    NVL(T2.COLUMN7_1, 0) AS COLUMN7_1,
    NVL(T2.COLUMN7_2, 0) AS COLUMN7_2,
    NVL(T2.COLUMN8, 0) AS COLUMN8,
    NVL(T2.COLUMN9, 0) AS COLUMN9,
    NVL(T2.COLUMN10, 0) AS COLUMN10,
    NVL(T2.COLUMN11, 0) AS COLUMN11,
    NVL(T2.COLUMN12, 0) AS COLUMN12
FROM ( SELECT '10' AS CD,
    '직접조사(A)' AS CD_NM,
    'A' AS PKKEY
FROM DUAL UNION ALL SELECT '20' AS CD,
    '위탁조사(B)' AS CD_NM,
    'A' AS PKKEY
FROM DUAL UNION ALL SELECT '30' AS CD,
    '조사종결(C)' AS CD_NM,
    'A' AS PKKEY
FROM DUAL )T1, ( SELECT S1.PK,
    S1.SLCT_PRCS_PRCS /* 청탁처리구분코드 */,
    NVL(NVL(S1.TOTAL,0) - NVL(S2.TOTAL,0), 0) AS TOTAL,
    NVL(NVL(S1.COLUMN1,0) - NVL(S2.COLUMN1,0), 0) AS COLUMN1,
    NVL(NVL(S1.COLUMN1_AM,0) - NVL(S2.COLUMN1_AM,0), 0) AS COLUMN1_AM,
    NVL(NVL(S1.COLUMN1_CNT,0) - NVL(S2.COLUMN1_CNT,0), 0) AS COLUMN1_CNT,
    NVL(NVL(S1.COLUMN2,0) - NVL(S2.COLUMN2,0), 0) AS COLUMN2,
    NVL(NVL(S1.COLUMN2_CNT,0) - NVL(S2.COLUMN2_CNT,0), 0) AS COLUMN2_CNT,
    NVL(NVL(S1.COLUMN3,0) - NVL(S2.COLUMN3,0), 0) AS COLUMN3,
    NVL(NVL(S1.COLUMN3_AM,0) - NVL(S2.COLUMN3_AM,0), 0) AS COLUMN3_AM,
    NVL(NVL(S1.COLUMN4,0) - NVL(S2.COLUMN4,0), 0) AS COLUMN4,
    NVL(NVL(S1.COLUMN4_CNT,0) - NVL(S2.COLUMN4_CNT,0), 0) AS COLUMN4_CNT,
    NVL(NVL(S1.COLUMN5,0) - NVL(S2.COLUMN5,0), 0) AS COLUMN5,
    NVL(NVL(S1.COLUMN6,0) - NVL(S2.COLUMN6,0), 0) AS COLUMN6,
    NVL(NVL(S1.COLUMN7,0) - NVL(S2.COLUMN7,0), 0) AS COLUMN7,
    NVL(NVL(S1.COLUMN7_1,0) - NVL(S2.COLUMN7_1,0), 0) AS COLUMN7_1,
    NVL(NVL(S1.COLUMN7_2,0) - NVL(S2.COLUMN7_2,0), 0) AS COLUMN7_2,
    NVL(NVL(S1.COLUMN8,0) - NVL(S2.COLUMN8,0), 0) AS COLUMN8,
    NVL(NVL(S1.COLUMN9,0) - NVL(S2.COLUMN9,0), 0) AS COLUMN9,
    NVL(NVL(S1.COLUMN10,0) - NVL(S2.COLUMN10,0), 0) AS COLUMN10,
    NVL(NVL(S1.COLUMN11,0) - NVL(S2.COLUMN11,0), 0) AS COLUMN11,
    NVL(NVL(S1.COLUMN12,0) - NVL(S2.COLUMN12,0), 0) AS COLUMN12
FROM ( SELECT 'A' AS PK,
    SLCT_PRCS_PRCS /* 청탁처리구분코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120', '210', '310', '320', '410', '510', '520', '530', '611', '610', '630', '620', '621', '623', '810', '820', '830', '840', '850', '916', '390', '391', '490', '710', '720', '730') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120') THEN DSPS_RQT_AMT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120') THEN CNT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('210') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('210') THEN CNT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('310', '320') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('310', '320') THEN DSPS_RQT_AMT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('410') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('410') THEN CNT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('510', '520', '530') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('611') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('610', '630') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('620', '621', '623') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('810', '820', '830', '840', '850') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('916') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('390', '391') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('490') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('710', '720') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('730') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */
FROM DATA GROUP BY SLCT_PRCS_PRCS )S1, ( SELECT 'A' AS PK,
    SLCT_PRCS_PRCS /* 청탁처리구분코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120', '210', '310', '320', '410', '510', '520', '530', '611', '610', '630', '620', '621', '623', '810', '820', '830', '840', '850', '916', '390', '391', '490', '710', '720', '730') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120') THEN DSPS_RQT_AMT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('110', '120') THEN CNT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('210') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('210') THEN CNT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('310', '320') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('310', '320') THEN DSPS_RQT_AMT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('410') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('410') THEN CNT ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('510', '520', '530') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('611') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('610', '630') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('620', '621', '623') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('810', '820', '830', '840', '850') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('916') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('390', '391') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('490') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('710', '720') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN DSPS_RQT_KDCD IN ('730') THEN 1 ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */
FROM PRE_DATA GROUP BY SLCT_PRCS_PRCS )S2 WHERE S1.PK = S2.PK(+) )T2 WHERE T1.CD = T2.SLCT_PRCS_PRCS(+)