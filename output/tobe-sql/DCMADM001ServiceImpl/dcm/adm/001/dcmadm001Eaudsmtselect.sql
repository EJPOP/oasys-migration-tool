SELECT A.ADT_SBMSN_DATA_ID /* 감사제출자료아이디 */,
    A.REG_DMND_YMD /* 등록요청일자 */,
    A.ADT_SBMSN_DATA_NM /* 감사제출자료명 */,
    A.DMND_CN /* 요청내용 */,
    A.RQSTR_ENO /* 요청자직원전산번호 */,
    A.DMND_DOC_ID /* 요청문서아이디 */,
    A.SBMSN_YMD /* 제출일자 */,
    A.SBMSN_CN /* 제출내용 */,
    A.PRSNR_NM /* 제출자명 */,
    A.PRSNR_TELNO /* 제출자전화번호 */,
    A.PRSNR_EML_ADDR /* 제출자이메일주소 */,
    A.SBMSN_DOC_ID /* 제출문서아이디 */,
    A.PRSNR_INST_CD /* 제출자기관코드 */,
    C.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    A.SBMSN_INST_CD /* 제출기관코드 */,
    A.SBMSN_INST_NM /* 제출기관명 */,
    A.SBMSN_INST_DEPT_CD /* 제출기관부서코드 */,
    A.VLD_PRD_BGNG_YM || '01' AS VLD_PRD_BGNG_YM /* 유효기간시작연월 */,
    A.VLD_PRD_END_YM || '01' AS VLD_PRD_END_YM /* 유효기간종료연월 */,
    A.SBMSN_SECD /* 제출구분코드 */,
    A.ADT_SBMSN_DATA_RCPT_STTS_SECD /* 감사제출자료접수상태구분코드 */,
    A.RLS_STTS_SECD /* 공개상태구분코드 */,
    A.SBMSN_INST_CNTN_YMD /* 제출기관접속일자 */,
    A.DMND_INST_CNTN_YMD /* 요청기관접속일자 */,
    A.RQSTR_DEPT_CD /* 요청자부서코드 */,
    A.FRST_USER_ID /* 최초사용자아이디 */,
    A.LAST_USER_ID /* 최종사용자아이디 */,
    A.LAST_PRCS_DEPT_CD /* 최종처리부서코드 */,
    A.LAST_MENU_ID /* 최종메뉴아이디 */,
    A.FRST_REG_DT /* 최초등록일시 */,
    A.LAST_MDFCN_DT /* 최종수정일시 */,
    B.USER_NM /* 사용자명 */,
    B.EML_ADDR /* 이메일주소 */,
    CASE WHEN B.CRU_TELNO IS NULL THEN B.CNSTN_MBCMT_HOME_TELNO ELSE B.CRU_TELNO END AS CRU_TELNO /* 부패전화번호 */,
    A.SBMSN_INST_DEPT_NM AS SBMSN_INST_DEPT_NM /* 제출기관부서명 */,
    A.ADT_YR /* 감사년도 */,
    A.ADT_NO /* 감사번호 */,
    D.ADT_MTTR_NM /* 감사사항명 */,
    A.AUTHRT_SECD /* 권한구분코드 */,
    CASE WHEN D.ADT_YR >= '2016' THEN D.ADT_KDCD ELSE '' END AS ADT_YR /* 감사년도 */,
    D.ADT_GRNT_NO AS ADT_GRNT_NO /* 감사부여번호 */,
    A.DATA_SBMSN_RCPT_YR /* 자료제출접수년도 */,
    A.DATA_SBMSN_RCPT_SECD /* 자료제출접수구분코드 */,
    A.DATA_SBMSN_RCPT_SQNO /* 자료제출접수순번 */,
    (SELECT AS RSCH_ASMT_TTL /* 연구과제제목 */
FROM TB_BADFRE012M S1 WHERE S1.CVLCPT_RCPT_YR = A.CVLCPT_RCPT_YR AND S1.SRECS_RCPT_SECD = A.SRECS_RCPT_SECD AND S1.SRECS_RCPT_SQNO = A.SRECS_RCPT_SQNO ) AS ACP_TIT_NM FROM TB_DCMIDM001L A, TBDCMACM001M B, TBDCMACM015M C, TB_BADDED001M D WHERE A.RQSTR_ENO = B.TRGT_NOP_ENO(+) AND A.PRSNR_INST_CD = C.INST_CD(+) AND A.CVLCPT_ADT_YR = D.ADT_YR(+) AND A.ADT_NO = D.ADT_NO(+) A.AUTHRT_SECD = #AUTHRT_SECD# A.ADT_SBMSN_DATA_RCPT_STTS_SECD IN ('1', '2', '9','11','12','13') A.ADT_SBMSN_DATA_RCPT_STTS_SECD IN ('3','11','12','13') A.ADT_SBMSN_DATA_RCPT_STTS_SECD IN ('4', '10') A.ADT_SBMSN_DATA_RCPT_STTS_SECD IN ('5','6','7') A.ADT_SBMSN_DATA_ID = #ADT_SBMSN_DATA_ID# (A.SBMSN_YMD >= #strSmtStDt# OR A.SBMSN_YMD IS NULL) (A.SBMSN_YMD A.SBMSN_YMD IS NULL A.SBMSN_SECD = #SBMSN_SECD# (A.DMND_CN LIKE '%' || #strSchString# || '%' OR A.ADT_SBMSN_DATA_NM LIKE '%' || #strSchString# || '%' OR C.PROF_RBPRSN_INST_NM LIKE '%' || #strSchString# || '%' OR B.USER_NM LIKE '%' || #strSchString# || '%' ) A.RQSTR_DEPT_CD = #RQSTR_DEPT_CD# A.RQSTR_ENO = #RQSTR_ENO# ORDER BY A.FRST_REG_DT DESC, A.SBMSN_YMD DESC,A.REG_DMND_YMD DESC, A.SBMSN_INST_CD ASC