SELECT /*BADEAR057QMainSelect*/ F_MNG_KND_AUDYRNO(T1.CVLCPT_ADT_YR, T1.ADT_NO, T1.ADT_KDCD, '-') AS ADT_CLSF_NO /* 감사분류번호 */,
    F_DPT_INFO(T1.SPRVSN_DEPT_CD,'1') AS F_DPT_INFO /* 주관국과명 */,
    T1.ADT_MTTR_NM /* 감사사항명 */,
    T2.ENFC_YMD /* 시행일자 */,
    T3.PBRL_SBMSN_YMD /* 홍보제출일자 */,
    T3.REG_YMD /* 등록일자 */,
    T4.C_PRL_SMT_DT,
    T4.C_REGI_DT,
    DECODE(T5.ADT_BGNG_YMD,NULL,NULL,TO_CHAR(TO_DATE(T5.ADT_BGNG_YMD),'YY-MM-DD')||' ~ '||TO_CHAR(TO_DATE(T5.ADT_END_YMD),'YY-MM-DD')) AS ADT_YMD /* 감사일자 */
FROM TB_BADDED001M T1 ,( SELECT CVLCPT_ADT_YR /* 민원감사년도 */,
    ADT_NO /* 감사번호 */,
    MAX(ENFC_YMD) AS ENFC_YMD /* 시행일자 */
FROM TBBADEAR002D S1 GROUP BY CVLCPT_ADT_YR, ADT_NO ) T2 ,( SELECT SUBSTR(S1.ADT_SQNO,1,4) AS CVLCPT_ADT_YR /* 민원감사년도 */,
    SUBSTR(S1.ADT_SQNO,5,3) AS ADT_NO /* 감사번호 */,
    MAX(TPOF_CYCL) AS TPOF_CYCL /* 제보차수 */,
    MAX(S1.PBRL_SBMSN_YMD) AS PBRL_SBMSN_YMD /* 홍보제출일자 */,
    MAX(S1.REG_YMD) AS REG_YMD /* 등록일자 */
FROM TBBADEAR028M S1 GROUP BY S1.ADT_SQNO ) T3 /*전문공개*/ ,( SELECT S1.ADT_YR /* 감사년도 */,
    S1.ADT_NO /* 감사번호 */,
    MAX(S1.PBRL_SBMSN_YMD) AS PBRL_SBMSN_YMD /* 홍보제출일자 */,
    MAX(S1.REG_YMD) AS REG_YMD /* 등록일자 */
FROM TBBADEAR030M S1 GROUP BY S1.CVLCPT_ADT_YR, S1.ADT_NO ) T4 ,( SELECT S1.REL_ADT_YR AS REL_ADT_YR /* 관계감사년도 */,
    S1.REL_ADT_NO AS REL_ADT_NO /* 관계감사번호 */,
    MIN(ADT_BGNG_YMD) AS ADT_BGNG_YMD /* 감사시작일자 */,
    MAX(ADT_END_YMD) AS ADT_END_YMD /* 감사종료일자 */
FROM TBBADDED002M S1 GROUP BY S1.REL_ADT_YR, S1.REL_ADT_NO )T5 WHERE 1=1 AND T1.BZTRP_BGT_SECD = '1' /*원배정인 자료*/ AND T1.CVLCPT_ADT_YR = T2.CVLCPT_ADT_YR(+) AND T1.ADT_NO = T2.ADT_NO(+) AND T1.CVLCPT_ADT_YR = T3.CVLCPT_ADT_YR(+) AND T1.ADT_NO = T3.ADT_NO(+) AND T1.CVLCPT_ADT_YR = T4.CVLCPT_ADT_YR(+) AND T1.ADT_NO = T4.ADT_NO(+) AND T1.CVLCPT_ADT_YR = T5.CVLCPT_ADT_YR(+) AND T1.ADT_NO = T5.ADT_NO(+) AND T1.SPRVSN_DEPT_CD IN (SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TABLE(F_AUTH_DEPT('', 'ALL', '', #strDPT_CD#))) AND T1.CVLCPT_ADT_YR||LPAD(T1.ADT_GRNT_NO,4,'0') >= #strAudYrSt#||DECODE(#strAudGrnNoSt#,'','0000', LPAD(#strAudGrnNoSt#,4,'0')) AND T1.CVLCPT_ADT_YR||LPAD(T1.ADT_GRNT_NO,4,'0') AND SUBSTR(T1.ADT_KDCD,3,1) = SUBSTR(#strAudYrNoKndCdSt#,3,1) AND T1.ADT_MTTR_NM LIKE '%'||#strAudSbjNm#||'%' AND T2.ENFC_YMD IS NOT NULL AND T3.PBRL_SBMSN_YMD IS NOT NULL AND T3.REG_YMD IS NOT NULL AND T4.C_PRL_SMT_DT IS NOT NULL AND T4.C_REGI_DT IS NOT NULL ORDER BY T1.CVLCPT_ADT_YR DESC, T1.ADT_NO DESC