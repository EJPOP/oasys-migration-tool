SELECT '(' || SUBSTR(A.PNSH_DT, 1, 4) || CASE WHEN LENGTH(A.PNSH_DT) > 4 THEN '.' || SUBSTR(A.PNSH_DT, 5, 2) ELSE '' END || CASE WHEN LENGTH(A.PNSH_DT) > 6 THEN '.' || SUBSTR(A.PNSH_DT, 7, 2) ELSE '' END || ')' AS SUBSTR /* 징계일 */,
    F_CODE_NM('1000064', A.PNSH_TYP_CD) AS F_CODE_NM /* 징계유형코드 */,
    CASE WHEN A.WRDO_TXT IS NOT NULL THEN '(' || A.WRDO_TXT || ')' END AS WRDO_TXT /* 비위내용 */,
    CASE WHEN A.PNSH_ORG_CD IS NOT NULL THEN (SELECT B.PROF_RBPRSN_INST_NM AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */
FROM TBDCMACM015M B WHERE B.INST_CD = A.PNSH_ORG_CD) END AS PNSH_ORG_NM /* 징계기관명 */ , '변경일:'||TO_CHAR(A.LAST_MDFCN_DT, 'YYYY.MM.DD') AS MDFCN_YMD /* 변경일 */ FROM TBCSPBII351L A WHERE A.CRU_RRNO_SCRTY = #CRU_RRNO_SCRTY# ORDER BY A.PNSH_DT