SELECT '(' || SUBSTR(A.ISPCT_STR_DT, 1, 4) || CASE WHEN LENGTH(A.ISPCT_STR_DT) > 4 THEN '.' || SUBSTR(A.ISPCT_STR_DT, 5, 2) ELSE '' END || CASE WHEN LENGTH(A.ISPCT_STR_DT) > 6 THEN '.' || SUBSTR(A.ISPCT_STR_DT, 7, 2) ELSE '' END || '~' || SUBSTR(A.ISPCT_END_DT, 1, 4) || CASE WHEN LENGTH(A.ISPCT_END_DT) > 4 THEN '.' || SUBSTR(A.ISPCT_END_DT, 5, 2) ELSE '' END || CASE WHEN LENGTH(A.ISPCT_END_DT) > 6 THEN '.' || SUBSTR(A.ISPCT_END_DT, 7, 2) ELSE '' END || ')' AS SUBSTR /* 기간 */,
    A.ISPCT_STUD_SPH_NM /* 시찰수학분야명 */,
    A.NAT_NM /* 국가명 */,
    A.TNG_ISPCT_ORG_NM /* 연수시찰기관명 */,
    CASE WHEN A.ENF_ORG_NM IS NOT NULL THEN '[시행기관:' || A.ENF_ORG_NM || ']' END AS ENF_ORG_NM /* 시행기관명 */
FROM TBCSPBII322L A WHERE A.CRU_RRNO_SCRTY = #CRU_RRNO_SCRTY# ORDER BY A.ISPCT_STR_DT , A.ISPCT_END_DT