SELECT '(' || SUBSTR(A.TRN_STR_DT, 1, 4) || CASE WHEN LENGTH(A.TRN_STR_DT) > 4 THEN '.' || SUBSTR(A.TRN_STR_DT, 5, 2) ELSE '' END || CASE WHEN LENGTH(A.TRN_STR_DT) > 6 THEN '.' || SUBSTR(A.TRN_STR_DT, 7, 2) ELSE '' END || '~' || SUBSTR(A.TRN_END_DT, 1, 4) || CASE WHEN LENGTH(A.TRN_END_DT) > 4 THEN '.' || SUBSTR(A.TRN_END_DT, 5, 2) ELSE '' END || CASE WHEN LENGTH(A.TRN_END_DT) > 6 THEN '.' || SUBSTR(A.TRN_END_DT, 7, 2) ELSE '' END || ')' AS SUBSTR /* 기간 */,
    A.TRN_CRS_NM /* 훈련과정명 */,
    CASE WHEN A.TRN_ORG_NM IS NOT NULL THEN '(' || A.TRN_ORG_NM || ')' END AS TRN_ORG_NM /* 훈련기관명 */,
    CASE WHEN F_CODE_NM('1000065', A.TRN_DVSN_CD) IS NOT NULL THEN '[구분:' || F_CODE_NM('1000065', A.TRN_DVSN_CD) || ']' END AS F_CODE_NM /* 훈련구분명 */
FROM TBCSPBII321L A WHERE A.CRU_RRNO_SCRTY = #CRU_RRNO_SCRTY# ORDER BY A.TRN_STR_DT , A.TRN_END_DT