SELECT '(' || SUBSTR(A.ENT_DT, 1, 4) || CASE WHEN LENGTH(A.ENT_DT) > 4 THEN '.' || SUBSTR(A.ENT_DT, 5, 2) ELSE '' END || CASE WHEN LENGTH(A.ENT_DT) > 6 THEN '.' || SUBSTR(A.ENT_DT, 7, 2) ELSE '' END || '~' || SUBSTR(A.GRD_DT, 1, 4) || CASE WHEN LENGTH(A.GRD_DT) > 4 THEN '.' || SUBSTR(A.GRD_DT, 5, 2) ELSE '' END || CASE WHEN LENGTH(A.GRD_DT) > 6 THEN '.' || SUBSTR(A.GRD_DT, 7, 2) ELSE '' END || ')' AS SUBSTR /* 기간 */,
    A.SCHL_NM /* 학교명 */,
    A.MJR_TXT /* 전공학과내용 */,
    CASE WHEN F_CODE_NM('1000066', A.DEG_CD) IS NOT NULL THEN '(' || F_CODE_NM('1000066', A.DEG_CD) || ')' END AS F_CODE_NM /* 학위명 */
FROM TBCSPBII320L A WHERE A.CRU_RRNO_SCRTY = #CRU_RRNO_SCRTY# ORDER BY A.ENT_DT , A.GRD_DT