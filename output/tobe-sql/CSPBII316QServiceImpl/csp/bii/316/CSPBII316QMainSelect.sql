SELECT A.CRU_RRNO_SCRTY /* 부패주민등록번호보안 */,
    A.INFO_RLPR_NM /* 정보관계자명 */,
    CASE WHEN A.CHC_NAM IS NOT NULL THEN '[' || CHC_NAM || ']' ELSE '' END AS CHC_NAM,
    SUBSTR(CRU_RRNO_SCRTY, 1, 6) || '-*******' AS SUBSTR,
    A.CRU_RRNO_SCRTY /* 부패주민등록번호보안 */,
    F_CODE_NM('1000084', A.EPS_MNG_DVSN_CD) || ' | 근무기간(' || (SELECT SUBSTR(MIN(B.JOCP_DT), 1, 4) || CASE WHEN LENGTH(MIN(B.JOCP_DT)) > 4 THEN '.' || SUBSTR(MIN(B.JOCP_DT), 5, 2) ELSE '' END || CASE WHEN LENGTH(MIN(B.JOCP_DT)) > 6 THEN '.' || SUBSTR(MIN(B.JOCP_DT), 7, 2) ELSE '' AS F_CODE_NM
FROM TBCSPBII610L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) ||' ~ '|| DECODE(NVL(A.RSG_YN, 'N'), 'Y', SUBSTR(A.RTRM_YMD, 1, 4) || CASE WHEN LENGTH(A.RTRM_YMD) > 4 THEN '.' || SUBSTR(A.RTRM_YMD, 5, 2) ELSE '' END || CASE WHEN LENGTH(A.RTRM_YMD) > 6 THEN '.' || SUBSTR(A.RTRM_YMD, 7, 2) ELSE '' END, '현재') || ')' AS EPS_DVSN_NM /* 중점구분 */ , (SELECT B.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */
FROM TBDCMACM015M B WHERE B.INST_CD = A.OGDP_INST_CD) || CASE WHEN (SELECT 1
FROM TBCSPBII300M B WHERE B.ORGCHF_YN = 'Y' AND B.OGDP_INST_CD = A.OGDP_INST_CD AND ROWNUM = 1) IS NOT NULL THEN ' (' || (SELECT MAX(INFO_RLPR_NM) KEEP (DENSE_RANK LAST ORDER BY LAST_MDFCN_DT) AS INFO_RLPR_NM /* 정보관계자명 */
FROM TBCSPBII300M B WHERE B.ORGCHF_YN = 'Y' AND B.OGDP_INST_CD = A.OGDP_INST_CD) || ')' ELSE '' END || CASE WHEN A.CRU_OGDP_DEPT_NM IS NOT NULL THEN ' (' || A.CRU_OGDP_DEPT_NM || ')' ELSE '' END AS TPOF_OGDP_INST_NM /* 소속기관명 */ , A.JBPS_NM || ' | ' || A.JBGD_NM || '(' || F_CODE_NM('1000173', A.CLSS_CD) || ', ' || F_CODE_NM('1000058', A.CRSP_OD_RANK_CD) || ')' AS JBPS_NM , A.OTSD_EXPRT_ADDR || CASE WHEN A.CRU_TELNO IS NOT NULL THEN ' 전화(' || A.CRU_TELNO || ')' ELSE '' END || CASE WHEN A.CNSTN_MBCMT_FAX_NO IS NOT NULL THEN ' 팩스(' || A.CNSTN_MBCMT_FAX_NO || ')' ELSE '' END || CASE WHEN A.EML_ADDR IS NOT NULL THEN ' 이메일(' || A.EML_ADDR || ')' ELSE '' END AS OTSD_EXPRT_ADDR , F_CODE_NM('1000061', A.DICE_DVSN_CD) || CASE WHEN A.EMP_RSN_CD IS NOT NULL THEN '(' || F_CODE_NM('1000062', A.EMP_RSN_CD) || ')' ELSE '' END || CASE WHEN A.RLG_CD IS NOT NULL THEN ' | ' || F_CODE_NM('1000060', A.RLG_CD) ELSE '' END AS DICE_DVSN_NM , CASE WHEN A.MTRL_SRC_CD IS NOT NULL THEN F_CODE_NM('1000067', A.MTRL_SRC_CD) ELSE '' END || ' | ' || A.FRST_USER_ID || '(' || TO_CHAR(A.FRST_REG_DT, 'YYYY.MM.DD') || ' 등록, ' || TO_CHAR(A.LAST_MDFCN_DT, 'YYYY.MM.DD') || ' 수정)' AS MTRL_SRC_NM , A.ETC_TXT , A.CVLCPT_DOC_ID , (SELECT COUNT(*)
FROM TB_BADEAR007M B ,TB_BADEAR002D X WHERE B.CVLCPT_ADT_YR = X.CVLCPT_ADT_YR AND B.ADT_NO = X.ADT_NO AND B.DSPS_RQT_SQNO = X.DSPS_RQT_SQNO AND X.CFMTN_STTS_SECD IN ('1','2') AND B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS BAI_MTRL_CNT01 , (SELECT COUNT(*)
FROM TB_CSPBII130L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS BAI_MTRL_CNT02 , (SELECT COUNT(*)
FROM TBFAAAEA032M B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS BAI_MTRL_CNT04 , (SELECT COUNT(*)
FROM TB_BADGDA001L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS BAI_MTRL_CNT05 , (SELECT COUNT(*)
FROM TBCSPBII401L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS BAI_MTRL_CNT06 , (SELECT COUNT(*)
FROM TBCSPBII500L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS BAI_MTRL_CNT07 , (SELECT COUNT(*)
FROM TBCSPBII630L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS BAI_MTRL_CNT08 , 0 AS HRA_MTRL_CNT01 , 0 AS HRA_MTRL_CNT02 , (SELECT COUNT(*)
FROM TBCSPBII320L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS HRA_MTRL_CNT03 , (SELECT COUNT(*)
FROM TBCSPBII330L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS HRA_MTRL_CNT04 , (SELECT COUNT(*)
FROM TBCSPBII342L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS HRA_MTRL_CNT05 , (SELECT COUNT(*)
FROM TBCSPBII360L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS HRA_MTRL_CNT06 , (SELECT COUNT(*)
FROM TBCSPBII340L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS HRA_MTRL_CNT07 , (SELECT COUNT(*)
FROM TBCSPBII341L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS HRA_MTRL_CNT08 , (SELECT COUNT(*)
FROM TBCSPBII350L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS HRA_MTRL_CNT09 , (SELECT COUNT(*)
FROM TBCSPBII351L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS HRA_MTRL_CNT10 , (SELECT COUNT(*)
FROM TBCSPBII321L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS HRA_MTRL_CNT11 , (SELECT COUNT(*)
FROM TBCSPBII322L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS HRA_MTRL_CNT12 , (SELECT COUNT(*)
FROM TBCSPBII610L B WHERE B.CRU_RRNO_SCRTY = A.CRU_RRNO_SCRTY) AS HRA_MTRL_CNT13 FROM TBCSPBII300M A /* 대인정보기본 */ WHERE A.CRU_RRNO_SCRTY = #CRU_RRNO_SCRTY#