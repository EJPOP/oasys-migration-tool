SELECT F_DPT_INFO(MAN.BLT_DPT_CD , '1') AS CRU_OGDP_DEPT_NM /* 부패소속부서명 */,
    F_CODE_NM('1000173', MAN.JBGD_SECD) AS JBGD_NM /* 직급명 */,
    F_USR_INFO(MAN.NEVLT_CNB, '2') AS F_USR_INFO /* 피평가자 이름 */,
    F_CODE_NM('1000280', NVL(EVL.EVL_STA_CD, '100')) AS F_CODE_NM /* 평가상태 */,
    MAN.NEVLT_CNB /* 피평가자 전산번호 */,
    MAN.EVL_GP_CD AS EVL_GP_CD /* 평가군 코드 */,
    MAN.EVL_YR AS EVL_YR,
    MAN.HLYR_DVSN_CD AS HLYR_DVSN_CD,
    MAN.EVLT_CNB AS EVLT_CNB /* 평가자 전산번호 */,
    F_USR_INFO (MAN.EVLT_CNB,'2') AS F_USR_INFO /* 평가자 이름 */
FROM ( /*각 부서의 과장들이 평가할 리스트*/ SELECT D1.EVL_YR,
    D1.HLYR_DVSN_CD,
    D1.EVL_GP_CD,
    D1.EVL_GP_NM,
    D2.EVLT_CNB /* 평가자 전산번호 */,
    D3.NEVLT_CNB /* 피평가자 전산번호 */,
    D3.BLT_DPT_CD /* 피평가자 소속부서코드 */,
    D3.JBGD_SECD /* 직급구분코드 */,
    D3.EVLT_CNB
FROM TBCSPAOE018M D1 , TBCSPAOE019D D2 , TBCSPAOE020D D3 WHERE D1.EVL_YR = D2.EVL_YR AND D1.HLYR_DVSN_CD = D2.HLYR_DVSN_CD AND D1.EVL_GP_CD = D2.EVL_GP_CD AND D1.EVL_YR = D3.EVL_YR AND D1.HLYR_DVSN_CD = D3.HLYR_DVSN_CD AND D1.EVL_GP_CD = D3.EVL_GP_CD AND D1.EVL_YR = #strEvlYr# AND D1.HLYR_DVSN_CD = #strHlyrDvsnCd# AND D2.EVLT_CNB = #strEvlCnb# /*로그인한 평가자 전산번호*/ ) MAN /*운영직업무 평가자 리스트*/ , ( SELECT EVL_YR,
    HLYR_DVSN_CD,
    NEVLT_CNB,
    EVL_CMTR_CNB,
    MIN(EVL_STA_CD) AS EVL_STA_CD,
    MIN(EVL_CMTR_DVSN_CD) AS EVL_CMTR_DVSN_CD
FROM TBCSPAOE032M WHERE EVL_YR = #strEvlYr# AND HLYR_DVSN_CD = #strHlyrDvsnCd# GROUP BY EVL_YR, HLYR_DVSN_CD, NEVLT_CNB, EVL_CMTR_CNB ) EVL WHERE MAN.EVL_YR = EVL.EVL_YR (+) AND MAN.HLYR_DVSN_CD = EVL.HLYR_DVSN_CD (+) AND MAN.NEVLT_CNB = EVL.NEVLT_CNB (+) AND MAN.EVLT_CNB = EVL.EVL_CMTR_CNB (+) AND MAN.EVL_GP_CD = EVL.EVL_CMTR_DVSN_CD (+) and case when MAN.W_EVLT_CNB = MAN.EVLT_CNB then 1 when MAN.W_EVLT_CNB <> MAN.EVLT_CNB and (select count(1)
from TBCSPAOE032M s1 where MAN.EVL_YR = S1.EVL_YR and MAN.HLYR_DVSN_CD = S1.HLYR_DVSN_CD and MAN.NEVLT_CNB = S1.NEVLT_CNB and MAN.W_EVLT_CNB = S1.EVL_CMTR_CNB and MAN.EVL_GP_CD = S1.EVL_CMTR_DVSN_CD) > 0 then 1 else 0 end = 1 AND NVL(EVL.EVL_STA_CD, '100') = #strEvlStaCd#