/* 특정일 기준으로 계산에 필요한 날짜 계산 */ WITH BASE_DATE_CTE AS (SELECT CASE WHEN #strStdDt# = '20250814' THEN TO_DATE('20250814' , 'YYYYMMDD') + 1 ELSE TO_DATE(#strStdDt# , 'YYYYMMDD') END AS #STRSTDDT#
FROM DUAL) SELECT DT AS DT,
    TO_CHAR(TO_DATE(DT), 'YYYY-MM-DD') || '(' || TO_CHAR(TO_DATE(DT), 'DY', 'NLS_DATE_LANGUAGE=korean') || ')' AS TO_CHAR,
    CASE WHEN (SELECT COUNT(1)
FROM TB_BADDED013B WHERE INFO_YR || HLDY_CRTR_MND = T1.DT) > 0 THEN 'Y' WHEN (SELECT COUNT(1)
FROM TBCSPMWF011M WHERE HLDY = T1.DT AND BOKG_DVSN_CD = '1') > 0 THEN 'Y' /* 임시휴일 적용 - 2019.07.29 yyh */ ELSE 'N' END AS HOLIDAY_YN FROM ( SELECT TO_CHAR(LEVEL + 2 + (SELECT NEXT_DAY(TO_DATE(BASE_DATE_CTE.BASE_DATE), 6) - 7
FROM DUAL), 'YYYYMMDD') AS DT FROM BASE_DATE_CTE , DUAL CONNECT BY LEVEL <= 5 ) T1 ORDER BY DT