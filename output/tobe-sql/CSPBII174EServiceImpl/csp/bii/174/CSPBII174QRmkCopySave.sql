UPDATE TB_CSPBII160L D1 SET MLG_RMRK_CN = ( SELECT S1.MLG_RMRK_CN /* 마일리지비고내용 */
FROM TB_CSPBII160L S1 WHERE S1.INFO_YR = CASE WHEN #INFO_MLG_QTR_SECD# = '1' THEN TO_NUMBER(#INFO_YR#) -1 ELSE TO_NUMBER(#INFO_YR#) END AND S1.INFO_MLG_QTR_SECD = DECODE(#INFO_MLG_QTR_SECD#, '1', '4', '2','1','3','2','4','3') AND S1.TRGT_NOP_ENO = D1.INFO_PRSNR_ENO) WHERE INFO_YR = #INFO_YR# AND INFO_MLG_QTR_SECD = #INFO_MLG_QTR_SECD#