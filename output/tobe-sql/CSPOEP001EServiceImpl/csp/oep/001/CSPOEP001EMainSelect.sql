SELECT T1.*,
    ROWNUM
FROM ( SELECT A.VI_DT,
    A.VI_HM,
    SUBSTR(A.VI_HM, 0,2) AS SUBSTR,
    SUBSTR(A.VI_HM, 3,2) AS SUBSTR,
    TO_CHAR(TO_DATE(A.VI_DT), 'YYYY-MM-DD') || ' ' || TO_CHAR(TO_DATE(A.VI_HM, 'HH24:MI'), 'HH24:MI') AS TO_CHAR,
    A.VI_SLN,
    A.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    (SELECT AS CRU_TELNO /* 부패전화번호 */
FROM TBDCMACM001M M WHERE M.TRGT_NOP_ENO = A.TRGT_NOP_ENO) IN_TNB, A.BLT_BRDV_NM, A.OGDP_DEPT_CD, A.INFO_RLPR_NM, CASE WHEN A.JBGD_SECD IN (SELECT CD
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000173') THEN A.JBGD_SECD ELSE '' END AS JBGD_SECD, CASE WHEN A.JBGD_SECD IN (SELECT CD
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000173') THEN F_CODE_NM('1000173', A.JBGD_SECD) ELSE '' END AS JBGD_NM, A.SLCT_OOFC_NM, A.VI_PEN_RGN_CD, A.VI_PEN_NAM, A.TPOF_NOPE, A.VI_PEN_NAM || '(' || NVL(A.TPOF_NOPE,0) || ')' AS NM, A.CAR_NO, A.VI_PPS_CD, A.VI_PPS_TXT, A.VI_WAY_CD, A.CRU_TELNO, A.IO_NO, #fromYmd# AS FROMYMD, #toYmd# AS TOYMD, A.REN_DT, A.REN_HH, A.REN_MM, TO_CHAR(TO_DATE(A.REN_DT), 'YYYY-MM-DD') || ' ' || TO_CHAR(TO_DATE((A.REN_HH||A.REN_MM), 'HH24:MI'), 'HH24:MI') AS REN_TIME, NVL2(REN_DT,'반납','출입') AS REN_STATUS, A.VI_WAY_TXT FROM TBCSPOEP001M A WHERE 1=1 AND A.VI_DT &gt;= #fromYmd# AND A.VI_DT &lt;= #toYmd# AND A.OGDP_DEPT_CD = #OGDP_DEPT_CD# AND A.JBGD_SECD = #JBGD_SECD# AND A.TRGT_NOP_ENO = #TRGT_NOP_ENO# AND A.IO_NO LIKE '%'||#ioNo#||'%' AND A.SLCT_OOFC_NM LIKE '%'||#workPlace#||'%' AND A.CAR_NO LIKE '%'||#carNo#||'%' AND A.VI_PEN_NAM LIKE '%'||#name#||'%' ORDER BY A.VI_DT DESC, A.VI_HM DESC) T1