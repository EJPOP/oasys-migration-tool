SELECT DECODE(A.TG_CAT_ID,'00','총계',TG_CAT_NM) AS TG_CAT_ID,
    A.TG_CAT_ID,
    DECODE(A.TG_CAT_ID,'00','',NM2) AS TG_CAT_ID,
    A.CNT,
    A.SUM1,
    A.SUM2,
    A.SUM3,
    A.SUM4,
    A.SUM5,
    A.SUM6
FROM ( SELECT CASE WHEN B.CD IN ('01','02','03','04','05') THEN '연구보고서' WHEN B.CD IN ('06','07','08') THEN '정기간행물' WHEN B.CD = '09' THEN '세미나자료' ELSE '기타' END AS TG_CAT_NM ,NVL2(B.CD,B.CD,'00') AS TG_CAT_ID ,MAX(B.CD_NM) AS NM2 ,COUNT(A.RSCH_ASMT_RSCH_TPCD) AS CNT ,NVL(SUM(CASE WHEN TO_CHAR(TO_DATE(SRECS_RPT_YMD),'YYYY')= TO_CHAR(SYSDATE,'YYYY') THEN 1 ELSE 0 END ),0) AS SUM1 ,SUM(CASE WHEN TO_CHAR(TO_DATE(SRECS_RPT_YMD),'YYYY')= (TO_CHAR(SYSDATE,'YYYY')-1) THEN 1 ELSE 0 END ) AS SUM2 ,SUM(CASE WHEN TO_CHAR(TO_DATE(SRECS_RPT_YMD),'YYYY')= (TO_CHAR(SYSDATE,'YYYY')-2) THEN 1 ELSE 0 END ) AS SUM3 ,SUM(CASE WHEN TO_CHAR(TO_DATE(SRECS_RPT_YMD),'YYYY')= (TO_CHAR(SYSDATE,'YYYY')-3) THEN 1 ELSE 0 END ) AS SUM4 ,SUM(CASE WHEN TO_CHAR(TO_DATE(SRECS_RPT_YMD),'YYYY')= (TO_CHAR(SYSDATE,'YYYY')-4) THEN 1 ELSE 0 END ) AS SUM5 ,SUM(CASE WHEN TO_CHAR(TO_DATE(SRECS_RPT_YMD),'YYYY') '000000000' AND A.RSCH_ASMT_SECD(+) = '3' GROUP BY ROLLUP (B.CD) ) A ORDER BY A.TG_CAT_ID ASC