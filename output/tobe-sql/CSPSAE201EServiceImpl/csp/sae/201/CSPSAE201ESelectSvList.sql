SELECT #LINK_YR# AS LINK_YR /* 연계년도 */,
    #strEDU_CRS_CD# AS #STREDU_CRS_CD#,
    #CRS_CDN# AS CRS_CDN /* 과정기수 */,
    B.SV_QEST_NO,
    B.SV_TIT_CD,
    B.SUB_QEST_NO,
    B.SV_QEST_TXT,
    B.QEST_DVSN_CD,
    B.SV_CLU_NO,
    B.SV_CLU_TXT,
    NVL((SELECT AS RP_CNT
FROM TBCSPSAE302D WHERE LINK_YR = A.LINK_YR AND CRS_CD = A.CRS_CD AND CRS_CDN = A.CRS_CDN AND SV_QEST_NO = A.SV_QEST_NO AND SV_CLU_NO = B.SV_CLU_NO), 0) AS RP_CNT, A.RP_TXT, A.SV_DT FROM ( SELECT A.LINK_YR /* 연계년도 */,
    A.CRS_CD,
    A.CRS_CDN /* 과정기수 */,
    A.SV_TIT_CD,
    A.SV_QEST_NO,
    A.SV_CLU_NO,
    A.RP_CNT,
    A.RP_TXT,
    B.SV_DT
FROM TBCSPSAE302D A , TBCSPSAE201D B WHERE B.LINK_YR = A.LINK_YR AND B.CRS_CD = A.CRS_CD AND B.CRS_CDN = A.CRS_CDN AND A.LINK_YR = #LINK_YR# AND A.CRS_CD = #strEDU_CRS_CD# AND A.CRS_CDN = #CRS_CDN# AND B.SV_DT = #SV_DT# ) A , ( SELECT C.SV_TIT_CD,
    C.SUB_QEST_NO,
    C.SV_QEST_NO,
    C.SV_QEST_TXT,
    C.QEST_DVSN_CD,
    D.SV_CLU_NO,
    D.SV_CLU_TXT
FROM TBCSPSAE122C C , TBCSPSAE123C D WHERE D.SV_TIT_CD = C.SV_TIT_CD AND D.SV_QEST_NO = C.SV_QEST_NO AND C.SV_TIT_CD = (SELECT MAX(A.SV_TIT_CD) AS SV_TIT_CD
FROM TBCSPSAE302D A , TBCSPSAE201D B WHERE B.LINK_YR = A.LINK_YR AND B.CRS_CD = A.CRS_CD AND B.CRS_CDN = A.CRS_CDN AND A.LINK_YR = #LINK_YR# AND A.CRS_CD = #strEDU_CRS_CD# AND A.CRS_CDN = #CRS_CDN# AND B.SV_DT = #SV_DT#) ) B WHERE A.SV_TIT_CD(+) = B.SV_TIT_CD AND A.SV_QEST_NO(+) = B.SV_QEST_NO AND A.SV_CLU_NO(+) = B.SV_CLU_NO AND B.SV_CLU_NO IS NOT NULL ORDER BY B.SV_QEST_NO, B.SV_CLU_NO