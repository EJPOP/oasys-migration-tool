/* 강사료 조회 */ SELECT A.LINK_YR /* 연계년도 */,
    A.CRS_CD /* 교육과정코드 */,
    A.CRS_CDN /* 과정기수 */,
    D.PFSR_DVSN_CD /* 강사구분코드 */,
    (SELECT AS CD_NM
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000312' AND CD = D.PFSR_DVSN_CD) AS PFSR_DVSN_NM /* 강사구분명 */ , A.SUBJ_CD /* 과목코드 */ , C.BLL_SBJCT_NM /* 과목명 */ , A.PFSR_ID /* 강사아이디 */ , D.PFSR_BLT_NM || '-' || D.INFO_RLPR_NM AS INFO_RLPR_NM /* 강사명 */ , MAX(E.ASG_SNO) AS LCT_TIME /* 강의시간 */ , NVL(B.BSC_PFSR_FEE, (1*F.BSC_PFSR_FEE)) AS BSC_PFSR_FEE /* 기본강사료 */ , NVL(B.EXCS_PFSR_FEE, (MAX(E.ASG_SNO)-1)*F.EXCS_PFSR_FEE) AS EXCS_PFSR_FEE /* 초과강사료 */ , NVL(B.BSC_PFSR_FEE, (1*F.BSC_PFSR_FEE)) + NVL(B.EXCS_PFSR_FEE, (MAX(E.ASG_SNO)-1)*F.EXCS_PFSR_FEE) AS AB /* 강사료(기본+초과) */ , NVL(B.TREP, 0) AS TREP /* 교통비 */ , NVL(B.BSC_PFSR_FEE, (1*F.BSC_PFSR_FEE)) + NVL(B.EXCS_PFSR_FEE, (MAX(E.ASG_SNO)-1)*F.EXCS_PFSR_FEE) + NVL(B.TREP, 0) AS ABC /* 강사료(기본+초과+교통) */ , NVL(B.TAX_RTE, 0) AS TAX_RTE /* 세율 */ , (NVL(B.BSC_PFSR_FEE, (1*F.BSC_PFSR_FEE)) + NVL(B.EXCS_PFSR_FEE, (MAX(E.ASG_SNO)-1)*F.EXCS_PFSR_FEE) + NVL(B.TREP, 0)) * NVL(B.TAX_RTE, 0) AS EE /* 세액(기본+초과+교통)*세율 */ , NVL(B.GIVE_AMT, (NVL(B.BSC_PFSR_FEE, (1*F.BSC_PFSR_FEE)) + NVL(B.EXCS_PFSR_FEE, (MAX(E.ASG_SNO)-1)*F.EXCS_PFSR_FEE) + NVL(B.TREP, 0))-((NVL(B.BSC_PFSR_FEE, (1*F.BSC_PFSR_FEE)) + NVL(B.EXCS_PFSR_FEE, (MAX(E.ASG_SNO)-1)*F.EXCS_PFSR_FEE) + NVL(B.TREP, 0)) * NVL(B.TAX_RTE, 0))) AS GIVE_AMT /* 강사료 */ , NVL(B.DEPTS_BNK_NM, D.DEPTS_BNK_NM) AS DEPTS_BNK_NM /* 은행명 */ , D.ACTNO_SCRTY , NVL(B.PMT_YN, 'N') AS PMT_YN /* 지급여부 */ FROM TBCSPSAE101D A , TBCSPSAE305D B , TBCSPSAE101M C , TBCSPSAE109M D , TBCSPSAE202D E , (SELECT PFSR_RK_CD,
    BSC_PFSR_FEE,
    EXCS_PFSR_FEE,
    APC_DT
FROM TBCSPSAE112B) F WHERE 1=1 AND A.LINK_YR = B.LINK_YR(+) AND A.CRS_CD = B.CRS_CD(+) AND A.CRS_CDN = B.CRS_CDN(+) AND A.SUBJ_CD = B.SUBJ_CD(+) AND A.PFSR_ID = B.PFSR_ID(+) AND C.SUBJ_CD = A.SUBJ_CD AND D.PFSR_ID = A.PFSR_ID AND E.LINK_YR = A.LINK_YR AND E.CRS_CD = A.CRS_CD AND E.CRS_CDN = A.CRS_CDN AND E.SUBJ_CD = A.SUBJ_CD AND E.PFSR_ID = A.PFSR_ID AND F.PFSR_RK_CD = D.PFSR_RK_CD AND F.APC_DT = (SELECT MAX(APC_DT) AS APC_DT
FROM TBCSPSAE112B WHERE APC_DT <= E.LCT_DT) AND C.BSC_OP_SUBJ_YN != 'Y' AND A.LINK_YR = #LINK_YR# AND A.CRS_CD = #strEDU_CRS_CD# AND A.CRS_CDN = #CRS_CDN# GROUP BY A.LINK_YR, A.CRS_CD, A.CRS_CDN, D.PFSR_DVSN_CD, A.SUBJ_CD, C.BLL_SBJCT_NM, A.PFSR_ID, D.PFSR_BLT_NM, D.INFO_RLPR_NM, B.BSC_PFSR_FEE, B.EXCS_PFSR_FEE, B.TREP, B.TAX_RTE, B.GIVE_AMT, B.DEPTS_BNK_NM, D.DEPTS_BNK_NM, D.ACTNO_SCRTY, B.PMT_YN, F.PFSR_RK_CD, F.BSC_PFSR_FEE, A.LCT_TM_HM, A.JON_TM_HM, A.ETC_TM_HM, F.BSC_PFSR_FEE, F.EXCS_PFSR_FEE ORDER BY PFSR_DVSN_CD, SUBJ_CD, INFO_RLPR_NM