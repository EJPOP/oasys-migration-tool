SELECT /* CSPNBK115PMouiListSelect */ D1.MOUI_DVSN_CD,
    DECODE( D1.MOUI_DVSN_CD, '0', '개인', '1', '단체' ) AS MOUI_DVSN_CD,
    D1.MOUI_NO,
    DECODE( D1.MOUI_DVSN_CD, '0', D2.USER_NM, '1', D1.OGNZ_NM ) AS MOUI_DVSN_CD,
    D2.USER_NM /* 사용자명 */,
    D1.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    SUBSTR(D2.CRU_RRNO_SCRTY, 1, 6) || '-*******' AS CRU_RRNO_SCRTY /* 부패주민등록번호보안 */,
    D3.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    TO_CHAR(SYSDATE, 'YYYYMMDD') AS TO_CHAR,
    F_CODE_NM( '1000176', D2.JBPS_CD ) AS F_CODE_NM,
    F_CODE_NM( '1000173', D2.JBGD_SECD ) AS F_CODE_NM,
    D4.INV_BL
FROM TBCSPNBK001M D1 , TBDCMACM001M D2 , TBDCMACM002M D3 , TBCSPNBK101M D4 WHERE D1.TRGT_NOP_ENO = D2.TRGT_NOP_ENO AND D2.SRECS_DEPT_CD = D3.SRECS_DEPT_CD AND D1.MOUI_NO = D4.MOUI_NO(+) D1.MOUI_DVSN_CD = #mouiDvsnCd# ( (D1.MOUI_NO = #TRGT_NOP_ENO#) OR ( (D2.USER_NM LIKE #TRGT_NOP_ENO# || '%') OR (D1.OGNZ_NM LIKE #TRGT_NOP_ENO# || '%' ) ) OR ( D1.TRGT_NOP_ENO = #TRGT_NOP_ENO# ) ) D1.TRGT_NOP_ENO = #TRGT_NOP_ENO# D1.SCS_YN = #scsYn# D3.SRECS_DEPT_CD = '880880' D3.SRECS_DEPT_CD != '880880' ORDER BY MOUI_NO