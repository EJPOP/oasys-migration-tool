SELECT D1.INST_CD /* 기관코드 */,
    D1.NTFCTN_SECD /* 통보구분코드 */,
    D1.LINK_YR /* 연계년도 */,
    D1.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    F_DPT_INFO(D1.SRECS_DEPT_CD, '1') AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    D1.NTFCTN_SQNO /* 통보순번 */,
    D1.STT_RCPT_STTS_SECD /* 법령접수상태구분코드 */,
    CASE WHEN D1.STT_RCPT_STTS_SECD IN ('58','59') THEN '미접수' WHEN D1.STT_RCPT_STTS_SECD IN ('71','72','76') THEN '처리중' WHEN D1.STT_RCPT_STTS_SECD = '75' THEN '결재중' WHEN D1.STT_RCPT_STTS_SECD = '77' THEN '완결' ELSE D1.STT_RCPT_STTS_SECD END AS STT_RCPT_STTS_SECD /* 법령접수상태구분코드 */,
    D1.NTFCTN_RCPT_MNG_NO /* 통보접수관리번호 */,
    D1.NTFCTN_RCPT_YMD /* 통보접수일자 */,
    D1.DGE1_INST_RCPT_YMD /* 1차기관접수일자 */,
    D1.BAI_DEPT_CD /* 감사원부서코드 */,
    D1.JRSD_INST_CD /* 소관기관코드 */,
    D1.RSCH_ASMT_TTL /* 연구과제제목 */,
    D1.VIOL_SECD /* 비위구분코드 */,
    D1.VIOL_NM /* 비위명 */,
    D1.SRECS_RLPR_NOPE /* 심사재심의관계자인원수 */,
    D1.NTFCTN_ETC_CN /* 통보기타내용 */,
    D1.OCRN_SECD /* 발생구분코드 */,
    D1.REG_YMD /* 등록일자 */,
    D1.RGTR_ID /* 등록자아이디 */,
    D1.GPCD_PRCS_YMD /* 처리일자 */,
    D1.TASK_SECD /* 업무구분코드 */,
    D1.HRM_AMT /* 손해금액 */,
    D1.RFND_AMT /* 환불금액 */,
    D1.SELF_CPS_AMT /* 자체변상금액 */,
    D1.OPM_NO /* 시행문번호 */,
    D1.APRV_YMD /* 승인일자 */,
    D1.CPLT_YMD /* 완결일자 */,
    D1.ENFC_KDCD /* 시행종류코드 */,
    D1.ADT_TRGT_INST_CD /* 감사대상기관코드 */,
    D1.EXCN_INST_CD /* 실행기관코드 */,
    D1.DOC_NO /* 문서번호 */,
    D1.DOC_YMD /* 문서일자 */,
    D1.CPADT_CLR_ENO /* 위탁대행감사접수자직원전산번호 */,
    D1.ATRZ_DOC_NO /* 결재문서번호 */,
    D1.PRCS_PIC_NM /* 처리담당자명 */,
    D1.PRCS_OPNN_SECD /* 처리의견구분코드 */,
    CASE WHEN D1.PRCS_OPNN_SECD IS NOT NULL THEN F_CODE_NM('1000200', D1.PRCS_OPNN_SECD) ELSE '미처리' END AS PRCS_OPNN_SECD /* 처리의견구분코드 */,
    D1.IDNTY_YN /* 확인여부 */,
    D1.IDNTY_DT /* 확인일시 */,
    D1.MDFCN_YMD /* 수정일자 */,
    D1.MDFCN_PIC_ID /* 수정담당자아이디 */,
    D1.RVW_RSLT_CN /* 검토결과내용 */,
    D1.PRCS_PIC_JBGD_NM /* 처리담당자직급명 */,
    D1.PRCS_STTS_CN /* 처리상태내용 */,
    D1.CMT_SBCN_CN /* 위원회부의내용 */,
    D1.ENFC_YMD /* 시행일자 */,
    D1.ADT_DATA_RMRK_CN /* 감사자료비고내용 */,
    D1.ADT_DATA_YR /* 감사자료년도 */,
    D1.ADT_DATA_DEPT_CD /* 감사자료부서코드 */,
    D1.ADT_DATA_SQNO /* 감사자료순번 */,
    D1.SELF_PRGRS_SECD /* 자체진행구분코드 */,
    D1.SELF_SNDNG_YMD /* 자체발송일자 */,
    D1.SELF_ATRZ_YMD /* 자체결재일자 */,
    D1.CVLCPT_DOC_ID /* 민원문서아이디 */,
    D1.ADT_PLAN_DOC_TPCD /* 감사계획문서유형코드 */,
    D1.FRST_USER_ID /* 최초사용자아이디 */,
    D1.LAST_USER_ID /* 최종사용자아이디 */,
    D1.LAST_PRCS_DEPT_CD /* 최종처리부서코드 */,
    D1.LAST_MENU_ID /* 최종메뉴아이디 */,
    D1.FRST_REG_DT /* 최초등록일시 */,
    D1.LAST_MDFCN_DT /* 최종수정일시 */,
    D1.LINK_RJCT_IDNO_NM /* 연계반려식별번호명 */,
    D1.LINK_YR /* 연계년도 */,
    D1.LINK_SQNO /* 연계순번 */,
    D2.DFNT_NMS /* 가공한 관계자명 */,
    (SELECT AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */
FROM TBDCMACM015M WHERE INST_CD = D1.INST_CD) || '-' || (SELECT CD_NM
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD ='1000202' AND CD = D1.OCRN_SECD AND NVL(USE_YN,'N') ='Y') || '-' || D1.NTFCTN_SQNO AS NTF_SBJ_NO /* 통보사항번호 */ FROM TB_BADGDA001M D1 /* 통보기본사항 */ ,( SELECT T1.NTFCTN_INST_CD AS NTFCTN_INST_CD /* 통보기관코드 */,
    T1.NTFCTN_SECD AS NTFCTN_SECD /* 통보구분코드 */,
    T1.NTFCTN_SQNO AS NTFCTN_SQNO /* 통보순번 */,
    CASE WHEN COUNT(T2.NTFCTN_SQNO) = 1 THEN MAX(T2.RLPR_NM) WHEN COUNT(T2.NTFCTN_SQNO) > 1 THEN MAX(T2.RLPR_NM) || '외 ' || ( COUNT(T2.NTFCTN_SQNO) - 1 ) || '명' ELSE '' END AS NTFCTN_SQNO /* 통보순번 */
FROM TBBADGDA001M T1 /* 통보사항 기본 */ ,TBBADGDA001L T2 /* 통보사항 관계자 내역 */ WHERE 1=1 AND T1.INST_CD = T2.INST_CD(+) AND T1.NTFCTN_SECD = T2.NTFCTN_SECD(+) AND T1.NTFCTN_SQNO = T2.NTFCTN_SQNO(+) AND T1.RSCH_ASMT_TTL LIKE '%' || #strSchTxt# || '%' GROUP BY T1.INST_CD, T1.NTFCTN_SECD, T1.NTFCTN_SQNO UNION SELECT T1.NTFCTN_INST_CD AS NTFCTN_INST_CD /* 통보기관코드 */,
    T1.NTFCTN_SECD AS NTFCTN_SECD /* 통보구분코드 */,
    T1.NTFCTN_SQNO AS NTFCTN_SQNO /* 통보순번 */,
    CASE WHEN COUNT(T1.NTFCTN_SQNO) = 1 THEN MAX(T1.RLPR_NM) WHEN COUNT(T1.NTFCTN_SQNO) > 1 THEN MAX(T1.RLPR_NM) || '외 ' || ( COUNT(T1.NTFCTN_SQNO) - 1 ) || '명' ELSE '' END AS NTFCTN_SQNO /* 통보순번 */
FROM TBBADGDA001L T1 /* 통보사항 관계자 내역 */ WHERE 1=1 AND T1.CRIM_VIOL_CN LIKE '%' || #strSchTxt# || '%' AND T1.RLPR_NM LIKE '%' || #strDfntNm# || '%' GROUP BY T1.INST_CD, T1.NTFCTN_SECD, T1.NTFCTN_SQNO ) D2 ,(SELECT T1.NTFCTN_INST_CD AS NTFCTN_INST_CD /* 통보기관코드 */,
    T1.NTFCTN_SECD AS NTFCTN_SECD /* 통보구분코드 */,
    T1.NTFCTN_SQNO AS NTFCTN_SQNO /* 통보순번 */,
    CASE WHEN COUNT(T2.NTFCTN_SQNO) = 1 THEN MAX(T2.RLPR_NM) WHEN COUNT(T2.NTFCTN_SQNO) > 1 THEN MAX(T2.RLPR_NM) || '외 ' || ( COUNT(T2.NTFCTN_SQNO) - 1 ) || '명' ELSE '' END AS NTFCTN_SQNO /* 통보순번 */
FROM TBBADGDA001M T1 /* 통보사항 기본 */ ,TBBADGDA001L T2 /* 통보사항 관계자 내역 */ WHERE 1=1 AND T1.INST_CD = T2.INST_CD(+) AND T1.NTFCTN_SECD = T2.NTFCTN_SECD(+) AND T1.NTFCTN_SQNO = T2.NTFCTN_SQNO(+) AND T1.RSCH_ASMT_TTL LIKE '%' || #strSchTxt# || '%' GROUP BY T1.INST_CD, T1.NTFCTN_SECD, T1.NTFCTN_SQNO ) D2 ,(SELECT T1.NTFCTN_INST_CD AS NTFCTN_INST_CD /* 통보기관코드 */,
    T1.NTFCTN_SECD AS NTFCTN_SECD /* 통보구분코드 */,
    T1.NTFCTN_SQNO AS NTFCTN_SQNO /* 통보순번 */,
    CASE WHEN COUNT(T1.NTFCTN_SQNO) = 1 THEN MAX(T1.RLPR_NM) WHEN COUNT(T1.NTFCTN_SQNO) > 1 THEN MAX(T1.RLPR_NM) || '외 ' || ( COUNT(T1.NTFCTN_SQNO) - 1 ) || '명' ELSE '' END AS NTFCTN_SQNO /* 통보순번 */
FROM TBBADGDA001L T1 /* 통보사항 관계자 내역 */ WHERE 1=1 AND T1.CRIM_VIOL_CN LIKE '%' || #strSchTxt# || '%' AND T1.RLPR_NM LIKE '%' || #strDfntNm# || '%' GROUP BY T1.INST_CD, T1.NTFCTN_SECD, T1.NTFCTN_SQNO ) D2 ,(SELECT T1.NTFCTN_INST_CD AS NTFCTN_INST_CD /* 통보기관코드 */,
    T1.NTFCTN_SECD AS NTFCTN_SECD /* 통보구분코드 */,
    T1.NTFCTN_SQNO AS NTFCTN_SQNO /* 통보순번 */,
    CASE WHEN COUNT(T2.NTFCTN_SQNO) = 1 THEN MAX(T2.RLPR_NM) WHEN COUNT(T2.NTFCTN_SQNO) > 1 THEN MAX(T2.RLPR_NM) || '외 ' || ( COUNT(T2.NTFCTN_SQNO) - 1 ) || '명' ELSE '' END AS NTFCTN_SQNO /* 통보순번 */
FROM TBBADGDA001M T1 /* 통보사항 기본 */ ,TBBADGDA001L T2 /* 통보사항 관계자 내역 */ WHERE 1=1 AND T1.INST_CD = T2.INST_CD(+) AND T1.NTFCTN_SECD = T2.NTFCTN_SECD(+) AND T1.NTFCTN_SQNO = T2.NTFCTN_SQNO(+) AND T2.RLPR_NM LIKE '%' || #strDfntNm# || '%' GROUP BY T1.INST_CD, T1.NTFCTN_SECD, T1.NTFCTN_SQNO ) D2 WHERE 1=1 AND D1.INST_CD = D2.INST_CD AND D1.NTFCTN_SECD = D2.NTFCTN_SECD AND D1.NTFCTN_SQNO = D2.NTFCTN_SQNO AND D1.NTFCTN_SECD = '1' /* 통보구분코드 (1:범죄및징계, 2:망실및훼손) */ AND D1.STT_RCPT_STTS_SECD != '51' AND D1.SRECS_DEPT_CD IN (SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TABLE(F_AUTH_DEPT(#strCnb#, #strDptAuth#, '', #strDptCd#))) AND D1.SRECS_DEPT_CD = #SRECS_DEPT_CD# AND D1.NTFCTN_RCPT_YMD BETWEEN #strAcpDtStr# AND #strAcpDtEnd# /* 접수일자 */ AND D1.STT_RCPT_STTS_SECD IN ('58', '59', '71', '72', '75', '76') AND D1.STT_RCPT_STTS_SECD IN ('71', '72', '76') AND D1.STT_RCPT_STTS_SECD = '75' AND D1.STT_RCPT_STTS_SECD = '77' AND D1.OCRN_SECD IN ('1','2') /* 통보구분 */ AND D1.OCRN_SECD = #OCRN_SECD# /* 통보구분 */ AND D1.INST_CD = #INST_CD# AND D1.PRCS_OPNN_SECD = #PRCS_OPNN_SECD# AND D1.PRCS_OPNN_SECD IN (#PRCS_OPNN_SECD#, #strHndlOpinCd2#) AND D1.PRCS_OPNN_SECD IN (#PRCS_OPNN_SECD#, #strHndlOpinCd2#, #strHndlOpinCd3#) AND D1.PRCS_OPNN_SECD IN (#PRCS_OPNN_SECD#, #strHndlOpinCd2#, #strHndlOpinCd3#, #strHndlOpinCd4#) AND D1.PRCS_OPNN_SECD IN (#PRCS_OPNN_SECD#, #strHndlOpinCd2#, #strHndlOpinCd3#, #strHndlOpinCd4#, #strHndlOpinCd5#)