SELECT D1.CVLCPT_ADT_YR AS CVLCPT_ADT_YR /* 민원감사년도 */,
    D1.ADT_NO AS ADT_NO /* 감사번호 */,
    D1.DSPS_RQT_SQNO AS DSPS_RQT_SQNO /* 처분요구순번 */,
    F_MNG_KND_AUDYRNO(D1.CVLCPT_ADT_YR, D1.ADT_NO, '', '-') AS F_MNG_KND_AUDYRNO,
    F_MNG_KND_AUDYRNO(D1.CVLCPT_ADT_YR, D1.ADT_NO, '', '-') || '-' || D1.DSPS_RQT_SQNO AS F_MNG_KND_AUDYRNO,
    D2.DSPS_RQT_KDCD AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    F_CODE_NM('1000002', D2.DSPS_RQT_KDCD) AS F_CODE_NM,
    D3.ADT_MTTR_NM AS ADT_MTTR_NM /* 감사사항명 */,
    D2.DSPS_RQT_NM AS DSPS_RQT_NM /* 처분요구명 */,
    D1.TYPE AS TYPE,
    D1.DSPS_RQT_AMT AS DSPS_RQT_AMT /* 처분요구금액 */
FROM ( SELECT CVLCPT_ADT_YR AS CVLCPT_ADT_YR /* 민원감사년도 */,
    ADT_NO AS ADT_NO /* 감사번호 */,
    DSPS_RQT_SQNO AS DSPS_RQT_SQNO /* 처분요구순번 */,
    CASE WHEN EXPT_EFCT_SECD = '1' THEN '예산절감금액' WHEN EXPT_EFCT_SECD = '2' THEN '수입증대금액' WHEN EXPT_EFCT_SECD = '3' THEN '국민편익금액' WHEN EXPT_EFCT_SECD = '4' THEN '재산증가금액' WHEN EXPT_EFCT_SECD = '5' THEN '지출합리화금액' END AS EXPT_EFCT_SECD /* 기대효과구분코드 */,
    NVL(EXPT_EFCT_AMT,0) AS DSPS_RQT_AMT /* 처분요구금액 */
FROM TBBADEAR003M WHERE 1=1 AND CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND ADT_NO = #ADT_NO# AND NVL(EXPT_EFCT_AMT,0) != 0 UNION ALL SELECT CVLCPT_ADT_YR AS CVLCPT_ADT_YR /* 민원감사년도 */,
    ADT_NO AS ADT_NO /* 감사번호 */,
    DSPS_RQT_SQNO AS DSPS_RQT_SQNO /* 처분요구순번 */,
    '조치금액' AS TYPE,
    NVL(PNRT_PRSRV_AMT, 0) + NVL(RMBR_AMT, 0) + NVL(SPLP_AMT, 0) AS DSPS_RQT_AMT /* 처분요구금액 */
FROM TBBADEAR003M D1 WHERE 1=1 AND CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND ADT_NO = #ADT_NO# AND (NVL(PNRT_PRSRV_AMT, 0) != 0 OR NVL(RMBR_AMT, 0) != 0 OR NVL(SPLP_AMT, 0) != 0) UNION ALL SELECT CVLCPT_ADT_YR AS CVLCPT_ADT_YR /* 민원감사년도 */,
    ADT_NO AS ADT_NO /* 감사번호 */,
    DSPS_RQT_SQNO AS DSPS_RQT_SQNO /* 처분요구순번 */,
    '사후적효과금액' AS TYPE,
    NVL(EPFC_EFCT_AMT, 0) AS DSPS_RQT_AMT /* 처분요구금액 */
FROM TBBADEAR003M D1 WHERE 1=1 AND CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND ADT_NO = #ADT_NO# AND NVL(EPFC_EFCT_AMT, 0) != 0 ) D1 ,TB_BADEAR001M D2 ,TB_BADDED001M D3 WHERE D1.CVLCPT_ADT_YR = D2.ADT_YR AND D1.ADT_NO = D2.ADT_NO AND D1.DSPS_RQT_SQNO = D2.DSPS_RQT_SQNO AND D1.CVLCPT_ADT_YR = D3.ADT_YR AND D1.ADT_NO = D3.ADT_NO ORDER BY D1.CVLCPT_ADT_YR ,D1.ADT_NO ,D1.DSPS_RQT_SQNO