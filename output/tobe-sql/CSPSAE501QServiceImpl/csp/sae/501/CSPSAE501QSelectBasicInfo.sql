SELECT MAX(A.MN_BOKG_NBC) AS MN_BOKG_NBC,
    MAX(A.BOKG_POSS_RM_CNT) AS BOKG_POSS_RM_CNT,
    MAX(C.MN_BOKG_NBC) AS MN_BOKG_NBC,
    MAX(C.BOKG_POSS_RM_CNT) AS BOKG_POSS_RM_CNT,
    DECODE(MAX(B.LTD_STR_DT), NULL, '', SUBSTR(MAX(B.LTD_STR_DT), 0, 4) || '-' || SUBSTR(MAX(B.LTD_STR_DT), 5, 2) || '-' || SUBSTR(MAX(B.LTD_STR_DT), 7, 2) || ' ~ ' || SUBSTR(MAX(B.LTD_END_DT), 0, 4) || '-' || SUBSTR(MAX(B.LTD_END_DT), 5, 2) || '-' || SUBSTR(MAX(B.LTD_END_DT), 7, 2)) AS LTD_STR_DT
FROM ( SELECT DECODE(MAX(A.TRGT_NOP_ENO), '', 0, MAX(A.TRGT_NOP_ENO)) || '/' || (SELECT AS TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBCSPSAE132B) AS MN_BOKG_NBC , (SELECT BOKG_POSS_RM_CNT
FROM TBCSPSAE132B) - COUNT(B.FRS_MDM_SQNO) AS BOKG_POSS_RM_CNT , '1' AS ADT_RPTP_EDT_HSTRY_SQNO FROM ( SELECT COUNT(NVL(A.BSC_SRNO, 0)) AS TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM (SELECT DISTINCT A.BSC_SRNO
FROM TBCSPSAE501M A , TBCSPSAE501D B WHERE B.TRGT_NOP_ENO = A.TRGT_NOP_ENO AND B.APL_DT = A.APL_DT AND B.BSC_SRNO = A.BSC_SRNO AND A.TRGT_NOP_ENO = #TRGT_NOP_ENO# AND B.COFM_STA_CD IN ('10', '30', '50', '60') AND A.APL_DT BETWEEN #strFromY# || #strFromM# || '01' AND #strToY# || #strToM# || '31' ) A ) A , ( SELECT B.FRS_MDM_SQNO /* 포렌식매체순번 */
FROM TBCSPSAE501D B WHERE B.TRGT_NOP_ENO = #TRGT_NOP_ENO# AND B.COFM_STA_CD IN('10', '30','50', '60') AND B.APL_DT BETWEEN #strFromY# || #strFromM# || '01' AND #strToY# || #strToM# || '31' AND B.APL_DT >= TO_CHAR(SYSDATE,'YYYYMMDD') ) B ) A ,( SELECT C.LTD_STR_DT,
    C.LTD_END_DT,
    '1' AS ADT_RPTP_EDT_HSTRY_SQNO /* 감사보고서편집이력순번 */
FROM TBCSPSAE502D C WHERE C.TRGT_NOP_ENO = #TRGT_NOP_ENO# AND C.UN_USE_DT BETWEEN #strFromY# || #strFromM# || '01' AND #strToY# || #strToM# || '31' ) B , (SELECT DECODE(MAX(A.TRGT_NOP_ENO), '', 0, MAX(A.TRGT_NOP_ENO)) || '/' || (SELECT AS TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBCSPSAE132B) AS MN_BOKG_NBC , (SELECT BOKG_POSS_RM_CNT
FROM TBCSPSAE132B) - COUNT(B.FRS_MDM_SQNO) AS BOKG_POSS_RM_CNT , '1' AS ADT_RPTP_EDT_HSTRY_SQNO FROM ( SELECT COUNT(NVL(A.BSC_SRNO, 0)) AS TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM (SELECT DISTINCT A.BSC_SRNO
FROM TBCSPSAE501M A , TBCSPSAE501D B WHERE B.TRGT_NOP_ENO = A.TRGT_NOP_ENO AND B.APL_DT = A.APL_DT AND B.BSC_SRNO = A.BSC_SRNO AND A.TRGT_NOP_ENO = #TRGT_NOP_ENO# AND B.COFM_STA_CD IN ('10', '30', '50', '60') AND A.APL_DT BETWEEN #strFromY# || #strFromM# || '01' AND #strToY# || #strToM# || '31' ) A ) A , ( SELECT B.FRS_MDM_SQNO /* 포렌식매체순번 */
FROM TBCSPSAE501D B WHERE B.TRGT_NOP_ENO = #TRGT_NOP_ENO# AND B.COFM_STA_CD IN('10', '30','50', '60') AND B.APL_DT BETWEEN #strFromY# || #strFromM# || '01' AND #strToY# || #strToM# || '31' AND B.APL_DT >= TO_CHAR(SYSDATE,'YYYYMMDD') ) B ) C WHERE A.ADT_RPTP_EDT_HSTRY_SQNO = B.ADT_RPTP_EDT_HSTRY_SQNO(+) AND C.ADT_RPTP_EDT_HSTRY_SQNO = A.ADT_RPTP_EDT_HSTRY_SQNO