SELECT TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'YYYY-MM-DD(DY)') AS TO_CHAR
FROM ( SELECT DDT,
    TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') AS TO_CHAR
FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD') - LEVEL + 1,'YYYYMMDD') AS TO_CHAR
FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1 ) ) WHERE DY IN('2', '3', '4', '5', '6') ORDER BY DATENAME