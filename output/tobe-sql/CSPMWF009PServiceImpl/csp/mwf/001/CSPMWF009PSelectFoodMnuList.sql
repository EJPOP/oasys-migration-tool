SELECT RSTRNT_CD,
    ORD,
    MEAL_DVSN_CD,
    NM,
    NM_1,
    NM_2,
    NM_3,
    NM_4,
    NM_5
FROM ( SELECT *
FROM (WITH DATA AS ( SELECT DDT,
    ROWNUM+1 AS ROWNUM,
    RSTRNT_CD,
    MEAL_DVSN_CD,
    RICE_NM,
    SOUP_NM,
    D1.SD_NM_1,
    D1.SD_NM_2,
    D1.SD_NM_3,
    D1.SD_NM_4,
    D1.SD_NM_5,
    D1.SD_NM_6,
    D1.SD_NM_7,
    D1.SNC_NM,
    D1.COO_INF_NM_1,
    D1.COO_INF_NM_2,
    D1.COO_INF_NM_3,
    D1.COO_INF_NM_4,
    D1.COO_INF_NM_5
FROM ( SELECT B.DDT,
    '1' AS RSTRNT_CD,
    '2' AS MEAL_DVSN_CD,
    ROWNUM+1 AS ROWNUM,
    D1.RICE_NM,
    D1.SOUP_NM,
    D1.SD_NM_1,
    D1.SD_NM_2,
    D1.SD_NM_3,
    D1.SD_NM_4,
    D1.SD_NM_5,
    D1.SD_NM_6,
    D1.SD_NM_7,
    D1.SNC_NM,
    D1.COO_INF_NM_1,
    D1.COO_INF_NM_2,
    D1.COO_INF_NM_3,
    D1.COO_INF_NM_4,
    D1.COO_INF_NM_5
FROM TBCSPMWF002M D1, ( SELECT DDT,
    DY
FROM ( SELECT DDT,
    TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') AS TO_CHAR
FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD') - LEVEL+1, 'YYYYMMDD') AS TO_CHAR
FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B WHERE 1=1 AND D1.MNU_DT(+) = B.DDT AND D1.RSTRNT_CD(+) = '1' AND D1.MEAL_DVSN_CD(+) = '2' ORDER BY DDT) D1) SELECT D2.RSTRNT_CD,
    TO_NUMBER('1') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '밥' AS NM,
    MAX(DECODE(D2.D, 2, DECODE(D2.RICE_NM,NULL, NVL((SELECT AS HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_1, MAX(DECODE(D2.D, 3, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_2, MAX(DECODE(D2.D, 4, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_3, MAX(DECODE(D2.D, 5, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_4, MAX(DECODE(D2.D, 6, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_5 FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('2') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '국' AS NM,
    MAX(DECODE(D2.D, 2, D2.SOUP_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SOUP_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SOUP_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SOUP_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SOUP_NM, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('3') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬1' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('4') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬2' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_2, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('5') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬3' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_3, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('6') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬4' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_4, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('7') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬5' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_5, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('8') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬6' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_6, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_6, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_6, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_6, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_6, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD,D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('9') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬7' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_7, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_7, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_7, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_7, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_7, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('10') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '간식(16:00~16:30)' AS NM,
    MAX(DECODE(D2.D, 2, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SNC_NM, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('11') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지1' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('12') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지2' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('13') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지3' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('14') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지4' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('15') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지5' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD ) ORDER BY ORD) A WHERE A.NM IS NOT NULL UNION ALL SELECT RSTRNT_CD,
    ORD,
    MEAL_DVSN_CD,
    NM,
    NM_1,
    NM_2,
    NM_3,
    NM_4,
    NM_5
FROM ( SELECT *
FROM (WITH DATA AS ( SELECT DDT,
    ROWNUM+1 AS ROWNUM,
    RSTRNT_CD,
    MEAL_DVSN_CD,
    RICE_NM,
    SOUP_NM,
    D1.SD_NM_1,
    D1.SD_NM_2,
    D1.SD_NM_3,
    D1.SD_NM_4,
    D1.SD_NM_5,
    D1.SD_NM_6,
    D1.SD_NM_7,
    D1.SNC_NM,
    D1.COO_INF_NM_1,
    D1.COO_INF_NM_2,
    D1.COO_INF_NM_3,
    D1.COO_INF_NM_4,
    D1.COO_INF_NM_5
FROM ( SELECT B.DDT,
    '2' AS RSTRNT_CD,
    '2' AS MEAL_DVSN_CD,
    ROWNUM+1 AS ROWNUM,
    D1.RICE_NM,
    D1.SOUP_NM,
    D1.SD_NM_1,
    D1.SD_NM_2,
    D1.SD_NM_3,
    D1.SD_NM_4,
    D1.SD_NM_5,
    D1.SD_NM_6,
    D1.SD_NM_7,
    D1.SNC_NM,
    D1.COO_INF_NM_1,
    D1.COO_INF_NM_2,
    D1.COO_INF_NM_3,
    D1.COO_INF_NM_4,
    D1.COO_INF_NM_5
FROM TBCSPMWF002M D1, ( SELECT DDT,
    DY
FROM ( SELECT DDT,
    TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') AS TO_CHAR
FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD') - LEVEL+1, 'YYYYMMDD') AS TO_CHAR
FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B WHERE 1=1 AND D1.MNU_DT(+) = B.DDT AND D1.RSTRNT_CD(+) = '2' AND D1.MEAL_DVSN_CD(+) = '2' ORDER BY DDT) D1) SELECT D2.RSTRNT_CD,
    TO_NUMBER('1') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '밥' AS NM,
    MAX(DECODE(D2.D, 2, DECODE(D2.RICE_NM,NULL, NVL((SELECT AS HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_1, MAX(DECODE(D2.D, 3, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_2, MAX(DECODE(D2.D, 4, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_3, MAX(DECODE(D2.D, 5, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_4, MAX(DECODE(D2.D, 6, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_5 FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('2') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '국' AS NM,
    MAX(DECODE(D2.D, 2, D2.SOUP_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SOUP_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SOUP_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SOUP_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SOUP_NM, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('3') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬1' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('4') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬2' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_2, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('5') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬3' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_3, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('6') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬4' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_4, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('7') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬5' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_5, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('8') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬6' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_6, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_6, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_6, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_6, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_6, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD,D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('9') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬7' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_7, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_7, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_7, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_7, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_7, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('11') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지1' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('12') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지2' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('13') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지3' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('14') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지4' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('15') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지5' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD ) ORDER BY ORD) A WHERE A.NM IS NOT NULL UNION ALL SELECT RSTRNT_CD,
    ORD,
    MEAL_DVSN_CD,
    NM,
    NM_1,
    NM_2,
    NM_3,
    NM_4,
    NM_5
FROM ( SELECT *
FROM (WITH DATA AS ( SELECT DDT,
    ROWNUM+1 AS ROWNUM,
    RSTRNT_CD,
    MEAL_DVSN_CD,
    RICE_NM,
    SOUP_NM,
    D1.SD_NM_1,
    D1.SD_NM_2,
    D1.SD_NM_3,
    D1.SD_NM_4,
    D1.SD_NM_5,
    D1.SD_NM_6,
    D1.SD_NM_7,
    D1.SNC_NM,
    D1.COO_INF_NM_1,
    D1.COO_INF_NM_2,
    D1.COO_INF_NM_3,
    D1.COO_INF_NM_4,
    D1.COO_INF_NM_5
FROM ( SELECT B.DDT,
    '3' AS RSTRNT_CD,
    '2' AS MEAL_DVSN_CD,
    ROWNUM+1 AS ROWNUM,
    D1.RICE_NM,
    D1.SOUP_NM,
    D1.SD_NM_1,
    D1.SD_NM_2,
    D1.SD_NM_3,
    D1.SD_NM_4,
    D1.SD_NM_5,
    D1.SD_NM_6,
    D1.SD_NM_7,
    D1.SNC_NM,
    D1.COO_INF_NM_1,
    D1.COO_INF_NM_2,
    D1.COO_INF_NM_3,
    D1.COO_INF_NM_4,
    D1.COO_INF_NM_5
FROM TBCSPMWF002M D1, ( SELECT DDT,
    DY
FROM ( SELECT DDT,
    TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') AS TO_CHAR
FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD') - LEVEL+1, 'YYYYMMDD') AS TO_CHAR
FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B WHERE 1=1 AND D1.MNU_DT(+) = B.DDT AND D1.RSTRNT_CD(+) = '3' AND D1.MEAL_DVSN_CD(+) = '2' ORDER BY DDT) D1) SELECT D2.RSTRNT_CD,
    TO_NUMBER('1') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '밥' AS NM,
    MAX(DECODE(D2.D, 2, DECODE(D2.RICE_NM,NULL, NVL((SELECT AS HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_1, MAX(DECODE(D2.D, 3, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_2, MAX(DECODE(D2.D, 4, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_3, MAX(DECODE(D2.D, 5, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_4, MAX(DECODE(D2.D, 6, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM /* 휴일명 */
FROM TBBADDED013B Z WHERE D2.DDT=Z.INFO_YR||Z.HLDY_CRTR_MND),' ') ,D2.RICE_NM),NULL )) AS NM_5 FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('2') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '국' AS NM,
    MAX(DECODE(D2.D, 2, D2.SOUP_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SOUP_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SOUP_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SOUP_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SOUP_NM, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('3') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬1' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('4') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬2' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_2, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('5') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬3' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_3, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('6') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬4' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_4, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('7') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬5' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_5, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('8') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬6' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_6, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_6, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_6, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_6, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_6, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD,D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('9') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '테마' AS NM,
    MAX(DECODE(D2.D, 2, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SNC_NM, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('11') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지1' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('12') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지2' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('13') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지3' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('14') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지4' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('15') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지5' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD ) ORDER BY ORD) A WHERE A.NM IS NOT NULL UNION ALL SELECT RSTRNT_CD,
    ORD,
    MEAL_DVSN_CD,
    NM,
    NM_1,
    NM_2,
    NM_3,
    NM_4,
    NM_5
FROM ( SELECT *
FROM (WITH DATA AS ( SELECT DDT,
    ROWNUM+1 AS ROWNUM,
    RSTRNT_CD,
    MEAL_DVSN_CD,
    D1.SD_NM_1,
    D1.COO_INF_NM_1,
    D1.COO_INF_NM_2,
    D1.COO_INF_NM_3,
    D1.COO_INF_NM_4,
    D1.COO_INF_NM_5
FROM ( SELECT B.DDT,
    '4' AS RSTRNT_CD,
    '3' AS MEAL_DVSN_CD,
    ROWNUM+1 AS ROWNUM,
    D1.SD_NM_1,
    D1.COO_INF_NM_1,
    D1.COO_INF_NM_2,
    D1.COO_INF_NM_3,
    D1.COO_INF_NM_4,
    D1.COO_INF_NM_5
FROM TBCSPMWF002M D1, ( SELECT DDT,
    DY
FROM ( SELECT DDT,
    TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') AS TO_CHAR
FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD') - LEVEL+1, 'YYYYMMDD') AS TO_CHAR
FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B WHERE 1=1 AND D1.MNU_DT(+) = B.DDT AND D1.RSTRNT_CD(+) = '1' AND D1.MEAL_DVSN_CD(+) = '3' ORDER BY DDT) D1) SELECT D2.RSTRNT_CD,
    TO_NUMBER('1') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬1' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('2') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지1' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('3') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지2' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('4') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지3' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('5') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지4' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('6') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지5' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD ) ORDER BY ORD) A WHERE A.NM IS NOT NULL UNION ALL SELECT RSTRNT_CD,
    ORD,
    MEAL_DVSN_CD,
    NM,
    NM_1,
    NM_2,
    NM_3,
    NM_4,
    NM_5
FROM ( SELECT *
FROM (WITH DATA AS ( SELECT DDT,
    ROWNUM+1 AS ROWNUM,
    RSTRNT_CD,
    MEAL_DVSN_CD,
    D1.SD_NM_1,
    D1.COO_INF_NM_1,
    D1.COO_INF_NM_2,
    D1.COO_INF_NM_3,
    D1.COO_INF_NM_4,
    D1.COO_INF_NM_5
FROM ( SELECT B.DDT,
    '5' AS RSTRNT_CD,
    '4' AS MEAL_DVSN_CD,
    ROWNUM+1 AS ROWNUM,
    D1.SD_NM_1,
    D1.COO_INF_NM_1,
    D1.COO_INF_NM_2,
    D1.COO_INF_NM_3,
    D1.COO_INF_NM_4,
    D1.COO_INF_NM_5
FROM TBCSPMWF002M D1, ( SELECT DDT,
    DY
FROM ( SELECT DDT,
    TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') AS TO_CHAR
FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD') - LEVEL+1, 'YYYYMMDD') AS TO_CHAR
FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B WHERE 1=1 AND D1.MNU_DT(+) = B.DDT AND D1.RSTRNT_CD(+) = '1' AND D1.MEAL_DVSN_CD(+) = '4' ORDER BY DDT) D1) SELECT D2.RSTRNT_CD,
    TO_NUMBER('1') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '반찬1' AS NM,
    MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('2') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지1' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('3') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지2' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('4') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지3' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('5') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지4' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('6') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지5' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD ) ORDER BY ORD) A WHERE A.NM IS NOT NULL