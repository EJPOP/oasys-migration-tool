SELECT A.CVLCPT_ADT_YR AS CVLCPT_ADT_YR /* 민원감사년도 */,
    A.ADT_NO AS ADT_NO /* 감사번호 */,
    B.DSPS_RQT_SQNO AS DSPS_RQT_SQNO /* 처분요구순번 */,
    F_MNG_KND_AUDYRNO(A.CVLCPT_ADT_YR, A.ADT_NO, '', '-') ||'-'|| A.DSPS_RQT_SQNO AS ADT_CLSF_NO /* 감사분류번호 */,
    C.ADT_MTTR_NM AS ADT_MTTR_NM /* 감사사항명 */,
    TO_CHAR(TO_DATE(B.ENFC_YMD),'YYYY-MM-DD') AS ENFC_YMD /* 시행일자 */,
    A.DSPS_RQT_NM AS DSPS_RQT_NM /* 처분요구명 */,
    F_CODE_NM('1000002', A.DSPS_RQT_KDCD) AS DSPS_RQT_KND_CVN /* 처분요구종류코드값명 */,
    D.DSPS_RQT_KYWD_CN_1 AS DSPS_RQT_KYWD_CN_1 /* 처분요구키워드내용1 */,
    D.DSPS_RQT_KYWD_CN_2 AS DSPS_RQT_KYWD_CN_2 /* 처분요구키워드내용2 */,
    D.DSPS_RQT_KYWD_CN_3 AS DSPS_RQT_KYWD_CN_3 /* 처분요구키워드내용3 */,
    D.DSPS_RQT_KYWD_CN_4 AS DSPS_RQT_KYWD_CN_4 /* 처분요구키워드내용4 */,
    D.DSPS_RQT_KYWD_CN_5 AS DSPS_RQT_KYWD_CN_5 /* 처분요구키워드내용5 */,
    (SELECT MIN(ST2.PROF_RBPRSN_INST_NM) || DECODE((COUNT(DISTINCT ST1.REL_INST_CD) - 1),0,'',' 외 ' || (COUNT(DISTINCT ST1.REL_INST_CD) - 1)) AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */
FROM TB_BADEAR006M ST1 ,TBDCMACM015M ST2 WHERE ST1.SRECS_REL_INST_CD = ST2.INST_CD AND ST1.CVLCPT_ADT_YR = A.CVLCPT_ADT_YR AND ST1.ADT_NO = A.ADT_NO AND ST1.DSPS_RQT_SQNO = A.DSPS_RQT_SQNO GROUP BY ST1.CVLCPT_ADT_YR ,ST1.ADT_NO ,ST1.DSPS_RQT_SQNO) AS REL_INST_NM /* 소관기관 */ ,'공개문보기' AS RLS_CN ,(SELECT T2.CVLCPT_DOC_ID /* 문서아이디 */
FROM TB_BADEAR001M T1 INNER JOIN TB_BADDED103M T2 ON T1.CVLCPT_ADT_YR = T2.CVLCPT_ADT_YR AND T1.ADT_NO = T2.ADT_NO AND TO_CHAR(T1.ADT_DSPS_RQT_SQNO) = T2.TPOF_RFRNC_ID WHERE T1.CVLCPT_ADT_YR = A.CVLCPT_ADT_YR AND T1.ADT_NO = A.ADT_NO AND T1.DSPS_RQT_SQNO = A.DSPS_RQT_SQNO AND T2.ADT_STP_SECD = 'A1080' AND T2.SLCT_RPTP_KDCD = 'A10800500') AS ELCT_DOC_ID /* 전자감사 공개문 DOC_ID */ FROM TB_BADEAR001M A ,TB_BADEAR002D B ,TB_BADDED001M C ,(SELECT CVLCPT_ADT_YR /* 민원감사년도 */,
    ADT_NO /* 감사번호 */,
    DSPS_RQT_SQNO /* 처분요구순번 */,
    MAX(CASE WHEN GRNDS_EXMN_AEX_SQNO=1 THEN DSPS_RQT_KYWD_CN END) AS DSPS_RQT_KYWD_CN_1 /* 처분요구키워드내용1 */,
    MAX(CASE WHEN GRNDS_EXMN_AEX_SQNO=2 THEN DSPS_RQT_KYWD_CN END) AS DSPS_RQT_KYWD_CN_2 /* 처분요구키워드내용2 */,
    MAX(CASE WHEN GRNDS_EXMN_AEX_SQNO=3 THEN DSPS_RQT_KYWD_CN END) AS DSPS_RQT_KYWD_CN_3 /* 처분요구키워드내용3 */,
    MAX(CASE WHEN GRNDS_EXMN_AEX_SQNO=4 THEN DSPS_RQT_KYWD_CN END) AS DSPS_RQT_KYWD_CN_4 /* 처분요구키워드내용4 */,
    MAX(CASE WHEN GRNDS_EXMN_AEX_SQNO=5 THEN DSPS_RQT_KYWD_CN END) AS DSPS_RQT_KYWD_CN_5 /* 처분요구키워드내용5 */
FROM TBBADEAR037M GROUP BY CVLCPT_ADT_YR, ADT_NO, DSPS_RQT_SQNO) D WHERE 1=1 AND A.CVLCPT_ADT_YR = B.ADT_YR AND A.ADT_NO = B.ADT_NO AND A.DSPS_RQT_SQNO = B.DSPS_RQT_SQNO AND A.CVLCPT_ADT_YR = C.ADT_YR AND A.ADT_NO = C.ADT_NO AND A.CVLCPT_ADT_YR = D.CVLCPT_ADT_YR(+) AND A.ADT_NO = D.ADT_NO(+) AND A.DSPS_RQT_SQNO = D.DSPS_RQT_SQNO(+) AND B.ENFC_YMD >= '20130101' AND EXISTS (SELECT 1
FROM TB_BADEAR004M WHERE CVLCPT_ADT_YR = A.CVLCPT_ADT_YR AND ADT_NO = A.ADT_NO AND DSPS_RQT_SQNO = A.DSPS_RQT_SQNO AND EXTT_ID = #EXTT_ID#) /* 적출자 */ AND EXISTS (SELECT 1
FROM TB_BADEAR037M WHERE CVLCPT_ADT_YR = A.CVLCPT_ADT_YR AND ADT_NO = A.ADT_NO AND DSPS_RQT_SQNO = A.DSPS_RQT_SQNO) /* 입력 */ AND NOT EXISTS (SELECT 1
FROM TB_BADEAR037M WHERE CVLCPT_ADT_YR = A.CVLCPT_ADT_YR AND ADT_NO = A.ADT_NO AND DSPS_RQT_SQNO = A.DSPS_RQT_SQNO) /* 미입력 */