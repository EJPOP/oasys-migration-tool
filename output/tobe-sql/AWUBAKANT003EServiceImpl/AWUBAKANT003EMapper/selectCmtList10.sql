/* AWU.BAK.BRR.AWUBAKANT003EMapper.selectCmtList10 */ SELECT T.TITLE AS VT_SBJ_NM--의결사항명 ,F_DPT_INFO(T.DPT_CD,'1') AS DPT_NM --부서명 ,T.DPT_CD ,NVL(F_AWU_CODE_NM('10000010', T.WRK_DVSN_CD), '기타안건') AS TSK_DVSN_NM --업무구분명 ,NVL(TO_CHAR(T.REGI_NO),' ') AS REGI_NO ,NVL(TO_CHAR(T.SBCN_PAGE_CNT),' ') AS SBCN_PON --부의면수 ,NVL(TO_CHAR(T.AUD_YR_NO),' ') AS CAT_NO --분류번호 ,NVL(TO_CHAR(T.AUD_YR),' ') AS AUD_YR --년도 ,NVL(TO_CHAR(T.AUD_NO),' ') AS AUD_NO --번호 ,NVL(T.WRK_DVSN_CD,' ')AS TSK_DVSN_CD --업무구분코드 ,NVL(T.DPT_CD,' ') AS DPT_CD --부서코드 ,NVL(T.AUD_KND_CD,' ') AS AUD_KND_CD --감사종류 ,T.CMT_DY --회의일자 ,'제'||T.CMT_SQ||'회 '||T.CMT_TIT AS CMT_TIT --회의제목 ,DOC_ID FROM ( SELECT F_MNG_KND_AUDYRNO(D.AUD_YR, D.AUD_NO, D.AUD_KND_CD, '-') AS AUD_YR_NO ,D.AUD_SBJ_NM AS TITLE ,A.SBCN_PAGE_CNT AS SBCN_PAGE_CNT ,D.MNG_DPT_CD AS DPT_CD ,D4.CMT_DY AS CMT_DY ,'10' AS CMT_DVSN_CD ,TO_CHAR(D4.CMT_SQ) AS CMT_SQ ,D.AUD_YR AS AUD_YR ,D.AUD_NO AS AUD_NO ,D.AUD_KND_CD AS AUD_KND_CD ,A.SBCN_REGI_REQ_DT AS SBCN_REGI_REQ_DT ,'실지감사' AS WRK_DVSN_NM ,'A10' AS WRK_DVSN_CD ,(SELECT REGI_NO FROM TBBADDED112D ST1 WHERE ST1.AUD_YR = A.AUD_YR AND ST1.AUD_NO = A.AUD_NO AND ST1.DOC_ID = A.DOC_ID) AS REGI_NO, D4.CMT_TIT, (SELECT S1.OPEN_DOC_ID FROM TBAWUBAKDAR001M S1 WHERE S1.AUD_YR = D.AUD_YR AND S1.AUD_NO = D.AUD_NO AND ROWNUM = 1 ) AS DOC_ID FROM TBBADDED113M AS A INNER JOIN TBBADDED001M AS D ON (A.AUD_YR = D.AUD_YR AND A.AUD_NO = D.AUD_NO) LEFT OUTER JOIN TBBADDED120M D4 ON (D4.CMT_DY = A.SBCN_DY AND D4.CMT_DVSN_CD = #{cmtDvsnCd} ) -- 회의구분코드 PARAMETER WHERE A.SBCN_DY = REPLACE(#{cmtDy},'-') --회의일자 PARAMETER AND A.SBCN_DY IS NOT NULL GROUP BY D.AUD_YR, D.AUD_NO, D.AUD_KND_CD, D.AUD_SBJ_NM, D.MNG_DPT_CD, A.SBCN_PAGE_CNT, A.SBCN_REGI_REQ_DT , A.AUD_YR, A.AUD_NO, D4.CMT_DY , D4.CMT_SQ, A.DOC_ID, D4.CMT_TIT UNION ALL SELECT A.ACP_YR || '-' || DECODE(A.ACP_DVSN_CD, '1', '심사', '재심') || '-' || TO_CHAR(A.ACP_SRNO)AS AUD_YR_NO , (SELECT TIT_NM FROM TBBADFRE112M WHERE ACP_YR = A.ACP_YR AND ACP_DVSN_CD = A.ACP_DVSN_CD AND ACP_SRNO = A.ACP_SRNO) AS TITLE, A.SBCN_PAGE_CNT AS SBCN_PAGE_CNT, (SELECT DPT_CD FROM TBBADFRE012M WHERE ACP_YR = A.ACP_YR AND ACP_DVSN_CD = A.ACP_DVSN_CD AND ACP_SRNO = A.ACP_SRNO) AS DPT_CD, D4.CMT_DY AS CMT_DY, '10' AS CMT_DVSN_CD, TO_CHAR(D4.CMT_SQ) AS CMT_SQ, A.ACP_YR AS AUD_YR, TO_CHAR(A.ACP_SRNO) AS AUD_NO, A.ACP_DVSN_CD AS AUD_KND_CD, A.SBCN_REGI_REQ_DT AS SBCN_REGI_REQ_DT, DECODE(A.ACP_DVSN_CD,'1','심사','2','재심') AS WRK_DVSN_NM, DECODE(A.ACP_DVSN_CD,'1','D10','2','E10') AS WRK_DVSN_CD, (SELECT REGI_NO FROM TBBADFRE112D ST1 WHERE ST1.ACP_YR = A.ACP_YR AND ST1.ACP_DVSN_CD = A.ACP_DVSN_CD AND ST1.ACP_SRNO = A.ACP_SRNO AND ST1.DOC_ID = A.DOC_ID) AS REGI_NO, D4.CMT_TIT, (SELECT S1.DOC_ID FROM TBCSPTSM002L S1 WHERE S1.BBS_ID = 'BBSMSTR_100000000013' AND S1.BIZ_KEY1 = A.ACP_YR AND S1.BIZ_KEY2 = A.ACP_DVSN_CD AND S1.BIZ_KEY3 = A.ACP_SRNO AND ROWNUM = 1 ) AS DOC_ID FROM TBBADFRE113M AS A INNER JOIN TBBADFRE012M AS D ON (A.ACP_YR = NVL(D.MG_ACP_YR, D.ACP_YR) AND A.ACP_SRNO = NVL(D.MG_ACP_SRNO, D.ACP_SRNO) AND A.ACP_DVSN_CD = NVL(D.ACP_DVSN_CD, D.ACP_DVSN_CD)) LEFT OUTER JOIN TBBADDED120M D4 ON (D4.CMT_DY = A.SBCN_DY AND D4.CMT_DVSN_CD = #{cmtDvsnCd}) -- 회의구분코드 PARAMETER WHERE A.SBCN_DY = REPLACE(#{cmtDy},'-') --회의일자 PARAMETER AND A.SBCN_DY IS NOT NULL GROUP BY A.ACP_YR, A.ACP_SRNO, A.ACP_DVSN_CD, A.SBCN_PAGE_CNT, A.SBCN_REGI_REQ_DT , A.ACP_YR, A.ACP_SRNO,A.ACP_DVSN_CD, D4.CMT_DY , D4.CMT_SQ, A.DOC_ID, D4.CMT_TIT UNION ALL SELECT DECODE(A.WORK_DVSN_CD,'D10', REL_AUD_YR||'-심사-'||REL_AUD_NO /* 심사청구 */ ,'E10',REL_AUD_YR||'-재심-'||REL_AUD_NO /* 재심의청구 */ ,'A10', (SELECT F_MNG_KND_AUDYRNO(ST1.AUD_YR, ST1.AUD_NO, ST1.AUD_KND_CD, '-') FROM TBBADDED001M ST1 WHERE ST1.AUD_YR = A.REL_AUD_YR AND ST1.AUD_NO = A.REL_AUD_NO)) AS AUD_YR_NO, DECODE(A.REL_TSK_NM, NULL, A.CMT_SBJ_TIT) AS TITLE, A.SBCN_SNO AS SBCN_PAGE_CNT, A.REL_DPT_CD AS DPT_CD, A.CMT_DY AS CMT_DY, A.CMT_DVSN_CD AS CMT_DVSN_CD, TO_CHAR(A.CMT_SQ) AS CMT_SQ, A.REL_AUD_YR AS AUD_YR, A.REL_AUD_NO AS AUD_NO, '' AS AUD_KND_CD, '' AS SBCN_REGI_REQ_DT, DECODE(A.WORK_DVSN_CD,'A10','실지감사' ,'D10','심사청구' ,'E10','재심의청구' ,'Z90','기타안건','기타안건') AS WRK_DVSN_NM, A.WORK_DVSN_CD, A.REGI_NO, D4.CMT_TIT, '' AS DOC_ID FROM TBBADDED121M AS A LEFT OUTER JOIN TBBADDED120M D4 ON (D4.CMT_DY = A.CMT_DY AND D4.CMT_DVSN_CD = #{cmtDvsnCd}) -- 회의구분코드 PARAMETER WHERE A.CMT_DY = REPLACE(#{cmtDy},'-') --회의일자 PARAMETER AND A.CMT_DVSN_CD = #{cmtDvsnCd} -- 회의구분코드 PARAMETER AND A.CMT_SQ = #{cmtSq} --회의회차 PARAMETER ) T WHERE T.CMT_DVSN_CD = #{cmtDvsnCd} -- 회의구분코드 PARAMETER ORDER BY T.SBCN_PAGE_CNT ASC