SELECT A.LINK_YR /* 연계년도 */,
    A.PFSR_DVSN_NM,
    A.INFO_RLPR_NM /* 정보관계자명 */,
    A.PFSR_ID,
    A.BLL_SBJCT_NM /* 계산서과목명 */,
    A.EDU_DVSN_NM,
    A.CRS_CD,
    A.CRS_NM /* 과정명 */,
    A.CRS_CDN /* 과정기수 */,
    DECODE(B.EDU_BGNG_YMD, NULL, '', SUBSTR(B.EDU_BGNG_YMD, 5, 2) || '.' || SUBSTR(B.EDU_BGNG_YMD, 7, 2) || ' ~ ' || SUBSTR(B.EDU_END_YMD, 5, 2) || '.' || SUBSTR(B.EDU_END_YMD, 7, 2)) AS EDU_BGNG_YMD /* 교육시작일자 */,
    A.LCT_TM_HM
FROM ( SELECT A.LINK_YR /* 연계년도 */,
    A.SUBJ_CD,
    A.BLL_SBJCT_NM /* 계산서과목명 */,
    A.EDU_DVSN_CD,
    A.EDU_DVSN_NM,
    A.EDU_CAT_CD,
    A.CRS_CD,
    A.CRS_NM /* 과정명 */,
    A.CRS_CDN /* 과정기수 */,
    A.LCT_TM_HM,
    A.PFSR_DVSN_NM,
    A.PFSR_DVSN_CD,
    A.PFSR_ID,
    A.INFO_RLPR_NM /* 정보관계자명 */
FROM ( SELECT A.LINK_YR /* 연계년도 */,
    A.SUBJ_CD,
    A.BLL_SBJCT_NM /* 계산서과목명 */,
    B.EDU_DVSN_CD,
    D.EDU_DVSN_NM,
    C.EDU_CAT_CD,
    A.CRS_CD,
    B.CRS_NM /* 과정명 */,
    A.CRS_CDN /* 과정기수 */,
    A.LCT_TM_HM,
    A.PFSR_DVSN_NM,
    A.PFSR_DVSN_CD,
    A.PFSR_ID,
    A.INFO_RLPR_NM /* 정보관계자명 */
FROM ( SELECT A.LINK_YR /* 연계년도 */,
    A.SUBJ_CD,
    A.BLL_SBJCT_NM /* 계산서과목명 */,
    A.CRS_CD,
    A.CRS_CDN /* 과정기수 */,
    A.LCT_TM_HM,
    ( SELECT AS CD_NM
FROM TBDCMACM013C WHERE TASK_SECD = 'SP' AND FUNC_CAT_CD = 'AE' AND CMM_CD_DVSN_CD = '1000312' AND CD = B.PFSR_DVSN_CD ) PFSR_DVSN_NM, B.PFSR_DVSN_CD, A.PFSR_ID, B.INFO_RLPR_NM FROM ( SELECT A.LINK_YR /* 연계년도 */,
    A.SUBJ_CD,
    ( SELECT AS BLL_SBJCT_NM /* 계산서과목명 */
FROM TBCSPSAE101M WHERE SUBJ_CD = A.SUBJ_CD ) BLL_SBJCT_NM, A.CRS_CD, A.CRS_CDN, SUM(A.LCT_TM_HM) LCT_TM_HM, A.PFSR_ID FROM TBCSPSAE202D A WHERE A.LINK_YR BETWEEN #strFromY# AND #strToY# GROUP BY A.LINK_YR, A.SUBJ_CD, A.CRS_CD, A.CRS_CDN, A.PFSR_ID ) A, TBCSPSAE109M B WHERE B.PFSR_ID = A.PFSR_ID ) A , TBCSPSAE103C B , TBCSPSAE102C C , TBCSPSAE101C D WHERE B.CRS_CD = A.CRS_CD AND C.EDU_CAT_CD = B.EDU_CAT_CD AND C.EDU_DVSN_CD = B.EDU_DVSN_CD AND D.EDU_DVSN_CD = B.EDU_DVSN_CD ) A ) A, TBCSPSAE201D B WHERE B.LINK_YR = A.LINK_YR AND B.CRS_CD = A.CRS_CD AND B.CRS_CDN = A.CRS_CDN AND SUBSTR(B.EDU_BGNG_YMD, 0, 6) BETWEEN #strFromY# || #strFromM# AND #strToY# || #strToM# AND A.EDU_DVSN_CD = #strEDU_DVSN_CD# AND A.EDU_CAT_CD = #strEDU_CAT_CD# AND A.CRS_CD = #strEDU_CRS_CD# AND A.CRS_CDN = #CRS_CDN# AND A.INFO_RLPR_NM LIKE '%' || #strNAM# || '%' AND A.PFSR_DVSN_CD = #strPFSR_DVSN_CD# ORDER BY A.LINK_YR ASC, A.PFSR_DVSN_NM ASC, A.PFSR_ID, A.BLL_SBJCT_NM, A.EDU_DVSN_NM, A.CRS_CD, EDU_DATE