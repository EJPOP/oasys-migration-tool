SELECT A.SUBJ_CD,
    A.BLL_SBJCT_NM /* 계산서과목명 */,
    E.PFSR_ID,
    E.INFO_RLPR_NM /* 정보관계자명 */,
    (SELECT B.CD_NM
FROM TBDCMACM013C B WHERE B.CMM_CD_DVSN_CD = '1000313' AND B.CD = E.VLD_DVSN_CD) AS VLD_DVSN_NM , MAX(C.LCT_DT) AS LCT_DT FROM TBCSPSAE101M A , TBCSPSAE101L B , TBCSPSAE202D C , TBCSPSAE201D D , TBCSPSAE109M E WHERE B.SUBJ_CD = A.SUBJ_CD AND C.SUBJ_CD(+) = B.SUBJ_CD AND D.LINK_YR(+) = C.LINK_YR AND D.CRS_CD(+) = C.CRS_CD AND D.CRS_CDN(+) = C.CRS_CDN AND C.PFSR_ID(+) = B.PFSR_ID AND E.PFSR_ID(+) = B.PFSR_ID AND A.USE_YN = 'Y' AND B.USE_YN = 'Y' AND ( C.LCT_DT AND UPPER(A.BLL_SBJCT_NM) LIKE '%' || UPPER(#strSUBJ_NM#) || '%' AND E.INFO_RLPR_NM LIKE '%' || #strNAM# || '%' AND E.VLD_DVSN_CD = #strVLD_DVSN_CD# AND FLOOR(MOD(MONTHS_BETWEEN(TO_CHAR(SYSDATE, 'yyyyMMdd'), (SELECT MAX(C.LCT_DT)
FROM TBCSPSAE202D B WHERE B.PFSR_ID = E.PFSR_ID)),0)*30.5) &lt;= #strRange# GROUP BY A.SUBJ_CD, A.BLL_SBJCT_NM, E.PFSR_ID, E.INFO_RLPR_NM, E.VLD_DVSN_CD ORDER BY A.BLL_SBJCT_NM