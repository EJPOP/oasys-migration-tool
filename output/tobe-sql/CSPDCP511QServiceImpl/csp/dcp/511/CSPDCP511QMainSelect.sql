SELECT D1.CLM_SECD /* 청구구분코드 */,
    D1.CRU_KDCD /* 부패종류코드 */,
    F_CODE_NM('1000047', D1.CRU_KDCD) AS F_CODE_NM,
    TO_CHAR(D1.CRU_RCPT_DT, 'YYYY-MM-DD') AS CRU_RCPT_DT /* 부패접수일시 */,
    D1.CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    D1.CVLCPT_RCPT_YR /* 민원접수년도 */,
    D1.CVLCPT_RCPT_YR||'-민원-'||D1.TPOF_ACTL_RCPT_NO AS CVLCPT_RCPT_YR /* 민원접수년도 */,
    F_CODE_NM('1000754', D3.TPOF_PRCS_SECD) AS F_CODE_NM,
    F_CODE_NM('1000051', D3.TPOF_BFR_CVLCPT_PRCS_SECD) AS F_CODE_NM,
    CASE WHEN ( SELECT COUNT(*)
FROM TB_CSPDCP105L S1 WHERE S1.CLM_SECD = D1.CLM_SECD AND S1.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND S1.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT ) > 0 THEN D1.RSCH_ASMT_TTL||'(합건 : '||D1.TPOF_ACTL_RCPT_NO||', '||( SELECT AGGR_CONCAT( S3.TPOF_ACTL_RCPT_NO, ', ')||' )' AS TPOF_ACTL_RCPT_NO /* 제보실제접수번호 */
FROM TB_CSPDCP105L S2, TB_CSPDCP101M S3 WHERE D1.CLM_SECD = S2.CVLCPT_CLM_SECD AND D1.CVLCPT_RCPT_YR = S2.TPOF_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = S2.TPOF_RCPT_NO AND S2.TPOF_MCA_CLM_SECD = S3.CVLCPT_CLM_SECD AND S2.TPOF_MCA_RCPT_YR = S3.TPOF_RCPT_YR AND S2.TPOF_MCA_CVLCPT_RCPT_NO = S3.TPOF_RCPT_NO) ELSE D1.RSCH_ASMT_TTL END AS RSCH_ASMT_TTL ,DECODE(D1.SLCT_CLMT_KDCD,'1',D1.TPOF_CVLPR_NM,'2',D1.SLCT_CVLPR_RPRSV_NM,'3',D1.SLCT_CVLPR_RPRSV_NM,'4',D1.TPOF_CVLPR_NM) AS TPOF_CVLPR_NM ,D4.TPOF_LAST_PRCS_DT ,F_CODE_NM('1000361',D1.CRU_PRCS_PRCS_STTS) AS PRCS_NM ,( SELECT TO_DATE(TO_CHAR(D1.CRU_RCPT_DT, 'YYYYMMDD'), 'YYYYMMDD') + NVL( S1.USR_DFN_TXT_2, 30) AS CRU_RCPT_DT /* 부패접수일시 */
FROM TBDCMACM013C S1 WHERE S1.CMM_CD_DVSN_CD = '1000051' AND S1.CD != '000000000' AND S1.CD = D3.TPOF_PRCS_SECD) AS HNDL_LIMIT__DT ,D3.TPOF_SQNO ,D3.TPOF_PRCS_SECD FROM TB_CSPDCP101M D1 ,TB_CSPDCP102M D2 ,TB_CSPDCP205L D3 ,TB_CSPDCP201M D4 WHERE 1=1 AND D1.CLM_SECD = '1' AND D1.CLM_SECD = D2.CLM_SECD AND D1.CVLCPT_RCPT_RCPT = D2.CVLCPT_RCPT_RCPT AND D1.CVLCPT_RCPT_YR = D2.CVLCPT_RCPT_YR AND D1.CLM_SECD = D3.CVLCPT_CLM_SECD AND D1.CVLCPT_RCPT_RCPT = D3.TPOF_RCPT_NO AND D1.CVLCPT_RCPT_YR = D3.TPOF_RCPT_YR AND D1.CLM_SECD = D4.CVLCPT_CLM_SECD AND D1.CVLCPT_RCPT_RCPT = D4.TPOF_RCPT_NO AND D1.CVLCPT_RCPT_YR = D4.TPOF_RCPT_YR AND D1.CRU_PRCS_PRCS_STTS IN ('50','60') AND (D3.CVLCPT_CLM_SECD, D3.TPOF_RCPT_NO, D3.TPOF_RCPT_YR, D3.TPOF_SQNO ) IN ( SELECT Z.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    Z.TPOF_RCPT_NO /* 제보접수번호 */,
    Z.TPOF_RCPT_YR /* 제보접수년도 */,
    MIN(Z.TPOF_SQNO) AS TPOF_SQNO /* 제보순번 */
FROM TB_CSPDCP205L Z WHERE D1.CLM_SECD = Z.CVLCPT_CLM_SECD AND D1.CVLCPT_RCPT_RCPT = Z.TPOF_RCPT_NO AND D1.CVLCPT_RCPT_YR = Z.TPOF_RCPT_YR GROUP BY Z.CVLCPT_CLM_SECD, Z.TPOF_RCPT_NO, Z.TPOF_RCPT_YR ) AND ( D3.TPOF_PRCS_SECD = '60' OR CRU_BFR_CVLCPT_PRCS_SECD = '14' ) AND (D1.CLM_SECD, D1.CVLCPT_RCPT_YR, D1.CVLCPT_RCPT_RCPT) NOT IN ( SELECT CVLCPT_MCA_CLM_SECD /* 민원합건청구구분코드 */,
    TPOF_MCA_RCPT_YR /* 제보합건접수년도 */,
    CVLCPT_MCA_CVLCPT_RCPT_NO /* 민원합건민원접수번호 */
FROM TB_CSPDCP105L ) AND D4.TPOF_PRCS_DEPT_CD = #ETC_LBSVC_MNG_DEPT_CD# AND D4.TPOF_PRCS_PIC_ID = #PRCS_PIC_ID# AND D1.RSCH_ASMT_TTL LIKE '%'||#TIT_NM#||'%' AND D2.TPOF_CN LIKE '%'||#TIT_NM#||'%' AND TO_CHAR(D1.CRU_RCPT_DT, 'YYYYMMDD') BETWEEN #ACP_DH_START# AND #ACP_DH_END# AND D1.CRU_KDCD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strCVPT_KND_CD# ||',' AS #STRCVPT_KND_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND D3.TPOF_PRCS_SECD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strCVPT_HNDL_DVSN_CD# ||',' AS #STRCVPT_HNDL_DVSN_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) --> AND D1.RM_CVPT_ACP_NO = LPAD(#RM_CVPT_ACP_NO#, 5, 0) AND D1.CVPTR_NM LIKE '%'||#CVPTR_NM#||'%' AND D1.ACP_YR = NVL(#ACP_YR#, D1.ACP_YR) AND D1.CVPT_HNDL_STA_CD = NVL(#CVPT_HNDL_STA_CD#, D1.CVPT_HNDL_STA_CD) ORDER BY D1.ACP_YR DESC , D1.RM_CVPT_ACP_NO DESC