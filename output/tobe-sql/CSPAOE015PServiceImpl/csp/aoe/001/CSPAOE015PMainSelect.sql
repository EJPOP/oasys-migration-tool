SELECT D1.CVLCPT_ADT_YR /* 민원감사년도 */,
    D1.TSK_NO /* 감사번호 */,
    NVL(F_MNG_KND_AUDYRNO(D1.CVLCPT_ADT_YR, D1.TSK_NO, D2.ADT_KDCD, '-'),D1.CVLCPT_ADT_YR || '-' || D1.TSK_NO) AS ADT_CLSF_NO /* 감사분류번호 */,
    D1.ADT_KDCD /* 감사종류코드 */,
    D1.ADT_MTTR_NM /* 감사사항명 */,
    D1.HNDL_DIV_DPT_CD /* 처리과 */
FROM TBCSPAOE021M D1 ,TB_BADDED001M D2 WHERE 1=1 AND D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND LENGTH(D1.TSK_NO) = 3 AND D1.HNDL_DIV_DPT_CD = #strUsrDptCd# AND D1.CVLCPT_ADT_YR = D2.ADT_YR (+) and D1.TSK_NO = D2.ADT_NO (+) D2.ADT_GRNT_NO = #ADT_GRNT_NO# D1.ADT_MTTR_NM like '%'||#strAudSbjNm#||'%' SUBSTR(D2.ADT_KDCD,3,1) = #strAudYrNoKndCd# ORDER BY D1.CVLCPT_ADT_YR, D1.TSK_NO ASC