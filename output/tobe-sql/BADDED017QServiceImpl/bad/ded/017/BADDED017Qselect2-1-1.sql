SELECT ECD.CD_NM,
    /*구분*/ (NVL(AFT.MAN_DAY, 0 ) - NVL(BEFORE.MAN_DAY, 0)) AS MAN_DAY,
    /*연인원*/ (NVL(AFT.LEAD_CST, 0) - NVL(BEFORE.LEAD_CST, 0)) AS LEAD_CST /* 지휘비용 */,
    /*지휘비*/ (NVL(AFT.ADT_ACTV_ACTC_AMT, 0) - NVL(BEFORE.ADT_ACTV_ACTC_AMT, 0)) AS ADT_ACTV_ACTC_AMT /* 감사활동수용금액 */,
    /*감사활동수용비*/ (NVL(AFT.SPM_CST, 0) - NVL(BEFORE.SPM_CST, 0)) AS SPM_CST /* 보충비용 */,
    /*보충경비*/ (NVL(AFT.SUM_ALL, 0) - NVL(BEFORE.SUM_ALL, 0)) AS SUM_ALL /* 계 */
FROM TBDCMACM013C ECD, ( SELECT RGN_SECD /* 지역구분코드 */,
    SUM(BZTRP_DCN) AS BZTRP_DCN /* 출장일수 */,
    SUM(NVL(LEAD_CST, 0)) AS LEAD_CST /* 지휘비용 */,
    SUM(NVL(ADT_ACTV_ACTC_AMT, 0)) AS ADT_ACTV_ACTC_AMT /* 감사활동수용금액 */,
    SUM(SPM_CST) AS SPM_CST /* 보충비용 */,
    SUM(NVL(LEAD_CST, 0)) + SUM(NVL(ADT_ACTV_ACTC_AMT, 0)) + SUM(SPM_CST) AS LEAD_CST /* 지휘비용 */
FROM (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    MAX(BZTRP_CLCLN_SQNO) AS BZTRP_CLCLN_SQNO /* 출장정산순번 */,
    MAX(CLCLN_CHG_RSN_CN) AS CLCLN_CHG_RSN_CN /* 정산변경사유내용 */
FROM TBBADDED019H WHERE BZTRP_YR = #BZTRP_YR# AND BZTRP_SQNO = #BZTRP_SQNO# AND NVL(CLCLN_YN, 'N') = 'N' GROUP BY BZTRP_YR , BZTRP_SQNO , BZTRVR_ENO) D1 , TBBADDED019H TE WHERE 1=1 AND D1.BZTRP_YR = TE.BZTRP_YR AND D1.BZTRP_SQNO = TE.BZTRP_SQNO AND D1.BZTRVR_ENO = TE.BZTRVR_ENO AND D1.MAX_SNO = TE.BZTRP_CLCLN_SQNO AND D1.BZTRP_YR = #BZTRP_YR# AND D1.BZTRP_SQNO = #BZTRP_SQNO# GROUP BY TE.RGN_SECD ) AFT, ( SELECT RGN_SECD /* 지역구분코드 */,
    SUM(BZTRP_DCN) AS BZTRP_DCN /* 출장일수 */,
    SUM(NVL(LEAD_CST, 0)) AS LEAD_CST /* 지휘비용 */,
    SUM(NVL(ADT_ACTV_ACTC_AMT, 0)) AS ADT_ACTV_ACTC_AMT /* 감사활동수용금액 */,
    SUM(SPM_CST) AS SPM_CST /* 보충비용 */,
    SUM(NVL(LEAD_CST, 0)) + SUM(NVL(ADT_ACTV_ACTC_AMT, 0)) + SUM(SPM_CST) AS LEAD_CST /* 지휘비용 */
FROM (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    MAX(BZTRP_CLCLN_SQNO) AS BZTRP_CLCLN_SQNO /* 출장정산순번 */,
    MAX(CLCLN_CHG_RSN_CN) AS CLCLN_CHG_RSN_CN /* 정산변경사유내용 */
FROM TBBADDED019H WHERE BZTRP_YR = #BZTRP_YR# AND BZTRP_SQNO = #BZTRP_SQNO# AND NVL(CLCLN_YN, 'N') = 'Y' GROUP BY BZTRP_YR , BZTRP_SQNO , BZTRVR_ENO) D1 , TBBADDED019H TE WHERE 1=1 AND D1.BZTRP_YR = TE.BZTRP_YR AND D1.BZTRP_SQNO = TE.BZTRP_SQNO AND D1.BZTRVR_ENO = TE.BZTRVR_ENO AND D1.MAX_SNO = TE.BZTRP_CLCLN_SQNO AND D1.BZTRP_YR = #BZTRP_YR# AND D1.BZTRP_SQNO = #BZTRP_SQNO# GROUP BY TE.RGN_SECD ) BEFORE WHERE ECD.CMM_CD_DVSN_CD='1000023' AND ECD.CD IN ('1', '2', '3', '4', '5', '6') AND BEFORE.RGN_SECD(+) = ECD.CD AND AFT.RGN_SECD(+) = ECD.CD