SELECT D1.CVLCPT_ADT_YR AS CVLCPT_ADT_YR /* 민원감사년도 */,
    D1.ADT_NO AS ADT_NO /* 감사번호 */,
    T1.ADT_GRNT_NO AS ADT_GRNT_NO /* 감사부여번호 */,
    D1.CVLCPT_ADT_YR||D1.ADT_NO AS ADT_CLSF_NO /* 감사분류번호 */,
    (SELECT F_ORG_CNT_NM_AUD(D1.CVLCPT_ADT_YR,D1.ADT_NO,'AUD') AS CVLCPT_ADT_YR /* 민원감사년도 */
FROM DUAL ) AS AUD_ORG_CNT /*기관명*/ , D1.DSPS_RQT_SQNO AS DSPS_RQT_SQNO /*처분요구순번*/ , F_MNG_KND_AUDYRNO(T1.ADT_YR, T1.ADT_NO, T1.ADT_KDCD, '-') || '-' || D1.DSPS_RQT_SQNO AS DSP_RQ_SNO_NM /*처분요구순번DISP*/ , CASE WHEN T1.ADT_YR >= '2016' THEN SUBSTR(T1.ADT_KDCD,3,1) ELSE '' END AS AUD_YR_NO_KND_CD /*감사연번호종류코드 추가 - 2015.12.24 yyh*/ , CASE WHEN T1.ADT_YR >= '2016' THEN F_CODE_NM('1000739',SUBSTR(T1.ADT_KDCD,3,1)) ELSE '' END AS AUD_YR_NO_KND_NM /*감사연번호종류코드 추가 - 2015.12.24 yyh*/ , D1.TMPLT_NO AS TMPLT_NO /*서식번호*/ , D1.RPTP_NO AS RPTP_NO /*보고서식번호*/ , D1.DSPS_RQT_NM AS DSPS_RQT_NM /*제목내용*/ , D1.DSPS_RQT_KDCD AS DSPS_RQT_KDCD /*처분요구종류코드*/ , D1.INST_SECD AS INST_SECD /*기관구분코드*/ , D1.ADT_EMPHS_SECD AS ADT_EMPHS_SECD /*감사중점코드*/ , D2.DSPS_RQT_IDNO AS DSPS_RQT_IDNO /*처분요구일련번호*/ , D2.ENFC_YMD AS ENFC_YMD /*시행일*/ , D2.PRCS_TERM_YMD AS PRCS_TERM_YMD /*처리기한일*/ , D2.ENFC_DEPT_CD AS ENFC_DEPT_CD /*시행국과코드*/ , F_DPT_INFO(D2.ENFC_DEPT_CD,'1') AS ENF_BRDV_NM /*시행국과명*/ , D2.DOC_SNDNG_NO AS DOC_SNDNG_NO /*문서발송코드*/ , D2.VIOL_CS_SECD AS VIOL_CS_SECD /*비위원인코드*/ , D2.IMPL_MNG_JRSD_DEPT_CD AS IMPL_MNG_JRSD_DEPT_CD /*집행관리국과코드*/ , D2.CFMTN_YN AS CFMTN_YN /*확정여부*/ , D2.CFMTN_STTS_SECD AS CFMTN_STTS_SECD /*확정상태코드*/ , D2.HMPG_RLS_YN AS HMPG_RLS_YN /*홈페이지공개여부*/ , D2.DUTY_OBV_UTLZ_YN AS DUTY_OBV_UTLZ_YN /*직무관철활용여부*/ , D2.VIOL_TPCD AS VIOL_TPCD /*비위유형코드*/ , D2.DSPS_RQT_ATRZ_STTS_SECD AS DSPS_RQT_ATRZ_STTS_SECD /*처분요구결재상태코드*/ , D2.TASK_SECD AS TASK_SECD /*업무분류코드*/ , F_CODE_NM('1000121',D2.VIOL_TPCD) AS VIOL_TYPE_NM /*비위유형코드명*/ , F_CODE_NM('1000120',D2.TASK_SECD) AS TSK_CAT_NM /*업무분류명*/ , F_CODE_NM('1000002',D1.DSPS_RQT_KDCD ) AS DSPS_RQT_KND_CVN /*처분요구종류명*/ , F_CODE_NM('1000017',D2.CFMTN_STTS_SECD ) AS DTM_STA_NM /*결재상태명*/ FROM TB_BADEAR001M D1 , TB_BADEAR002D D2 , TB_BADDED001M T1 WHERE 1=1 AND D1.CVLCPT_ADT_YR = D2.ADT_YR AND D1.ADT_NO = D2.ADT_NO AND D1.DSPS_RQT_SQNO = D2.DSPS_RQT_SQNO AND D1.CVLCPT_ADT_YR = T1.ADT_YR AND D1.ADT_NO = T1.ADT_NO AND D1.DSPS_RQT_KDCD = #DSPS_RQT_KDCD# AND D2.ENFC_YMD >= #strEnfDtSt# AND D2.ENFC_YMD AND D1.CVLCPT_ADT_YR >= #strAudYrSt# AND D1.CVLCPT_ADT_YR AND D1.CVLCPT_ADT_YR||LPAD(T1.ADT_GRNT_NO,4,'0') >= #strAudYrSt#||DECODE(#strAudGrnNoSt#,'','0000', LPAD(#strAudGrnNoSt#,4,'0')) AND D1.CVLCPT_ADT_YR||LPAD(T1.ADT_GRNT_NO,4,'0') /* 감사연번종류코드 추가 - 2015.12.22 yyh */ AND SUBSTR(T1.ADT_KDCD,3,1) = SUBSTR(#strAudYrNoKndCdSt#,3,1) AND D2.ENFC_DEPT_CD = #ENFC_DEPT_CD# AND D1.DSPS_RQT_NM LIKE '%'||#strTitTxt#||'%' AND (SELECT PROF_RBPRSN_INST_NM /* 증명책임자기관명 */
FROM TBDCMACM015M WHERE INST_CD = D2.REL_INST_CD) LIKE #strRltnOrgNm#||'%' AND EXISTS (SELECT 1
FROM TB_BADEAR007M WHERE 1=1 AND CVLCPT_ADT_YR = D1.CVLCPT_ADT_YR AND ADT_NO = D1.ADT_NO AND DSPS_RQT_SQNO = D1.DSPS_RQT_SQNO AND RLPR_NM LIKE #strDfntNam#||'%') ORDER BY D1.CVLCPT_ADT_YR , D1.ADT_NO DESC, D1.DSPS_RQT_SQNO DESC