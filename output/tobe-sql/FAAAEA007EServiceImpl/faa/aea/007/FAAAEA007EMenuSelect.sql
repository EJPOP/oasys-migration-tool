WITH DATA AS ( SELECT ROW_NUMBER() OVER(PARTITION BY SUBSTR(CD,1,2) ORDER BY CD ASC) AS ROW_NUMBER,
    SUBSTR(CD,1,2) AS SUBSTR,
    CD AS CD
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000854' AND CD NOT IN ('000000000','1000','2000') AND SUBSTR(CD,3,4) != '00' AND USE_YN = 'Y' ) SELECT CD_11,
    (SELECT $strTxtColNm$
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_11) AS CD_NM_11 ,(SELECT USR_DFN_TXT_2
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_11) AS LINK_11 ,(SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_11) AS LINK_REG_11 ,(SELECT COUNT(1)
FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD = CD_11 AND INST_CD = #INST_CD#) AS CD_CNT_11 ,CD_12 ,(SELECT $strTxtColNm$
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_12) AS CD_NM_12 ,(SELECT USR_DFN_TXT_2
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_12) AS LINK_12 ,(SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_12) AS LINK_REG_12 ,(SELECT COUNT(1)
FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD = CD_12 AND INST_CD = #INST_CD#) AS CD_CNT_12 ,CD_13 ,(SELECT $strTxtColNm$
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_13) AS CD_NM_13 ,(SELECT USR_DFN_TXT_2
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_13) AS LINK_13 ,(SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_13) AS LINK_REG_13 ,(SELECT COUNT(1)
FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD = CD_13 AND INST_CD = #INST_CD#) AS CD_CNT_13 ,CD_14 ,(SELECT $strTxtColNm$
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_14) AS CD_NM_14 ,(SELECT USR_DFN_TXT_2
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_14) AS LINK_14 ,(SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_14) AS LINK_REG_14 ,(SELECT COUNT(1)
FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD = CD_14 AND INST_CD = #INST_CD#) AS CD_CNT_14 ,CD_15 ,(SELECT $strTxtColNm$
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_15) AS CD_NM_15 ,(SELECT USR_DFN_TXT_2
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_15) AS LINK_15 ,(SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_15) AS LINK_REG_15 ,(SELECT COUNT(1)
FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD = CD_15 AND INST_CD = #INST_CD#) AS CD_CNT_15 ,CD_16 ,(SELECT $strTxtColNm$
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_16) AS CD_NM_16 ,(SELECT USR_DFN_TXT_2
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_16) AS LINK_16 ,(SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_16) AS LINK_REG_16 ,(SELECT COUNT(1)
FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD = CD_16 AND INST_CD = #INST_CD#) AS CD_CNT_16 ,CD_21 ,(SELECT $strTxtColNm$
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_21) AS CD_NM_21 ,(SELECT USR_DFN_TXT_2
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_21) AS LINK_21 ,(SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_21) AS LINK_REG_21 ,(SELECT COUNT(1)
FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD = CD_21 AND INST_CD = #INST_CD#) AS CD_CNT_21 ,CD_22 ,(SELECT $strTxtColNm$
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_22) AS CD_NM_22 ,(SELECT USR_DFN_TXT_2
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_22) AS LINK_22 ,(SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_22) AS LINK_REG_22 ,CASE WHEN (SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_22) = 'Y' THEN (SELECT COUNT(1)
FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD = CD_22 AND INST_CD = #INST_CD#) ELSE 0 END AS CD_CNT_22 ,CD_23 ,(SELECT $strTxtColNm$
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_23) AS CD_NM_23 ,(SELECT USR_DFN_TXT_2
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_23) AS LINK_23 ,(SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_23) AS LINK_REG_23 ,(SELECT COUNT(1)
FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD = CD_23 AND INST_CD = #INST_CD#) AS CD_CNT_23 ,CD_24 ,(SELECT $strTxtColNm$
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_24) AS CD_NM_24 ,(SELECT USR_DFN_TXT_2
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_24) AS LINK_24 ,(SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_24) AS LINK_REG_24 ,(SELECT COUNT(1)
FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD = CD_24 AND INST_CD = #INST_CD#) AS CD_CNT_24 ,CD_25 ,(SELECT $strTxtColNm$
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_25) AS CD_NM_25 ,(SELECT USR_DFN_TXT_2
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_25) AS LINK_25 ,(SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_25) AS LINK_REG_25 ,(SELECT COUNT(1)
FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD = CD_25 AND INST_CD = #INST_CD#) AS CD_CNT_25 ,CD_26 ,(SELECT $strTxtColNm$
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_26) AS CD_NM_26 ,(SELECT USR_DFN_TXT_2
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_26) AS LINK_26 ,(SELECT USR_DFN_TXT_3
FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_26) AS LINK_REG_26 ,(SELECT COUNT(1)
FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD = CD_26 AND INST_CD = #INST_CD#) AS CD_CNT_26 FROM DATA PIVOT ( MAX(CD) FOR CUT_CD IN ( '11' AS CD_11 ,'12' AS CD_12 ,'13' AS CD_13 ,'14' AS CD_14 ,'15' AS CD_15 ,'16' AS CD_16 ,'21' AS CD_21 ,'22' AS CD_22 ,'23' AS CD_23 ,'24' AS CD_24 ,'25' AS CD_25 ,'26' AS CD_26 ) ) ORDER BY DVSN