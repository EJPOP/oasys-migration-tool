SELECT D1.JRSD_INST_CD /* 소관기관코드 */,
    D1.SYS_NM,
    D1.UNT_SYS_NM,
    D1.UNT_SYS_DES,
    CASE WHEN MAX(TRIM(D2.TBL_NM)) IS NOT NULL THEN MAX(TRIM(D2.TBL_NM))||' 등 '||( SELECT COUNT(TBL_ID) AS TBL_ID /* 테이블아이디 */
FROM TBFAAAEA003M WHERE JRSD_INST_CD = D1.JRSD_INST_CD AND SYS_NM = D1.SYS_NM AND UNT_SYS_NM = D1.UNT_SYS_NM GROUP BY SYS_NM, UNT_SYS_NM )||'개 자료' ELSE '' END AS TBL_CNT ,D1.TKCG_DEPT_NM||' '||D1.PIC_NM||' ('||D1.CHGR_CNIF_NM||')' AS CHR_INFO FROM TBFAAAEA002M D1 LEFT OUTER JOIN TBFAAAEA003M D2 ON D1.JRSD_INST_CD = D2.JRSD_INST_CD AND D1.SYS_NM = D2.SYS_NM AND D1.UNT_SYS_NM = D2.UNT_SYS_NM WHERE D1.JRSD_INST_CD = #JRSD_INST_CD# AND D1.SYS_NM = #strSysNm# GROUP BY D1.JRSD_INST_CD ,D1.SYS_NM ,D1.UNT_SYS_NM ,D1.UNT_SYS_DES ,D1.TKCG_DEPT_NM ,D1.PIC_NM ,D1.CHGR_CNIF_NM ORDER BY D1.UNT_SYS_NM