SELECT D1.NTFCTN_INST_CD /* 통보기관코드 */,
    D1.NTFCTN_SECD /* 통보구분코드 */,
    D1.NTFCTN_SQNO /* 통보순번 */,
    D1.NTFCTN_YR /* 통보년도 */,
    D1.DEPT_CD /* 부서코드 */,
    F_CODE_NM('1000202',D1.OCRN_SECD) AS F_CODE_NM,
    CASE WHEN D1.NTFCTN_RCPT_SQNO IS NOT NULL THEN LINK_YR || '-' || DECODE(D1.OCRN_SECD,'6','판청','손망') || '-' || D1.NTFCTN_RCPT_SQNO ELSE '' END AS NTFCTN_RCPT_SQNO /* 통보접수순번 */,
    F_CODE_NM('1000766', D1.LAD_RLVT_RULE_SECD) AS F_CODE_NM /* 손망실관련규정코드명 - 2016.11.17 yyh */,
    (SELECT AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */
FROM TBDCMACM015M WHERE INST_CD = D1.NTFCTN_INST_CD) || '-' || (SELECT CD_NM
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD ='1000202' AND CD = D1.OCRN_SECD) || '-' || D1.NTFCTN_SQNO AS NTF_SBJ_NO /* 통보사항번호 */ ,F_DPT_INFO(D1.DEPT_CD,'1') AS CNSTN_MBCMT_DEPT_NM /* 부서명 */ ,D1.NTFCTN_NM /* 제목명 */ ,D1.HRM_AMT /* 손해금액 */ ,(SELECT CASE WHEN COUNT(1) = 1 THEN MAX( RLPR_NM || '(' || LINK_JBGD_NM || ')' ) WHEN COUNT(1) > 1 THEN MAX( RLPR_NM || '(' || LINK_JBGD_NM || ')' ) || '외 ' || ( COUNT(FRS_MDM_SQNO) - 1 ) || '명' ELSE '' AS 1
FROM TB_BADGDA001L WHERE 1=1 AND INST_CD = D1.NTFCTN_INST_CD AND NTFCTN_SECD = D1.NTFCTN_SECD AND NTFCTN_SQNO = D1.NTFCTN_SQNO GROUP BY INST_CD, NTFCTN_SECD, NTFCTN_SQNO) AS DFNT_NMS ,D1.NTFCTN_RCPT_YMD /* 접수일 */ ,CASE WHEN D1.NTFCTN_RCPT_STTS_SECD IN ('58','59') THEN '미접수' WHEN D1.NTFCTN_RCPT_STTS_SECD IN ('71','72','76') THEN '처리중' WHEN D1.NTFCTN_RCPT_STTS_SECD = '75' THEN '결재중' WHEN D1.NTFCTN_RCPT_STTS_SECD = '77' THEN '완결' ELSE D1.NTFCTN_RCPT_STTS_SECD END AS ACP_STA_NM /* 접수상태코드 */ ,CASE WHEN D1.PRCS_OPNN_SECD IS NOT NULL THEN F_CODE_NM('1000200', D1.PRCS_OPNN_SECD) ELSE '미처리' END AS HNDL_OPIN_NM /* 처리의견 */ ,D1.CPLT_YMD /* 완결일 */ ,D1.BAI_RPT_YMD AS BAI_RPT_YMD /* 감사원통보일 */ FROM TB_BADGDA001M D1 WHERE D1.NTFCTN_SECD = '2' /* 통보구분코드 (1:범죄및징계, 2:망실및훼손) */ AND D1.NTFCTN_RCPT_STTS_SECD != '51' AND D1.NTFCTN_INST_CD = #INST_CD# AND D1.NTFCTN_RCPT_YMD BETWEEN #strAcpDtStr# AND #strAcpDtEnd# AND D1.NTFCTN_NM LIKE '%'||#strTitNm#||'%' AND 0