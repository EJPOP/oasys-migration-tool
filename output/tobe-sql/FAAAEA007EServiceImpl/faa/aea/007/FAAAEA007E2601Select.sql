SELECT D1.NTT_ID,
    D1.NTT_SJ,
    D1.FRST_REGISTER_ID,
    NVL(D2.USER_NM, D1.NTCR_NM) AS USER_NM /* 사용자명 */,
    TO_CHAR(D1.FRST_REGIST_PNTTM, 'YYYY-MM-DD') AS TO_CHAR,
    D1.CVLPR_EML_ADDR /* 민원인이메일주소 */,
    D1.CVLPR_TELNO /* 민원인전화번호 */,
    D1.JUSO,
    D1.SUB1,
    D1.SUB2,
    D1.RDCNT,
    D1.CATEGORY,
    D1.PARNTSCTT_NO,
    D1.ANSWER_AT,
    D1.ANSWER_LC,
    D1.USE_AT,
    D1.CVLCPT_DOC_ID /* 민원문서아이디 */,
    CASE WHEN D1.SUB1 IS NOT NULL AND D1.NTT_CN IS NOT NULL AND D1.SUB2 IS NOT NULL THEN TO_CLOB(D1.SUB1) || CHR(13)||CHR(10) || TO_CLOB(D1.NTT_CN) || CHR(13)||CHR(10) ||TO_CLOB(D1.SUB2) WHEN D1.SUB1 IS NOT NULL AND D1.NTT_CN IS NOT NULL AND D1.SUB2 IS NULL THEN TO_CLOB(D1.SUB1) || CHR(13)||CHR(10) || TO_CLOB(D1.NTT_CN) WHEN D1.SUB1 IS NOT NULL AND D1.NTT_CN IS NULL AND D1.SUB2 IS NOT NULL THEN TO_CLOB(D1.SUB1) || CHR(13)||CHR(10) || TO_CLOB(D1.SUB2) WHEN D1.SUB1 IS NULL AND D1.NTT_CN IS NOT NULL AND D1.SUB2 IS NOT NULL THEN TO_CLOB(D1.NTT_CN) || CHR(13)||CHR(10) || TO_CLOB(D1.SUB2) WHEN D1.SUB1 IS NOT NULL AND D1.NTT_CN IS NULL AND D1.SUB2 IS NULL THEN TO_CLOB(D1.SUB1) WHEN D1.SUB1 IS NULL AND D1.NTT_CN IS NOT NULL AND D1.SUB2 IS NULL THEN TO_CLOB(D1.NTT_CN) WHEN D1.SUB1 IS NULL AND D1.NTT_CN IS NULL AND D1.SUB2 IS NOT NULL THEN TO_CLOB(D1.SUB2) ELSE TO_CLOB('') END AS SUB1,
    D1.BBS_ID /* 게시판아이디 */,
    RTRIM(D1.NTCE_BGNDE) AS RTRIM,
    RTRIM(D1.NTCE_ENDDE) AS RTRIM,
    D1.NTCR_NM,
    D1.INSTITUTION,
    D1.REL_INST_CD /* 관계기관코드 */,
    F_ORG_INFO(D1.REL_INST_CD,'1') AS F_ORG_INFO,
    CASE WHEN D1.ORG_REGI_YN='Y' THEN '등록' ELSE '미등록' END AS ORG_REGI_YN
FROM TBCSPTSM002L D1 LEFT OUTER JOIN TBDCMACM001M D2 ON D1.FRST_REGISTER_ID = D2.USER_ID WHERE BBS_ID='BBSMSTR_100000000032' AND D1.USE_AT = 'Y' AND D1.REL_INST_CD = #REL_INST_CD# AND D1.ATRZ_STTS_SECD='3' AND (D1.NTT_SJ LIKE '%' || #strSearchBox# || '%' OR D1.NTT_CN LIKE '%' || #strSearchBox# || '%' OR D1.NTCR_NM LIKE '%' || #strSearchBox# || '%') AND (TO_CHAR(D1.FRST_REGIST_PNTTM,'YYYYMMDD') >= #strFRST_REGIST_PNTTMS# OR D1.FRST_REGIST_PNTTM IS NULL) AND (TO_CHAR(D1.FRST_REGIST_PNTTM,'YYYYMMDD') AND SUBSTR(D1.FRST_REGIST_PNTTM,1,4) = #strYr#