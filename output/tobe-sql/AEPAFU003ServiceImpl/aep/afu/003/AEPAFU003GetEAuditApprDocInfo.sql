SELECT A.SRECS_SORT_SQNO /* 심사재심의정렬순번 */,
    C.ADT_STP_NM /* 감사단계명 */,
    B.RPTP_NM /* 보고서명 */,
    B.RPTP_KDCD /* 보고서종류코드 */,
    A.ATRZ_DMND_ID /* 결재요청아이디 */,
    A.CVLCPT_ADT_YR /* 민원감사년도 */,
    A.ADT_NO /* 감사번호 */,
    A.ADT_STP_SECD /* 감사단계구분코드 */,
    A.CVLCPT_DOC_ID /* 민원문서아이디 */,
    A.TPOF_ATRZ_SECD /* 제보결재구분코드 */,
    A.CRU_ATRZ_DOC_SECD /* 부패결재문서구분코드 */,
    F_OPEN_EDIT(B.LNKG_URL_ADDR) AS F_OPEN_EDIT,
    D.EDT_DMND_SQNO /* 편집요청순번 */,
    D.EDT_PRM_YMD /* 편집허용일자 */,
    D.EDT_PRM_DT /* 편집허용일시 */
FROM TB_BADDED109M A INNER JOIN TB_BADDED103M B ON A.CVLCPT_ADT_YR = B.ADT_YR AND A.ADT_NO = B.ADT_NO AND A.ADT_STP_SECD = B.ADT_STP_SECD AND A.CVLCPT_DOC_ID = B.DOC_ID INNER JOIN TB_BADDED101M C ON A.CVLCPT_ADT_YR = C.ADT_YR AND A.ADT_NO = C.ADT_NO AND A.ADT_STP_SECD = C.ADT_STP_SECD INNER JOIN TB_BADDED149M D ON A.CVLCPT_ADT_YR = D.ADT_YR AND A.ADT_NO = D.ADT_NO AND A.ADT_STP_SECD = D.ADT_STP_SECD AND A.CVLCPT_DOC_ID = D.DOC_ID AND D.EDT_DMND_SQNO = (SELECT MAX(FRS_MDM_SQNO) AS FRS_MDM_SQNO /* 포렌식매체순번 */
FROM TB_BADDED149M AA WHERE AA.CVLCPT_ADT_YR = D.ADT_YR AND AA.ADT_NO = D.ADT_NO AND AA.ADT_STP_SECD = D.ADT_STP_SECD AND AA.CVLCPT_DOC_ID = D.DOC_ID AND AA.ATRZ_DMND_ID = D.ATRZ_DMND_ID) AND A.ATRZ_DMND_ID = D.ATRZ_DMND_ID WHERE A.ATRZ_DMND_ID = #ATRZ_DMND_ID# AND A.CRU_ATRZ_DOC_SECD = #CRU_ATRZ_DOC_SECD# ORDER BY A.SRECS_SORT_SQNO