SELECT DECODE(A.NTFCTN_RCPT_SQNO,NULL,'',A.ACP_YE||'-'||A.NTFCTN_RCPT_SQNO) AS NTFCTN_RCPT_SQNO /* 통보접수순번 */,
    A.SBMSN_YMD /* 제출일자 */,
    A.RSCH_ASMT_TTL /* 연구과제제목 */,
    F_USR_INFO(DGUARD.DECRYPT('TB_ENC','EAN', A.TRGT_NOP_ENO),'2') AS USER_NM /* 사용자명 */,
    A.NAM_OPEN_YN /* 성명공개여부 */,
    F_CODE_NM('1000992',A.PRGRS_STTS_SECD) AS F_CODE_NM /* 진행단계 */,
    A.PRGRS_STTS_SECD /* 진행상태구분코드 */,
    A.PRB_TXT /* 문제점내용 */,
    A.WSH_IMP_TXT /* 희망개선내용 */,
    A.MSG_TXT /* 숨김사유 */,
    (SELECT Z.CVLCPT_DOC_ID AS CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPLTT002M Z WHERE Z.TK_YE = A.TK_YE AND Z.TK_SLN = A.TK_SLN AND Z.ATT_FL_DVSN_CD = '1') AS CVLCPT_DOC_ID /*첨부파일 문서*/ ,F_DPT_INFO(A.EXAM_DPT_CD,'1') AS EXAM_DPT_NM /*검토부서*/ ,A.EXAM_DPT_CD /*검토부서코드*/ ,A.EXAM_DT /*검토일자*/ ,A.EXEC_APT_DT /*실시예정일자*/ ,F_USR_INFO(A.EXAM_CNB,'2') AS EXAM_NAM /*검토자*/ ,A.EXAM_TXT /*검토의견*/ ,A.EXAM_RPL_TXT /*검토회신내용*/ ,F_CODE_NM('1000077',A.EXAM_RSLT_CD) AS EXAM_RSLT_NM ,(SELECT Z.CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPLTT002M Z WHERE Z.TK_YE = A.TK_YE AND Z.TK_SLN = A.TK_SLN AND Z.ATT_FL_DVSN_CD = '2') AS EXAM_DOC_ID /*검토첨부파일 문서*/ ,DECODE(A.PRGRS_STTS_SECD,'N','Y','M','N','') AS PRSS_STA_YN /*채택여부*/ ,A.MDT_YN ,F_DPT_INFO(A.MDT_DPT_CD,'1') AS MDT_DPT_NM /*검토부서*/ ,A.MDT_DPT_CD /*검토부서코드*/ ,A.MDT_DT /*검토일자*/ ,A.MDT_EXEC_APT_DT /*실시예정일자*/ ,F_USR_INFO(A.MDT_CNB,'2') AS MDT_NAM /*검토자*/ ,A.MDT_TXT /*검토의견*/ ,A.MDT_RPL_TXT /*검토회신내용*/ ,F_CODE_NM('1000077',A.MDT_RSLT_CD) AS MDT_RSLT_NM ,(SELECT Z.CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPLTT002M Z WHERE Z.TK_YE = A.TK_YE AND Z.TK_SLN = A.TK_SLN AND Z.ATT_FL_DVSN_CD = '3') AS MDT_DOC_ID /*검토첨부파일 문서*/ ,A.TK_YE /*생각연도*/ ,A.TK_SLN /*생각연번*/ ,NVL(A.ENAIS_PST_INQ_NMTM, 0) AS ENAIS_PST_INQ_NMTM ,NVL(B.CMMT_CNT, 0) AS CMMT_CNT ,NVL(C.RCMD_CNT, 0) AS RCMD_CNT ,NVL(C.DCMD_CNT, 0) AS DCMD_CNT FROM TBCSPLTT001M A, /*함께생각합시다 기본*/ (SELECT TK_YE,
    TK_SLN,
    COUNT(*) AS CMMT_CNT
FROM TBCSPLTT004M GROUP BY TK_YE, TK_SLN) B, (SELECT TK_YE,
    TK_SLN,
    SUM(CASE WHEN RCMD_YN = 'Y' THEN 1 ELSE 0 END ) AS RCMD_YN,
    SUM(CASE WHEN RCMD_YN = 'N' THEN 1 ELSE 0 END ) AS RCMD_YN
FROM TBCSPLTT003M GROUP BY TK_YE, TK_SLN) C WHERE 1=1 AND A.TK_YE = B.TK_YE(+) AND A.TK_SLN = B.TK_SLN(+) AND A.TK_YE = C.TK_YE(+) AND A.TK_SLN = C.TK_SLN(+) AND A.TK_YE = #strTK_YE# AND A.TK_SLN = #strTK_SLN#