SELECT TL.FT_SQNO /* 출장조순번 */,
    TL.FT_TRGT_INST_SQNO /* 출장조대상기관순번 */,
    TL.RL_SCO_SQNO /* 철도구간순번 */,
    TL.BZTRP_SQNO /* 출장순번 */,
    TL.BZTRP_YR /* 출장년도 */,
    TL.RIDE_YMD /* 승차일자 */,
    TL.TRAIN_KDCD /* 열차종류코드 */,
    TL.CRG_SECD /* 요금구분코드 */,
    TL.DST_NM /* 출발역명 */,
    TL.ARVL_DST_NM /* 도착출발역명 */,
    TL.RL_FARE_AMT /* 철도운임금액 */,
    TL.STD_CRG_YN /* 표준요금여부 */,
    TL.BGNG_DPPL_SECD /* 시작출발지구분코드 */,
    TMA.BZTRVR_ENO /* 출장자직원전산번호 */,
    PTD.BZTRVR_ALTMNT_SQNO /* 출장자배정순번 */
FROM TB_BADDED009L TL , TB_BADDED005L TMA , TB_BADDED006L PTD WHERE 1=1 AND TL.FT_SQNO = PTD.FT_SQNO AND TL.FT_TRGT_INST_SQNO = PTD.FT_TRGT_INST_SQNO AND TL.BZTRP_SQNO = PTD.BZTRP_SQNO AND TL.BZTRP_YR = PTD.BZTRP_YR AND TL.FT_SQNO = TMA.FT_SQNO AND TL.BZTRP_SQNO = TMA.BZTRP_SQNO AND TL.BZTRP_YR = TMA.BZTRP_YR AND TMA.EMP_SECD <> '9' /*여비미지급 차출자 제외*/ AND TMA.BZTRVR_ALTMNT_SQNO = PTD.BZTRVR_ALTMNT_SQNO AND TMA.DPTRE_RGN_SECD = NVL(TL.BGNG_DPPL_SECD,'0100') AND (TL.RIDE_YMD BETWEEN PTD.ADT_BGNG_YMD AND PTD.ADT_END_YMD OR EXISTS (SELECT 1
FROM TB_BADDED013B H WHERE 1=1 AND H.HLDY_CRTR_YR||H.HLDY_CRTR_MND BETWEEN PTD.ADT_BGNG_YMD AND PTD.ADT_END_YMD AND (H.HLDY_CRTR_YR||H.HLDY_CRTR_MND = TO_CHAR(TO_DATE(TL.RIDE_YMD) -1,'YYYYMMDD') OR H.HLDY_CRTR_YR||H.HLDY_CRTR_MND = TO_CHAR(TO_DATE(TL.RIDE_YMD) +1,'YYYYMMDD')))) AND TL.BZTRP_YR = #BZTRP_YR# AND TL.BZTRP_SQNO = #BZTRP_SQNO# ORDER BY TL.RIDE_YMD