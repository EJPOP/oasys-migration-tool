SELECT D1.NTFCTN_YR /* 통보년도 */,
    D1.NTFCTN_SQNO /* 통보순번 */,
    D1.NTFCTN_INST_CD /* 통보기관코드 */,
    D1.NTFCTN_SECD /* 통보구분코드 */,
    D1.NTFCTN_YR||'-'||D1.NTFCTN_SQNO AS NTFCTN_YR /* 통보년도 */,
    F_CODE_NM('1000650', D1.NTFCTN_SECD) AS F_CODE_NM,
    D1.NTFCTN_NM /* 통보명 */,
    D1.HRM_AMT /* 손해금액 */,
    D2.RLPR_NM /* 관계자명 */,
    F_CODE_NM('1000058', D2.RLPR_JBGD_SECD) AS F_CODE_NM,
    CASE WHEN D2.DSPS_YMD IS NOT NULL THEN SUBSTRING(D2.DSPS_YMD,0,4)||'.'||SUBSTRING(D2.DSPS_YMD,5,2)||'.'||SUBSTRING(D2.DSPS_YMD,7,2) ELSE D2.DSPS_YMD END AS DSPS_YMD /* 처분일자 */,
    CASE WHEN D1.BAI_RPT_YMD IS NOT NULL THEN SUBSTRING(D1.BAI_RPT_YMD,0,4)||'.'||SUBSTRING(D1.BAI_RPT_YMD,5,2)||'.'||SUBSTRING(D1.BAI_RPT_YMD,7,2) ELSE D1.BAI_RPT_YMD END AS BAI_RPT_YMD /* 감사원보고일자 */
FROM TB_BADGDA001M D1 LEFT OUTER JOIN TB_BADGDA001L D2 ON D1.NTFCTN_INST_CD = D2.NTFCTN_INST_CD(+) AND D1.NTFCTN_SECD = D2.NTFCTN_SECD(+) AND D1.NTFCTN_SQNO = D2.NTFCTN_SQNO(+) AND D2.NTFCTN_SQNO = '1' WHERE D1.NTFCTN_SECD = '2' AND D1.NTFCTN_INST_CD = #INST_CD# AND D1.NTFCTN_INST_CD LIKE REPLACE(#INST_CD#,'000','') || '%' AND D1.NTFCTN_INST_CD = #INST_CD# AND D1.NTFCTN_INST_CD LIKE REPLACE(#INST_CD#,'000','') || '%' AND D1.NTFCTN_NM LIKE '%'||#strTitNm2#||'%' AND D1.BAI_RPT_YMD >= #strBaiRptSDt2# AND D1.BAI_RPT_YMD ORDER BY D1.NTFCTN_YR DESC, D1.NTFCTN_SQNO, D1.NTFCTN_NM , D1.BAI_RPT_YMD DESC