INSERT INTO TBCSPAOE038M (EVL_YR, HLYR_DVSN_CD, EVL_GP_CD, NEVLT_CNB, ACMP_EVL_SC, MNSD_EVL_SC, PSN_ASC, FRST_USER_ID, LAST_USER_ID, LAST_PRCS_DEPT_CD, LAST_MENU_ID, FRST_REG_DT, LAST_MDFCN_DT) SELECT D1.EVL_YR /* 평가년도 */,
    D1.HLYR_DVSN_CD /* 반기구분 */,
    D1.EVL_GP_CD /* 평가군 */,
    D1.NEVLT_CNB /* 피평가자 전산번호 */,
    NVL(SUM(D2.PSN_TSK_ASC), 0) AS PSN_TSK_ASC /* 실적평가 */,
    NVL(D3.MNSD_EVL_SC, 0) AS MNSD_EVL_SC /* 다면평가 */,
    NVL((SUM(D2.PSN_TSK_ASC) * (SELECT D4.ACMP_EVL_ASC_RT
FROM TBCSPAOE037M D4 WHERE D4.EVL_YR = #strEvlYr# AND D4.HLYR_DVSN_CD = #strHlyrDvsnCd#) + D3.MNSD_EVL_SC * (SELECT D4.MNSD_EVL_ASC_RT
FROM TBCSPAOE037M D4 WHERE D4.EVL_YR = #strEvlYr# AND D4.HLYR_DVSN_CD = #strHlyrDvsnCd#)),0) AS PSN_ASC /*개인평점*/ , D1.LAST_USER_ID , D1.LAST_USER_ID , D1.LAST_PRCS_DEPT_CD , 'CSPAOE0074E' AS LAST_MENU_ID , SYSDATE AS FRST_REG_DT , SYSDATE AS LAST_MDFCN_DT FROM TBCSPAOE020D D1 LEFT JOIN TBCSPAOE035M D2 ON D1.EVL_YR = D2.EVL_YR AND D1.HLYR_DVSN_CD = D2.HLYR_DVSN_CD AND D1.NEVLT_CNB = D2.NEVLT_CNB LEFT JOIN TBCSPAOE038M D3 ON D2.EVL_YR = D3.EVL_YR AND D2.HLYR_DVSN_CD = D3.HLYR_DVSN_CD AND D2.NEVLT_CNB = D3.NEVLT_CNB WHERE 1=1 AND D1.EVL_YR = #strEvlYr# AND D1.HLYR_DVSN_CD = #strHlyrDvsnCd# AND D1.EVL_GP_CD = #strEvlGpCd# GROUP BY D1.EVL_YR, D1.HLYR_DVSN_CD, D1.EVL_GP_CD, D1.NEVLT_CNB, D3.MNSD_EVL_SC, D3.PSN_ASC, D1.LAST_USER_ID, D1.LAST_USER_ID, D1.LAST_PRCS_DEPT_CD