SELECT ROWNUM,
    T1.*
FROM ( SELECT DECODE(A.NTFCTN_RCPT_SQNO,NULL,'',A.ACP_YE||'-'||A.NTFCTN_RCPT_SQNO) AS NTFCTN_RCPT_SQNO /* 통보접수순번 */,
    A.RSCH_ASMT_TTL /* 연구과제제목 */,
    A.SBMSN_YMD /* 제출일자 */,
    A.PRGRS_STTS_SECD /* 진행상태구분코드 */,
    F_CODE_NM('1000992',A.PRGRS_STTS_SECD) AS F_CODE_NM /* 제안상태코드 */,
    A.TK_YE /* 제안연도 */,
    A.TK_SLN /* 제안연번 */,
    A.ACP_YE,
    A.NTFCTN_RCPT_SQNO /* 통보접수순번 */,
    A.EXAM_APV_DOC_NO /* 검토결재문서번호 */,
    A.EXAM_RSLT_CD,
    A.MDT_APV_DOC_NO,
    A.MDT_RSLT_CD,
    A.ENAIS_PST_INQ_NMTM /* ENAIS게시물조회횟수 */,
    (SELECT COUNT(*)
FROM TBCSPLTT003M B WHERE B.TK_YE = A.TK_YE AND B.TK_SLN = A.TK_SLN AND B.RCMD_YN = 'Y') AS RCMD_CNT /*추천수*/ ,(SELECT COUNT(*)
FROM TBCSPLTT003M B WHERE B.TK_YE = A.TK_YE AND B.TK_SLN = A.TK_SLN AND B.RCMD_YN = 'N') AS DCMD_CNT /*비추천수*/ ,(SELECT COUNT(*)
FROM TBCSPLTT004M B WHERE B.TK_YE = A.TK_YE AND B.TK_SLN = A.TK_SLN) AS CMMT_CNT /*댓글수*/ , CASE WHEN TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')) 0 THEN 'Y' ELSE 'N' END AS CMT_NEW_YN , CASE WHEN NVL(A.MDT_YN,'N') = 'Y' AND A.PRGRS_STTS_SECD IN ('M', 'N') AND TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')) 'Y' AND A.PRGRS_STTS_SECD IN ('M', 'N') AND TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')) AND A.PRGRS_STTS_SECD &gt;= 'G' AND A.PRGRS_STTS_SECD = #PRGRS_STTS_SECD# AND A.SBMSN_YMD &gt;= #strSMT_DTS# AND A.SBMSN_YMD &lt;= #strSMT_DTE# AND A.RSCH_ASMT_TTL LIKE '%'||#strTIT_NM#||'%' ORDER BY TO_NUMBER(A.ACP_YE) ASC , TO_NUMBER(A.NTFCTN_RCPT_SQNO) ASC) T1 ORDER BY TO_NUMBER(NO) DESC;