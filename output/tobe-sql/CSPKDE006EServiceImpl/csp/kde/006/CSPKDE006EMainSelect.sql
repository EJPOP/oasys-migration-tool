SELECT D1.JUD_YR || '-판정-' || D1.JUD_NO AS JUD_YR,
    D1.JUD_YR AS JUD_YR /* 판정년도 */,
    D1.JUD_NO AS JUD_NO /* 판정번호 */,
    D1.ETC_LBSVC_MNG_DEPT_CD AS ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    F_DPT_INFO(D1.ETC_LBSVC_MNG_DEPT_CD, '1') AS PRCS_DEPT_NM /* 처리부서명 */,
    D1.REG_NO AS REG_NO /* 등록번호 */,
    D1.MTG_RUD AS MTG_RUD /* 회의회차 */,
    D1.CMT_VT_DT AS CMT_VT_DT /* 위원회의결일자 */,
    D1.MTG_RUD || '(' || TO_CHAR(TO_DATE(D1.CMT_VT_DT),'YYYY-MM-DD') || ')' AS MTG_RUD /* 회의회차 */,
    D1.CMO_INST_CD AS CMO_INST_CD /* 소관청기관코드 */,
    F_ORG_INFO(D1.CMO_INST_CD, '1') AS F_ORG_INFO /* 소관청명 */,
    D1.SRECS_REL_INST_CD AS SRECS_REL_INST_CD /* 심사재심의관계기관코드 */,
    F_ORG_INFO(D1.SRECS_REL_INST_CD, '1') AS REL_INST_NM /* 관계기관명 */,
    D1.JUD_DVSN_CD AS JUD_DVSN_CD /* 판정구분코드 */,
    F_CODE_NM('1000743', D1.JUD_DVSN_CD) AS F_CODE_NM /* 판정구분명 */,
    D1.CVLCPT_ADT_YR AS CVLCPT_ADT_YR /* 민원감사년도 */,
    D1.ADT_NO AS ADT_NO /* 감사번호 */,
    D1.DSPS_RQT_SQNO AS DSPS_RQT_SQNO /* 처분요구순번 */,
    CASE WHEN D1.CVLCPT_ADT_YR IS NOT NULL THEN F_MNG_KND_AUDYRNO(D1.CVLCPT_ADT_YR, D1.ADT_NO, D3.ADT_KDCD, '-') ||'-'|| D1.DSPS_RQT_SQNO ELSE '' END AS CVLCPT_ADT_YR /* 민원감사년도 */,
    CASE WHEN D1.CVLCPT_TASK_SECD = '1' /* 실시구분 */ THEN F_MNG_KND_AUDYRNO(D2.ADT_YR, D2.ADT_NO, D2.ADT_KDCD, '-') WHEN D1.CVLCPT_TASK_SECD = '2' /* 손망실 */ THEN (SELECT LINK_YR || '-손망-' || AS NTFCTN_RCPT_SQNO /* 통보접수순번 */
FROM TB_BADGDA001M WHERE LINK_YR = D1.DSPS_RQT_NM_1 AND NTFCTN_RCPT_SQNO = D1.DSPS_RQT_NM_2) WHEN D1.CVLCPT_TASK_SECD = '3' /* 판정청구 */ THEN (SELECT LINK_YR || '-판청-' || AS NTFCTN_RCPT_SQNO /* 통보접수순번 */
FROM TB_BADGDA001M WHERE LINK_YR = D1.DSPS_RQT_NM_1 AND NTFCTN_RCPT_SQNO = D1.DSPS_RQT_NM_2) END AS YR_NO ,D1.CVLCPT_TASK_SECD AS CVLCPT_TASK_SECD /*업무구분코드*/ ,D1.DSPS_RQT_NM_1 AS DSPS_RQT_NM_1 /*업무키1*/ ,D1.DSPS_RQT_NM_2 AS DSPS_RQT_NM_2 /*업무키2*/ ,D1.DSPS_RQT_NM_3 AS DSPS_RQT_NM_3 /*업무키3*/ ,D1.DSPS_RQT_NM_4 AS DSPS_RQT_NM_4 /*업무키4*/ ,(SELECT CASE WHEN COUNT(*) = 1 THEN MAX(SLCT_OGDP_NM || ' ' || INFO_RLPR_NM) WHEN COUNT(*) > 1 THEN MAX(SLCT_OGDP_NM || ' ' || INFO_RLPR_NM) || '외 ' || ( COUNT(*) - 1 ) || '명' ELSE '' AS 1
FROM TBCSPKDE004L WHERE 1=1 AND JUD_YR = D1.JUD_YR AND JUD_NO = D1.JUD_NO) AS NAMS /*판정대상자*/ FROM TBCSPKDE004M D1 /* 변상판정관리기본 */ ,TB_BADDED001M D2 /* 감사사항기본 */ ,TB_BADDED001M D3 /* 감사사항기본 */ WHERE 1=1 AND D1.DSPS_RQT_NM_1 = D2.ADT_YR(+) AND D1.DSPS_RQT_NM_2 = D2.ADT_NO(+) AND D1.CVLCPT_ADT_YR = D3.ADT_YR(+) AND D1.ADT_NO = D3.ADT_NO(+) /* 판정일자 */ AND D1.CMT_VT_DT BETWEEN NVL(#strCmtVtDtSt#,'19000101') AND NVL(#strCmtVtDtEnd#,'99991231') /* 처리국 */ AND D1.ETC_LBSVC_MNG_DEPT_CD IN (SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TABLE(F_AUTH_DEPT(#strCnb#, #strDptAuth#, '', #strDptCd#))) /* 처리과 */ AND D1.ETC_LBSVC_MNG_DEPT_CD = #ETC_LBSVC_MNG_DEPT_CD# /* 소관청 */ AND D1.CMO_INST_CD = #CMO_INST_CD# /* 관게기관 */ AND D1.SRECS_REL_INST_CD = #SRECS_REL_INST_CD# /* 대상자명 */ AND (D1.JUD_YR, D1.JUD_NO) IN (SELECT JUD_YR,
    JUD_NO
FROM TBCSPKDE004L WHERE INFO_RLPR_NM LIKE '%' || #strNam# || '%') /* 판정구분 */ AND D1.JUD_DVSN_CD = #strJudDvsnCd# /* 판정년도 */ AND D1.JUD_YR = #strJudYr# /* 판정번호 */ AND D1.JUD_NO = #strJudNo# ORDER BY D1.JUD_YR DESC ,TO_NUMBER(D1.JUD_NO) DESC