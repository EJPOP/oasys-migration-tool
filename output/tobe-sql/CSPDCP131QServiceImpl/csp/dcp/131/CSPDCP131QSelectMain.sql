SELECT /*CSPDCP131QSelectMain*/ D1.CVLCPT_RCPT_YR AS CVLCPT_RCPT_YR /* 민원접수년도 */,
    D1.CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    D1.CLM_SECD /* 청구구분코드 */,
    D1.CVLCPT_RCPT_YR||'-민원-'||D1.TPOF_ACTL_RCPT_NO AS CVLCPT_RCPT_YR /* 민원접수년도 */,
    F_CODE_NM('1000047', D1.CRU_KDCD) AS F_CODE_NM,
    D1.RSCH_ASMT_TTL /* 연구과제제목 */,
    DECODE(D1.SLCT_CLMT_KDCD,'1',D1.TPOF_CVLPR_NM,'2',D1.SLCT_CVLPR_RPRSV_NM,'3',D1.SLCT_CVLPR_RPRSV_NM,'4',D1.TPOF_CVLPR_NM) AS TPOF_CVLPR_NM /* 제보민원인명 */,
    F_CODE_NM('1000754', D2.TPOF_PRCS_SECD) AS F_CODE_NM,
    D3.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    D1.SLCT_ADT_TRNSF_SECD /* 청탁감사이관구분코드 */,
    (CASE WHEN D1.SLCT_ADT_TRNSF_SECD = 'T' THEN 'Y' ELSE 'N' END) AS SLCT_ADT_TRNSF_SECD /* 청탁감사이관구분코드 */,
    D5.INFO_YR /* 정보년도 */,
    D5.INFO_SQNO /* 정보순번 */,
    ( CASE WHEN D5.INFO_SQNO IS NOT NULL THEN D5.INFO_YR || '-' || D5.INFO_SQNO ELSE NULL END ) AS INFO_SQNO /* 정보순번 */,
    D6.DSP_RQ_KND_CD_NM,
    D6.SPV_BRDV_DPT_NM,
    F_CODE_NM('1000085', D5.ADT_INFO_PRGRS_STTS_SECD) AS F_CODE_NM
FROM TB_CSPDCP101M D1 ,TB_CSPDCP205L D2 ,(SELECT S1.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    S1.TPOF_RCPT_YR /* 제보접수년도 */,
    S1.TPOF_RCPT_NO /* 제보접수번호 */,
    AGGR_CONCAT( DECODE(S1.TPOF_OCRN_INST_CD,'10',S2.PROF_RBPRSN_INST_NM,'20',S1.TPOF_INST_NM), ',') AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */
FROM TBCSPDCP206L S1 ,TBDCMACM015M S2 WHERE S1.INST_CD = S2.INST_CD(+) AND S1.CLM_SECD = '1' AND S1.CVLCPT_INST_DSCTN_SECD = '1' GROUP BY S1.CLM_SECD, S1.CVLCPT_RCPT_YR, S1.CVLCPT_RCPT_RCPT ) D3 ,TB_CSPDCP102M D4 , TB_CSPBII100M D5 , ( SELECT D21.INFO_YR /* 정보년도 */,
    D21.INFO_SQNO /* 정보순번 */,
    D24.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    AGGR_CONCAT(( SELECT AS AGGR_CONCAT
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000002' AND CD = D22.DSPS_RQT_KDCD ), ' , ') AS DSP_RQ_KND_CD_NM FROM TBCSPBII120L D21 , TBBADEAR001M D22 , TBBADDED001M D23 , TBDCMACM002M D24 WHERE D21.CVLCPT_ADT_YR = D22.CVLCPT_ADT_YR AND D21.ADT_NO = D22.ADT_NO AND D21.DSPS_RQT_SQNO = D22.DSPS_RQT_SQNO AND D21.CVLCPT_ADT_YR = D23.CVLCPT_ADT_YR AND D21.ADT_NO = D23.ADT_NO AND D23.SPRVSN_DEPT_CD = D24.SRECS_DEPT_CD GROUP BY D21.INFO_YR, D21.FRS_MDM_SQNO, D24.CNSTN_MBCMT_DEPT_NM ) AS D6 WHERE 1=1 AND D1.CLM_SECD = D2.CVLCPT_CLM_SECD AND D1.CVLCPT_RCPT_YR = D2.TPOF_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = D2.TPOF_RCPT_NO AND D1.CLM_SECD = D3.CLM_SECD AND D1.CVLCPT_RCPT_YR = D3.CVLCPT_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = D3.CVLCPT_RCPT_RCPT AND D1.CLM_SECD = D4.CLM_SECD AND D1.CVLCPT_RCPT_YR = D4.CVLCPT_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = D4.CVLCPT_RCPT_RCPT AND D1.CLM_SECD = D5.CLM_SECD(+) AND D1.CVLCPT_RCPT_YR = D5.INFO_RCPT_YR(+) AND D1.CVLCPT_RCPT_RCPT = D5.CVLCPT_NO(+) AND D5.INFO_YR = D6.INFO_YR(+) AND D5.INFO_SQNO = D6.FRS_MDM_SQNO(+) AND D1.CLM_SECD = 1 AND D1.CRU_PRCS_PRCS_STTS = '60' AND (D2.CVLCPT_CLM_SECD, D2.TPOF_RCPT_NO, D2.TPOF_RCPT_YR, D2.TPOF_SQNO ) IN ( SELECT Z.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    Z.TPOF_RCPT_NO /* 제보접수번호 */,
    Z.TPOF_RCPT_YR /* 제보접수년도 */,
    MIN(Z.TPOF_SQNO) AS TPOF_SQNO /* 제보순번 */
FROM TB_CSPDCP205L Z WHERE D1.CLM_SECD = Z.CVLCPT_CLM_SECD AND D1.CVLCPT_RCPT_RCPT = Z.TPOF_RCPT_NO AND D1.CVLCPT_RCPT_YR = Z.TPOF_RCPT_YR GROUP BY Z.CVLCPT_CLM_SECD, Z.TPOF_RCPT_NO, Z.TPOF_RCPT_YR ) AND D1.RSCH_ASMT_TTL LIKE '%'||#TIT_NM#||'%' AND D4.TPOF_CN LIKE '%'||#TIT_NM#||'%' AND D1.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND D1.TPOF_ACTL_RCPT_NO = #TPOF_ACTL_RCPT_NO# AND TO_CHAR(D1.CRU_RCPT_DT, 'YYYYMMDD') BETWEEN #ACP_DH_START# AND #ACP_DH_END# AND D1.CRU_KDCD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strCVPT_KND_CD# ||',' AS #STRCVPT_KND_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND D2.TPOF_PRCS_SECD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strCVPT_HNDL_DVSN_CD# ||',' AS #STRCVPT_HNDL_DVSN_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND (D1.TPOF_CVLPR_NM LIKE '%'||#CVPTR_NM#||'%' OR D1.SLCT_CVLPR_RPRSV_NM LIKE '%'||#CVPTR_NM#||'%') AND D1.SLCT_ADT_TRNSF_SECD = 'T' AND (D1.SLCT_ADT_TRNSF_SECD != 'T' OR D1.SLCT_ADT_TRNSF_SECD IS NULL ) ORDER BY D1.CVLCPT_RCPT_YR DESC ,D1.TPOF_ACTL_RCPT_NO DESC