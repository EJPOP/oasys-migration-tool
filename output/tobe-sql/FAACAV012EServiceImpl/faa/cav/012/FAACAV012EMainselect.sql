/* faa/cav/012/FAACAV012EMainselect */ /*증명책임자수(월)*/ WITH M AS ( SELECT SUM(CASE WHEN #PROF_YR#||'01' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'01' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '01' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'02' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'02' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '02' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'03' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'03' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '03' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'04' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'04' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '04' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'05' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'05' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '05' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'06' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'06' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '06' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'07' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'07' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '07' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'08' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'08' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '08' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'09' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'09' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '09' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'10' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'10' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '10' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'11' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'11' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '11' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'12' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'12' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '12' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'13' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND (#PROF_YR#||'13' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') OR PROF_RBPRSN_ABL_YMD IN #PROF_YR#||'12') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '13' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' ), /*접수*/ R AS( SELECT SUM(CASE WHEN NVL(MN1_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN1_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN1_STTS_SECD /* 1월상태구분코드 */,
    '01' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN2_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN2_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN2_STTS_SECD /* 2월상태구분코드 */,
    '02' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN3_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN3_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN3_STTS_SECD /* 3월상태구분코드 */,
    '03' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN4_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN4_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN4_STTS_SECD /* 4월상태구분코드 */,
    '04' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN5_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN5_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN5_STTS_SECD /* 5월상태구분코드 */,
    '05' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN6_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN6_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN6_STTS_SECD /* 6월상태구분코드 */,
    '06' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN7_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN7_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN7_STTS_SECD /* 7월상태구분코드 */,
    '07' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN8_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN8_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN8_STTS_SECD /* 8월상태구분코드 */,
    '08' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN9_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN9_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN9_STTS_SECD /* 9월상태구분코드 */,
    '09' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN10_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN10_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN10_STTS_SECD /* 10월상태구분코드 */,
    '10' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN11_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN11_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN11_STTS_SECD /* 11월상태구분코드 */,
    '11' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN12_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN12_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN12_STTS_SECD /* 12월상태구분코드 */,
    '12' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN13_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN13_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN13_STTS_SECD /* 13월상태구분코드 */,
    '13' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# ) SELECT ROWNUM,
    M.MM AS MM,
    TO_CHAR(NVL(M.MCNT,0),'999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(R.RCNT,0),'999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(MCNT-RCNT,0),'999,999,999') AS TO_CHAR,
    NVL(ROUND((R.RCNT / M.MCNT * 100),2),0) AS ROUND,
    M.MCNT
FROM M,R WHERE M.MM = R.MM /*증명책임자수(분기)*/ WITH M AS ( SELECT SUM(CASE WHEN #PROF_YR#||'03' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'01' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '01' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'06' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'04' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '02' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'09' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'07' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '03' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' UNION ALL SELECT SUM(CASE WHEN #PROF_YR#||'12' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'10' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '04' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND MDFCN_SECD NOT IN 'D' ), /*접수*/ R AS( SELECT SUM(CASE WHEN NVL(MN1_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN1_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN1_STTS_SECD /* 1월상태구분코드 */,
    '01' AS MM
FROM TWFAACAV007M WHERE 1 = 1 AND PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN2_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN2_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN2_STTS_SECD /* 2월상태구분코드 */,
    '02' AS MM
FROM TWFAACAV007M WHERE 1 = 1 AND PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN3_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN3_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN3_STTS_SECD /* 3월상태구분코드 */,
    '03' AS MM
FROM TWFAACAV007M WHERE 1 = 1 AND PROF_YR=#PROF_YR# UNION ALL SELECT SUM(CASE WHEN NVL(MN4_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN4_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN4_STTS_SECD /* 4월상태구분코드 */,
    '04' AS MM
FROM TWFAACAV007M WHERE 1 = 1 AND PROF_YR=#PROF_YR# ) SELECT ROWNUM,
    M.MM AS MM,
    TO_CHAR(NVL(M.MCNT,0),'999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(R.RCNT,0),'999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(MCNT-RCNT,0),'999,999,999') AS TO_CHAR,
    NVL(ROUND((R.RCNT / M.MCNT * 100),2),0) AS ROUND,
    M.MCNT
FROM M,R WHERE M.MM = R.MM /*증명책임자수(년)*/ WITH M AS ( SELECT SUM(CASE WHEN #PROF_YR#||'12' &gt;= NVL(PROF_RBPRSN_CRT_YMD,'000000') AND #PROF_YR#||'01' &lt;= NVL(PROF_RBPRSN_ABL_YMD,'999999') THEN 1 ELSE 0 END) AS #PROF_YR#,
    '00' AS MM
FROM TWFAACAV003M WHERE 1 = 1 AND BLL_KDCD IN ('17','18') AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND BLL_KDCD IN ('17','18') AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' AND BLL_KDCD = '19' AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND BLL_KDCD = '19' AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' AND BLL_KDCD IN ('22','23','24') AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND BLL_KDCD IN ('22','23','24') AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' AND BLL_KDCD = '41' AND BLL_KDCD IN ('42','43') AND BLL_KDCD = '28' AND MDFCN_SECD NOT IN 'D' AND BLL_KDCD = '30' AND MDFCN_SECD NOT IN 'D' AND BLL_KDCD = '32' AND MDFCN_SECD NOT IN 'D' AND BLL_KDCD = '35' AND MDFCN_SECD NOT IN 'D' AND BLL_KDCD = #BLL_KDCD# ), /*접수*/ R AS( SELECT SUM(CASE WHEN NVL(MN1_STTS_SECD,'') &lt;&gt; '*' OR NVL(MN1_STTS_SECD,'') &lt;&gt; '' THEN 1 ELSE 0 END) AS MN1_STTS_SECD /* 1월상태구분코드 */,
    '00' AS MM
FROM TWFAACAV007M WHERE PROF_YR=#PROF_YR# AND BLL_KDCD IN ('17','18') AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND BLL_KDCD IN ('17','18') AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' AND BLL_KDCD = '19' AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND BLL_KDCD = '19' AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' AND BLL_KDCD IN ('22','23','24') AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND BLL_KDCD IN ('22','23','24') AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' AND BLL_KDCD = '41' AND BLL_KDCD IN ('42','43') AND BLL_KDCD = '28' AND EXISTS (SELECT 1
FROM TWFAACAV003M A WHERE JRSD_CD = A.JRSD_CD AND ACNTG_CD = A.ACNTG_CD AND BLL_KDCD = A.BLL_KDCD AND PROF_RBPRSN_SQNO = A.PROF_RBPRSN_SQNO AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND A.MDFCN_SECD NOT IN 'D') AND BLL_KDCD = '30' AND EXISTS (SELECT 1
FROM TWFAACAV003M A WHERE JRSD_CD = A.JRSD_CD AND ACNTG_CD = A.ACNTG_CD AND BLL_KDCD = A.BLL_KDCD AND PROF_RBPRSN_SQNO = A.PROF_RBPRSN_SQNO AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND A.MDFCN_SECD NOT IN 'D') AND BLL_KDCD = '32' AND EXISTS (SELECT 1
FROM TWFAACAV003M A WHERE JRSD_CD = A.JRSD_CD AND ACNTG_CD = A.ACNTG_CD AND BLL_KDCD = A.BLL_KDCD AND PROF_RBPRSN_SQNO = A.PROF_RBPRSN_SQNO AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND A.MDFCN_SECD NOT IN 'D') AND BLL_KDCD = '35' AND EXISTS (SELECT 1
FROM TWFAACAV003M A WHERE JRSD_CD = A.JRSD_CD AND ACNTG_CD = A.ACNTG_CD AND BLL_KDCD = A.BLL_KDCD AND PROF_RBPRSN_SQNO = A.PROF_RBPRSN_SQNO AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND A.MDFCN_SECD NOT IN 'D') AND BLL_KDCD = #BLL_KDCD# ) SELECT ROWNUM,
    M.MM AS MM,
    TO_CHAR(NVL(M.MCNT,0),'999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(R.RCNT,0),'999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(MCNT-RCNT,0),'999,999,999') AS TO_CHAR,
    NVL(ROUND((R.RCNT / M.MCNT * 100),2),0) AS ROUND,
    NVL(M.MCNT,0) AS MCNT
FROM M,R WHERE M.MM = R.MM ORDER BY KEY, MM