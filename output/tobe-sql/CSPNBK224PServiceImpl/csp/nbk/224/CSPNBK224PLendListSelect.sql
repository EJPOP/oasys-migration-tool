SELECT /* CSPNBK224PLendListSelect */ D1.LEND_KND_CD,
    D1.MOUI_NO,
    D1.LEND_SLN,
    D1.LEND_DT,
    D1.EXPR_DT,
    D1.LEND_AM,
    D1.LEND_BL,
    D2.FNL_RPM_DT AS FNL_RPM_DT,
    ( CASE WHEN D1.EXPR_DT TO_CHAR(SYSDATE, 'YYYYMM') || '25' THEN CASE WHEN D1.LEND_DT 999 THEN CASE WHEN FLOOR( D1.LEND_AM / ((SELECT D1.SET_TXT
FROM TBCSPNBK003M D1 WHERE D1.OP_MTRL_MNG_CD = '6')*12) ) - TRUNC( FLOOR( D1.LEND_AM / ((SELECT D1.SET_TXT
FROM TBCSPNBK003M D1 WHERE D1.OP_MTRL_MNG_CD = '6')*12) ), -3 ) > 0 THEN TRUNC( FLOOR( D1.LEND_AM / ((SELECT D1.SET_TXT
FROM TBCSPNBK003M D1 WHERE D1.OP_MTRL_MNG_CD = '6')*12) ), -3 ) + 1000 ELSE TRUNC( FLOOR( D1.LEND_AM / ((SELECT D1.SET_TXT
FROM TBCSPNBK003M D1 WHERE D1.OP_MTRL_MNG_CD = '6')*12) ), -3 ) END ELSE 1000 END ELSE CASE WHEN FLOOR( D1.LEND_AM / ((SELECT D1.SET_TXT
FROM TBCSPNBK003M D1 WHERE D1.OP_MTRL_MNG_CD = '7')*12) ) > 999 THEN CASE WHEN FLOOR( D1.LEND_AM / ((SELECT D1.SET_TXT
FROM TBCSPNBK003M D1 WHERE D1.OP_MTRL_MNG_CD = '7')*12) ) - TRUNC( FLOOR( D1.LEND_AM / ((SELECT D1.SET_TXT
FROM TBCSPNBK003M D1 WHERE D1.OP_MTRL_MNG_CD = '7')*12) ), -3 ) > 0 THEN TRUNC( FLOOR( D1.LEND_AM / ((SELECT D1.SET_TXT
FROM TBCSPNBK003M D1 WHERE D1.OP_MTRL_MNG_CD = '7')*12) ), -3 ) + 1000 ELSE TRUNC( FLOOR( D1.LEND_AM / ((SELECT D1.SET_TXT
FROM TBCSPNBK003M D1 WHERE D1.OP_MTRL_MNG_CD = '7')*12) ), -3 ) END ELSE 1000 END END END ) AS MIN_EMN_RPM_PRN , ( CASE WHEN EXPR_DT = D4.DELAY_LEND_BL THEN D4.DELAY_LEND_BL ELSE CASE WHEN D4.DELAY_LEND_BL = 400000 THEN CASE WHEN D2.ARR_RPM_PRN_SUM_AM >= 400000 THEN D2.ARR_RPM_PRN_SUM_AM ELSE 400000 END ELSE D4.DELAY_LEND_BL END ELSE CASE WHEN D4.DELAY_LEND_BL = 500000 THEN D2.ARR_RPM_PRN_SUM_AM ELSE 500000 END ELSE CASE WHEN D2.ARR_RPM_PRN_SUM_AM >= 670000 THEN D2.ARR_RPM_PRN_SUM_AM ELSE 670000 END END END END ELSE NULL END ) AS CH_ARR_RPM_PRN_SUM_AM , D1.GRT_YN , D1.GRT_MOUI_NO , D6.USER_NM AS GRT_MOUI_NM , D1.GRT_AM , D1.GRT_BL , D1.EST_EXPR_DT FROM TBCSPNBK203D D1 , TBCSPNBK202M D2 , ( SELECT D3.LEND_KND_CD , D3.MOUI_NO , SUM(D3.LEND_AM) AS LEND_AM , SUM(D3.LEND_BL) AS LEND_BL , SUM( CASE WHEN D3.LEND_BL > 0 AND D3.EXPR_DT 0 GROUP BY D3.LEND_KND_CD, D3.MOUI_NO ) D4 , TBCSPNBK001M D5 , TBDCMACM001M D6 WHERE D1.LEND_KND_CD = D2.LEND_KND_CD AND D1.MOUI_NO = D2.MOUI_NO AND D1.LEND_KND_CD = D4.LEND_KND_CD AND D1.MOUI_NO = D4.MOUI_NO AND D1.GRT_MOUI_NO = D5.MOUI_NO(+) AND D5.TRGT_NOP_ENO = D6.TRGT_NOP_ENO(+) AND D1.LEND_KND_CD = #lendKndCd# AND D1.MOUI_NO = #mouiNo# AND D1.CNL_YN = 'N' D1.LEND_BL > 0 D1.LEND_DT D1.LEND_DT >= '20080201' ORDER BY ARR_YN DESC, D1.LEND_DT