INSERT INTO TBCSPLFI104L (PMT_YM, ALW_DVSN_CD, TRGT_NOP_ENO, SRECS_DEPT_CD, ALW_OCP_CD, ALW_RANK_CD, ALW_PST_CD, PMT_AM, PMT_DT, FRST_USER_ID, LAST_USER_ID, LAST_PRCS_DEPT_CD, LAST_MENU_ID, FRST_REG_DT, LAST_MDFCN_DT, ALW_PS_CD /*호봉코드 추가 - 2019.12.03 les*/) ( SELECT substring(#yyyymm#,1,6) AS SUBSTRING,
    A.ALW_DVSN_CD,
    A.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    B.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    B.OCPT_SECD /* 직종구분코드 */,
    /*직종코드 추가 - 2019.12.03 les*/ B.JBGD_SECD AS JBGD_SECD /* 직급구분코드 */,
    NVL(JBPS_CD, '') AS JBPS_CD /* 직위코드 */,
    A.ALW_AM,
    TO_CHAR(SYSDATE, 'YYYYMMDD') AS TO_CHAR,
    #FRT_USR_ID# AS FRST_USER_ID /* 최초사용자아이디 */,
    #FNL_USR_ID# AS LAST_USER_ID /* 최종사용자아이디 */,
    #FNL_DEAL_DPT_CD# AS LAST_PRCS_DEPT_CD /* 최종처리부서코드 */,
    #FNL_MNU_ID# AS LAST_MENU_ID /* 최종메뉴아이디 */,
    SYSDATE,
    SYSDATE,
    B.PS_CD /* 호봉코드 추가 - 2019.12.03 les */
FROM TBCSPLFI102M A, TBDCMACM001M B WHERE A.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND A.ALW_AM <> 0 AND B.SRECS_DEPT_CD <> '880880' AND (B.RTRM_YMD IS NULL OR B.RTRM_YMD = '') AND A.ALW_DVSN_CD IN ( SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #cd# ||',' AS #CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) )