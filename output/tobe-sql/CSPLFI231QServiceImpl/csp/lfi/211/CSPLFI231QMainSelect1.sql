/* 수당변동자만 조회 (지급년월 없음) */ SELECT A.ALW_DVSN_CD,
    D.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    D.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    A.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    C.USER_NM /* 사용자명 */,
    C.JBGD_SECD /* 직급구분코드 */,
    C.PS_CD,
    F_CODE_NM('1000173', C.JBGD_SECD) || '-' ||F_CODE_NM('1000177', C.PS_CD) AS F_CODE_NM,
    C.JBPS_CD /* 직위코드 */,
    F_CODE_NM('1000176', C.JBPS_CD) AS JBPS_NM /* 직위명 */,
    NVL(A.ALW_AM, 0) AS ALW_AM,
    NVL(B.PMT_AM, 0) AS PMT_AM,
    A.FIX_YN,
    B.PMT_YM,
    B.PMT_DT
FROM TBCSPLFI102M A, TBCSPLFI104L B, TBDCMACM001M C, TBDCMACM002M D, TBDCMACM013C E WHERE 1=1 AND A.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND A.ALW_DVSN_CD = B.ALW_DVSN_CD AND A.TRGT_NOP_ENO = C.TRGT_NOP_ENO AND B.TRGT_NOP_ENO = C.TRGT_NOP_ENO AND C.SRECS_DEPT_CD = D.SRECS_DEPT_CD AND C.BAI_USR_YN = 'Y' AND D.SRECS_DEPT_CD != '880880' AND E.CMM_CD_DVSN_CD = '1000145' AND A.ALW_DVSN_CD = E.CD AND A.ALW_AM != B.PMT_AM AND B.PMT_YM = (SELECT MAX(PMT_YM)
FROM TBCSPLFI104L WHERE ALW_DVSN_CD IN ('9991','9992','9993','9994','9995')) AND A.ALW_DVSN_CD IN ( SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #cd# ||',' AS #CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND A.TRGT_NOP_ENO = #TRGT_NOP_ENO# AND C.SRECS_DEPT_CD LIKE (SELECT CASE WHEN SUBSTR(#dptCd#, 4, 3) = '000' THEN SUBSTR(#dptCd#, 0, 3) || '%' ELSE #dptCd# AS SUBSTR
FROM DUAL) AND A.FIX_YN = #fixYn#