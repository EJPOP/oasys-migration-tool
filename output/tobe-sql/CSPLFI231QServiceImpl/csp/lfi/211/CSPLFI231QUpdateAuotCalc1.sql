UPDATE TBCSPLFI102M D1 SET D1.ALW_AM = ( SELECT (CASE A.IMD_CD WHEN 'E' THEN 0 WHEN 'Y' THEN A.ACTV_DPT_AM WHEN 'N' THEN A.SPRT_DPT_AM WHEN 'S' THEN A.STD_PRN_AMT ELSE A.ETC_DPT_AM END ) AS IMD_CD
FROM ( SELECT A.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    C.IMD_CD,
    A.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    A.USER_NM /* 사용자명 */,
    B.ACTV_DPT_AM,
    B.SPRT_DPT_AM,
    B.ETC_DPT_AM,
    B.STD_PRN_AMT,
    A.RTRM_YMD /* 퇴직일자 */,
    A.HDOF_SECD /* 재직구분코드 */
FROM TBDCMACM001M A, TBCSPLFI101M B, TBDCMACM002M C WHERE A.SRECS_DEPT_CD = C.SRECS_DEPT_CD AND C.USE_YN <> 'N' AND B.ALW_DVSN_CD = #cd# AND (B.ALW_OCP_CD = '99' OR A.OCPT_SECD = B.ALW_OCP_CD) AND (ALW_RANK_CD = '99' OR A.JBGD_SORT_SEQ = B.ALW_RANK_CD) AND (ALW_PST_CD = '99' OR A.INSD_JBGD_SECD = B.ALW_PST_CD) ) A, TBCSPLFI102M B WHERE B.ALW_DVSN_CD = #cd# AND A.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND B.FIX_YN <> 'F' AND A.SRECS_DEPT_CD <> '880880' AND (A.RTRM_YMD IS NULL OR A.RTRM_YMD = '') AND A.HDOF_SECD IN ('AAA', 'AAB') AND B.TRGT_NOP_ENO = D1.TRGT_NOP_ENO AND B.ALW_DVSN_CD = D1.ALW_DVSN_CD ),  D1.LAST_USER_ID = #LAST_USER_ID# /* 최종사용자아이디 */,  D1.LAST_PRCS_DEPT_CD = #LAST_PRCS_DEPT_CD# /* 최종처리부서코드 */,  D1.LAST_MENU_ID = #LAST_MENU_ID# /* 최종메뉴아이디 */,  D1.LAST_MDFCN_DT = SYSDATE /* 최종수정일시 */WHERE ( D1.ALW_DVSN_CD , D1.TRGT_NOP_ENO ) IN ( SELECT B.ALW_DVSN_CD,
    B.TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM ( SELECT A.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    C.IMD_CD,
    A.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    A.USER_NM /* 사용자명 */,
    B.ACTV_DPT_AM,
    B.SPRT_DPT_AM,
    B.ETC_DPT_AM,
    B.STD_PRN_AMT,
    A.RTRM_YMD /* 퇴직일자 */,
    A.HDOF_SECD /* 재직구분코드 */
FROM TBDCMACM001M A, TBCSPLFI101M B, TBDCMACM002M C WHERE A.SRECS_DEPT_CD = C.SRECS_DEPT_CD AND C.USE_YN <> 'N' AND B.ALW_DVSN_CD = #cd# AND (B.ALW_OCP_CD = '99' OR A.OCPT_SECD = B.ALW_OCP_CD) AND (ALW_RANK_CD = '99' OR A.JBGD_SORT_SEQ = B.ALW_RANK_CD) AND (ALW_PST_CD = '99' OR A.INSD_JBGD_SECD = B.ALW_PST_CD) ) A, TBCSPLFI102M B WHERE B.ALW_DVSN_CD = #cd# AND A.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND B.FIX_YN <> 'F' AND A.SRECS_DEPT_CD <> '880880' AND (A.RTRM_YMD IS NULL OR A.RTRM_YMD = '') AND A.HDOF_SECD IN ('AAA', 'AAB') )