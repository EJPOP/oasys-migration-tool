UPDATE TBCSPLFI102M SET FIX_YN = #fix# WHERE 1=1 AND ALW_DVSN_CD IN ( SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #cd# ||',' AS #CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND FIX_YN = #fixYn# AND TRGT_NOP_ENO IN (SELECT TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBDCMACM001M WHERE SRECS_DEPT_CD LIKE(SELECT CASE WHEN SUBSTR(#dptCd#, 4, 3) = '000' THEN SUBSTR(#dptCd#, 0, 3) || '%' ELSE #dptCd# AS SUBSTR
FROM DUAL) AND TRGT_NOP_ENO NOT LIKE '8%' AND TRGT_NOP_ENO NOT LIKE '9%') AND TRGT_NOP_ENO = #TRGT_NOP_ENO#