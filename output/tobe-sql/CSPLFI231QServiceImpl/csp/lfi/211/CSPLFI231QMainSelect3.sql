SELECT TMP.*,
    TMP.ALW_RANK_CD AS JBGD_SECD,
    DECODE(TMP.ALW_PS_CD, NULL, ( SELECT AS ALW_PS_CD
FROM TBDCMACM037H WHERE TRGT_NOP_ENO = TMP.TRGT_NOP_ENO AND LAST_MDFCN_DT = TMP.LAST_MDFCN_DT ), TMP.ALW_PS_CD ) AS PS_CD , F_CODE_NM('1000173', TMP.ALW_RANK_CD) || '-' || F_CODE_NM('1000177', DECODE(TMP.ALW_PS_CD, NULL, ( SELECT PS_CD
FROM TBDCMACM037H WHERE TRGT_NOP_ENO = TMP.TRGT_NOP_ENO AND LAST_MDFCN_DT = TMP.LAST_MDFCN_DT ), TMP.ALW_PS_CD ) ) AS RANK_PS_NM FROM ( SELECT A.ALW_DVSN_CD,
    A.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    C.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    A.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    B.USER_NM /* 사용자명 */,
    A.ALW_RANK_CD,
    ( SELECT MAX(LAST_MDFCN_DT) AS LAST_MDFCN_DT /* 최종수정일시 */
FROM TBDCMACM037H WHERE LINK_NO > 0 AND TRGT_NOP_ENO = A.TRGT_NOP_ENO AND A.PMT_DT >= TO_CHAR(LAST_MDFCN_DT, 'YYYYMMDD') ) AS LAST_MDFCN_DT , A.ALW_PST_CD AS JBPS_CD , F_CODE_NM('1000176', A.ALW_PST_CD) AS JBPS_NM , NVL(A.PMT_AM, 0) AS ALW_AM , '' AS FIX_YN , A.PMT_YM , A.PMT_DT , D.USR_DFN_TXT_2 , A.ALW_PS_CD FROM TBCSPLFI104L A, TBDCMACM001M B, TBDCMACM002M C, TBDCMACM013C D WHERE 1 = 1 AND A.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND A.SRECS_DEPT_CD = C.SRECS_DEPT_CD AND B.BAI_USR_YN = 'Y' AND D.CMM_CD_DVSN_CD = '1000145' AND A.ALW_DVSN_CD = D.CD AND A.PMT_YM = substring(#yyyymm#, 1, 6) ) TMP WHERE 1 = 1 AND TMP.ALW_DVSN_CD IN ( SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #cd# ||',' AS #CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND TMP.TRGT_NOP_ENO = #TRGT_NOP_ENO# AND TMP.SRECS_DEPT_CD LIKE (SELECT CASE WHEN SUBSTR(#dptCd#, 4, 3) = '000' THEN SUBSTR(#dptCd#, 0, 3) || '%' ELSE #dptCd# AS SUBSTR
FROM DUAL) ORDER BY TMP.TRGT_NOP_ENO, TMP.USR_DFN_TXT_2