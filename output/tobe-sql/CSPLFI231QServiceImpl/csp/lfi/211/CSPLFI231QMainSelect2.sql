/* 수당테이블 조회 */ SELECT D1.ALW_DVSN_CD,
    D3.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    D3.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    D1.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    D2.USER_NM /* 사용자명 */,
    D2.JBGD_SECD /* 직급구분코드 */,
    D5.CD_NM || '-' || D6.CD_NM AS CD_NM,
    D2.PS_CD,
    D7.CD_NM AS JBPS_NM,
    D2.JBPS_CD /* 직위코드 */,
    NVL(D1.ALW_AM, 0) AS ALW_AM,
    D1.FIX_YN,
    D8.USR_DFN_TXT_2,
    '' AS PMT_YM,
    '' AS PMT_DT
FROM TBCSPLFI102M D1 , TBDCMACM001M D2 , TBDCMACM002M D3 , ( SELECT D4.CD,
    D4.CD_NM
FROM TBDCMACM013C D4 WHERE D4.CMM_CD_DVSN_CD = '1000173' ) D5 , ( SELECT D4.CD,
    D4.CD_NM
FROM TBDCMACM013C D4 WHERE D4.CMM_CD_DVSN_CD = '1000177' ) D6 , ( SELECT D4.CD,
    D4.CD_NM
FROM TBDCMACM013C D4 WHERE D4.CMM_CD_DVSN_CD = '1000176' ) D7 , ( SELECT D4.CD,
    D4.CD_NM,
    D4.USR_DFN_TXT_2
FROM TBDCMACM013C D4 WHERE D4.CMM_CD_DVSN_CD = '1000145' ) D8 WHERE D1.TRGT_NOP_ENO = D2.TRGT_NOP_ENO AND D2.SRECS_DEPT_CD = D3.SRECS_DEPT_CD AND D1.ALW_DVSN_CD = D8.CD AND D2.JBGD_SECD = D5.CD(+) AND D2.PS_CD = D6.CD(+) AND D2.JBPS_CD = D7.CD(+) AND D3.SRECS_DEPT_CD != '880880' AND D2.BAI_USR_YN = 'Y' AND D1.ALW_DVSN_CD IN ( SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #cd# ||',' AS #CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND D1.TRGT_NOP_ENO = #TRGT_NOP_ENO# AND D2.SRECS_DEPT_CD LIKE (SELECT CASE WHEN SUBSTR(#dptCd#, 4, 3) = '000' THEN SUBSTR(#dptCd#, 0, 3) || '%' ELSE #dptCd# AS SUBSTR
FROM DUAL) AND D1.FIX_YN = #fixYn# ORDER BY TRGT_NOP_ENO, D8.USR_DFN_TXT_2