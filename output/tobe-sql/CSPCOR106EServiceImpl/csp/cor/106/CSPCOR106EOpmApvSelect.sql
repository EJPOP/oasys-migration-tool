SELECT MAX(CASE WHEN ROW_ID = 1 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 2 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 3 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 4 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 5 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 6 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 7 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 1 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 2 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 3 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 4 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 5 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 6 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 7 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID
FROM ( SELECT DH1.ATRZ_DMND_ID /* 결재요청아이디 */,
    DH1.APV_SRNO,
    (SELECT H2.JBPS_NM AS JBPS_NM /* 직위명 */
FROM TBDCMACM111H H1 ,TBDCMACM112H H2 WHERE H1.RCPT_DT = H2.RCPT_DT AND H1.RCPT_ID = H2.RCPT_ID AND H1.ONR_DOC_MNG_CARD_ID = DH1.ATRZ_DMND_ID AND H2.CVLCPT_APRVR_ID = DH1.CVLCPT_APRVR_ID GROUP BY H2.JBPS_NM ) AS JBPS_NM ,DH1.PROF_RBPRSN_APRVR_NM ,DH1.APV_DH ,ROW_NUMBER() OVER (ORDER BY APV_SRNO) AS ROW_ID FROM ( SELECT ONR_DOC_MNG_CARD_ID AS ONR_DOC_MNG_CARD_ID /* 온나라문서관리카드아이디 */,
    APV_HIS_SRNO,
    CVLCPT_APRVR_ID /* 민원결재자아이디 */,
    TO_CHAR(APV_DH, 'YYYY-MM-DD') AS TO_CHAR,
    PROF_RBPRSN_APRVR_NM AS PROF_RBPRSN_APRVR_NM /* 증명책임자결재자명 */
FROM TBDCMACM102L D2 WHERE ONR_APV_DVSN_CD <> '10' AND ONR_DOC_MNG_CARD_ID = ( SELECT ONR_DOC_MNG_CARD_ID /* 온나라문서관리카드아이디 */
FROM TBCSPCOR104M S1 WHERE S1.CVLCPT_SECD = #CVLCPT_SECD# AND S1.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND S1.CVLCPT_RCPT_NO = #CVLCPT_RCPT_NO# ) ) DH1 )