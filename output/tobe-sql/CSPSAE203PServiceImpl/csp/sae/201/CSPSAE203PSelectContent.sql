SELECT EDU_DATE,
    TRGT_NOPE /* 대상인원수 */,
    SV_DATE,
    TRGT_NOPE || ' 중 ' || MAX(RP_CNT)||'명' AS TRGT_NOPE /* 대상인원수 */
FROM ( SELECT SUBSTR(B.EDU_BGNG_YMD, 0, 4) || '.' || SUBSTR(B.EDU_BGNG_YMD, 5, 2) || '.' || SUBSTR(B.EDU_BGNG_YMD, 7, 2) || '(' || SUBSTRING(UPPER(TO_CHAR(TO_DATE(B.EDU_BGNG_YMD), 'DAY', 'NLS_DATE_LANGUAGE=KOREAN')), 0, 1) || ')' || ' ~ ' || SUBSTR(B.EDU_END_YMD, 0, 4) || '.' || SUBSTR(B.EDU_END_YMD, 5, 2) || '.' || SUBSTR(B.EDU_END_YMD, 7, 2) || '(' || SUBSTRING(UPPER(TO_CHAR(TO_DATE(B.EDU_END_YMD), 'DAY', 'NLS_DATE_LANGUAGE=KOREAN')), 0, 1) || ')' AS SUBSTR,
    A.EDU_TG_TXT || ' ' || A.ONTM_NOP_CNT || '명' AS TRGT_NOPE /* 대상인원수 */,
    SUBSTR(B.SV_DT, 0, 4) || '.' || SUBSTR(B.SV_DT, 5, 2) || '.' || SUBSTR(B.SV_DT, 7, 2) || '(' || SUBSTRING(UPPER(TO_CHAR(TO_DATE(B.SV_DT), 'DAY', 'NLS_DATE_LANGUAGE=KOREAN')), 0, 1) || ')' AS SUBSTR,
    C.RP_CNT
FROM TBCSPSAE201M A , TBCSPSAE201D B , (SELECT SUM(RP_CNT) AS RP_CNT,
    LINK_YR /* 연계년도 */,
    CRS_CD,
    CRS_CDN /* 과정기수 */,
    SV_QEST_NO
FROM TBCSPSAE302D WHERE LINK_YR = #LINK_YR# AND CRS_CD = #strEDU_CRS_CD# AND CRS_CDN = #CRS_CDN# GROUP BY LINK_YR, CRS_CD, CRS_CDN, SV_QEST_NO) C WHERE B.LINK_YR = A.LINK_YR AND B.CRS_CD = A.CRS_CD AND C.LINK_YR = B.LINK_YR AND C.CRS_CD = B.CRS_CD AND C.CRS_CDN = B.CRS_CDN AND A.LINK_YR = #LINK_YR# AND A.CRS_CD = #strEDU_CRS_CD# AND B.CRS_CDN = #CRS_CDN# ) GROUP BY EDU_DATE, TRGT_NOPE, SV_DATE