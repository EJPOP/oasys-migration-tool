SELECT M1.GUBUN,
    NVL(M1.TOT_MAKE , 0) AS TOT_MAKE,
    NVL(M1.PAST_MAKE , 0) AS PAST_MAKE,
    NVL(M1.NOW_MAKE , 0) AS NOW_MAKE,
    NVL(M1.RESULT_TOT, 0) AS RESULT_TOT,
    NVL(M1.RESULT_1 , 0) AS RESULT_1,
    NVL(M1.RESULT_2 , 0) AS RESULT_2,
    NVL(M1.RESULT_3 , 0) AS RESULT_3,
    NVL(M1.RESULT_4 , 0) AS RESULT_4,
    NVL(M1.RESULT_5 , 0) AS RESULT_5,
    NVL(CASE WHEN M1.RESULT_TOT = 0 THEN NULL ELSE TRUNC(M1.RESULT_1/M1.RESULT_TOT*100,2)||'%' END, 0) AS RESULT_TOT,
    NVL(M1.TOT_MAKE, 0) - NVL(M1.RESULT_TOT, 0) AS TOT_MAKE
FROM ( SELECT NVL(#strFromDt#, '18000101')|| '~' || NVL(#strToDt#, '99991231') AS #STRFROMDT#,
    SUM( CASE WHEN D1.SRECS_RCPT_YMD BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') THEN NVL(D1.SRECS_STATS_CONT, 1) WHEN D1.SRECS_RCPT_YR < SUBSTR(#strFromDt#, 1, 4) AND D2.SRECS_SBCN_YMD IS NULL AND D3.SRECS_ENFC_YMD IS NULL THEN NVL(D1.SRECS_STATS_CONT, 1) WHEN D1.SRECS_RCPT_YR < SUBSTR(#strFromDt#, 1, 4) AND NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_RCPT_YMD /* 심사재심의접수일자 */,
    SUM( CASE WHEN D1.SRECS_RCPT_YR < SUBSTR(#strFromDt#, 1, 4) AND NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD) IS NULL THEN NVL(D1.SRECS_STATS_CONT, 1) WHEN D1.SRECS_RCPT_YR < SUBSTR(#strFromDt#, 1, 4) AND NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_RCPT_YR /* 심사재심의접수년도 */,
    SUM( CASE WHEN D1.SRECS_RCPT_YMD BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_RCPT_YMD /* 심사재심의접수일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND NVL(D2.SRECS_DCS_KDCD, '9999') != '9999' THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND D2.SRECS_DCS_KDCD IN ('3', '4', '5') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND D2.SRECS_DCS_KDCD IN ('1', '2') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND D2.SRECS_DCS_KDCD IN ('6') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND D2.SRECS_DCS_KDCD IN ('8') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND D2.SRECS_DCS_KDCD IN ('7') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND D2.SRECS_DCS_KDCD IN ('9') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */
FROM TBBADFRE012M D1 , TBBADFRE012D D2 , TBBADFRE013D D3 WHERE 1 = 1 AND D1.CVLCPT_RCPT_YR = D2.CVLCPT_RCPT_YR AND D1.SRECS_RCPT_SECD = D2.SRECS_RCPT_SECD AND D1.SRECS_RCPT_SQNO = D2.SRECS_RCPT_SQNO AND D1.SRECS_DEPT_CD = D2.SRECS_DEPT_CD AND D1.CVLCPT_RCPT_YR = D3.CVLCPT_RCPT_YR AND D1.SRECS_RCPT_SECD = D3.SRECS_RCPT_SECD AND D1.SRECS_RCPT_SQNO = D3.SRECS_RCPT_SQNO AND D1.SRECS_DEPT_CD = D3.SRECS_DEPT_CD AND D1.SRECS_RCPT_SECD = '2' UNION SELECT '우리원처분' AS GUBUN,
    SUM( CASE WHEN D1.SRECS_RCPT_YMD BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') THEN NVL(D1.SRECS_STATS_CONT, 1) WHEN D1.SRECS_RCPT_YR < SUBSTR(#strFromDt#, 1, 4) AND D2.SRECS_SBCN_YMD IS NULL AND D3.SRECS_ENFC_YMD IS NULL THEN NVL(D1.SRECS_STATS_CONT, 1) WHEN D1.SRECS_RCPT_YR < SUBSTR(#strFromDt#, 1, 4) AND NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_RCPT_YMD /* 심사재심의접수일자 */,
    SUM( CASE WHEN D1.SRECS_RCPT_YR < SUBSTR(#strFromDt#, 1, 4) AND NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD) IS NULL THEN NVL(D1.SRECS_STATS_CONT, 1) WHEN D1.SRECS_RCPT_YR < SUBSTR(#strFromDt#, 1, 4) AND NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_RCPT_YR /* 심사재심의접수년도 */,
    SUM( CASE WHEN D1.SRECS_RCPT_YMD BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_RCPT_YMD /* 심사재심의접수일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND NVL(D2.SRECS_DCS_KDCD, '9999') != '9999' THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND D2.SRECS_DCS_KDCD IN ('3', '4', '5') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND D2.SRECS_DCS_KDCD IN ('1', '2') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND D2.SRECS_DCS_KDCD IN ('6') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND D2.SRECS_DCS_KDCD IN ('8') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND D2.SRECS_DCS_KDCD IN ('7') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */,
    SUM( CASE WHEN NVL(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND D2.SRECS_DCS_KDCD IN ('9') THEN NVL(D1.SRECS_STATS_CONT, 1) ELSE 0 END ) AS SRECS_SBCN_YMD /* 심사재심의부의일자 */
FROM TBBADFRE012M D1 , TBBADFRE012D D2 , TBBADFRE013D D3 WHERE 1 = 1 AND D1.CVLCPT_RCPT_YR = D2.CVLCPT_RCPT_YR AND D1.SRECS_RCPT_SECD = D2.SRECS_RCPT_SECD AND D1.SRECS_RCPT_SQNO = D2.SRECS_RCPT_SQNO AND D1.SRECS_DEPT_CD = D2.SRECS_DEPT_CD AND D1.CVLCPT_RCPT_YR = D3.CVLCPT_RCPT_YR AND D1.SRECS_RCPT_SECD = D3.SRECS_RCPT_SECD AND D1.SRECS_RCPT_SQNO = D3.SRECS_RCPT_SQNO AND D1.SRECS_DEPT_CD = D3.SRECS_DEPT_CD AND D1.SRECS_RCPT_SECD = '2' AND NVL(D1.SRECS_BAI_DSPS_YN, 'N') = 'Y' )M1