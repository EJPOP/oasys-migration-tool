SELECT F_DPT_INFO(M1.SRECS_DEPT_CD, '1') AS F_DPT_INFO,
    NVL(SUM(CASE WHEN M1.DSPS_RQT_KDCD = '210' THEN NVL(M1.SRECS_STATS_CONT, 1) /* 징계, 문책 */ ELSE 0 END), 0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN M1.DSPS_RQT_KDCD = '410' THEN NVL(M1.SRECS_STATS_CONT, 1) /* 주의 */ ELSE 0 END), 0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN M1.DSPS_RQT_KDCD IN ('310', '320') THEN NVL(M1.SRECS_STATS_CONT, 1) /* 시정 */ ELSE 0 END), 0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN M1.DSPS_RQT_KDCD IN ('610', '620', '621', '623', '630') THEN NVL(M1.SRECS_STATS_CONT, 1) /* 통보 */ ELSE 0 END), 0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN M1.DSPS_RQT_KDCD IN ('110') THEN NVL(M1.SRECS_STATS_CONT, 1) /* 변상판정 */ ELSE 0 END), 0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN M1.DSPS_RQT_KDCD NOT IN ('210','410', '310', '320', '610', '620', '621', '623', '630', '110') THEN NVL(M1.SRECS_STATS_CONT, 1) /* 재심의기타 */ ELSE 0 END), 0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(M1.SRECS_STATS_CONT), 0) AS SRECS_STATS_CONT /* 심사재심의통계개수 */
FROM ( SELECT D1.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    D4.DSPS_RQT_KDCD /* 처분요구종류코드 */,
    D1.SRECS_STATS_CONT /* 심사재심의통계개수 */
FROM TBBADFRE012M D1 , TBBADFRE012D D2 , TBBADFRE013D D3 , TBBADEAR001M D4 WHERE 1 = 1 AND D1.CVLCPT_RCPT_YR = D2.CVLCPT_RCPT_YR AND D1.SRECS_RCPT_SECD = D2.SRECS_RCPT_SECD AND D1.SRECS_RCPT_SQNO = D2.SRECS_RCPT_SQNO AND D1.SRECS_DEPT_CD = D2.SRECS_DEPT_CD AND D1.CVLCPT_RCPT_YR = D3.CVLCPT_RCPT_YR AND D1.SRECS_RCPT_SECD = D3.SRECS_RCPT_SECD AND D1.SRECS_RCPT_SQNO = D3.SRECS_RCPT_SQNO AND D1.SRECS_DEPT_CD = D3.SRECS_DEPT_CD AND D1.CVLCPT_ADT_YR = D4.CVLCPT_ADT_YR AND D1.ADT_NO = D4.ADT_NO AND D1.DSPS_RQT_SQNO = D4.DSPS_RQT_SQNO AND D1.SRECS_RCPT_SECD = '2' /* 접수구분코드 2 : 재심의청구 */ AND NVL(NVL(D2.SBCN_YMD, D3.ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') ORDER BY D1.SRECS_DEPT_CD ) M1 GROUP BY M1.SRECS_DEPT_CD UNION SELECT '합계' AS S8GUBUN,
    NVL(SUM(CASE WHEN M1.DSPS_RQT_KDCD = '210' THEN NVL(M1.SRECS_STATS_CONT, 1) /* 징계, 문책 */ ELSE 0 END), 0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN M1.DSPS_RQT_KDCD = '410' THEN NVL(M1.SRECS_STATS_CONT, 1) /* 주의 */ ELSE 0 END), 0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN M1.DSPS_RQT_KDCD IN ('310', '320') THEN NVL(M1.SRECS_STATS_CONT, 1) /* 시정 */ ELSE 0 END), 0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN M1.DSPS_RQT_KDCD IN ('610', '620', '621', '623', '630') THEN NVL(M1.SRECS_STATS_CONT, 1) /* 통보 */ ELSE 0 END), 0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN M1.DSPS_RQT_KDCD IN ('110') THEN NVL(M1.SRECS_STATS_CONT, 1) /* 변상판정 */ ELSE 0 END), 0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(CASE WHEN M1.DSPS_RQT_KDCD NOT IN ('210','410', '310', '320', '610', '620', '621', '623', '630', '110') THEN NVL(M1.SRECS_STATS_CONT, 1) /* 재심의기타 */ ELSE 0 END),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(SUM(M1.SRECS_STATS_CONT), 0) AS SRECS_STATS_CONT /* 심사재심의통계개수 */
FROM ( SELECT D1.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    D4.DSPS_RQT_KDCD /* 처분요구종류코드 */,
    D1.SRECS_STATS_CONT /* 심사재심의통계개수 */
FROM TBBADFRE012M D1 , TBBADFRE012D D2 , TBBADFRE013D D3 , TBBADEAR001M D4 WHERE 1 = 1 AND D1.CVLCPT_RCPT_YR = D2.CVLCPT_RCPT_YR AND D1.SRECS_RCPT_SECD = D2.SRECS_RCPT_SECD AND D1.SRECS_RCPT_SQNO = D2.SRECS_RCPT_SQNO AND D1.SRECS_DEPT_CD = D2.SRECS_DEPT_CD AND D1.CVLCPT_RCPT_YR = D3.CVLCPT_RCPT_YR AND D1.SRECS_RCPT_SECD = D3.SRECS_RCPT_SECD AND D1.SRECS_RCPT_SQNO = D3.SRECS_RCPT_SQNO AND D1.SRECS_DEPT_CD = D3.SRECS_DEPT_CD AND D1.CVLCPT_ADT_YR = D4.CVLCPT_ADT_YR AND D1.ADT_NO = D4.ADT_NO AND D1.DSPS_RQT_SQNO = D4.DSPS_RQT_SQNO AND D1.SRECS_RCPT_SECD = '2' /* 접수구분코드 2 : 재심의청구 */ AND NVL(NVL(D2.SBCN_YMD, D3.ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') ) M1