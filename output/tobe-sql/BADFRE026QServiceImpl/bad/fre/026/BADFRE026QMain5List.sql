SELECT F_DPT_INFO(M1.SRECS_DEPT_CD, '1') AS F_DPT_INFO,
    NVL(SUM(M1.SRECS_STATS_CONT), 0) AS SRECS_STATS_CONT /* 심사재심의통계개수 */,
    NVL(SUM( CASE WHEN M1.TERM_DT BETWEEN 0 AND 90 THEN NVL(M1.SRECS_STATS_CONT, 1) ELSE 0 END ), 0) AS TERM_DT /* 3개월 이내 */,
    NVL(SUM( CASE WHEN M1.TERM_DT > 90 THEN NVL(M1.SRECS_STATS_CONT, 1) ELSE 0 END ), 0) AS TERM_DT /* 기간초과처리건수 계 */,
    NVL(SUM( CASE WHEN M1.TERM_DT BETWEEN 91 AND 180 THEN NVL(M1.SRECS_STATS_CONT, 1) ELSE 0 END ), 0) AS TERM_DT /* 기간초과처리건수 4에서 6월 */,
    NVL(SUM( CASE WHEN M1.TERM_DT BETWEEN 181 AND 270 THEN NVL(M1.SRECS_STATS_CONT, 1) ELSE 0 END ), 0) AS TERM_DT /* 기간초과처리건수 7에서 9월 */,
    NVL(SUM( CASE WHEN M1.TERM_DT BETWEEN 271 AND 365 THEN NVL(M1.SRECS_STATS_CONT, 1) ELSE 0 END ), 0) AS TERM_DT /* 기간초과처리건수 10에서 12월 */,
    NVL(SUM( CASE WHEN M1.TERM_DT > 365 THEN NVL(M1.SRECS_STATS_CONT, 1) ELSE 0 END ), 0) AS TERM_DT /* 기간초과처리건수 1년 초과 */,
    NVL(TRUNC(SUM(M1.TERM_DT*M1.SRECS_STATS_CONT)/SUM(M1.SRECS_STATS_CONT), 0), 0) AS TRUNC
FROM ( SELECT TO_DATE(NVL(D2.SRECS_SBCN_YMD, D3.SRECS_ENFC_YMD)) - TO_DATE(NVL(D3.SRECS_RMV_YMD, D1.SRECS_RCPT_YMD)) AS TO_DATE,
    D1.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    D1.SRECS_STATS_CONT /* 심사재심의통계개수 */
FROM TBBADFRE012M D1 , TBBADFRE012D D2 , TBBADFRE013D D3 WHERE 1 = 1 AND D1.CVLCPT_RCPT_YR = D2.CVLCPT_RCPT_YR AND D1.SRECS_RCPT_SECD = D2.SRECS_RCPT_SECD AND D1.SRECS_RCPT_SQNO = D2.SRECS_RCPT_SQNO AND D1.SRECS_DEPT_CD = D2.SRECS_DEPT_CD AND D1.CVLCPT_RCPT_YR = D3.CVLCPT_RCPT_YR AND D1.SRECS_RCPT_SECD = D3.SRECS_RCPT_SECD AND D1.SRECS_RCPT_SQNO = D3.SRECS_RCPT_SQNO AND D1.SRECS_DEPT_CD = D3.SRECS_DEPT_CD AND D1.SRECS_RCPT_SECD = '1' /* 접수구분코드 1 : 심사청구 */ AND NVL(NVL(D2.SBCN_YMD, D3.ENFC_YMD), '99999999') BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') AND NVL(D2.SRECS_DCS_KDCD, '9999') != '9999' ) M1 GROUP BY M1.SRECS_DEPT_CD ORDER BY M1.SRECS_DEPT_CD