SELECT CASE WHEN NVL(M1.GUBUN , 0) = '1' THEN '국세' WHEN NVL(M1.GUBUN , 0) = '2' THEN '지방세' WHEN NVL(M1.GUBUN , 0) = '3' THEN '산재' WHEN NVL(M1.GUBUN , 0) = '4' THEN '기타' ELSE '합계' END AS GUBUN,
    NVL(M1.TOT_MAKE , 0) AS TOT_MAKE,
    NVL(M1.PAST_MAKE , 0) AS PAST_MAKE,
    NVL(M1.NOW_MAKE , 0) AS NOW_MAKE,
    NVL(M1.RESULT_TOT, 0) AS RESULT_TOT,
    NVL(M1.RESULT_1 , 0) AS RESULT_1,
    NVL(M1.RESULT_2 , 0) AS RESULT_2,
    NVL(M1.RESULT_3 , 0) AS RESULT_3,
    NVL(M1.RESULT_4 , 0) AS RESULT_4,
    NVL(CASE WHEN M1.RESULT_TOT = 0 THEN NULL ELSE TRUNC(M1.RESULT_1/M1.RESULT_TOT*100,2)||'%' END, 0) AS RESULT_TOT,
    NVL(M1.TOT_MAKE, 0) - NVL(M1.RESULT_TOT, 0) AS TOT_MAKE
FROM ( SELECT CASE WHEN SUBSTR(D1.SRECS_SRNG_CLM_SECD, 1, 1) = 1 THEN '1' WHEN SUBSTR(D1.SRECS_SRNG_CLM_SECD, 1, 1) = 2 THEN '2' WHEN D1.SRECS_SRNG_CLM_SECD IN ('31') THEN '3' ELSE '4' END AS GUBUN , SUM( CASE WHEN D1.NTFCTN_RCPT_YMD BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') THEN NVL(D1.SRECS_STATS_CONT, 1) WHEN D1.CVLCPT_RCPT_YR AND D1.SRECS_DEPT_CD = #SRECS_DEPT_CD# GROUP BY CASE WHEN SUBSTR(D1.SRECS_SRNG_CLM_SECD, 1, 1) = 1 THEN '1' WHEN SUBSTR(D1.SRECS_SRNG_CLM_SECD, 1, 1) = 2 THEN '2' WHEN D1.SRECS_SRNG_CLM_SECD IN ('31') THEN '3' ELSE '4' END UNION SELECT '합계' AS GUBUN , SUM( CASE WHEN D1.NTFCTN_RCPT_YMD BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') THEN NVL(D1.SRECS_STATS_CONT, 1) WHEN D1.CVLCPT_RCPT_YR AND D1.SRECS_DEPT_CD = #SRECS_DEPT_CD# ) AS M1 ORDER BY M1.GUBUN