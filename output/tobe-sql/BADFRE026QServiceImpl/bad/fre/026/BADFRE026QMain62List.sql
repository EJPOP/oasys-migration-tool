SELECT NVL(M1.GUBUN , 0) AS GUBUN,
    NVL(M1.TOT_MAKE , 0) AS TOT_MAKE,
    NVL(M1.PAST_MAKE , 0) AS PAST_MAKE,
    NVL(M1.NOW_MAKE , 0) AS NOW_MAKE,
    NVL(M1.RESULT_TOT, 0) AS RESULT_TOT,
    NVL(M1.RESULT_1 , 0) AS RESULT_1,
    NVL(M1.RESULT_2 , 0) AS RESULT_2,
    NVL(M1.RESULT_3 , 0) AS RESULT_3,
    NVL(M1.RESULT_4 , 0) AS RESULT_4,
    NVL(CASE WHEN M1.RESULT_TOT = 0 THEN NULL ELSE TRUNC(M1.RESULT_1/M1.RESULT_TOT*100,2)||'%' END, 0) AS RESULT_TOT,
    NVL(M1.TOT_MAKE, 0) - NVL(M1.RESULT_TOT, 0) AS TOT_MAKE
FROM ( SELECT F_DPT_INFO(D1.SRECS_DEPT_CD, '1') AS GUBUN , SUM( CASE WHEN D1.NTFCTN_RCPT_YMD BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') THEN NVL(D1.SRECS_STATS_CONT, 1) WHEN D1.CVLCPT_RCPT_YR AND CASE WHEN SUBSTR(#SRECS_SRNG_CLM_SECD#, 1, 1) = '3' THEN ( CASE WHEN D1.SRECS_SRNG_CLM_SECD = #SRECS_SRNG_CLM_SECD# THEN 1 ELSE 0 END ) ELSE ( CASE WHEN SUBSTR(#SRECS_SRNG_CLM_SECD#, 1, 1) = SUBSTR(D1.SRECS_SRNG_CLM_SECD, 1, 1) THEN 1 ELSE 0 END ) END = 1 GROUP BY D1.SRECS_DEPT_CD UNION SELECT '합계' AS GUBUN , SUM( CASE WHEN D1.NTFCTN_RCPT_YMD BETWEEN NVL(#strFromDt#, '18000101') AND NVL(#strToDt#, '99991231') THEN NVL(D1.SRECS_STATS_CONT, 1) WHEN D1.CVLCPT_RCPT_YR AND CASE WHEN SUBSTR(#SRECS_SRNG_CLM_SECD#, 1, 1) = '3' THEN ( CASE WHEN D1.SRECS_SRNG_CLM_SECD = #SRECS_SRNG_CLM_SECD# THEN 1 ELSE 0 END ) ELSE ( CASE WHEN SUBSTR(#SRECS_SRNG_CLM_SECD#, 1, 1) = SUBSTR(D1.SRECS_SRNG_CLM_SECD, 1, 1) THEN 1 ELSE 0 END ) END = 1 ) AS M1 ORDER BY M1.GUBUN