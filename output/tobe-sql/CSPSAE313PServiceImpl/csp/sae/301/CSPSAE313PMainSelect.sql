SELECT T1.LCT_NM,
    T1.CRS_CDN /* 과정기수 */,
    T1.LCT_PLACE,
    SUBSTR(T1.EDU_BGNG_YMD, 0, 4) || '.' || SUBSTR(T1.EDU_BGNG_YMD, 5, 2) || '.' || SUBSTR(T1.EDU_BGNG_YMD, 7, 2) || ' ~ ' || SUBSTR(T1.EDU_END_YMD, 0, 4) || '.' || SUBSTR(T1.EDU_END_YMD, 5, 2) || '.' || SUBSTR(T1.EDU_END_YMD, 7, 2) AS SUBSTR,
    SUBSTR(T1.REG_STR_DT, 0, 4) || '.' || SUBSTR(T1.REG_STR_DT, 5, 2) || '.' || SUBSTR(T1.REG_STR_DT, 7, 2) || ' ~ ' || SUBSTR(T1.REG_END_DT, 0, 4) || '.' || SUBSTR(T1.REG_END_DT, 5, 2) || '.' || SUBSTR(T1.REG_END_DT, 7, 2) AS REG_DT /* 등록일시 */,
    T1.TPOF_NOPE /* 제보인원수 */,
    (SELECT COUNT(*)
FROM TBCSPSAE306D s1 WHERE S1.LINK_YR = T1.LINK_YR AND S1.CRS_CD = T1.CRS_CD AND S1.CRS_CDN = T1.CRS_CDN AND S1.SIGN_STATUS = '3') AS REG_CNT ,CASE WHEN T2.SIGN_STATUS IS NULL OR T2.SIGN_STATUS = '1' THEN '미신청' WHEN T2.SIGN_STATUS = '2' THEN '결재중' WHEN T2.SIGN_STATUS = '3' THEN '승인(신청완료)' WHEN T2.SIGN_STATUS = '4' THEN '반려' WHEN T2.SIGN_STATUS = '5' THEN '상신취소' ELSE '' END AS SIGN_STATUS_NM ,T2.SIGN_STATUS ,T2.APV_KEY ,T2.TRGT_NOP_ENO ,F_USR_INFO(T2.TRGT_NOP_ENO,'2') AS INFO_RLPR_NM FROM TBCSPSAE201D T1 ,TBCSPSAE306D T2 WHERE T1.LINK_YR = T2.LINK_YR AND T1.CRS_CD = T2.CRS_CD AND T1.CRS_CDN = T2.CRS_CDN AND T2.APV_KEY = #APV_KEY# AND T2.ATRZ_DOC_NO = #ATRZ_DOC_NO# ORDER BY T1.REG_STR_DT, T1.CRS_CD, T1.CRS_CDN