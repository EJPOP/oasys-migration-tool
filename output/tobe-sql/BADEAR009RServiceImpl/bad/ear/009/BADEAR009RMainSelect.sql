SELECT MASTER.ADT_YR AS ADT_YR /* 감사년도 */,
    MASTER.ADT_NO AS ADT_NO /* 감사번호 */,
    MASTER.DSPS_RQT_SQNO AS DSPS_RQT_SQNO /* 처분요구순번 */,
    F_ORG_INFO(DETAIL.CMO_INST_CD,'1') AS F_ORG_INFO,
    /*소관청명*/ F_CODE_NM('1000121', DETAIL.VIOL_TPCD) AS F_CODE_NM,
    /*비위유형명*/ CASE WHEN SUBSTRB(DETAIL.VIOL_TPCD, 1, 1) = '1' THEN CASE WHEN ACNT.DSPS_RQT_ACNTG_SECD IS NOT NULL THEN '회계(' || ACNT.ACNTG_YR || '-' || F_CODE_NM('1000004', ACNT.DSPS_RQT_ACNTG_SECD) || ')' ELSE '' END WHEN SUBSTRB(DETAIL.VIOL_TPCD, 1, 1) = '2' THEN '감찰' ELSE '' END AS ACNTG_CDNM /* 회계코드명 */,
    /* 회계사항 - 수정 2016.05.09 yyh */ F_CODE_NM('1000005', MASTER.ADT_EMPHS_SECD) AS F_CODE_NM,
    /*감사중점명*/ DETAIL.IMPL_MNG_JRSD_DEPT_CD AS IMPL_MNG_JRSD_DEPT_CD /* 집행관리소관부서코드 */,
    /*집행관리국과코드*/ F_DPT_INFO(DETAIL.IMPL_MNG_JRSD_DEPT_CD,'1') AS F_DPT_INFO,
    /*집행관리국과명*/ REL.SRECS_REL_INST_CD AS SRECS_REL_INST_CD /* 심사재심의관계기관코드 */,
    /*관계기관코드*/ F_ORG_INFO(REL.SRECS_REL_INST_CD,'1') AS F_ORG_INFO,
    /*관계기관명*/ REL.INST_CONT AS INST_CONT /* 기관개수 */,
    /*관계기관 건수*/ MASTER.DSPS_RQT_KDCD AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    F_CODE_NM('1000002', MASTER.DSPS_RQT_KDCD) AS F_CODE_NM,
    /*처분요구종류*/ MASTER.DSPS_RQT_NM AS DSPS_RQT_NM /* 처분요구명 */,
    /*처분요구제목*/ DETAIL.NOP_CONT AS TPOF_NOPE /* 제보인원수 */,
    /*인원수*/ DETAIL.ACSTN_RQST_NOP_CONT AS ACSTN_RQST_NOP_CONT /* 고발의뢰인원개수 */,
    /*고발의뢰인원수*/ DETAIL.PNRT_PRSRV_AMT AS PNRT_PRSRV_AMT /* 추징회수보전금액 */,
    DETAIL.RMBR_AMT AS RMBR_AMT /* 환급금액 */,
    /*환급금액*/ DETAIL.SPLP_AMT AS SPLP_AMT /* 추급금액 */,
    /*추급금액*/ NVL(DETAIL.RMBR_AMT, 0) + NVL(DETAIL.SPLP_AMT, 0) AS RMBR_AMT /* 환급금액 */,
    /*환추급금액*/ NVL(DETAIL.BGT_RTRC_AMT, 0) + NVL(DETAIL.INCM_INCRS_AMT, 0) + NVL(DETAIL.PPL_BRDN_RDT_AMT, 0) + NVL(DETAIL.PRPT_INCRS_AMT, 0) + NVL(DETAIL.EXPND_RATI_AMT, 0) AS BGT_RTRC_AMT /* 예산절감금액 */,
    /*기대효과금액*/ NVL(DETAIL.EPFC_EFCT_AMT, 0) AS EPFC_EFCT_AMT /* 사후효과금액 */,
    /*사후적효과금액*/ DETAIL.IJS_AMT AS IJS_AMT /* 부당금액 */,
    /*부당금액*/ DETAIL.BGT_RTRC_AMT AS BGT_RTRC_AMT /* 예산절감금액 */,
    /*예산절감금액*/ DETAIL.INCM_INCRS_AMT AS INCM_INCRS_AMT /* 수입증가금액 */,
    /*수입증대금액*/ DETAIL.PPL_BRDN_RDT_AMT AS PPL_BRDN_RDT_AMT /* 국민부담경감금액 */,
    F_MNG_KND_AUDYRNO(AUD.ADT_YR, AUD.ADT_NO, AUD.ADT_KDCD, '-') AS F_MNG_KND_AUDYRNO,
    F_MNG_KND_AUDYRNO(AUD.ADT_YR, AUD.ADT_NO, AUD.ADT_KDCD, '-')||'-'||MASTER.DSPS_RQT_SQNO AS F_MNG_KND_AUDYRNO,
    CASE WHEN AUD.ADT_YR >= '2016' THEN F_CODE_NM('1000739',SUBSTR(AUD.ADT_KDCD,3,1)) ELSE '' END AS ADT_YR /* 감사년도 */
FROM TB_BADEAR001M MASTER , TB_BADEAR002D DETAIL , TB_BADDED001M AUD , (SELECT CVLCPT_ADT_YR /* 민원감사년도 */,
    ADT_NO /* 감사번호 */,
    DSPS_RQT_SQNO /* 처분요구순번 */,
    DSPS_RQT_ACNTG_SECD /* 처분요구회계구분코드 */,
    ACNTG_YR /* 회계년도 */
FROM TBBADEAR003M WHERE 1=1 AND CVLCPT_ADT_YR = #CVLCPT_ADT_YR# /*인자값 1*/ ) ACNT, ( SELECT CVLCPT_ADT_YR /* 민원감사년도 */,
    ADT_NO /* 감사번호 */,
    DSPS_RQT_SQNO /* 처분요구순번 */,
    MIN(SRECS_REL_INST_CD) AS SRECS_REL_INST_CD /* 심사재심의관계기관코드 */,
    COUNT(*) AS INST_CONT /* 기관개수 */
FROM TBBADEAR006M WHERE 1=1 AND CVLCPT_ADT_YR = #CVLCPT_ADT_YR# /*인자값 1*/ GROUP BY CVLCPT_ADT_YR ,ADT_NO ,DSPS_RQT_SQNO ) REL WHERE 1=1 AND MASTER.ADT_YR = DETAIL.ADT_YR AND MASTER.ADT_NO = DETAIL.ADT_NO AND MASTER.DSPS_RQT_SQNO = DETAIL.DSPS_RQT_SQNO AND MASTER.ADT_YR = AUD.ADT_YR AND MASTER.ADT_NO = AUD.ADT_NO AND MASTER.ADT_YR = ACNT.CVLCPT_ADT_YR(+) AND MASTER.ADT_NO = ACNT.ADT_NO(+) AND MASTER.DSPS_RQT_SQNO = ACNT.DSPS_RQT_SQNO(+) AND MASTER.ADT_YR = REL.CVLCPT_ADT_YR(+) AND MASTER.ADT_NO = REL.ADT_NO(+) AND MASTER.DSPS_RQT_SQNO = REL.DSPS_RQT_SQNO(+) AND MASTER.ADT_YR = #CVLCPT_ADT_YR# /*인자값 1*/ AND AUD.ADT_GRNT_NO = #ADT_GRNT_NO# /*감사부여번호 조건 추가 - 2016.06.01 yyh*/ AND SUBSTR(AUD.ADT_KDCD,3,1) = #strAudYrNoKndCd# AND MASTER.DSPS_RQT_SQNO BETWEEN #strDspRqSnoSt# AND #strDspRqSnoEnd# /*인자값 2*/ ORDER BY MASTER.DSPS_RQT_SQNO