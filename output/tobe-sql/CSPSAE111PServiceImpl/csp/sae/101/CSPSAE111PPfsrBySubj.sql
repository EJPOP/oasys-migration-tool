SELECT ROWNUM || '. ' || A.BLL_SBJCT_NM AS BLL_SBJCT_NM /* 계산서과목명 */,
    A.ASG_SNO,
    A.PFSR_BLT_NM,
    A.PFSR_RANK_NM,
    A.INFO_RLPR_NM /* 정보관계자명 */
FROM ( SELECT B.BLL_SBJCT_NM /* 계산서과목명 */,
    COUNT(ASG_SNO) AS ASG_SNO,
    NVL(C.PFSR_BLT_NM, E.TKCG_DEPT_NM) AS PFSR_BLT_NM,
    NVL(C.PFSR_RANK_NM, '과정장') AS PFSR_RANK_NM,
    NVL(C.INFO_RLPR_NM, D.CRS_CHIF_NM) AS INFO_RLPR_NM /* 정보관계자명 */
FROM TBCSPSAE202D A , TBCSPSAE101M B , TBCSPSAE109M C , TBCSPSAE201D D , TBCSPSAE201M E WHERE B.SUBJ_CD(+) = A.SUBJ_CD AND C.PFSR_ID(+) = A.PFSR_ID AND D.LINK_YR = A.LINK_YR AND D.CRS_CD = A.CRS_CD AND D.CRS_CDN = A.CRS_CDN AND E.LINK_YR = A.LINK_YR AND E.CRS_CD = A.CRS_CD AND A.LINK_YR = #LINK_YR# AND A.CRS_CD = #strEDU_CRS_CD# AND A.CRS_CDN = #CRS_CDN# GROUP BY B.BLL_SBJCT_NM , C.INFO_RLPR_NM , C.PFSR_BLT_NM , C.PFSR_RANK_NM , D.CRS_CHIF_NM , E.TKCG_DEPT_NM ORDER BY B.BLL_SBJCT_NM, C.PFSR_BLT_NM, C.PFSR_RANK_NM, C.INFO_RLPR_NM ) A