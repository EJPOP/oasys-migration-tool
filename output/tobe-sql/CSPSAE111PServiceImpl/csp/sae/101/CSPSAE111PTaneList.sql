WITH DATA AS ( SELECT A.GRNDS_EXMN_AEX_SQNO /* 현장조사수용비순번 */,
    A.NPL_BLT_NM,
    A.JBGD_NM /* 직급명 */,
    A.INFO_RLPR_NM /* 정보관계자명 */
FROM ( SELECT A.NPL_BLT_NM,
    A.JBGD_NM /* 직급명 */,
    A.INFO_RLPR_NM /* 정보관계자명 */,
    A.GRNDS_EXMN_AEX_SQNO /* 현장조사수용비순번 */
FROM TBCSPSAE301D A WHERE 1=1 AND A.LINK_YR = #LINK_YR# AND A.CRS_CD = #strEDU_CRS_CD# AND CRS_CDN = #CRS_CDN# ORDER BY A.GRNDS_EXMN_AEX_SQNO, A.TANE_ID ) A ) SELECT A.SNO1,
    A.NPL_BLT_NM1,
    A.RANK_NM1,
    A.NAM1,
    B.SNO2,
    B.NPL_BLT_NM2,
    B.RANK_NM2,
    B.NAM2
FROM ( SELECT ROWNUM,
    DECODE(MOD(DATA.GRNDS_EXMN_AEX_SQNO, 2), 1, DATA.GRNDS_EXMN_AEX_SQNO) AS MOD,
    DECODE(MOD(DATA.GRNDS_EXMN_AEX_SQNO, 2), 1, DATA.NPL_BLT_NM) AS MOD,
    DECODE(MOD(DATA.GRNDS_EXMN_AEX_SQNO, 2), 1, DATA.JBGD_NM) AS MOD,
    DECODE(MOD(DATA.GRNDS_EXMN_AEX_SQNO, 2), 1, DATA.INFO_RLPR_NM) AS MOD
FROM DATA WHERE DECODE(MOD(DATA.GRNDS_EXMN_AEX_SQNO, 2), 1, DATA.GRNDS_EXMN_AEX_SQNO) IS NOT NULL ) A , ( SELECT ROWNUM,
    DECODE(MOD(DATA.GRNDS_EXMN_AEX_SQNO, 2), 0, DATA.GRNDS_EXMN_AEX_SQNO) AS MOD,
    DECODE(MOD(DATA.GRNDS_EXMN_AEX_SQNO, 2), 0, DATA.NPL_BLT_NM) AS MOD,
    DECODE(MOD(DATA.GRNDS_EXMN_AEX_SQNO, 2), 0, DATA.JBGD_NM) AS MOD,
    DECODE(MOD(DATA.GRNDS_EXMN_AEX_SQNO, 2), 0, DATA.INFO_RLPR_NM) AS MOD
FROM DATA WHERE DECODE(MOD(DATA.GRNDS_EXMN_AEX_SQNO, 2), 0, DATA.GRNDS_EXMN_AEX_SQNO) IS NOT NULL ) B WHERE A.SEQ1 = B.SEQ2(+)