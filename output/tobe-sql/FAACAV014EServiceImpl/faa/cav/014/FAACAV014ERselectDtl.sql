/* faa/cav/014/FAACAV014ERselectDtl */ SELECT AAA.증명책임자부호,
    AAA.증명년월,
    AAA.접수일시,
    AAA.검산일시,
    AAA.기관명,
    AAA.담당자,
    AAA.전화번호,
    BBB.구분,
    BBB.예산과목,
    BBB.불부합내역,
    BBB.계산서금액,
    BBB.재계산금액,
    BBB.불부합차액
FROM ( SELECT A.JRSD_CD||'-'||A.ACNTG_CD||'-'||A.BLL_KDCD||'-'||A.PROF_RBPRSN_SQNO||'-'||A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS 증명책임자부호 AS JRSD_CD /* 소관코드 */,
    SUBSTR(A.PROF_YM, 1, 4) || '. ' || SUBSTR(A.PROF_YM, 5, 2) || '.' AS 증명년월 AS PROF_YM /* 증명연월 */,
    TO_CHAR(A.BLL_RCPT_DT, 'YYYY.MM.DD HH24:MI:SS') AS 접수일시 AS BLL_RCPT_DT /* 계산서접수일시 */,
    TO_CHAR(A.PRCS_DT, 'YYYY.MM.DD HH24:MI:SS') AS 검산일시 AS PRCS_DT /* 처리일시 */,
    B.PROF_RBPRSN_INST_NM AS 기관명 AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    PROF_RBPRSN_MDFR_NM AS 담당자 AS PROF_RBPRSN_MDFR_NM /* 증명책임자수정자명 */,
    CRU_TELNO AS 전화번호 AS CRU_TELNO /* 부패전화번호 */
FROM TWFAACAV016M A , TWFAACAV003M B WHERE 1 = 1 AND A.JRSD_CD = B.JRSD_CD AND A.ACNTG_CD = B.ACNTG_CD AND A.BLL_KDCD = B.BLL_KDCD AND A.PROF_RBPRSN_SQNO = B.PROF_RBPRSN_SQNO AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = B.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND A.JRSD_CD = #JRSD_CD# AND A.ACNTG_CD = #ACNTG_CD# AND A.BLL_KDCD = #BLL_KDCD# AND A.PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND A.PROF_YM = #PROF_YM# ORDER BY 증명책임자부호 ) AAA, ( SELECT A.JRSD_CD||'-'||A.ACNTG_CD||'-'||A.BLL_KDCD||'-'||A.PROF_RBPRSN_SQNO||'-'||A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS 증명책임자부호 AS JRSD_CD /* 소관코드 */,
    A.SUM_SE_ID AS 구분 AS SUM_SE_ID /* 합계구분아이디 */,
    CASE WHEN A.BLL_KDCD = '28' AND A.SUM_SE_ID ='49' THEN '합계' ELSE A.ERR_SBJCT_NM END AS 예산과목 AS BLL_KDCD /* 계산서종류코드 */,
    A.DISAG_CD AS 불부합코드 AS DISAG_CD /* 불부합코드 */,
    NVL(B.RMRK_DTL_CN,A.DISAG_CD) AS 불부합내역 AS RMRK_DTL_CN /* 비고상세내용 */,
    CAST(A.BLL_AMT AS char(18)) AS 계산서금액 AS BLL_AMT /* 계산서금액 */,
    CAST(A.RECAL_AMT AS char(18)) AS 재계산금액 AS RECAL_AMT /* 재계산금액 */,
    CAST(A.CHEK_MGN AS char(18)) AS 불부합차액 AS CHEK_MGN /* 검산차액 */
FROM TWFAACAV017D A, TWFAACAV024C B WHERE B.ACNTG_SECD(+) = '12' AND A.JRSD_CD = #JRSD_CD# AND A.ACNTG_CD = #ACNTG_CD# AND A.BLL_KDCD = #BLL_KDCD# AND A.PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND A.PROF_YM = #PROF_YM# AND B.ACNTG_CD(+) = A.DISAG_CD ORDER BY 증명책임자부호 ) BBB WHERE AAA.증명책임자부호 = BBB.증명책임자부호 ORDER BY BBB.증명책임자부호, BBB.구분, BBB.예산과목, BBB.불부합코드