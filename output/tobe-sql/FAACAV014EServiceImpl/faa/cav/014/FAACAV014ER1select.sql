/* faa/cav/014/FAACAV014ER1select */ SELECT D1.JRSD_CD || '-' || D1.ACNTG_CD || '-' || D1.BLL_KDCD || '-' || D1.PROF_RBPRSN_SQNO || '-' || D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS 증명책임자부호 AS JRSD_CD /* 소관코드 */,
    SUBSTR(D1.PROF_YM, 1, 4) AS 검산결과년 AS PROF_YM /* 증명연월 */,
    SUBSTR(D1.PROF_YM, 5, 2) AS 검산결과월 AS PROF_YM /* 증명연월 */,
    TO_CHAR(D1.BLL_RCPT_DT, 'YYYY. MM. DD. HH24:MI:SS') AS 접수일시 AS BLL_RCPT_DT /* 계산서접수일시 */,
    TO_CHAR(D1.PRCS_DT, 'YYYY') AS 검산년 AS PRCS_DT /* 처리일시 */,
    TO_CHAR(D1.PRCS_DT, 'MM') AS 검산월 AS PRCS_DT /* 처리일시 */,
    TO_CHAR(D1.PRCS_DT, 'DD') AS 검산일 AS PRCS_DT /* 처리일시 */,
    ( SELECT AS ACNTG_CDNM /* 회계코드명 */
FROM TWFAACAV024C WHERE ACNTG_SECD = '02' AND ACNTG_CD = D1.JRSD_CD ) AS 소속기관 , D3.PROF_RBPRSN_INST_NM AS 증명기관 , ( SELECT ACNTG_CDNM /* 회계코드명 */
FROM TWFAACAV024C WHERE ACNTG_SECD = '01' AND ACNTG_CD = D1.ACNTG_CD ) AS 회계명 , F_DPT_INFO(RPAD(D3.PROF_RBPRSN_RB_SECD,3,'0')||RPAD(D3.PROF_RBPRSN_CPD_SECD,3,'0'), '9') AS 주무과 , D3.PROF_RBPRSN_MDFR_NM AS 담당자 , D3.PROF_RBPRSN_TELNO AS 전화번호 , F_AV_BLL_CD_NM( D1.BLL_KDCD, D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO ) AS 계산서명 , D2.SUM_SE_ID AS 구분 , ( CASE WHEN D2.SUM_SE_ID = '51' THEN '월계' WHEN D2.SUM_SE_ID = '49' THEN '합계' ELSE D2.ERR_SBJCT_NM END ) AS 예산과목 , ( SELECT RMRK_DTL_CN /* 비고상세내용 */
FROM TWFAACAV024C WHERE ACNTG_SECD = '12' AND ACNTG_CD = D2.DISAG_CD ) AS 내용 , D2.BLL_AMT AS 계산증명금액 , D2.RECAL_AMT AS 검산금액 , D2.CHEK_MGN AS 불부합금액 , (SELECT DISAG_NO /* 불부합번호 */
FROM TWFAACAV019M WHERE JRSD_CD = D1.JRSD_CD AND ACNTG_CD = D1.ACNTG_CD AND BLL_KDCD = D1.BLL_KDCD AND PROF_RBPRSN_SQNO = D1.PROF_RBPRSN_SQNO AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND PROF_YM = D1.PROF_YM) AS 불부합번호 , D1.PRCS_STTS_YN AS 처리상태 FROM TWFAACAV016M D1 , TWFAACAV017D D2 , TWFAACAV003M D3 WHERE D1.JRSD_CD = D2.JRSD_CD AND D1.ACNTG_CD = D2.ACNTG_CD AND D1.BLL_KDCD = D2.BLL_KDCD AND D1.PROF_RBPRSN_SQNO = D2.PROF_RBPRSN_SQNO AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = D2.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND D1.PROF_YM = D2.PROF_YM AND D1.JRSD_CD = D3.JRSD_CD AND D1.ACNTG_CD = D3.ACNTG_CD AND D1.BLL_KDCD = D3.BLL_KDCD AND D1.PROF_RBPRSN_SQNO = D3.PROF_RBPRSN_SQNO AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = D3.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND D1.PRCS_STTS_YN IN ('K','S') AND D1.PROF_YM = #PROF_YM#||#strMm# AND 1 = ( CASE WHEN #BLL_KDCD# IN ( '17', '18' ) THEN CASE WHEN #strFildSsecYn# = 'N' THEN CASE WHEN D1.BLL_KDCD IN ( '17', '18' ) AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' THEN 1 ELSE 0 END ELSE CASE WHEN D1.BLL_KDCD IN ( '17', '18' ) AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO != '000' THEN 1 ELSE 0 END END WHEN #BLL_KDCD# IN ( '22', '23', '24' ) THEN CASE WHEN #strFildSsecYn# = 'N' THEN CASE WHEN D1.BLL_KDCD IN ( '22', '23', '24' ) AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' THEN 1 ELSE 0 END ELSE CASE WHEN D1.BLL_KDCD IN ( '22', '23', '24' ) AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO != '000' THEN 1 ELSE 0 END END WHEN #BLL_KDCD# IN ( '19' ) THEN CASE WHEN #strFildSsecYn# = 'N' THEN CASE WHEN D1.BLL_KDCD IN ( '19' ) AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' THEN 1 ELSE 0 END ELSE CASE WHEN D1.BLL_KDCD IN ( '19' ) AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO != '000' THEN 1 ELSE 0 END END WHEN #BLL_KDCD# IN ( '42', '43' ) THEN CASE WHEN #strFildSsecYn# = 'N' THEN CASE WHEN D1.BLL_KDCD IN ( '42', '43' ) AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' THEN 1 ELSE 0 END ELSE CASE WHEN D1.BLL_KDCD IN ( '42', '43' ) AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO != '000' THEN 1 ELSE 0 END END ELSE CASE WHEN #strFildSsecYn# = 'N' THEN CASE WHEN D1.BLL_KDCD = #BLL_KDCD# AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' THEN 1 ELSE 0 END ELSE CASE WHEN D1.BLL_KDCD = #BLL_KDCD# AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO != '000' THEN 1 ELSE 0 END END END ) AND D1.JRSD_CD BETWEEN DECODE(#strCoptCd#, NULL, '000', '', '000', #strCoptCd#, #strCoptCd#) AND DECODE(#strCoptCd2#, NULL, '999', '', '999', #strCoptCd#, #strCoptCd2#) AND D1.ACNTG_CD BETWEEN DECODE(#strAcntCd#, NULL, '000', '', '000', #strAcntCd#, #strAcntCd#) AND DECODE(#strAcntCd2#, NULL, '999', '', '999', #strAcntCd2#, #strAcntCd2#) AND D1.BLL_KDCD BETWEEN DECODE(#strBllCd#, NULL, '00', '', '00', #strBllCd#, #strBllCd#) AND DECODE(#strBllCd2#, NULL, '99', '', '99', #strBllCd2#, #strBllCd2#) AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO != '000' AND D1.JRSD_CD||D1.ACNTG_CD||D1.BLL_KDCD||D1.PROF_RBPRSN_SQNO||D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO BETWEEN DECODE(#strCoptCd#, NULL, '000', '', '000', #strCoptCd#, #strCoptCd#)||DECODE(#strAcntCd#, NULL, '000', '', '000', #strAcntCd#, #strAcntCd#)||DECODE(#strBllCd#, NULL, '00', '', '00', #strBllCd#, #strBllCd#)||DECODE(#strProfDrtrSrno#, NULL, '000', '', '000', #strProfDrtrSrno#, #strProfDrtrSrno#)||DECODE(#strDlXpnRcdbPbsvtSrno#, NULL, '001', '', '001', #strDlXpnRcdbPbsvtSrno#, #strDlXpnRcdbPbsvtSrno#) AND DECODE(#strCoptCd2#, NULL, '999', '', '999', #strCoptCd2#, #strCoptCd2#)||DECODE(#strAcntCd2#, NULL, '999', '', '999', #strAcntCd2#, #strAcntCd2#)||DECODE(#strBllCd2#, NULL, '99', '', '99', #strBllCd2#, #strBllCd2#)||DECODE(#strProfDrtrSrno2#, NULL, '999', '', '999', #strProfDrtrSrno2#, #strProfDrtrSrno2#)||DECODE(#strDlXpnRcdbPbsvtSrno2#, NULL, '999', '', '999', #strDlXpnRcdbPbsvtSrno2#, #strDlXpnRcdbPbsvtSrno2#) AND D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND D1.JRSD_CD||D1.ACNTG_CD||D1.BLL_KDCD||D1.PROF_RBPRSN_SQNO||D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO BETWEEN DECODE(#strCoptCd#, NULL, '000', '', '000', #strCoptCd#, #strCoptCd#)||DECODE(#strAcntCd#, NULL, '000', '', '000', #strAcntCd#, #strAcntCd#)||DECODE(#strBllCd#, NULL, '00', '', '00', #strBllCd#, #strBllCd#)||DECODE(#strProfDrtrSrno#, NULL, '000', '', '000', #strProfDrtrSrno#, #strProfDrtrSrno#)||'000' AND DECODE(#strCoptCd2#, NULL, '999', '', '999', #strCoptCd2#, #strCoptCd2#)||DECODE(#strAcntCd2#, NULL, '999', '', '999', #strAcntCd2#, #strAcntCd2#)||DECODE(#strBllCd2#, NULL, '99', '', '99', #strBllCd2#, #strBllCd2#)||DECODE(#strProfDrtrSrno2#, NULL, '999', '', '999', #strProfDrtrSrno2#, #strProfDrtrSrno2#)||'000' ORDER BY D1.JRSD_CD , D1.ACNTG_CD , D1.BLL_KDCD , D1.PROF_RBPRSN_SQNO , D1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO , D1.PROF_YM