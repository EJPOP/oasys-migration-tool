SELECT MAX(CASE WHEN ROW_ID = 1 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 2 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 3 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 4 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 5 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 6 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 7 THEN JBPS_NM ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 1 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 2 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 3 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 4 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 5 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 6 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID,
    MAX(CASE WHEN ROW_ID = 7 THEN CASE WHEN APV_DH IS NULL THEN PROF_RBPRSN_APRVR_NM ELSE PROF_RBPRSN_APRVR_NM||CHR(10)||'('||APV_DH||')' END ELSE NULL END) AS ROW_ID
FROM ( SELECT ATRZ_DOC_NO /* 결재문서번호 */,
    APV_SNO,
    PROF_RBPRSN_APRVR_NM /* 증명책임자결재자명 */,
    APV_DH,
    JBPS_NM /* 직위명 */,
    ROW_NUMBER() OVER (ORDER BY APV_SNO) AS ROW_NUMBER
FROM ( SELECT ATRZ_DOC_NO /* 결재문서번호 */,
    APV_SNO,
    CASE WHEN APRVR_JBPS_SECD IS NULL THEN ONR_PST_NM ELSE F_CODE_NM('1000176', APRVR_JBPS_SECD) END AS JBPS_NM /* 직위명 */,
    F_USR_INFO(APRVR_ENO, '2') AS PROF_RBPRSN_APRVR_NM /* 증명책임자결재자명 */,
    CASE WHEN SUBSTR(APVR_STA_CD, 0, 1) = '2' THEN TO_CHAR(APV_DH, 'YYYY-MM-DD') ELSE NULL END AS SUBSTR
FROM TBDCMACM023L WHERE APV_SNO <> '1' AND APRVR_KDCD NOT IN ('4','6','7') AND ATRZ_DOC_NO = ( SELECT ATRZ_DOC_NO /* 결재문서번호 */
FROM TBCSPCOR101M S1 WHERE S1.CVLCPT_SECD = #CVLCPT_SECD# AND S1.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND S1.CVLCPT_RCPT_NO = #CVLCPT_RCPT_NO# ) ) )