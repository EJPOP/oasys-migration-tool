INSERT INTO TBCSPAOE017D (EVL_YR, HLYR_DVSN_CD, CVLCPT_TASK_SECD, AUD_TSK_KND_CD, CHGR_DVSN_CD, PIC_ENO, EVL_CMTR_NO, BLT_DPT_CD, JBGD_SECD, FRST_USER_ID, LAST_USER_ID, LAST_PRCS_DEPT_CD, LAST_MENU_ID, FRST_REG_DT, LAST_MDFCN_DT) SELECT #strEvlYr#,
    #strHlyrDvsnCd#,
    #CVLCPT_TASK_SECD#,
    #strAudTskKndCd#,
    'CD01',
    CASE WHEN D3.TRGT_NOP_ENO IS NOT NULL THEN D3.TRGT_NOP_ENO ELSE 'X' || ROWNUM END AS TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    ( ROWNUM - 1 ) + (SELECT NVL(MAX(EVL_CMTR_NO), 0) + 1
FROM TBCSPAOE017D WHERE EVL_YR = #strEvlYr# AND HLYR_DVSN_CD = #strHlyrDvsnCd# AND CVLCPT_TASK_SECD = #CVLCPT_TASK_SECD# AND AUD_TSK_KND_CD = #strAudTskKndCd# AND CHGR_DVSN_CD = 'CD01' ) AS EVL_CMTR_NO , NVL(D3.SRECS_DEPT_CD, D4.BLT_DPT_CD) AS SRECS_DEPT_CD , D3.JBGD_SECD , #FRT_USR_ID# , #FNL_USR_ID# , #FNL_DEAL_DPT_CD# , #FNL_MNU_ID# , SYSDATE , SYSDATE FROM ( SELECT D1.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    D1.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    D1.JBGD_SECD /* 직급구분코드 */
FROM TBDCMACM001M D1 , TBDCMACM002M D2 WHERE D1.SRECS_DEPT_CD = D2.SRECS_DEPT_CD AND D2.DEPT_TPCD = 'S' /*지원부서*/ AND D2.USE_YN = 'Y' AND D1.JBPS_CD IN ('0013600', '0096800', '0035400') /*과장, 팀장, 담당관 15.01.28 최원형감사관님 요청.*/ AND D1.SRECS_DEPT_CD NOT IN ('770770', '300210', '300220', '300230', '100100') /*감사원, 연구1,2,3팀, 감찰담당관 제외 15.01.29 최원형감사관님 요청. 앞으로 쭉 평가대상제외부서*/ AND D1.USER_NM NOT LIKE 'test%' /*test로 들어간 정보들은 제거한다*/ ) D3 FULL OUTER JOIN ( SELECT BLT_DPT_CD
FROM TBCSPAOE017D WHERE EVL_YR = #strCopyEvlYr# AND HLYR_DVSN_CD = #strCopyHlyrDvsnCd# AND CVLCPT_TASK_SECD = '10002' AND AUD_TSK_KND_CD = '10000' AND CHGR_DVSN_CD = 'CD01' GROUP BY BLT_DPT_CD ) D4 ON D3.SRECS_DEPT_CD = D4.BLT_DPT_CD