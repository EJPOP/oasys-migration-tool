SELECT (SELECT AS HIRK_DPT_CD
FROM TBDCMACM002M WHERE SRECS_DEPT_CD = T2.IMPL_MNG_JRSD_DEPT_CD AND ROWNUM = 1) AS HIRK_ENFM_MNG_BRDV_CD , (SELECT F_DPT_INFO(ST1.HIRK_DPT_CD, '1')
FROM TBDCMACM002M ST1 WHERE ST1.SRECS_DEPT_CD = T2.IMPL_MNG_JRSD_DEPT_CD AND ROWNUM = 1) AS HIRK_ENFM_MNG_BRDV_NM , T2.IMPL_MNG_JRSD_DEPT_CD , F_DPT_INFO(T2.IMPL_MNG_JRSD_DEPT_CD, '1') AS ENFM_MNG_BRDV_NM , (SELECT ADT_MTTR_NM /* 감사사항명 */
FROM TB_BADDED001M ST1 WHERE 1 = 1 AND ST1.CVLCPT_ADT_YR||ST1.ADT_NO = T2.CVLCPT_ADT_YR||T2.ADT_NO ) AS ADT_MTTR_NM , T1.DSPS_RQT_KDCD AS DSPS_RQT_KDCD , F_CODE_NM('1000002', T1.DSPS_RQT_KDCD) AS DSPS_RQT_KND_CVN , SUM(1) AS "TOT_CNT" , SUM( CASE WHEN T2.DSPS_RQT_ATRZ_STTS_SECD = '1' OR T2.DSPS_RQT_ATRZ_STTS_SECD = '5' OR T2.DSPS_RQT_ATRZ_STTS_SECD IS NULL THEN 1 ELSE 0 END ) AS "NONEPLAY_CNT" , SUM( CASE WHEN T2.DSPS_RQT_ATRZ_STTS_SECD = '2' THEN 1 ELSE 0 END ) AS "PLAY_CNT" , SUM( CASE WHEN T2.DSPS_RQT_ATRZ_STTS_SECD = '3' THEN 1 ELSE 0 END ) AS "ENTER_CNT" , SUM( CASE WHEN T2.DSPS_RQT_ATRZ_STTS_SECD = '4' THEN 1 ELSE 0 END ) AS "CANCLE_CNT" FROM TB_BADEAR001M T1 , TB_BADEAR002D T2 , TB_BADDED001M J1 , (SELECT ST1.ADT_YR /* 감사년도 */,
    ST1.ADT_NO /* 감사번호 */,
    ST1.DSPS_RQT_SQNO /* 처분요구순번 */,
    COUNT(ST1.IMPL_URG_SQNO) AS IMPL_URG_SQNO /* 집행독촉순번 */
FROM TBBADFRE009M ST1 WHERE 1 = 1 GROUP BY ST1.CVLCPT_ADT_YR, ST1.ADT_NO, ST1.DSPS_RQT_SQNO ) T3 WHERE 1 = 1 AND T1.CVLCPT_ADT_YR = T2.CVLCPT_ADT_YR AND T1.ADT_NO = T2.ADT_NO AND T1.DSPS_RQT_SQNO = T2.DSPS_RQT_SQNO AND T2.CVLCPT_ADT_YR = T3.CVLCPT_ADT_YR(+) AND T2.ADT_NO = T3.ADT_NO(+) AND T2.DSPS_RQT_SQNO = T3.DSPS_RQT_SQNO(+) AND T1.CVLCPT_ADT_YR = J1.ADT_YR AND T1.ADT_NO = J1.ADT_NO /* 속도개선으로 쿼리로 변경 2015.05.13 yyh */ AND 'Y' = (CASE WHEN (#strAudYr# = '' AND #strAudGrnNo# = '' AND #strAudYrTo# = '' AND #strAudGrnNoTo# = '') THEN 'Y' ELSE (CASE WHEN LPAD(T1.CVLCPT_ADT_YR, 4, '0') || LPAD(J1.ADT_GRNT_NO, 3, '0') BETWEEN LPAD(NVL(#strAudYr#, '1700'), 4, '0') || LPAD(NVL(#strAudGrnNo#, '000'), 3, '0') AND LPAD(NVL(#strAudYrTo#, '9999'), 4, '0') || LPAD(NVL(#strAudGrnNoTo#, '999'), 3, '0') THEN 'Y' ELSE 'N' END) END) AND NVL(T2.ENFC_YMD, '19000101') BETWEEN NVL(#strEnfDtFrom#, '17000101') AND NVL(#strEnfDtTo#, '99991231') AND NVL(T2.IMPL_WHLS_CFMTN_YMD, '19000101') BETWEEN NVL(#strConfirmDtFrom#, '17000101') AND NVL(#strConfirmDtTo#, '99991231') AND T1.DSPS_RQT_KDCD IN ('110', '210', '310', '320', '391', '800', '810', '820', '830', '840', '850') AND T2.CFMTN_STTS_SECD IN ('1','2') AND T2.IMPL_MNG_JRSD_DEPT_CD IN (SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TABLE(F_AUTH_DEPT(#S_CNB#, #strDptAuth#, '', #strUpSpvBrdvCd#))) AND T2.CMO_INST_CD = #CMO_INST_CD# AND T2.IMPL_MNG_JRSD_DEPT_CD = #IMPL_MNG_JRSD_DEPT_CD# /* 감사연번종류코드 추가 - 2015.12.24 yyh 감사연번종류코드 from ~ to 에서 한개로 변경 - 2016.06.02 yyh */ AND SUBSTR(J1.ADT_KDCD,3,1) = NVL(#strAudYrNoKndCdSt#,'0') GROUP BY T2.IMPL_MNG_JRSD_DEPT_CD , T2.CVLCPT_ADT_YR||T2.ADT_NO , T1.DSPS_RQT_KDCD ORDER BY T2.IMPL_MNG_JRSD_DEPT_CD , T2.CVLCPT_ADT_YR||T2.ADT_NO , T1.DSPS_RQT_KDCD