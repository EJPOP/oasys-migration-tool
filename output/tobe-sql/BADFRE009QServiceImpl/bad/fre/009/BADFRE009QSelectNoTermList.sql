SELECT DECODE(T.T7TERM_FLAG,1,'1개월 미만',2,'1개월 경과 2개월 미만' ,3,'2개월 경과 3개월 미만',4,'3개월 경과 1년 미만' ,5,'1년 경과 2년 미만',6,'2년 경과 5년 미만' ,7,'5년 경과 10년 미만',8,'10년 이상' ,'합계') AS T7TERM_FLAG,
    T.T7TOT_CNT,
    ROUND(T.T7TOT_CNT / T.T7TOT_SUM1 * 100, 1) || ' %' AS ROUND,
    T.T7ITEM1_CNT,
    T.T7ITEM2_CNT,
    T.T7ITEM3_CNT,
    T.T7ITEM5_CNT
FROM ( SELECT CASE WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 1 ), 'YYYYMMDD') > TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '1' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 1 ), 'YYYYMMDD') TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '2' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 2 ), 'YYYYMMDD') TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '3' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 3 ), 'YYYYMMDD') TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '4' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 12*1), 'YYYYMMDD') TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '5' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 12*2), 'YYYYMMDD') TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '6' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 12*5), 'YYYYMMDD') TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '7' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 12*10), 'YYYYMMDD') 'Y' OR DETAIL.CFMTN_YN IS NULL) AND DETAIL.PRCS_TERM_YMD AND SUBSTR(J1.ADT_KDCD,3,1) = NVL(#strAudYrNoKndCdSt#,'0') AND DETAIL.CMO_INST_CD = #CMO_INST_CD# AND DETAIL.IMPL_MNG_JRSD_DEPT_CD = #IMPL_MNG_JRSD_DEPT_CD# GROUP BY ROLLUP(CASE WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 1 ), 'YYYYMMDD') > TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '1' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 1 ), 'YYYYMMDD') TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '2' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 2 ), 'YYYYMMDD') TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '3' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 3 ), 'YYYYMMDD') TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '4' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 12*1), 'YYYYMMDD') TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '5' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 12*2), 'YYYYMMDD') TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '6' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 12*5), 'YYYYMMDD') TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '7' WHEN TO_CHAR(ADD_MONTHS(DETAIL.PRCS_TERM_YMD, 12*10), 'YYYYMMDD')<= TO_CHAR(SYSDATE, 'YYYYMMDD') THEN '8' END) ) T