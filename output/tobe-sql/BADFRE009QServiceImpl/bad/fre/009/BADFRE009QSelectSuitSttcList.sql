WITH BASE AS ( SELECT F_DPT_INFO(SUBSTR(IMPL_MNG_JRSD_DEPT_CD,0,3) || '000','1') AS F_DPT_INFO,
    F_DPT_INFO(IMPL_MNG_JRSD_DEPT_CD,'1') AS F_DPT_INFO,
    SUM(CASE WHEN (ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1') THEN 1 ELSE 0 END) AS ENFC_YMD /* 시행일자 */,
    SUM(CASE WHEN (ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) THEN 1 ELSE 0 END) AS ENFC_YMD /* 시행일자 */,
    SUM(CASE WHEN (ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND (CFMTN_STTS_SECD = '2') THEN 1 ELSE 0 END) AS ENFC_YMD /* 시행일자 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '110') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '120') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '210') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '310') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '320') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '390') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '391') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '410') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '490') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '510') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '520') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '530') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '610') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '611') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '620') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '621') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '623') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '630') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '710') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '720') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '730') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '810') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '820') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '830') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '840') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '850') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '904') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '905') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '910') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '911') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '912') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '913') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '914') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '915') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    SUM(CASE WHEN (DSPS_RQT_KDCD = '916') AND (((ENFC_YMD <= #strStdDt#) AND (CFMTN_STTS_SECD = '1')) OR ((ENFC_YMD BETWEEN #strEnfDtFrom# AND #strEnfDtTo#) AND CFMTN_STTS_SECD = '1')) THEN 1 ELSE 0 END) AS DSPS_RQT_KDCD /* 처분요구종류코드 */
FROM TB_BADEAR001M T1 ,TB_BADEAR002D T2 WHERE 1=1 AND T1.ADT_YR = T2.CVLCPT_ADT_YR AND T1.ADT_NO = T2.ADT_NO AND T1.DSPS_RQT_SQNO = T2.DSPS_RQT_SQNO AND T1.DSPS_RQT_KDCD IN ('110','210','310','320','391','620','621','623','630','510','520','530','610','611','810','820','830','840','850') AND T2.CFMTN_STTS_SECD IN ('1','2') AND T2.ENFC_YMD IS NOT NULL AND T2.IMPL_MNG_JRSD_DEPT_CD IS NOT NULL GROUP BY IMPL_MNG_JRSD_DEPT_CD ORDER BY IMPL_MNG_JRSD_DEPT_CD ) SELECT DPT_NM1,
    DPT_NM2,
    SUM_A,
    SUM_B,
    SUM_C,
    SUM_A + SUM_B - SUM_C AS SUM_A,
    DTL_1,
    DTL_2,
    DTL_3,
    DTL_4,
    DTL_5,
    DTL_6,
    DTL_7,
    DTL_8,
    DTL_9,
    DTL_10,
    DTL_11,
    DTL_12,
    DTL_13,
    DTL_14,
    DTL_15,
    DTL_16,
    DTL_17,
    DTL_18,
    DTL_19,
    DTL_20,
    DTL_21,
    DTL_22,
    DTL_23,
    DTL_24,
    DTL_25,
    DTL_26,
    DTL_27,
    DTL_28,
    DTL_29,
    DTL_30,
    DTL_31,
    DTL_32,
    DTL_33,
    DTL_34,
    DTL_35,
    DTL_1 + DTL_2 + DTL_3 + DTL_4 + DTL_5 + DTL_6 + DTL_7 + DTL_8 + DTL_9 + DTL_10 + DTL_11 + DTL_12 + DTL_13 + DTL_14 + DTL_15 + DTL_16 + DTL_17 + DTL_18 + DTL_19 + DTL_20 + DTL_21 + DTL_22 + DTL_23 + DTL_24 + DTL_25 + DTL_26 + DTL_27 + DTL_28 + DTL_29 + DTL_30 + DTL_31 + DTL_32 + DTL_33 + DTL_34 + DTL_35 AS DTL_1,
    (SUM_A + SUM_B - SUM_C) - (DTL_1 + DTL_2 + DTL_3 + DTL_4 + DTL_5 + DTL_6 + DTL_7 + DTL_8 + DTL_9 + DTL_10 + DTL_11 + DTL_12 + DTL_13 + DTL_14 + DTL_15 + DTL_16 + DTL_17 + DTL_18 + DTL_19 + DTL_20 + DTL_21 + DTL_22 + DTL_23 + DTL_24 + DTL_25 + DTL_26 + DTL_27 + DTL_28 + DTL_29 + DTL_30 + DTL_31 + DTL_32 + DTL_33 + DTL_34 + DTL_35) AS SUM_A
FROM BASE WHERE 1=1