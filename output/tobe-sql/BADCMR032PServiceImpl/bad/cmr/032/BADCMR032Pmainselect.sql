SELECT D.TASK_TIT_NM /* 과제명 */,
    F_DPT_INFO(D.CHR_DPT_CD, '1') AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    F_USR_INFO(D.PIC_ID, '2') AS PIC_NM /* 담당자명 */,
    #INFO_YR# AS INFO_YR /* 정보년도 */,
    #strTaskSno# AS #STRTASKSNO#,
    D.FIRST_HALF_MDF_DH /* 상반기 */,
    D.SECOND_HALF_MDF_DH /* 하반기 */,
    CASE WHEN D.FIRST_HALF_MDF_DH IS NOT NULL THEN (SELECT AS FIRST_HALF_MDF_DH
FROM TBBADCMR019D WHERE INFO_YR = #INFO_YR# AND TASK_SNO = #strTaskSno# AND REG_YMD = D.FIRST_HALF_MDF_DH) ELSE NULL END FIRST_HALF_MAIN_PLCY_DTL_TXT /*상반기 주요정책상세내용*/ , CASE WHEN SECOND_HALF_MDF_DH IS NOT NULL THEN (SELECT MAIN_PLCY_DTL_TXT
FROM TBBADCMR019D WHERE INFO_YR = #INFO_YR# AND TASK_SNO = #strTaskSno# AND REG_YMD = D.SECOND_HALF_MDF_DH) ELSE NULL END SECOND_HALF_MAIN_PLCY_DTL_TXT /*상반기 주요정책상세내용*/ ,FIRST_DOC_ID ,SECOND_DOC_ID FROM ( SELECT A.TASK_TIT_NM /* 과제제목명 */,
    A.CHR_DPT_CD /* 담당부서 */,
    A.PIC_ID /* 담당자아이디 */,
    MAX(CASE WHEN B.REG_YMD BETWEEN #INFO_YR#||'0101' AND #INFO_YR#||'0401' THEN B.REG_YMD ELSE NULL END) AS REG_YMD /* 등록일자 */,
    MAX(CASE WHEN B.REG_YMD BETWEEN #INFO_YR#||'0402' AND #INFO_YR#||'1001' THEN B.REG_YMD ELSE NULL END) AS REG_YMD /* 등록일자 */,
    MAX( CASE WHEN B.REG_YMD BETWEEN #INFO_YR#||'0101' AND #INFO_YR#||'0401' THEN B.CVLCPT_DOC_ID ELSE NULL END) AS REG_YMD /* 등록일자 */,
    MAX( CASE WHEN B.REG_YMD BETWEEN #INFO_YR#||'0402' AND #INFO_YR#||'1001' THEN B.CVLCPT_DOC_ID ELSE NULL END) AS REG_YMD /* 등록일자 */
FROM TBBADCMR016M A , TBBADCMR019D B WHERE A.INFO_YR = B.INFO_YR (+) AND A.TASK_SNO = B.TASK_SNO (+) AND A.INFO_YR = #INFO_YR# AND A.TASK_SNO = #strTaskSno# GROUP BY A.TASK_TIT_NM, A.CHR_DPT_CD, A.PIC_ID ) D