SELECT A.INFO_YR /* 정보년도 */,
    A.SALL_CAT_SNO,
    A.LAG_CAT_SNO,
    A.MID_CAT_SNO,
    A.SALL_CAT_TIT_NM,
    A.SALL_CAT_TXT,
    A.CHR_DPT_CD,
    F_DPT_INFO(A.CHR_DPT_CD,'1') AS TKCG_DEPT_NM /* 담당부서명 */,
    A.PIC_ID /* 담당자아이디 */,
    A.CMPTN_YN /* 완료여부 */,
    A.REG_YMD /* 등록일자 */,
    A.RGTR_ID /* 등록자아이디 */,
    A.MDFCN_YMD /* 수정일자 */,
    A.MDFCN_PIC_ID /* 수정담당자아이디 */,
    A.DEL_YN /* 삭제여부 */,
    A.INFO_YR||'-'||A.LAG_CAT_SNO||'-'||MID_CAT_SNO||'-'||SALL_CAT_SNO AS GRNDS_EXMN_AEX_SQNO /* 현장조사수용비순번 */,
    (select max(REG_YMD) AS REG_YMD /* 등록일자 */
from TBBADCMR004D where INFO_YR = A.INFO_YR and SALL_CAT_SNO = A.SALL_CAT_SNO and REG_YMD BETWEEN #INFO_YR#||'0101' AND #INFO_YR#||'0401' ) QT1_PLCY_MDF_DH ,(select max(REG_YMD) AS REG_YMD /* 등록일자 */
from TBBADCMR004D where INFO_YR = A.INFO_YR and SALL_CAT_SNO = A.SALL_CAT_SNO and REG_YMD BETWEEN #INFO_YR#||'0402' AND #INFO_YR#||'1001' ) QT2_PLCY_MDF_DH ,(SELECT SUBSTR(MAX(PLCY_MDF_DH), 0, 8)
FROM TBBADCMR004D WHERE INFO_YR = A.INFO_YR AND SALL_CAT_SNO = A.SALL_CAT_SNO AND REG_YMD BETWEEN #INFO_YR# ||'0101' AND #INFO_YR# ||'0401' ) AS FIRST_HALF_MDF_DH /*상반기 - 2015.06.03 yyh*/ ,(SELECT SUBSTR(MAX(PLCY_MDF_DH), 0, 8)
FROM TBBADCMR004D WHERE INFO_YR = A.INFO_YR AND SALL_CAT_SNO = A.SALL_CAT_SNO AND REG_YMD BETWEEN #INFO_YR# ||'0402' AND #INFO_YR# ||'1001' ) AS SECOND_HALF_MDF_DH /*하반기 - 2015.06.03 yyh*/ ,D.USER_NM AS CHRG_PSON_NM , A.CPR_CHGR_ID , F_USR_INFO(A.CPR_CHGR_ID,'2')AS CPR_CHGR_NM , A.CPR_DPT_CD , F_DPT_INFO(A.CPR_DPT_CD,'1') AS CPR_DPT_NM , A.STD_CHGR_ID , F_USR_INFO(A.STD_CHGR_ID,'2')AS STD_CHGR_NM , A.STD_DPT_CD , F_DPT_INFO(A.STD_DPT_CD,'1') AS STD_DPT_NM , NVL(EPS_MNG_YN,'N') AS EPS_MNG_YN FROM TBBADCMR003M A , TBDCMACM001M D WHERE D.BAI_USR_YN = 'Y' AND A.PIC_ID = D.TRGT_NOP_ENO(+) A.INFO_YR =#INFO_YR# ((A.CHR_DPT_CD LIKE #strHrkDptCd#||'%') OR A.CPR_DPT_CD = #strDptCd# OR A.STD_DPT_CD = #strDptCd# ) NVL(A.EPS_MNG_YN,'N') = #strEPS_MNG_YN# ORDER BY A.INFO_YR, CASE WHEN A.INFO_YR ='2017' AND A.SALL_CAT_SNO < 187 THEN 1 ELSE 0 END, A.SALL_CAT_SNO