SELECT A.SUBJ_CD,
    A.BLL_SBJCT_NM /* 계산서과목명 */,
    B.PFSR_ID,
    B.INFO_RLPR_NM /* 정보관계자명 */,
    B.PFSR_DVSN_CD,
    B.PFSR_RK_CD,
    A.BSC_OP_SUBJ_YN,
    A.USE_YN /* 사용여부 */
FROM TBCSPSAE101M A ,(SELECT SUBJ_CD,
    SUBSTR(MAX(SYS_CONNECT_BY_PATH(PFSR_ID, '/')), 2) AS SUBSTR,
    SUBSTR(MAX(SYS_CONNECT_BY_PATH(INFO_RLPR_NM, '/')), 2) AS INFO_RLPR_NM /* 정보관계자명 */,
    MAX(PFSR_DVSN_CD) AS PFSR_DVSN_CD,
    MAX(PFSR_RK_CD) AS PFSR_RK_CD,
    MAX(USE_YN) AS USE_YN /* 사용여부 */
FROM (SELECT ROW_NUMBER() OVER(PARTITION BY A.SUBJ_CD ORDER BY A.PFSR_ID) AS ROW_NUMBER,
    A.PFSR_ID,
    A.SUBJ_CD,
    B.INFO_RLPR_NM /* 정보관계자명 */,
    B.PFSR_DVSN_CD,
    B.PFSR_RK_CD,
    A.USE_YN /* 사용여부 */
FROM TBCSPSAE101L A , TBCSPSAE109M B WHERE 1=1 AND B.PFSR_ID = A.PFSR_ID AND A.PFSR_ID IN (SELECT A.PFSR_ID
FROM TBCSPSAE101L)) START WITH RNUM = 1 CONNECT BY PRIOR RNUM = RNUM-1 AND PRIOR SUBJ_CD = SUBJ_CD GROUP BY SUBJ_CD) B WHERE 1=1 AND B.SUBJ_CD(+) = A.SUBJ_CD AND UPPER(A.BLL_SBJCT_NM) LIKE '%' || UPPER(#strSUBJ_NM#) || '%' AND B.INFO_RLPR_NM LIKE '%' || #strNAM# || '%' AND A.BSC_OP_SUBJ_YN = #strBSC_OP_SUBJ_YN# ORDER BY A.BLL_SBJCT_NM