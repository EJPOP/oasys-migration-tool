/* faa/cav/042/FAACAV042EMainselect4 */ SELECT F_AV_BLL_COPT_CD_NM(A.JRSD_CD) AS F_AV_BLL_COPT_CD_NM,
    F_AV_ACNT_CD_NM(A.ACNTG_CD) AS ACNTG_CDNM /* 회계코드명 */,
    F_AV_ACCMN_NM(A.JRSD_CD,A.ACNTG_CD,A.BLL_KDCD, A.PROF_RBPRSN_SQNO, A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO) AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    A.PROF_RBPRSN_MDFR_NM||'('||CRU_TELNO||')' AS PROF_RBPRSN_MDFR_NM /* 증명책임자수정자명 */,
    A.JRSD_CD||'-'||A.ACNTG_CD||'-'||A.BLL_KDCD||'-'||A.PROF_RBPRSN_SQNO||'-'|| A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS JRSD_CD /* 소관코드 */,
    CASE WHEN A.PROF_RBPRSN_CRT_YMD = '999999' THEN '' ELSE SUBSTRING(A.PROF_RBPRSN_CRT_YMD,0,4)||'.'||SUBSTRING(A.PROF_RBPRSN_CRT_YMD,5,2) END AS PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    CASE WHEN A.PROF_RBPRSN_ABL_YMD = '999999' THEN '' ELSE SUBSTRING(A.PROF_RBPRSN_ABL_YMD,0,4)||'.'||SUBSTRING(A.PROF_RBPRSN_ABL_YMD,5,2) END AS PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    A.JRSD_CD /* 소관코드 */,
    A.ACNTG_CD /* 회계코드 */,
    A.BLL_KDCD /* 계산서종류코드 */,
    A.PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */
FROM TWFAACAV003M A WHERE A.BLL_KDCD IN('11','12') AND A.PROF_RBPRSN_ABL_YMD >= #strYr#||'00' AND A.PROF_RBPRSN_CRT_YMD = '10') THEN #strYr#||'04' ELSE #strYr#||'04' END)) AND NOT EXISTS( SELECT 1
FROM TWFAACAV055L C WHERE C.JRSD_CD = A.JRSD_CD AND C.ACNTG_CD = A.ACNTG_CD AND C.BLL_KDCD = A.BLL_KDCD AND C.PROF_RBPRSN_SQNO = A.PROF_RBPRSN_SQNO AND C.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND C.PROF_YM = ( CASE WHEN (SUBSTR(A.PROF_RBPRSN_ABL_YMD,1,4) = '10') THEN #strYr#||'04' ELSE #strYr#||'04' END)) ORDER BY JRSD_CD, ACNTG_CD, BLL_KDCD, PROF_RBPRSN_SQNO, GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO