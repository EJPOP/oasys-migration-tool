SELECT M.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    M.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    M.USER_NM /* 사용자명 */,
    M.JBGD_NM /* 직급명 */,
    (M.A1 + M.B1 + M.C1 + M.D1 + M.E1 + M.F1 + M.G1) AS A1,
    (M.A2 + M.C2) AS A2,
    NVL((M.A3 + M.C3),0) AS A3,
    TO_CHAR(M.B2 + M.F2 + M.G2, '999,990.99') AS TO_CHAR,
    M.A1,
    M.A2,
    M.A3,
    M.B1,
    TO_CHAR(M.B2,'999,990.99') AS TO_CHAR,
    M.C1,
    M.C2,
    M.C3,
    M.D1,
    M.E1,
    M.F1,
    TO_CHAR(M.F2,'999,990.99') AS TO_CHAR,
    M.G1,
    TO_CHAR(M.G2,'999,990.99') AS TO_CHAR
FROM (SELECT C.EXTT_ID AS EXTT_ID /* 적출자아이디 */,
    NVL(D.SRECS_DEPT_CD,'ZZZZZZ') AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    E.CNSTN_MBCMT_DEPT_NM AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    D.USER_NM AS USER_NM /* 사용자명 */,
    F_CODE_NM('1000173',D.JBGD_SECD) AS JBGD_NM /* 직급명 */,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='1' THEN 1 ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='1' THEN NVL(C.PNRT_PRSRV_AMT,0) ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='1' THEN NVL(C.IJS_AMT,0) ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='2' THEN 1 ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='2' THEN NVL(C.NOP_RT,0) ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='3' THEN 1 ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='3' THEN NVL(C.PNRT_PRSRV_AMT,0) ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='3' THEN NVL(C.IJS_AMT,0) ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='4' THEN 1 ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='5' THEN 1 ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='6' THEN 1 ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='6' THEN NVL(C.NOP_RT,0) ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='7' THEN 1 ELSE 0 END ) AS SUBSTR,
    SUM( CASE WHEN SUBSTR(A.DSPS_RQT_KDCD,1,1)='7' THEN NVL(C.NOP_RT,0) ELSE 0 END ) AS SUBSTR
FROM TBBADEAR001M A, TBBADEAR002D B, TBBADEAR004M C, TBDCMACM001M D, TBDCMACM002M E WHERE 1=1 AND B.CFMTN_STTS_SECD !='0' AND A.DSPS_RQT_KDCD <='730' AND B.ENFC_YMD BETWEEN #strStartFromDt#||'01' and #strStartToDt#||'31' AND A.CVLCPT_ADT_YR = B.CVLCPT_ADT_YR AND A.ADT_NO = B.ADT_NO AND A.DSPS_RQT_SQNO = B.DSPS_RQT_SQNO AND A.CVLCPT_ADT_YR = C.CVLCPT_ADT_YR AND A.ADT_NO = C.ADT_NO AND A.DSPS_RQT_SQNO = C.DSPS_RQT_SQNO AND C.EXTT_ID = D.TRGT_NOP_ENO(+) AND D.SRECS_DEPT_CD = E.SRECS_DEPT_CD(+) GROUP BY C.EXTT_ID ,D.SRECS_DEPT_CD ,E.CNSTN_MBCMT_DEPT_NM ,D.USER_NM ,D.JBGD_SECD ) M ORDER BY M.SRECS_DEPT_CD ,M.JBGD_NM ,M.USER_NM ,M.CNSTN_MBCMT_DEPT_NM