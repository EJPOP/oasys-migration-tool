SELECT B.DISP_REQ_NM,
    B.GUBUN,
    NVL(A.A2, 0) AS A2,
    NVL(A.A3, 0) AS A3,
    NVL(A.A4, 0) AS A4,
    TO_CHAR(NVL(A.A5,0),'999,990.99') AS TO_CHAR,
    NVL(A.BUNHO, #EXTT_ID#) AS BUNHO
FROM (SELECT CASE WHEN A.DSPS_RQT_KDCD = '611' THEN '01' WHEN A.DSPS_RQT_KDCD = '510' THEN '02' WHEN A.DSPS_RQT_KDCD = '110' THEN '03' WHEN A.DSPS_RQT_KDCD = '730' THEN '04' WHEN A.DSPS_RQT_KDCD = '310' THEN '05' WHEN A.DSPS_RQT_KDCD = '320' THEN '05' WHEN A.DSPS_RQT_KDCD = '720' THEN '06' WHEN A.DSPS_RQT_KDCD = '520' THEN '07' WHEN A.DSPS_RQT_KDCD = '410' THEN '08' WHEN A.DSPS_RQT_KDCD = '710' THEN '09' WHEN A.DSPS_RQT_KDCD = '210' THEN '10' WHEN A.DSPS_RQT_KDCD = '610' THEN '11' WHEN A.DSPS_RQT_KDCD = '630' THEN '12' WHEN A.DSPS_RQT_KDCD = '620' THEN '13' WHEN A.DSPS_RQT_KDCD = '621' THEN '13' WHEN A.DSPS_RQT_KDCD = '530' THEN '14' WHEN A.DSPS_RQT_KDCD = '390' THEN '15' WHEN A.DSPS_RQT_KDCD = '391' THEN '15' WHEN A.DSPS_RQT_KDCD = '490' THEN '16' WHEN A.DSPS_RQT_KDCD = '625' THEN '17' /* 통보(시정완료):625 추가 - 2016.11.23 yyh */ WHEN A.DSPS_RQT_KDCD = '395' THEN '18' /* 시정(국장전결):395 추가 - 2022.11.25 */ WHEN A.DSPS_RQT_KDCD = '396' THEN '18' /* 시정(국장전결):396 추가 - 2022.11.25 */ WHEN A.DSPS_RQT_KDCD = '495' THEN '19' /* 주의(국장전결):495 추가 - 2022.11.25 */ END AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    CASE WHEN NVL(C.CTB_RT,0) = 100 THEN '단독' ELSE '공동' END AS CTB_RT /* 기여비율 */,
    COUNT(C.CTB_RT) AS CTB_RT /* 기여비율 */,
    SUM(NVL(C.PNRT_PRSRV_AMT,0)) AS PNRT_PRSRV_AMT /* 추징회수보전금액 */,
    SUM(NVL(C.IJS_AMT,0)) AS IJS_AMT /* 부당금액 */,
    SUM(NVL(C.NOP_RT,0)) AS NOP_RT /* 인원비율 */,
    MAX(C.EXTT_ID) AS EXTT_ID /* 적출자아이디 */
from TBBADEAR001M A, TBBADEAR002D B, TBBADEAR004M C WHERE 1=1 AND B.CFMTN_STTS_SECD !='0' AND A.DSPS_RQT_KDCD <='730' AND C.EXTT_ID = #EXTT_ID# AND B.ENFC_YMD BETWEEN #strStartFromDt#||'01' and #strStartToDt#||'31' AND A.CVLCPT_ADT_YR = B.CVLCPT_ADT_YR AND A.ADT_NO = B.ADT_NO AND A.DSPS_RQT_SQNO = B.DSPS_RQT_SQNO AND A.CVLCPT_ADT_YR = C.CVLCPT_ADT_YR AND A.ADT_NO = C.ADT_NO AND A.DSPS_RQT_SQNO = C.DSPS_RQT_SQNO GROUP BY CASE WHEN A.DSPS_RQT_KDCD = '611' THEN '01' WHEN A.DSPS_RQT_KDCD = '510' THEN '02' WHEN A.DSPS_RQT_KDCD = '110' THEN '03' WHEN A.DSPS_RQT_KDCD = '730' THEN '04' WHEN A.DSPS_RQT_KDCD = '310' THEN '05' WHEN A.DSPS_RQT_KDCD = '320' THEN '05' WHEN A.DSPS_RQT_KDCD = '720' THEN '06' WHEN A.DSPS_RQT_KDCD = '520' THEN '07' WHEN A.DSPS_RQT_KDCD = '410' THEN '08' WHEN A.DSPS_RQT_KDCD = '710' THEN '09' WHEN A.DSPS_RQT_KDCD = '210' THEN '10' WHEN A.DSPS_RQT_KDCD = '610' THEN '11' WHEN A.DSPS_RQT_KDCD = '630' THEN '12' WHEN A.DSPS_RQT_KDCD = '620' THEN '13' WHEN A.DSPS_RQT_KDCD = '621' THEN '13' WHEN A.DSPS_RQT_KDCD = '530' THEN '14' WHEN A.DSPS_RQT_KDCD = '390' THEN '15' WHEN A.DSPS_RQT_KDCD = '391' THEN '15' WHEN A.DSPS_RQT_KDCD = '490' THEN '16' WHEN A.DSPS_RQT_KDCD = '625' THEN '17' WHEN A.DSPS_RQT_KDCD = '395' THEN '18' WHEN A.DSPS_RQT_KDCD = '396' THEN '18' WHEN A.DSPS_RQT_KDCD = '495' THEN '19' END ,CASE WHEN NVL(C.CTB_RT,0) = 100 THEN '단독' ELSE '공동' END ) A, (SELECT B.DSPS_RQT_KDCD /* 처분요구종류코드 */,
    CASE WHEN B.DSPS_RQT_KDCD = '01' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '02' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '03' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '04' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '05' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '06' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '07' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '08' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '09' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '10' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '11' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '12' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '13' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '14' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '15' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '16' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '17' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '18' THEN B.DISP_REQ_NM WHEN B.DSPS_RQT_KDCD = '19' THEN B.DISP_REQ_NM END AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    A.GUBUN
from (SELECT '단독' AS GUBUN
FROM DUAL UNION SELECT '공동' AS GUBUN
FROM DUAL ) A, (SELECT '01' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '권 고' AS DISP_REQ_NM
FROM DUAL UNION SELECT '02' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '법령개선' AS DISP_REQ_NM
FROM DUAL UNION SELECT '03' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '변상판정' AS DISP_REQ_NM
FROM DUAL UNION SELECT '04' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '수사자료' AS DISP_REQ_NM
FROM DUAL UNION SELECT '05' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '시 정' AS DISP_REQ_NM
FROM DUAL UNION SELECT '06' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '자체고발' AS DISP_REQ_NM
FROM DUAL UNION SELECT '07' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '제도개선' AS DISP_REQ_NM
FROM DUAL UNION SELECT '08' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '주 의' AS DISP_REQ_NM
FROM DUAL UNION SELECT '09' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '직접고발' AS DISP_REQ_NM
FROM DUAL UNION SELECT '10' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '징계문책' AS DISP_REQ_NM
FROM DUAL UNION SELECT '11' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '통 보' AS DISP_REQ_NM
FROM DUAL UNION SELECT '12' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '통보개선' AS DISP_REQ_NM
FROM DUAL UNION SELECT '13' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '통보인사' AS DISP_REQ_NM
FROM DUAL UNION SELECT '14' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '행정개선' AS DISP_REQ_NM
FROM DUAL UNION SELECT '15' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '현지시정' AS DISP_REQ_NM
FROM DUAL UNION SELECT '16' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '현지주의' AS DISP_REQ_NM
FROM DUAL UNION SELECT '17' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '통보(시정완료)' AS DISP_REQ_NM
FROM DUAL UNION SELECT '18' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '시정(국장전결)' AS DISP_REQ_NM
FROM DUAL UNION SELECT '19' AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    '주의(국장전결)' AS DISP_REQ_NM
FROM DUAL ) B ) B WHERE A.AA(+) = B.DSPS_RQT_KDCD AND A.A1(+) = B.GUBUN ORDER BY B.DISP_REQ_NM