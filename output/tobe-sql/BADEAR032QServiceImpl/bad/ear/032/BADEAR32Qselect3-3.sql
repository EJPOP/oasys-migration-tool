SELECT MAX(CASE WHEN T1.NM = '공동' THEN A2 ELSE 0 END) AS NM,
    MAX(CASE WHEN T1.NM = '공동' THEN A3 ELSE 0 END) AS NM,
    MAX(CASE WHEN T1.NM = '공동' THEN A4 ELSE 0 END) AS NM,
    TO_CHAR(MAX(CASE WHEN T1.NM = '공동' THEN A5 ELSE 0 END),'999,990.99') AS TO_CHAR,
    MAX(CASE WHEN T1.NM = '단독' THEN A2 ELSE 0 END) AS NM,
    MAX(CASE WHEN T1.NM = '단독' THEN A3 ELSE 0 END) AS NM,
    MAX(CASE WHEN T1.NM = '단독' THEN A4 ELSE 0 END) AS NM,
    TO_CHAR(MAX(CASE WHEN T1.NM = '단독' THEN A5 ELSE 0 END),'999,990.99') AS TO_CHAR
FROM ( SELECT '공동' AS NM,
    NVL(COUNT(C.CTB_RT),0) AS CTB_RT /* 기여비율 */,
    NVL(SUM(NVL(C.PNRT_PRSRV_AMT,0)),0) AS PNRT_PRSRV_AMT /* 추징회수보전금액 */,
    NVL(SUM(NVL(C.IJS_AMT,0)),0) AS IJS_AMT /* 부당금액 */,
    NVL(SUM(NVL(C.NOP_RT,0)),0) AS NOP_RT /* 인원비율 */
FROM TBBADEAR001M A ,TBBADEAR002D B ,TBBADEAR004M C WHERE 1=1 AND B.CFMTN_STTS_SECD !='0' AND A.DSPS_RQT_KDCD <='730' AND C.EXTT_ID = #EXTT_ID# AND B.ENFC_YMD BETWEEN #strStartFromDt#||'01' and #strStartToDt#||'31' AND A.CVLCPT_ADT_YR = B.CVLCPT_ADT_YR AND A.ADT_NO = B.ADT_NO AND A.DSPS_RQT_SQNO = B.DSPS_RQT_SQNO AND A.CVLCPT_ADT_YR = C.CVLCPT_ADT_YR AND A.ADT_NO = C.ADT_NO AND A.DSPS_RQT_SQNO = C.DSPS_RQT_SQNO AND NVL(C.CTB_RT,0) != 100 UNION ALL SELECT '단독' AS NM,
    NVL(COUNT(C.CTB_RT),0) AS CTB_RT /* 기여비율 */,
    NVL(SUM(NVL(C.PNRT_PRSRV_AMT,0)),0) AS PNRT_PRSRV_AMT /* 추징회수보전금액 */,
    NVL(SUM(NVL(C.IJS_AMT,0)),0) AS IJS_AMT /* 부당금액 */,
    NVL(SUM(NVL(C.NOP_RT,0)),0) AS NOP_RT /* 인원비율 */
FROM TBBADEAR001M A ,TBBADEAR002D B ,TBBADEAR004M C WHERE 1=1 AND B.CFMTN_STTS_SECD !='0' AND A.DSPS_RQT_KDCD <='730' AND C.EXTT_ID = #EXTT_ID# AND B.ENFC_YMD BETWEEN #strStartFromDt#||'01' and #strStartToDt#||'31' AND A.CVLCPT_ADT_YR = B.CVLCPT_ADT_YR AND A.ADT_NO = B.ADT_NO AND A.DSPS_RQT_SQNO = B.DSPS_RQT_SQNO AND A.CVLCPT_ADT_YR = C.CVLCPT_ADT_YR AND A.ADT_NO = C.ADT_NO AND A.DSPS_RQT_SQNO = C.DSPS_RQT_SQNO AND NVL(C.CTB_RT,0) = 100 ) T1