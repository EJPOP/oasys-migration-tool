SELECT /* CSPNBK511QDvdRtsListSelect */ D3.DVD_YR,
    D3.ELT_CRFW_PRF_M,
    D3.THTM_UN_DSP_PRF_SP,
    D3.THTM_PIA_DVD_M,
    D3.THTM_DVD_TG_PRF_M,
    D3.TOT_ACM,
    D4.TOT_DVD_AM,
    D3.THTM_DVD_TG_PRF_M - D4.TOT_DVD_AM AS THTM_DVD_TG_PRF_M,
    D3.WTDW_DVD_RTS,
    D3.NWD_DVD_RTS,
    D3.EX_DVD_RTS,
    D3.DVD_HNDL_STA_CD,
    D3.DVD_HNDL_STA_CD_NM
FROM ( SELECT D1.DVD_YR,
    D1.ELT_CRFW_PRF_M,
    D1.THTM_UN_DSP_PRF_SP,
    D1.THTM_PIA_DVD_M,
    D1.THTM_DVD_TG_PRF_M,
    NVL(D1.WTDW_ACM, 0 ) + NVL(D1.NWD_ACM, 0 ) + NVL(D1.EX_ACM, 0 ) AS WTDW_ACM,
    D1.WTDW_DVD_RTS,
    D1.NWD_DVD_RTS,
    D1.EX_DVD_RTS,
    D1.DVD_HNDL_STA_CD,
    F_CODE_NM( '1000159' , D1.DVD_HNDL_STA_CD) AS F_CODE_NM
FROM TBCSPNBK401M D1 D1.DVD_YR BETWEEN #beginDvdYr# AND #endDvdYr# D1.DVD_YR = #dvdYr# ) D3 , ( SELECT D2.DVD_YR,
    SUM(D2.DVD_AM) AS DVD_AM
FROM TBCSPNBK402M D2 D2.DVD_YR = #dvdYr# GROUP BY D2.DVD_YR ) D4 WHERE D3.DVD_YR = D4.DVD_YR ORDER BY D3.DVD_YR DESC