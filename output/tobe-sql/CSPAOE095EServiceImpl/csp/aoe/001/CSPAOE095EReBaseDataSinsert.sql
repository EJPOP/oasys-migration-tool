INSERT INTO TBCSPAOE034M (EVL_YR, HLYR_DVSN_CD, DPT_TYP_DVSN_CD, SRECS_DEPT_CD, DPT_NOP_CNT, FRST_USER_ID, LAST_USER_ID, LAST_PRCS_DEPT_CD, LAST_MENU_ID, FRST_REG_DT, LAST_MDFCN_DT) SELECT #strEvlYr# /* 평가년도 */,
    #strHlyrDvsnCd# /* 반기구분코드 */,
    '20' /* 부서유형구분코드 */,
    DPT.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NVL(CNT.CNT, 1) AS CNT /* 부서인원수 */,
    #FRT_USR_ID# AS FRST_USER_ID /* 최초사용자아이디 */,
    #FRT_USR_ID# AS FRST_USER_ID /* 최초사용자아이디 */,
    #FNL_DEAL_DPT_CD# AS LAST_PRCS_DEPT_CD /* 최종처리부서코드 */,
    #FNL_MNU_ID# AS LAST_MENU_ID /* 최종메뉴아이디 */,
    SYSDATE,
    SYSDATE
FROM (SELECT A.SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM (SELECT CHR_DPT_CD AS SRECS_DEPT_CD
FROM TBCSPAOE026M WHERE EVL_YR = #strEvlYr# AND HLYR_DVSN_CD = #strHlyrDvsnCd# GROUP BY CHR_DPT_CD) A WHERE NOT EXISTS (SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TBCSPAOE034M B WHERE B.EVL_YR = #strEvlYr# AND B.HLYR_DVSN_CD = #strHlyrDvsnCd# AND B.DPT_TYP_DVSN_CD = '20' AND A.SRECS_DEPT_CD = B.SRECS_DEPT_CD) ) DPT /*지원부서*/ , ( SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */,
    COUNT(TRGT_NOP_ENO) AS TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBDCMACM001M GROUP BY SRECS_DEPT_CD ) CNT /*처음에는 인사정보테이블에서 건수를 가져온다.*/ WHERE DPT.SRECS_DEPT_CD = CNT.SRECS_DEPT_CD (+)