SELECT A.CVLCPT_ADT_YR AS CVLCPT_ADT_YR /* 민원감사년도 */,
    A.ADT_NO AS ADT_NO /* 감사번호 */,
    F_MNG_KND_AUDYRNO(A.CVLCPT_ADT_YR, A.ADT_NO, A.ADT_KDCD, '-') AS ADT_CLSF_NO /* 감사분류번호 */,
    B.BZTRP_YR AS BZTRP_YR /* 출장년도 */,
    B.BZTRP_SQNO AS BZTRP_SQNO /* 출장순번 */,
    A.ADT_ASMT_SECD AS ADT_ASMT_SECD /* 감사과제구분코드 */,
    A.ADT_KDCD AS ADT_KDCD /* 감사종류코드 */,
    F_CODE_NM_YEAR('1000007', A.ADT_KDCD, A.CVLCPT_ADT_YR) AS F_CODE_NM_YEAR /* 감사종류명 */,
    F_CODE_NM('1000751', A.BZTRP_BGT_SECD) AS F_CODE_NM /* 예산구분명 추가 - 2019.11.12 les */,
    A.SPRVSN_DEPT_CD AS SPRVSN_DEPT_CD /* 주관부서코드 */,
    F_DPT_INFO(A.SPRVSN_DEPT_CD,'1') AS F_DPT_INFO /* 주관국과명 */,
    F_DPT_INFO(A.MNG_DEPT_CD, '1') AS F_DPT_INFO /* 관리부서명 */,
    B.ADT_BZTRP_KDCD AS ADT_BZTRP_KDCD /* 감사출장종류코드 */,
    F_CODE_NM('1000030',B.ADT_BZTRP_KDCD) AS F_CODE_NM /* 감사출장종류명 */,
    F_ORG_CNT_NM_AUD(B.BZTRP_YR,B.BZTRP_SQNO,'BZT') AS INST_CONT /* 기관개수 */,
    ( SELECT COUNT(DISTINCT BZTRVR_ENO) AS BZTRVR_ENO /* 출장자직원전산번호 */
FROM TB_BADDED005L WHERE 1=1 AND BZTRP_YR = B.BZTRP_YR AND BZTRP_SQNO = B.BZTRP_SQNO )AS BZT_CNB_CNT /*출장인원*/ , A.ADT_MTTR_NM AS ADT_MTTR_NM /*감사사항명*/ , TO_CHAR(TO_DATE(B.ADT_BGNG_YMD),'YYYY-MM-DD')||'~'|| TO_CHAR(TO_DATE(B.ADT_END_YMD),'YYYY-MM-DD') AS AUD_ST_END_DT FROM TB_BADDED001M A , TB_BADDED002M B WHERE 1=1 AND A.CVLCPT_ADT_YR = B.REL_ADT_YR(+) AND A.ADT_NO = B.REL_ADT_NO(+) AND B.BZTRP_SECD = '1' /* 속도개선으로 변경 - 2016.01.07 yyh */ AND A.CVLCPT_ADT_YR BETWEEN #strAudYrSt# AND #strAudYrEnd# AND A.CVLCPT_ADT_YR||LPAD(A.ADT_GRNT_NO,4,'0') >= #strAudYrSt#||DECODE(#strAudGrnNoSt#,'','0000', LPAD(#strAudGrnNoSt#,4,'0')) AND A.CVLCPT_ADT_YR||LPAD(A.ADT_GRNT_NO,4,'0') /* 감사연번종류코드 추가 - 2015.12.22 yyh */ AND SUBSTR(A.ADT_KDCD,3,1) = SUBSTR(#strAudYrNoKndCdSt#,3,1) /* 감찰담당관실은 조회시 제외하며, 로그인 한 담당자가 감찰담당관일때만 포함하여 모두 보임 - 2016.01.04 yyh */ AND A.SPRVSN_DEPT_CD != '100100' AND A.SPRVSN_DEPT_CD >= #strDptStCd# AND A.SPRVSN_DEPT_CD AND A.MNG_DEPT_CD >= #strMngDptStCd# AND A.MNG_DEPT_CD AND A.ADT_MTTR_NM LIKE '%'||#strSbjNm#||'%' AND A.ADT_RBPRSN_ENO = #ADT_RBPRSN_ENO# /*출장책임자*/ AND (A.CVLCPT_ADT_YR, A.ADT_NO) IN (SELECT CVLCPT_ADT_YR /* 민원감사년도 */,
    ADT_NO /* 감사번호 */
FROM TB_BADDED031L WHERE ADTR_SECD = '1' AND TRGT_NOP_ENO = #TRGT_NOP_ENO#) /*감사주관자 - 2018.05.03 yyh*/ SUBSTR(A.ADT_KDCD,3) IN #strAudTypeCd[]# A.INST_SECD IN #strOrgDvsnCd[]# AND EXISTS ( SELECT 1
FROM TB_BADDED008L T1 ,TBDCMACM015M T2 WHERE 1=1 AND T1.BZTRP_YR = B.BZTRP_YR AND T1.BZTRP_SQNO = B.BZTRP_SQNO AND T1.INST_CD = T2.INST_CD T2.INST_SECD IN #strOrgDvsnCd[]# ) AND (B.BZTRP_YR, B.BZTRP_SQNO) IN (SELECT TRIPSITU.BZTRP_YR /* 출장년도 */,
    TRIPSITU.BZTRP_SQNO /* 출장순번 */
FROM TB_BADDED002M TRIPSITU , TB_BADDED005L TRIPMEMBER , TB_BADDED008L TRIPORG WHERE 1=1 AND TRIPSITU.REL_ADT_YR BETWEEN #strAudYrSt# AND #strAudYrEnd# AND TRIPSITU.REL_ADT_YR (+)= A.CVLCPT_ADT_YR AND TRIPSITU.REL_ADT_NO (+)= A.ADT_NO TRIPSITU.ADT_BZTRP_KDCD IN #strAudBztKndCd[]# AND TRIPMEMBER.BZTRP_YR (+)= TRIPSITU.BZTRP_YR AND TRIPMEMBER.BZTRP_SQNO (+)= TRIPSITU.BZTRP_SQNO AND( (TRIPMEMBER.BZTRP_BGNG_YMD BETWEEN #strBztStDt# AND '99991231') OR (TRIPMEMBER.BZTRP_END_YMD BETWEEN #strBztStDt# AND '99991231') ) AND( (TRIPMEMBER.BZTRP_BGNG_YMD BETWEEN '19000101' AND #strBztEndDt#) OR (TRIPMEMBER.BZTRP_END_YMD BETWEEN '19000101' AND #strBztEndDt#) ) AND BZTRVR_ENO = #BZTRVR_ENO# /*내부출장자*/ AND BZTRVR_NM LIKE #strOutPctNm#||'%' /*외부출장자*/ AND TRIPORG.BZTRP_YR = TRIPSITU.BZTRP_YR AND TRIPORG.BZTRP_SQNO = TRIPSITU.BZTRP_SQNO AND TRIPORG.INST_CD LIKE SUBSTR(#INST_CD#,0,3) || '%' AND TRIPORG.INST_CD LIKE SUBSTR(#INST_CD#,0,6) || '%' AND TRIPORG.INST_CD LIKE SUBSTR(#INST_CD#,0,9) || '%' AND TRIPORG.INST_CD = #INST_CD# AND TRIPORG.INST_CD = #INST_CD# AND TRIPORG.RGN_CD LIKE SUBSTR(#RGN_CD#,0,2) || '%' AND TRIPORG.RGN_CD = #RGN_CD# ) /* 예산구분코드 추가 - 2019.11.12 les */ AND A.BZTRP_BGT_SECD = #BZTRP_BGT_SECD#