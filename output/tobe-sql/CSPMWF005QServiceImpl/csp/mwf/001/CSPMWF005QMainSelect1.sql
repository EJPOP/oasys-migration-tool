SELECT RSTRNT_CD,
    ORD,
    MEAL_DVSN_CD,
    NM,
    NM_1,
    NM_2,
    NM_3,
    NM_4,
    NM_5
FROM ( SELECT *
FROM (WITH DATA AS ( SELECT DDT,
    ROWNUM+1 AS ROWNUM,
    RSTRNT_CD,
    MEAL_DVSN_CD,
    RICE_NM,
    SOUP_NM,
    D1.SD_NM_1,
    D1.SD_NM_2,
    D1.SD_NM_3,
    D1.SD_NM_4,
    D1.SD_NM_5,
    D1.SD_NM_6,
    D1.SD_NM_7,
    D1.SNC_NM,
    D1.COO_INF_NM_1,
    D1.COO_INF_NM_2,
    D1.COO_INF_NM_3,
    D1.COO_INF_NM_4,
    D1.COO_INF_NM_5
FROM ( SELECT B.DDT,
    #RSTRNT_CD# AS #RSTRNT_CD#,
    #MEAL_DVSN_CD# AS #MEAL_DVSN_CD#,
    ROWNUM+1 AS ROWNUM,
    D1.RICE_NM,
    D1.SOUP_NM,
    D1.SD_NM_1,
    D1.SD_NM_2,
    D1.SD_NM_3,
    D1.SD_NM_4,
    D1.SD_NM_5,
    D1.SD_NM_6,
    D1.SD_NM_7,
    D1.SNC_NM,
    D1.COO_INF_NM_1,
    D1.COO_INF_NM_2,
    D1.COO_INF_NM_3,
    D1.COO_INF_NM_4,
    D1.COO_INF_NM_5
FROM TBCSPMWF002M D1, ( SELECT DDT,
    DY
FROM ( SELECT DDT,
    TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') AS TO_CHAR
FROM ( SELECT TO_CHAR( (TO_DATE(#toYmd#, 'YYYYMMDD') - (#currPage# - 1) *7) - LEVEL+1, 'YYYYMMDD') AS TO_CHAR
FROM DUAL CONNECT BY LEVEL SELECT D2.RSTRNT_CD,
    TO_NUMBER('10') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '간식(16:00~16:30)' AS NM,
    MAX(DECODE(D2.D, 2, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SNC_NM, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('10') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '샐러드바' AS NM,
    MAX(DECODE(D2.D, 2, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.SNC_NM, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.SNC_NM, NULL ) ) AS D
FROM DATA D2 GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('11') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS D
FROM DATA D2 WHERE D2.COO_INF_NM_1 IS NOT NULL GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('12') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS D
FROM DATA D2 WHERE D2.COO_INF_NM_2 IS NOT NULL GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('13') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS D
FROM DATA D2 WHERE D2.COO_INF_NM_3 IS NOT NULL GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('14') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS D
FROM DATA D2 WHERE D2.COO_INF_NM_4 IS NOT NULL GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD UNION ALL SELECT D2.RSTRNT_CD,
    TO_NUMBER('15') AS TO_NUMBER,
    D2.MEAL_DVSN_CD,
    '원산지' AS NM,
    MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS D,
    MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS D
FROM DATA D2 WHERE D2.COO_INF_NM_5 IS NOT NULL GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD ) ORDER BY ORD) A WHERE A.NM IS NOT NULL