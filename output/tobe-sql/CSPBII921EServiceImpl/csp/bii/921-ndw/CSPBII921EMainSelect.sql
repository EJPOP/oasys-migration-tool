SELECT A.RESPONSEORGNAME /* 요청대상기관 */,
    A.RESPONSEDEPTNAME /* 요청대상부서 */,
    (SELECT MAX(D.PJTNAME)
FROM AM_ONNARA_DOC D WHERE D.PJTID = A.PJTID) AS PJTNAME /* 대상과제 */ , A.REQUESTTITLE /* 요청제목 */ , A.REQUESTUSERNAME /* 요청자명 */ , SUBSTR(A.REQUESTDATE, 1, 8) AS REQUESTDATE /* 요청일 */ , SUBSTR(B.RESPONSEDATE, 1, 8) AS RESPONSEDATE /* 제출일 */ , CASE A.SHAREYN WHEN 'A' THEN '○' WHEN 'D' THEN '△' WHEN 'P' THEN 'X' END AS SHAREYN /* 공유범위 */ , A.REQUESTCOMMENT /* 요청내용 */ , B.ACCEPTSTATCD /* 수락상태코드 */ , CASE WHEN B.ADT_RPTP_EDT_HSTRY_SQNO IS NULL THEN '요청' WHEN B.ACCEPTSTATCD = '0' THEN '미접수' WHEN B.ACCEPTSTATCD = '1' THEN '접수' END AS ACCEPTSTATNM /* 수락상태명 */ , C.FILETITLE , C.FILEPATH , C.FILENAME , A.SHAREYN AS SHAREYN2 , B.RESPONSEUSERNAME , B.RESPONSEDATE , B.RESPONSECOMMENT , A.REQUESTID , B.ADT_RPTP_EDT_HSTRY_SQNO , A.REQUESTUSERID FROM AM_ONNARA_REQUEST A LEFT JOIN AM_ONNARA_RESPONSE B ON A.REQUESTID = B.REQUESTID , AM_ONNARA_REQUEST A LEFT JOIN AM_ONNARA_ATTACH_FILE C ON A.REQUESTID = C.REQUESTID AND C.FILETYPECD = '1' WHERE 1=1 AND B.ADT_RPTP_EDT_HSTRY_SQNO IS NULL AND B.ACCEPTSTATCD = '0' AND B.ACCEPTSTATCD = '1' AND A.SHAREYN = #strShareYn# AND A.REQUESTBAIDEPTCD = #strRequestBaiDeptCd# AND A.REQUESTUSERID = #strRequestUserId# AND A.REQUESTDATE >= #strStrRequestDate# AND A.REQUESTDATE &lt;= #strEndRequestDate# AND A.REQUESTUSERNAME LIKE #strRequestUserName# || '%' AND A.RESPONSEORGID = #strResponseOrgId# AND A.RESPONSEDEPTID = #strResponseDeptId# AND A.RESPONSEDEPTID = #strResponseOrgId2# AND B.ADT_RPTP_EDT_HSTRY_SQNO IS NOT NULL AND A.REQUESTTITLE LIKE #strRequestTitle# || '%' AND A.PJTID IN (SELECT PJTID
FROM AM_ONNARA_DOC WHERE PJTNAME LIKE #strPjtName# || '%') AND A.REQUESTID = #strRequestId# ORDER BY A.REQUESTID, B.ADT_RPTP_EDT_HSTRY_SQNO