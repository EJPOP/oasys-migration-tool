SELECT MAN.TSK_NM AS TSK_NM /* 업무 명 */,
    F_CODE_NM('1000279', MAN.EVL_STEP_CD) AS F_CODE_NM /* 평가단계 */,
    F_CODE_NM('1000280', NVL(D3.EVL_STA_CD, '100')) AS F_CODE_NM /* 평가상태 - 미확인만 뽑는거니깐. */,
    F_DPT_INFO(MAN.CHR_DPT_CD, '1') AS TKCG_DEPT_NM /* 담당부서명 */
FROM ( SELECT D1.EVL_YR,
    D1.HLYR_DVSN_CD,
    D1.TASK_KDCD /* 업무종류코드 */,
    D1.CHGR_DVSN_CD,
    D1.TSK_NO,
    D1.TSK_NM,
    D1.EVL_STEP_CD,
    D1.PIC_ENO /* 담당자직원전산번호 */,
    D1.CHR_DPT_CD
FROM ( SELECT D1.EVL_YR,
    D1.HLYR_DVSN_CD,
    D1.TASK_KDCD /* 업무종류코드 */,
    D1.TSK_NO,
    D1.TSK_NM,
    D2.CHGR_DVSN_CD,
    DECODE(MOD(SUBSTR(D2.CHGR_DVSN_CD, 4), 2), 1, '600', '700') AS MOD /* 홀수면 평가자, 짝수면 확인자 */,
    D2.PIC_ENO /* 담당자직원전산번호 */,
    D1.CHR_DPT_CD
FROM TBCSPAOE024M D1 , TBCSPAOE017D D2 WHERE D1.EVL_YR = D2.EVL_YR AND D1.HLYR_DVSN_CD = D2.HLYR_DVSN_CD AND D2.CVLCPT_TASK_SECD = '10001' AND D1.TASK_KDCD = D2.AUD_TSK_KND_CD AND D1.EVL_YR = #strEvlYr# AND D1.HLYR_DVSN_CD = #strHlyrDvsnCd# AND D1.TASK_KDCD = #TASK_KDCD# AND D2.CHGR_DVSN_CD = #strEvlDvsnCd# AND D2.CHGR_DVSN_CD NOT IN ('CD33', 'CD34') /*감사업무쪽 코드임*/ )D1 , ( SELECT EVL_YR,
    HLYR_DVSN_CD,
    TASK_KDCD /* 업무종류코드 */,
    TSK_NO
FROM TBCSPAOE025M WHERE EVL_YR = #strEvlYr# AND HLYR_DVSN_CD = #strHlyrDvsnCd# AND TASK_KDCD = #TASK_KDCD# GROUP BY EVL_YR, HLYR_DVSN_CD, TASK_KDCD, TSK_NO ) D5 /*감사외 업무 팜여인원이 등록되지 않음 업무명 보여줄 필요 없다.*/ WHERE D1.EVL_YR = D5.EVL_YR AND D1.HLYR_DVSN_CD = D5.HLYR_DVSN_CD AND D1.TASK_KDCD = D5.TASK_KDCD AND D1.TSK_NO = D5.TSK_NO ) MAN , TBCSPAOE029M D3 WHERE MAN.EVL_YR = D3.EVL_YR (+) AND MAN.HLYR_DVSN_CD = D3.HLYR_DVSN_CD (+) AND D3.CVLCPT_TASK_SECD (+) = '10001' /*감사외업무*/ AND MAN.TASK_KDCD = D3.AUD_TSK_KND_CD (+) AND MAN.EVL_STEP_CD = D3.EVL_STEP_CD (+) AND MAN.PIC_ENO = D3.EVL_CMTR_CNB (+) AND MAN.TSK_NO = D3.TSK_NO (+) AND MAN.CHGR_DVSN_CD = D3.EVL_CMTR_DVSN_CD (+) AND NVL(D3.EVL_STA_CD, '100') IN ('100', '200') /*평가상태코드가 100인 미확인인것만 조회한다.*/ ORDER BY MAN.CHR_DPT_CD