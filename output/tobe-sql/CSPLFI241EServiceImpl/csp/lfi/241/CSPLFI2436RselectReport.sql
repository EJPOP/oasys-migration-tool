SELECT B.CD_NM ||DECODE(F_CODE_NM ('1000176', A.ALW_PST_CD), NULL, '','-') || F_CODE_NM ('1000176', A.ALW_PST_CD) AS CD_NM,
    CNT1,
    MONTH1,
    CNT2,
    MONTH2,
    CNT3,
    MONTH3,
    CNT4,
    MONTH4,
    CNT5,
    MONTH5,
    CNT6,
    MONTH6,
    CNT7,
    MONTH7,
    CNT8,
    MONTH8,
    CNT9,
    MONTH9,
    CNT10,
    MONTH10,
    CNT11,
    MONTH11,
    CNT12,
    MONTH12,
    (CNT1+CNT2+CNT3+CNT4+CNT5+CNT6+CNT7+CNT8+CNT9+CNT10+CNT11+CNT12) AS CNT1,
    (MONTH1+MONTH2+MONTH3+MONTH4+MONTH5+MONTH6+ MONTH7+MONTH8+MONTH9+MONTH10+MONTH11+MONTH12) AS MONTH1,
    #yyyy# AS #YYYY#
FROM ( SELECT ALW_RANK_CD,
    ALW_PST_CD,
    COUNT(CASE WHEN PMT_YM = #yyyy# || '01' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '01' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy# || '02' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '02' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy# || '03' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '03' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy# || '04' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '04' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy# || '05' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '05' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy# || '06' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '06' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy# || '07' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '07' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy# || '08' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '08' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy# || '09' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '09' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy# || '10' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '10' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy# || '11' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '11' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy# || '12' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '12' THEN PMT_AM END),0) AS PMT_YM
FROM TBCSPLFI104L WHERE ALW_DVSN_CD = #AlwDvsnCd# GROUP BY ALW_RANK_CD,ALW_PST_CD ) A, TBDCMACM013C B WHERE B.CMM_CD_DVSN_CD = '1000173' AND B.CD = A.ALW_RANK_CD ORDER BY B.CD_NM ASC,ALW_RANK_CD DESC