SELECT A.PMT_YM,
    A.CNT2,
    A.TOTAL2,
    A.CNT3,
    A.TOTAL3,
    A.CNT4,
    A.TOTAL4,
    A.CNT5,
    A.TOTAL5,
    NVL(A.CNT2+A.CNT3+A.CNT4+A.CNT5, 0) AS CNT2,
    NVL(A.TOTAL2+A.TOTAL3+A.TOTAL4+A.TOTAL5, 0) AS TOTAL2,
    #fromYm# AS #FROMYM#,
    #toYm# AS #TOYM#
FROM ( SELECT PMT_YM,
    COUNT(CASE WHEN A.ALW_DVSN_CD = '9992' THEN B.TRGT_NOP_ENO END) AS ALW_DVSN_CD,
    NVL(SUM(CASE WHEN A.ALW_DVSN_CD = '9992' THEN PMT_AM END),0) AS ALW_DVSN_CD,
    COUNT(CASE WHEN A.ALW_DVSN_CD = '9993' THEN B.TRGT_NOP_ENO END) AS ALW_DVSN_CD,
    NVL(SUM(CASE WHEN A.ALW_DVSN_CD = '9993' THEN PMT_AM END),0) AS ALW_DVSN_CD,
    COUNT(CASE WHEN A.ALW_DVSN_CD = '9994' THEN B.TRGT_NOP_ENO END) AS ALW_DVSN_CD,
    NVL(SUM(CASE WHEN A.ALW_DVSN_CD = '9994' THEN PMT_AM END),0) AS ALW_DVSN_CD,
    COUNT(CASE WHEN A.ALW_DVSN_CD = '9995' THEN B.TRGT_NOP_ENO END) AS ALW_DVSN_CD,
    NVL(SUM(CASE WHEN A.ALW_DVSN_CD = '9995' THEN PMT_AM END),0) AS ALW_DVSN_CD
FROM TBCSPLFI104L A, TBDCMACM001M B WHERE A.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND PMT_YM BETWEEN #fromYm# AND #toYm# AND A.ALW_DVSN_CD IN ('9992','9993','9994','9995') GROUP BY PMT_YM ORDER BY PMT_YM ) A