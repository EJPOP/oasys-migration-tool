SELECT CD,
    CD_NM,
    CNT1,
    MONTH1,
    CNT2,
    MONTH2,
    CNT3,
    MONTH3,
    CNT4,
    MONTH4,
    CNT5,
    MONTH5,
    CNT6,
    MONTH6,
    CNT7,
    MONTH7,
    CNT8,
    MONTH8,
    CNT9,
    MONTH9,
    CNT10,
    MONTH10,
    CNT11,
    MONTH11,
    CNT12,
    MONTH12,
    CNTTOTAL,
    TOTAL,
    #yyyy# AS #YYYY#
FROM( SELECT substring(A.CD,1,3) AS SUBSTRING,
    B.ABR_DPT_NM_2 /* 20181104 EUNOK CD_NM -> E.ABR_DPT_NM_2 */,
    B.DPT_SNO,
    B.CRU_SORT_SQNO /* 부패정렬순번 */
FROM TBDCMACM013C A, TBDCMACM002M B WHERE A.CMM_CD_DVSN_CD = '1000144' AND (A.CD LIKE '___000' OR A.CD ='770770') AND A.USE_YN ='Y' AND A.CD = B.SRECS_DEPT_CD ) a, (SELECT substring(SRECS_DEPT_CD,1,3) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    SUM(CNT1) AS CNT1,
    SUM(MONTH1) AS MONTH1,
    SUM(CNT2) AS CNT2,
    SUM(MONTH2) AS MONTH2,
    SUM(CNT3) AS CNT3,
    SUM(MONTH3) AS MONTH3,
    SUM(CNT4) AS CNT4,
    SUM(MONTH4) AS MONTH4,
    SUM(CNT5) AS CNT5,
    SUM(MONTH5) AS MONTH5,
    SUM(CNT6) AS CNT6,
    SUM(MONTH6) AS MONTH6,
    SUM(CNT7) AS CNT7,
    SUM(MONTH7) AS MONTH7,
    SUM(CNT8) AS CNT8,
    SUM(MONTH8) AS MONTH8,
    SUM(CNT9) AS CNT9,
    SUM(MONTH9) AS MONTH9,
    SUM(CNT10) AS CNT10,
    SUM(MONTH10) AS MONTH10,
    SUM(CNT11) AS CNT11,
    SUM(MONTH11) AS MONTH11,
    SUM(CNT12) AS CNT12,
    SUM(MONTH12) AS MONTH12,
    SUM(CNT1+CNT2+CNT3+CNT4+CNT5+CNT6+CNT7+CNT8+CNT9+CNT10+CNT11+CNT12) AS CNT1,
    SUM(MONTH1+MONTH2+MONTH3+MONTH4+MONTH5+MONTH6+ MONTH7+MONTH8+MONTH9+MONTH10+MONTH11+MONTH12) AS MONTH1
FROM ( SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */,
    COUNT(CASE WHEN PMT_YM = #yyyy#||'01' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'01' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy#||'02' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'02' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy#||'03' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'03' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy#||'04' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'04' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy#||'05' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'05' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy#||'06' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'06' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy#||'07' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'07' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy#||'08' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'08' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy#||'09' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'09' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy#||'10' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'10' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy#||'11' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'11' THEN PMT_AM END),0) AS PMT_YM,
    COUNT(CASE WHEN PMT_YM = #yyyy#||'12' THEN TRGT_NOP_ENO END) AS PMT_YM,
    NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'12' THEN PMT_AM END),0) AS PMT_YM
FROM TBCSPLFI104L WHERE ALW_DVSN_CD = #AlwDvsnCd# GROUP BY SRECS_DEPT_CD ) GROUP BY substring(SRECS_DEPT_CD,1,3) ) b WHERE substring(CD,1,3)= substring(SRECS_DEPT_CD,1,3) ORDER BY a.DPT_SNO ASC, A.CRU_SORT_SQNO ASC