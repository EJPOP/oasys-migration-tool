SELECT JBGD_NM /* 직급명 */,
    CNT,
    TOTAL,
    #toYm# AS #TOYM#
FROM ( SELECT NVL2(JBGD_NM, JBGD_NM,'합계') AS JBGD_NM /* 직급명 */,
    SUM(CNT) AS CNT,
    SUM(TOTAL) AS TOTAL,
    MAX(ALW_RANK_CD) AS ALW_RANK_CD,
    MAX(A.ALW_PST_CD) AS ALW_PST_CD
FROM ( SELECT C.CD_NM ||DECODE(F_CODE_NM ('1000176', A.ALW_PST_CD), NULL, '','-') || F_CODE_NM ('1000176', A.ALW_PST_CD) AS JBGD_NM /* 직급명 */,
    A.ALW_RANK_CD,
    A.ALW_PST_CD,
    CASE WHEN ALW_DVSN_CD = '9992' THEN 1 ELSE 0 END AS ALW_DVSN_CD,
    CASE WHEN ALW_DVSN_CD = '9992' THEN PMT_AM ELSE 0 END AS ALW_DVSN_CD
FROM TBCSPLFI104L A, TBDCMACM001M B, TBDCMACM013C C WHERE 1=1 AND A.PMT_YM = #toYm# AND A.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND A.ALW_RANK_CD IS NOT NULL AND C.CMM_CD_DVSN_CD = '1000173' AND A.ALW_RANK_CD = C.CD) A GROUP BY ROLLUP (JBGD_NM) ) A ORDER BY DECODE(JBGD_NM, '합계', '9999999999', A.ALW_RANK_CD) ASC, A.ALW_PST_CD DESC