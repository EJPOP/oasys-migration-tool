SELECT A.CD_NM,
    NVL(C.CNT1,0) AS CNT1,
    NVL(C.TOTAL1,0) AS TOTAL1,
    NVL(C.CNT2,0) AS CNT2,
    NVL(C.TOTAL2,0) AS TOTAL2,
    NVL(C.CNT3,0) AS CNT3,
    NVL(C.TOTAL3,0) AS TOTAL3,
    NVL(C.CNT4,0) AS CNT4,
    NVL(C.TOTAL4,0) AS TOTAL4,
    NVL(C.CNT1 + C.CNT2 + C.CNT3 + C.CNT4, 0) AS CNT1,
    NVL(C.TOTAL1 + C.TOTAL2 + C.TOTAL3 + C.TOTAL4, 0) AS TOTAL1,
    #toYm# AS #TOYM#
FROM ( SELECT A.CD,
    B.ABR_DPT_NM_2 /* 20181104 EUNOK CD_NM -> B.ABR_DPT_NM_2 */,
    B.DPT_SNO,
    B.CRU_SORT_SQNO /* 부패정렬순번 */
FROM TBDCMACM013C A,TBDCMACM002M B WHERE A.CMM_CD_DVSN_CD = '1000144' AND A.CD <> '000000000' AND A.USE_YN != 'N' AND A.CD = B.SRECS_DEPT_CD )A, ( SELECT D3.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    COUNT(CASE WHEN D3.ALW_DVSN_CD = '9992' THEN D3.TRGT_NOP_ENO END) AS ALW_DVSN_CD,
    SUM(CASE WHEN D3.ALW_DVSN_CD = '9992' THEN D3.PMT_AM ELSE 0 END) AS ALW_DVSN_CD,
    COUNT(CASE WHEN D3.ALW_DVSN_CD = '9993' THEN D3.TRGT_NOP_ENO END) AS ALW_DVSN_CD,
    SUM(CASE WHEN D3.ALW_DVSN_CD = '9993' THEN D3.PMT_AM ELSE 0 END) AS ALW_DVSN_CD,
    COUNT(CASE WHEN D3.ALW_DVSN_CD = '9994' THEN D3.TRGT_NOP_ENO END) AS ALW_DVSN_CD,
    SUM(CASE WHEN D3.ALW_DVSN_CD = '9994' THEN D3.PMT_AM ELSE 0 END) AS ALW_DVSN_CD,
    COUNT(CASE WHEN D3.ALW_DVSN_CD = '9995' THEN D3.TRGT_NOP_ENO END) AS ALW_DVSN_CD,
    SUM(CASE WHEN D3.ALW_DVSN_CD = '9995' THEN D3.PMT_AM ELSE 0 END) AS ALW_DVSN_CD
FROM ( SELECT SUBSTR(D1.SRECS_DEPT_CD, 1, 3) || '000' AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    1,
    D1.PMT_AM,
    D1.ALW_DVSN_CD,
    D1.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    D1.PMT_AM
FROM TBCSPLFI104L D1 , TBDCMACM001M D2 WHERE D1.TRGT_NOP_ENO = D2.TRGT_NOP_ENO AND D1.PMT_YM = #toYm# AND D1.ALW_DVSN_CD IN ('9992', '9993', '9994', '9995') ) D3 GROUP BY D3.SRECS_DEPT_CD UNION ALL SELECT B.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    SUM(CNT1) AS CNT1,
    SUM(TOTAL1) AS TOTAL1,
    SUM(CNT2) AS CNT2,
    SUM(TOTAL2) AS TOTAL2,
    SUM(CNT3) AS CNT3,
    SUM(TOTAL3) AS TOTAL3,
    SUM(CNT4) AS CNT4,
    SUM(TOTAL4) AS TOTAL4
FROM( SELECT A.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    COUNT(CASE WHEN A.ALW_DVSN_CD = '9992' THEN A.TRGT_NOP_ENO END) AS ALW_DVSN_CD,
    SUM(CASE WHEN A.ALW_DVSN_CD = '9992' THEN A.PMT_AM ELSE 0 END) AS ALW_DVSN_CD,
    COUNT(CASE WHEN A.ALW_DVSN_CD = '9993' THEN A.TRGT_NOP_ENO END) AS ALW_DVSN_CD,
    SUM(CASE WHEN A.ALW_DVSN_CD = '9993' THEN A.PMT_AM ELSE 0 END) AS ALW_DVSN_CD,
    COUNT(CASE WHEN A.ALW_DVSN_CD = '9994' THEN A.TRGT_NOP_ENO END) AS ALW_DVSN_CD,
    SUM(CASE WHEN A.ALW_DVSN_CD = '9994' THEN A.PMT_AM ELSE 0 END) AS ALW_DVSN_CD,
    COUNT(CASE WHEN A.ALW_DVSN_CD = '9995' THEN A.TRGT_NOP_ENO END) AS ALW_DVSN_CD,
    SUM(CASE WHEN A.ALW_DVSN_CD = '9995' THEN A.PMT_AM ELSE 0 END) AS ALW_DVSN_CD
FROM TBCSPLFI104L A, TBDCMACM001M B WHERE A.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND PMT_YM = #toYm# AND A.ALW_DVSN_CD IN ('9992', '9993', '9994', '9995') GROUP BY A.SRECS_DEPT_CD )B GROUP BY B.SRECS_DEPT_CD )C WHERE A.CD= C.SRECS_DEPT_CD (+) AND A.CD_NM LIKE '%' || #dptNm# ||'%' ORDER BY A.DPT_SNO ASC, A.CRU_SORT_SQNO ASC, A.CD ASC