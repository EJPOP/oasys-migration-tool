SELECT A.CD_NM,
    NVL(C.CNT,0) AS CNT,
    NVL(C.TOTAL,0) AS TOTAL,
    #toYm# AS #TOYM#
FROM ( SELECT A.CD,
    B.ABR_DPT_NM_2 /* 20181104 EUNOK CD_NM -> B.ABR_DPT_NM_2 */,
    B.DPT_SNO,
    B.CRU_SORT_SQNO /* 부패정렬순번 */
FROM TBDCMACM013C A,TBDCMACM002M B WHERE A.CMM_CD_DVSN_CD = '1000144' AND A.CD <> '000000000' AND A.USE_YN != 'N' AND A.CD = B.SRECS_DEPT_CD )A, ( SELECT D3.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    SUM(D3.CNT) AS CNT,
    SUM(D3.TOTAL) AS TOTAL
FROM ( SELECT SUBSTR(D1.SRECS_DEPT_CD, 1, 3) || '000' AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    1,
    D1.PMT_AM
FROM TBCSPLFI104L D1 , TBDCMACM001M D2 WHERE D1.TRGT_NOP_ENO = D2.TRGT_NOP_ENO AND D1.PMT_YM = #toYm# AND D1.ALW_DVSN_CD = #AlwDvsnCd# ) D3 GROUP BY D3.SRECS_DEPT_CD UNION ALL SELECT A.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    COUNT(A.TRGT_NOP_ENO) AS TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    SUM(A.PMT_AM) AS PMT_AM
FROM TBCSPLFI104L A, TBDCMACM001M B WHERE A.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND PMT_YM = #toYm# AND A.ALW_DVSN_CD = #AlwDvsnCd# GROUP BY A.SRECS_DEPT_CD )C WHERE A.CD= C.SRECS_DEPT_CD (+) AND A.CD_NM LIKE '%' || NULL ||'%' ORDER BY A.DPT_SNO ASC, A.CRU_SORT_SQNO ASC, A.CD ASC