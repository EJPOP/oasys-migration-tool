SELECT D1.TPOF_RCPT_YR||CASE WHEN D1.CVLCPT_CLM_SECD = '1' THEN DECODE(D1.TPOF_ACTL_RCPT_SECD,'','-','2','-민원-','1','-제보-') ||D1.TPOF_ACTL_RCPT_NO WHEN D1.CVLCPT_CLM_SECD IN ('2','3') THEN DECODE(D1.CVLCPT_CLM_SECD,'','-','2','-국민-','3','-공익-') ||D1.TPOF_ACTL_RCPT_NO ELSE '' END AS TPOF_RCPT_YR /* 제보접수년도 */,
    TO_CHAR(D1.TPOF_RCPT_DT, 'YYYY-MM-DD') AS NTFCTN_RCPT_YMD /* 통보접수일자 */,
    CASE WHEN D1.CVLCPT_CLM_SECD = '1' THEN (SELECT F_USR_INFO((SELECT AS TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBDCMACM001M WHERE USER_ID = D2.PRCS_PIC_ID), '2') FROM TB_CSPDCP201M D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT) WHEN D1.CVLCPT_CLM_SECD IN ('2','3') THEN (SELECT F_USR_INFO((SELECT AS TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBDCMACM001M WHERE USER_ID = D2.PRCS_PIC_ID), '2') FROM TB_CSPEAR001M D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT) ELSE '' END AS SRECS_PRCS_PIC_NM ,CASE WHEN D1.CVLCPT_CLM_SECD = '1' THEN (SELECT AGGR_CONCAT(F_ORG_INFO(D2.TPOF_INST_CD, '1'), ',') AS TPOF_INST_CD /* 제보기관코드 */
FROM TB_CSPDCP206L D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT AND D2.CVLCPT_INST_DSCTN_SECD = '1') WHEN D1.CVLCPT_CLM_SECD IN ('2','3') THEN (SELECT AGGR_CONCAT(F_ORG_INFO(D2.TPOF_ADT_TRGT_INST_CD, '1'), ',') AS TPOF_ADT_TRGT_INST_CD /* 제보감사대상기관코드 */
FROM TB_CSPDCP104L D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT) ELSE '' END AS AUD_TG_ORG_NM ,CASE WHEN D1.CVLCPT_CLM_SECD = '1' THEN (SELECT F_DPT_INFO(D2.TPOF_PRCS_DEPT_CD, '1') AS TPOF_PRCS_DEPT_CD /* 제보처리부서코드 */
FROM TB_CSPDCP201M D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT) WHEN D1.CVLCPT_CLM_SECD IN ('2','3') THEN (SELECT F_DPT_INFO(D2.PRCS_DEPT_CD, '1') AS PRCS_DEPT_CD /* 처리부서코드 */
FROM TB_CSPEAR001M D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT) ELSE '' END AS PRCS_DEPT_NM ,(SELECT LTRIM(sys_connect_by_path(S3.SUC_ACP_YRNO,','),',')
FROM (SELECT S2.TPOF_RCPT_YR /* 제보접수년도 */,
    S2.TPOF_RCPT_NO /* 제보접수번호 */,
    S2.TPOF_MCA_RCPT_YR||'-'||S2.TPOF_MCA_CVLCPT_RCPT_NO AS TPOF_MCA_RCPT_YR /* 제보합건접수년도 */,
    ROW_NUMBER() OVER (ORDER BY S2.TPOF_RCPT_YR, S2.TPOF_RCPT_NO) AS ROW_NUMBER,
    COUNT(1) OVER () AS 1
FROM TBCSPDCP105L S2 WHERE S2.CLM_SECD = #CLM_SECD# AND S2.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND S2.CVLCPT_RCPT_RCPT = #CVLCPT_RCPT_RCPT#) S3 WHERE LEVEL = 2 START WITH S3.RNUM = 1 CONNECT BY PRIOR S3.CVLCPT_RCPT_YR = S3.CVLCPT_RCPT_YR AND S3.CVLCPT_RCPT_RCPT = S3.CVLCPT_RCPT_RCPT AND PRIOR S3.RNUM = S3.RNUM - 1) AS SUC_CVPT ,D1.SLCT_CVLPR_NM ,D1.SLCT_CVLPR_ADDR ,D1.SLCT_TTL ,(SELECT SLCT_CN /* 청탁내용 */
FROM TB_CSPDCP102M D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT) AS SLCT_CN FROM TB_CSPDCP101M D1 WHERE 1=1 AND D1.CVLCPT_CLM_SECD = #CLM_SECD# AND D1.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND D1.CVLCPT_RCPT_RCPT = #CVLCPT_RCPT_RCPT# UNION ALL SELECT D1.CVLCPT_RCPT_YR||'-부감-'||D1.CRU_ACTL_RCPT_NO AS CVLCPT_RCPT_YR /* 민원접수년도 */,
    TO_CHAR(D1.CRU_RCPT_DT, 'YYYY-MM-DD') AS NTFCTN_RCPT_YMD /* 통보접수일자 */,
    (SELECT F_USR_INFO((SELECT AS TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBDCMACM001M WHERE USER_ID = D2.PRCS_PIC_ID), '2') FROM TB_CORCOR201M D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT) AS SRECS_PRCS_PIC_NM ,(SELECT AGGR_CONCAT(F_ORG_INFO(D2.CRU_INST_CD, '1'), ',') AS CRU_INST_CD /* 부패기관코드 */
FROM TB_CORCOR206L D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT AND D2.CVLCPT_INST_DSCTN_SECD = '1') AS AUD_TG_ORG_NM ,(SELECT F_DPT_INFO(D2.CRU_PRCS_DEPT_CD, '1') AS CRU_PRCS_DEPT_CD /* 부패처리부서코드 */
FROM TB_CORCOR201M D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT) AS PRCS_DEPT_NM ,(SELECT LTRIM(sys_connect_by_path(S3.SUC_ACP_YRNO,','),',')
FROM (SELECT S2.CVLCPT_RCPT_YR /* 민원접수년도 */,
    S2.CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    S2.CVLCPT_MCA_RCPT_YR||'-'||S2.CVLCPT_MCA_CVLCPT_RCPT_NO AS CVLCPT_MCA_RCPT_YR /* 민원합건접수년도 */,
    ROW_NUMBER() OVER (ORDER BY S2.CVLCPT_RCPT_YR, S2.CVLCPT_RCPT_RCPT) AS ROW_NUMBER,
    COUNT(1) OVER () AS 1
FROM TBCORCOR105L S2 WHERE S2.CLM_SECD = #CLM_SECD# AND S2.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND S2.CVLCPT_RCPT_RCPT = #CVLCPT_RCPT_RCPT#) S3 WHERE LEVEL = 2 START WITH S3.RNUM = 1 CONNECT BY PRIOR S3.CVLCPT_RCPT_YR = S3.CVLCPT_RCPT_YR AND S3.CVLCPT_RCPT_RCPT = S3.CVLCPT_RCPT_RCPT AND PRIOR S3.RNUM = S3.RNUM - 1) AS SUC_CVPT ,D1.SLCT_CVLPR_NM ,D1.SLCT_CVLPR_ADDR ,D1.SLCT_TTL ,(SELECT SLCT_CN /* 청탁내용 */
FROM TB_CORCOR102M D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT) AS SLCT_CN FROM TB_CORCOR101M D1 WHERE 1=1 AND D1.CVLCPT_CLM_SECD = #CLM_SECD# AND D1.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND D1.CVLCPT_RCPT_RCPT = #CVLCPT_RCPT_RCPT# UNION ALL SELECT D1.CVLCPT_RCPT_YR||'-청금-'||D1.SLCT_ACTL_RCPT_NO AS CVLCPT_RCPT_YR /* 민원접수년도 */,
    TO_CHAR(D1.SLCT_RCPT_DT, 'YYYY-MM-DD') AS NTFCTN_RCPT_YMD /* 통보접수일자 */,
    (SELECT F_USR_INFO((SELECT AS TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBDCMACM001M WHERE USER_ID = D2.PRCS_PIC_ID), '2') FROM TB_DCPDCP201M D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT) AS SRECS_PRCS_PIC_NM ,(SELECT AGGR_CONCAT(F_ORG_INFO(D2.SLCT_INST_CD, '1'), ',') AS SLCT_INST_CD /* 청탁기관코드 */
FROM TB_DCPDCP206L D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT AND D2.CVLCPT_INST_DSCTN_SECD = '1') AS AUD_TG_ORG_NM ,(SELECT F_DPT_INFO(D2.SLCT_PRCS_DEPT_CD, '1') AS SLCT_PRCS_DEPT_CD /* 청탁처리부서코드 */
FROM TB_DCPDCP201M D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT) AS PRCS_DEPT_NM ,(SELECT LTRIM(sys_connect_by_path(S3.SUC_ACP_YRNO,','),',')
FROM (SELECT S2.CVLCPT_RCPT_YR /* 민원접수년도 */,
    S2.CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    S2.CVLCPT_MCA_RCPT_YR||'-'||S2.CVLCPT_MCA_CVLCPT_RCPT_NO AS CVLCPT_MCA_RCPT_YR /* 민원합건접수년도 */,
    ROW_NUMBER() OVER (ORDER BY S2.CVLCPT_RCPT_YR, S2.CVLCPT_RCPT_RCPT) AS ROW_NUMBER,
    COUNT(1) OVER () AS 1
FROM TBDCPDCP105L S2 WHERE S2.CLM_SECD = #CLM_SECD# AND S2.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND S2.CVLCPT_RCPT_RCPT = #CVLCPT_RCPT_RCPT#) S3 WHERE LEVEL = 2 START WITH S3.RNUM = 1 CONNECT BY PRIOR S3.CVLCPT_RCPT_YR = S3.CVLCPT_RCPT_YR AND S3.CVLCPT_RCPT_RCPT = S3.CVLCPT_RCPT_RCPT AND PRIOR S3.RNUM = S3.RNUM - 1) AS SUC_CVPT ,D1.SLCT_CVLPR_NM ,D1.SLCT_CVLPR_ADDR ,D1.SLCT_TTL ,(SELECT SLCT_CN /* 청탁내용 */
FROM TB_DCPDCP102M D2 WHERE D2.CLM_SECD = D1.CVLCPT_CLM_SECD AND D2.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND D2.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT) AS SLCT_CN FROM TB_DCPDCP101M D1 WHERE 1=1 AND D1.CVLCPT_CLM_SECD = #CLM_SECD# AND D1.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND D1.CVLCPT_RCPT_RCPT = #CVLCPT_RCPT_RCPT#