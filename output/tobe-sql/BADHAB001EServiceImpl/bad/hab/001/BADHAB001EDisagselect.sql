SELECT T4.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    F_DPT_INFO ( RPAD(T1.RB_CD,3,'0') || RPAD(T1.PROF_RBPRSN_CPD_SECD,3,'0') , '1') AS F_DPT_INFO /* 소관기관 */,
    T3.ACNTG_CDNM AS ACNTG_CDNM /* 회계코드명 */,
    CASE WHEN (T1.BLL_KDCD='17' AND T1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') or (T1.BLL_KDCD='18' AND T1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') THEN '관서운영경비출납계산서' ELSE CASE WHEN (T1.BLL_KDCD='22' AND T1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') or (T1.BLL_KDCD='23' AND T1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') or (T1.BLL_KDCD='24' AND T1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') THEN '기금관서운영경비출납계산서' ELSE T2.ACNTG_CDNM END END AS BLL_KDCD /* 계산서종류코드 */,
    T1.PROF_YM /* 증명연월 */,
    T1.ADT_STUT_CN /* 감사상황내용 */,
    T1.WT_ADT_PRCS_YMD /* 서면감사처리일자 */,
    T1.WT_ADT_ATRZ_YMD /* 서면감사결재일자 */,
    T1.QSTNAI_PBLCN_YMD /* 질의서발부일자 */,
    T1.QSTNAI_ANS_YMD /* 질의서답변일자 */,
    T1.DPP_ATRZ_YMD /* 처리안결재일자 */,
    T1.DPP_TYPE_NM /* 처리안유형명 */,
    T1.CMT_MTG_CN /* 위원회회의내용 */,
    T1.ENFC_YMD /* 시행일자 */,
    T1.DISAG_RMRK_CN /* 불부합비고내용 */,
    T1.JRSD_CD /* 소관코드 */,
    T1.ACNTG_CD /* 회계코드 */,
    T1.BLL_KDCD /* 계산서종류코드 */,
    T1.PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    T1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    RPAD(T1.RB_CD,3,'0') AS RB_CD /* 소관국코드 */,
    RPAD(T1.PROF_RBPRSN_CPD_SECD,3,'0') AS PROF_RBPRSN_CPD_SECD /* 증명책임자소관과구분코드 */,
    RPAD(T1.RB_CD,3,'0') || RPAD(T1.PROF_RBPRSN_CPD_SECD,3,'0') AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    ( SELECT TO_CHAR(TO_DATE(X1.TRF_DT),'YYYY-MM-DD') || '(' || F_DPT_INFO (X1.TRF_BEF_CHR_DPT_CD, '1') || '->' || F_DPT_INFO (RPAD(T1.RB_CD,3,'0') || RPAD(T1.PROF_RBPRSN_CPD_SECD,3,'0'), '1') || ')' AS RB_CD /* 소관국코드 */
FROM TBBADHAB002H X1 WHERE X1.CMPTN_YN = 'Y' AND X1.CVLCPT_TASK_SECD = '02' AND X1.REF_DVSN_CD = T1.PROF_YM || T1.JRSD_CD || T1.ACNTG_CD || T1.BLL_KDCD AND X1.REF_SRNO = TO_NUMBER(T1.PROF_RBPRSN_SQNO || T1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO) ) AS TRF_BEF_AF_DPT FROM TWFAACAV019M T1 /*불부합내역*/ , TWFAACAV024C T2 /*회계코드마스타*/ , TWFAACAV024C T3 /*회계코드마스타*/ , TWFAACAV003M T4 /*증명책임자부호내역*/ WHERE 1=1 AND T2.ACNTG_CD = T1.BLL_KDCD AND T2.ACNTG_SECD = '03' AND T3.ACNTG_CD = T1.ACNTG_CD AND T3.ACNTG_SECD = '01' AND T1.JRSD_CD = T4.JRSD_CD AND T1.ACNTG_CD = T4.ACNTG_CD AND T1.BLL_KDCD = T4.BLL_KDCD AND T1.PROF_RBPRSN_SQNO = T4.PROF_RBPRSN_SQNO AND T1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = T4.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND RPAD(T1.RB_CD,3,'0') || RPAD(T1.PROF_RBPRSN_CPD_SECD,3,'0') IN (SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TABLE(F_AUTH_DEPT(#strCnb#, #strDptAuth#, '', #strDptCd#))) AND RPAD(T1.RB_CD,3,'0') || RPAD(T1.PROF_RBPRSN_CPD_SECD,3,'0') = #strDptCd2# AND T1.PROF_YM BETWEEN #strYr# || '01' AND #strYr# || '12' AND T1.JRSD_CD = #JRSD_CD# AND T1.ACNTG_CD = #ACNTG_CD# AND T1.BLL_KDCD = #BLL_KDCD# AND T1.PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND T1.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND SUBSTR(T1.PROF_RBPRSN_SQNO, 1, 4) = #REF_YR# AND T1.PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# ORDER BY T1.PROF_YM DESC ,T1.RB_CD ,T1.PROF_RBPRSN_CPD_SECD ,T1.DISAG_NO