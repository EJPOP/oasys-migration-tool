INSERT INTO TBDCMACM023H SELECT (SELECT NVL(MAX(ADT_RPTP_EDT_HSTRY_SQNO), 0) + RN AS ADT_RPTP_EDT_HSTRY_SQNO /* 감사보고서편집이력순번 */
FROM TBDCMACM023H) AS ADT_RPTP_EDT_HSTRY_SQNO ,ATRZ_DOC_NO ,TPOF_ATRZ_SECD ,APRVR_ENO ,APVR_SEQ ,APRVR_DEPT_CD ,APRVR_JBGD_SECD ,APRVR_JBPS_SECD ,APRVR_KDCD ,APV_SNO ,APVR_STA_CD ,APV_DH ,APV_OPIN ,FRST_USER_ID ,LAST_USER_ID ,LAST_PRCS_DEPT_CD ,LAST_MENU_ID ,FRST_REG_DT ,LAST_MDFCN_DT ,ONR_PST_NM ,VACANCY_CD ,READ_YN FROM ( SELECT ROWNUM,
    A.ATRZ_DOC_NO /* 결재문서번호 */,
    A.TPOF_ATRZ_SECD /* 제보결재구분코드 */,
    A.APRVR_ENO /* 결재자직원전산번호 */,
    A.APVR_SEQ,
    A.APRVR_DEPT_CD /* 결재자부서코드 */,
    A.APRVR_JBGD_SECD /* 결재자직급구분코드 */,
    A.APRVR_JBPS_SECD /* 결재자직위구분코드 */,
    A.APRVR_KDCD /* 결재자종류코드 */,
    A.APV_SNO,
    A.APVR_STA_CD,
    A.APV_DH,
    A.APV_OPIN,
    A.FRST_USER_ID /* 최초사용자아이디 */,
    A.LAST_USER_ID /* 최종사용자아이디 */,
    A.LAST_PRCS_DEPT_CD /* 최종처리부서코드 */,
    A.LAST_MENU_ID /* 최종메뉴아이디 */,
    SYSDATE AS FRST_REG_DT,
    SYSDATE AS LAST_MDFCN_DT,
    A.ONR_PST_NM,
    A.VACANCY_CD,
    A.READ_YN
FROM TBDCMACM023L A LEFT OUTER JOIN TBDCMACM023H B ON (B.ATRZ_DOC_NO = A.ATRZ_DOC_NO AND B.TPOF_ATRZ_SECD = A.TPOF_ATRZ_SECD AND B.APRVR_ENO = A.APRVR_ENO AND B.APVR_SEQ = A.APVR_SEQ AND B.APV_DH = A.APV_DH) WHERE A.ATRZ_DOC_NO = #ATRZ_DOC_NO# AND A.TPOF_ATRZ_SECD = #TPOF_ATRZ_SECD# AND SUBSTR(A.APVR_STA_CD,0,1) >= '2' AND SUBSTR(A.APVR_STA_CD,0,1) <> '3' AND B.ADT_RPTP_EDT_HSTRY_SQNO IS NULL ORDER BY A.APV_DH DESC, A.APRVR_KDCD DESC )