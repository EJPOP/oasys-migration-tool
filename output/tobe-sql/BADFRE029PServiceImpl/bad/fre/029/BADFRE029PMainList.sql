SELECT F_DPT_INFO(D1.IMPL_MNG_JRSD_DEPT_CD, '1') AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    D1.IMPL_MNG_JRSD_DEPT_CD /* 집행관리소관부서코드 */,
    D1.GROUP_FLAG,
    D1.IN_TERM,
    D1.OUT_TERM,
    D1.HRA_CNT,
    D1.OVER_CNT
FROM ( SELECT E.IMPL_MNG_JRSD_DEPT_CD /* 집행관리소관부서코드 */,
    '처분요구' AS GROUP_FLAG,
    SUM( CASE WHEN TO_CHAR(SYSDATE, 'YYYYMMDD') NVL(E.PRCS_TERM_YMD, '99991231') THEN 1 ELSE 0 END ) AS OUT_TERM /* 처분요구 기한외 */ AS PRCS_TERM_YMD /* 처리기한일자 */,
    SUM( CASE WHEN E.PND_CPLT_STTS_SECD = '2' THEN 1 ELSE 0 END ) AS PND_CPLT_STTS_SECD /* 미결완결상태구분코드 */,
    SUM(NVL(F.TMP_CNT, 0)) AS TMP_CNT /* 처분요구 집행회보접수 */
FROM TBBADEAR001M D , TBBADEAR002D E , ( SELECT 1,
    S1.ADT_YR /* 감사년도 */,
    S1.ADT_NO /* 감사번호 */,
    S1.DSPS_RQT_SQNO /* 처분요구순번 */
FROM TBBADFRE001H S1 WHERE 1 = 1 AND S1.BAI_TKCG_DEPT_RCPT_YMD IS NULL GROUP BY S1.CVLCPT_ADT_YR , S1.ADT_NO , S1.DSPS_RQT_SQNO ) F WHERE 1=1 AND D.CVLCPT_ADT_YR = E.CVLCPT_ADT_YR(+) AND D.ADT_NO = E.ADT_NO(+) AND D.DSPS_RQT_SQNO = E.DSPS_RQT_SQNO(+) AND D.CVLCPT_ADT_YR = F.CVLCPT_ADT_YR(+) AND D.ADT_NO = F.ADT_NO(+) AND D.DSPS_RQT_SQNO = F.DSPS_RQT_SQNO(+) AND E.CFMTN_STTS_SECD = '1' AND D.DSPS_RQT_KDCD IN ('110', '210', '310', '320', '391', '800', '810', '820', '830', '840', '850') AND E.IMPL_MNG_JRSD_DEPT_CD IN ( SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TBDCMACM002M START WITH SRECS_DEPT_CD = #SRECS_DEPT_CD# CONNECT BY PRIOR SRECS_DEPT_CD = HIRK_DPT_CD ) AND E.IMPL_MNG_JRSD_DEPT_CD NOT IN (#SRECS_DEPT_CD#) GROUP BY E.IMPL_MNG_JRSD_DEPT_CD UNION ALL SELECT E.IMPL_MNG_JRSD_DEPT_CD /* 집행관리소관부서코드 */,
    '권고.통보' AS GROUP_FLAG,
    SUM( CASE WHEN TO_CHAR(SYSDATE, 'YYYYMMDD') NVL(E.PRCS_TERM_YMD, '99991231') THEN 1 ELSE 0 END ) AS OUT_TERM /* 처분요구 기한외 */ AS PRCS_TERM_YMD /* 처리기한일자 */,
    SUM( CASE WHEN E.PND_CPLT_STTS_SECD = '2' THEN 1 ELSE 0 END ) AS PND_CPLT_STTS_SECD /* 미결완결상태구분코드 */,
    SUM(NVL(F.TMP_CNT, 0)) AS TMP_CNT /* 처분요구 집행회보접수 */
FROM TBBADEAR001M D , TBBADEAR002D E , ( SELECT 1,
    S1.ADT_YR /* 감사년도 */,
    S1.ADT_NO /* 감사번호 */,
    S1.DSPS_RQT_SQNO /* 처분요구순번 */
FROM TBBADFRE001H S1 WHERE 1 = 1 AND S1.BAI_TKCG_DEPT_RCPT_YMD IS NULL GROUP BY S1.CVLCPT_ADT_YR , S1.ADT_NO , S1.DSPS_RQT_SQNO ) F WHERE 1=1 AND D.CVLCPT_ADT_YR = E.CVLCPT_ADT_YR(+) AND D.ADT_NO = E.ADT_NO(+) AND D.DSPS_RQT_SQNO = E.DSPS_RQT_SQNO(+) AND D.CVLCPT_ADT_YR = F.CVLCPT_ADT_YR(+) AND D.ADT_NO = F.ADT_NO(+) AND D.DSPS_RQT_SQNO = F.DSPS_RQT_SQNO(+) AND E.CFMTN_STTS_SECD = '1' AND D.DSPS_RQT_KDCD IN ('510','520','530','610','611', '620', '621', '623', '630') AND E.IMPL_MNG_JRSD_DEPT_CD IN ( SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TBDCMACM002M START WITH SRECS_DEPT_CD = #SRECS_DEPT_CD# CONNECT BY PRIOR SRECS_DEPT_CD = HIRK_DPT_CD ) AND E.IMPL_MNG_JRSD_DEPT_CD NOT IN (#SRECS_DEPT_CD#) GROUP BY E.IMPL_MNG_JRSD_DEPT_CD ) D1 ORDER BY D1.IMPL_MNG_JRSD_DEPT_CD , D1.GROUP_FLAG DESC