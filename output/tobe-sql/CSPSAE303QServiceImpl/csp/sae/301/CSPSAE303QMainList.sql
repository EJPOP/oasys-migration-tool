SELECT NVL2(A.LINK_YR, A.LINK_YR, '합계') AS LINK_YR /* 연계년도 */,
    DECODE(NVL2(A.LINK_YR, A.LINK_YR, '합계'), '합계', '', NVL2(B.EDU_DVSN_NM, B.EDU_DVSN_NM, '소계')) AS NVL2,
    DECODE(NVL2(B.EDU_DVSN_NM, B.EDU_DVSN_NM, '소계'), '소계', '', NVL2(C.EDU_CAT_NM, C.EDU_CAT_NM, '소계')) AS NVL2,
    DECODE(NVL2(C.EDU_CAT_NM, C.EDU_CAT_NM, '소계'), '소계', '', DECODE(A.CRS_CDN, NULL, '소계', NVL2('제 ' || A.CRS_CDN || '기 ' || D.CRS_NM, '제 ' || A.CRS_CDN || '기 ' || D.CRS_NM, '소계'))) AS CRS_NM /* 과정명 */,
    DECODE(NVL2(D.CRS_NM, D.CRS_NM, '소계'), '소계', '', NVL((SUBSTR(E.EDU_BGNG_YMD, 5, 2) || '.' || SUBSTR(E.EDU_BGNG_YMD, 7, 2)) || ' ~ ' || (SUBSTR(E.EDU_END_YMD, 5, 2) || '.' || SUBSTR(E.EDU_END_YMD, 7, 2)), '') ) AS NVL2,
    SUM(A.CNT_EDU_PSON) AS CNT_EDU_PSON,
    SUM(A.CNT_DRMTY_USE) AS CNT_DRMTY_USE,
    NVL(SUM(A.EDU_EXS), 0) AS EDU_EXS,
    NVL(SUM(A.DMT_EXS), 0) AS DMT_EXS,
    NVL(SUM(A.PAID_AMT), 0) AS PAID_AMT,
    NVL(SUM(A.PAID_AMT) OVER(ORDER BY A.LINK_YR, B.EDU_DVSN_NM, C.EDU_CAT_NM, D.CRS_NM, A.CRS_CDN,NVL((SUBSTR(E.EDU_BGNG_YMD, 5, 2) || '.' || SUBSTR(E.EDU_BGNG_YMD, 7, 2)) || ' ~ ' || (SUBSTR(E.EDU_END_YMD, 5, 2) || '.' || SUBSTR(E.EDU_END_YMD, 7, 2)), '소계')), 0) AS PAID_AMT
FROM ( SELECT A.LINK_YR /* 연계년도 */,
    A.CRS_CD,
    A.CRS_CDN /* 과정기수 */,
    C.CNT_EDU_PSON,
    NVL(B.CNT_DRMTY_USE, 0) AS CNT_DRMTY_USE,
    A.EDU_EXS,
    A.DMT_EXS,
    A.PAID_AMT,
    A.PD_DT
FROM ( SELECT LINK_YR /* 연계년도 */,
    CRS_CD,
    CRS_CDN /* 과정기수 */,
    SUM(EDU_EXS) AS EDU_EXS,
    SUM(DMT_EXS) AS DMT_EXS,
    SUM(EDU_EXS + DMT_EXS) AS EDU_EXS,
    MAX(PD_DT) AS PD_DT
FROM TBCSPSAE301D WHERE PD_YN = 'Y' GROUP BY LINK_YR, CRS_CD, CRS_CDN) A, ( SELECT LINK_YR /* 연계년도 */,
    CRS_CD,
    CRS_CDN /* 과정기수 */,
    COUNT(DMT_UE_YN) AS DMT_UE_YN
FROM TBCSPSAE301D WHERE DMT_UE_YN = 'Y' AND PD_YN = 'Y' GROUP BY LINK_YR, CRS_CD, CRS_CDN) B, ( SELECT LINK_YR /* 연계년도 */,
    CRS_CD,
    CRS_CDN /* 과정기수 */,
    COUNT(TANE_ID) AS TANE_ID
FROM TBCSPSAE301D WHERE PD_YN = 'Y' GROUP BY LINK_YR, CRS_CD, CRS_CDN) C WHERE B.LINK_YR(+) = A.LINK_YR AND B.CRS_CD(+) = A.CRS_CD AND B.CRS_CDN(+) = A.CRS_CDN AND C.LINK_YR = A.LINK_YR AND C.CRS_CD = A.CRS_CD AND C.CRS_CDN = A.CRS_CDN ) A , TBCSPSAE101C B , TBCSPSAE102C C , TBCSPSAE103C D , TBCSPSAE201D E WHERE D.CRS_CD = A.CRS_CD AND C.EDU_CAT_CD = D.EDU_CAT_CD AND B.EDU_DVSN_CD = D.EDU_DVSN_CD AND B.EDU_DVSN_CD = C.EDU_DVSN_CD AND E.LINK_YR = A.LINK_YR AND E.CRS_CD = A.CRS_CD AND E.CRS_CDN = A.CRS_CDN AND A.LINK_YR BETWEEN #strFromY# AND #strToY# AND B.EDU_DVSN_CD = #strEDU_DVSN_CD# AND C.EDU_CAT_CD = #strEDU_CAT_CD# AND A.CRS_CD = #strEDU_CRS_CD# AND SUBSTR(E.EDU_BGNG_YMD, 0, 6) &gt;= #strFromY# || #strFromM# AND SUBSTR(E.EDU_END_YMD, 0, 6) &lt;= #strToY# || #strToM# AND SUBSTR(A.PD_DT, 0, 6) BETWEEN #strFromY# || #strFromM# AND #strToY# || #strToM# GROUP BY ROLLUP(A.LINK_YR, B.EDU_DVSN_NM, C.EDU_CAT_NM, (D.CRS_NM, A.CRS_CDN, B.EDU_DVSN_NM, C.EDU_CAT_NM, D.CRS_NM, NVL((SUBSTR(E.EDU_BGNG_YMD, 5, 2) || '.' || SUBSTR(E.EDU_BGNG_YMD, 7, 2)) || ' ~ ' || (SUBSTR(E.EDU_END_YMD, 5, 2) || '.' || SUBSTR(E.EDU_END_YMD, 7, 2)), ''), E.EDU_BGNG_YMD, E.EDU_END_YMD, A.PAID_AMT))