/* faa/cav/004/FAACAV004EMainSelect */ SELECT A.KEY,
    A.PROF_DRTR_SG,
    A.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    A.PERIOD,
    A.MN1_STTS_SECD /* 1월상태구분코드 */,
    A.MN2_STTS_SECD /* 2월상태구분코드 */,
    A.MN3_STTS_SECD /* 3월상태구분코드 */,
    A.MN4_STTS_SECD /* 4월상태구분코드 */,
    A.MN5_STTS_SECD /* 5월상태구분코드 */,
    A.MN6_STTS_SECD /* 6월상태구분코드 */,
    A.MN7_STTS_SECD /* 7월상태구분코드 */,
    A.MN8_STTS_SECD /* 8월상태구분코드 */,
    A.MN9_STTS_SECD /* 9월상태구분코드 */,
    A.MN10_STTS_SECD /* 10월상태구분코드 */,
    A.MN11_STTS_SECD /* 11월상태구분코드 */,
    A.MN12_STTS_SECD /* 12월상태구분코드 */,
    A.MN13_STTS_SECD /* 13월상태구분코드 */,
    A.JRSD_NM /* 소관명 */,
    A.ACNTG_CDNM /* 회계코드명 */,
    A.BLL_NM,
    A.PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    A.PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    A.JBPS_NM /* 직위명 */,
    A.PROF_RBPRSN_MDFR_NM /* 증명책임자수정자명 */,
    A.CRU_TELNO /* 부패전화번호 */,
    A.OTSD_EXPRT_ADDR /* 외부전문가주소 */
FROM ( SELECT ROWNUM,
    MSTR.JRSD_CD||'-'||MSTR.ACNTG_CD||'-'||MSTR.BLL_KDCD||'-'||MSTR.PROF_RBPRSN_SQNO||'-'||MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS JRSD_CD /* 소관코드 */,
    MN.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    CD.RMRK_DTL_CN /* 비고상세내용 */,
    MSTR.MN1_STTS_SECD /* 1월상태구분코드 */,
    MSTR.MN2_STTS_SECD /* 2월상태구분코드 */,
    MSTR.MN3_STTS_SECD /* 3월상태구분코드 */,
    MSTR.MN4_STTS_SECD /* 4월상태구분코드 */,
    MSTR.MN5_STTS_SECD /* 5월상태구분코드 */,
    MSTR.MN6_STTS_SECD /* 6월상태구분코드 */,
    MSTR.MN7_STTS_SECD /* 7월상태구분코드 */,
    MSTR.MN8_STTS_SECD /* 8월상태구분코드 */,
    MSTR.MN9_STTS_SECD /* 9월상태구분코드 */,
    MSTR.MN10_STTS_SECD /* 10월상태구분코드 */,
    MSTR.MN11_STTS_SECD /* 11월상태구분코드 */,
    MSTR.MN12_STTS_SECD /* 12월상태구분코드 */,
    MSTR.MN13_STTS_SECD /* 13월상태구분코드 */,
    F_AV_BLL_COPT_CD_NM(MSTR.JRSD_CD) AS JRSD_NM /* 소관명 */,
    /*소관명*/ F_AV_ACNT_CD_NM(MSTR.ACNTG_CD) AS ACNTG_CDNM /* 회계코드명 */,
    /*회계명*/ F_AV_BLL_CD_NM(MSTR.BLL_KDCD, MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO) AS F_AV_BLL_CD_NM,
    /*계산서명*/ MN.PROF_RBPRSN_CRT_YMD AS PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    /*신설일*/ MN.PROF_RBPRSN_ABL_YMD AS PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    /*폐지일*/ MN.PROF_RBPRSN_JBPS_NM AS PROF_RBPRSN_JBPS_NM /* 증명책임자직위명 */,
    /*담당자직위*/ MN.PROF_RBPRSN_MDFR_NM AS PROF_RBPRSN_MDFR_NM /* 증명책임자수정자명 */,
    /*담당자*/ MN.PROF_RBPRSN_TELNO AS PROF_RBPRSN_TELNO /* 증명책임자전화번호 */,
    /*전화번호*/ MN.PROF_RBPRSN_ADDR AS PROF_RBPRSN_ADDR /* 증명책임자주소 */
FROM TWFAACAV007M MSTR , TWFAACAV003M MN, TWFAACAV024C CD WHERE 1=1 AND MSTR.JRSD_CD = MN.JRSD_CD AND MSTR.ACNTG_CD = MN.ACNTG_CD AND MSTR.BLL_KDCD = MN.BLL_KDCD AND MSTR.PROF_RBPRSN_SQNO = MN.PROF_RBPRSN_SQNO AND MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = MN.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND MSTR.PROF_YR = #PROF_YR# AND CD.ACNTG_SECD = '30' AND NVL(MN.PROF_RBPRSN_ABL_YMD, '999999') &gt;= #strYm# AND CD.ACNTG_CD = MSTR.BLL_KDCD || CASE WHEN MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO= '000' THEN '000' WHEN MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000' THEN 'XXX' END AND MN.MDFCN_SECD NOT IN 'D' AND MN.INST_CD = #INST_CD#||#strOrg2#||#strOrg3#||#strOrg4# ) A SELECT A.KEY,
    A.PROF_DRTR_SG,
    A.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    A.PERIOD,
    A.MN1_STTS_SECD /* 1월상태구분코드 */,
    A.MN2_STTS_SECD /* 2월상태구분코드 */,
    A.MN3_STTS_SECD /* 3월상태구분코드 */,
    A.MN4_STTS_SECD /* 4월상태구분코드 */,
    A.MN5_STTS_SECD /* 5월상태구분코드 */,
    A.MN6_STTS_SECD /* 6월상태구분코드 */,
    A.MN7_STTS_SECD /* 7월상태구분코드 */,
    A.MN8_STTS_SECD /* 8월상태구분코드 */,
    A.MN9_STTS_SECD /* 9월상태구분코드 */,
    A.MN10_STTS_SECD /* 10월상태구분코드 */,
    A.MN11_STTS_SECD /* 11월상태구분코드 */,
    A.MN12_STTS_SECD /* 12월상태구분코드 */,
    A.MN13_STTS_SECD /* 13월상태구분코드 */,
    A.JRSD_NM /* 소관명 */,
    A.ACNTG_CDNM /* 회계코드명 */,
    A.BLL_NM,
    A.PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    A.PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    A.JBPS_NM /* 직위명 */,
    A.PROF_RBPRSN_MDFR_NM /* 증명책임자수정자명 */,
    A.CRU_TELNO /* 부패전화번호 */,
    A.OTSD_EXPRT_ADDR /* 외부전문가주소 */
FROM ( SELECT ROWNUM,
    MSTR.JRSD_CD||'-'||MSTR.ACNTG_CD||'-'||MSTR.BLL_KDCD||'-'||MSTR.PROF_RBPRSN_SQNO||'-'||MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS JRSD_CD /* 소관코드 */,
    MN.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    MN.PERIOD,
    MSTR.MN1_STTS_SECD /* 1월상태구분코드 */,
    MSTR.MN2_STTS_SECD /* 2월상태구분코드 */,
    MSTR.MN3_STTS_SECD /* 3월상태구분코드 */,
    MSTR.MN4_STTS_SECD /* 4월상태구분코드 */,
    MSTR.MN5_STTS_SECD /* 5월상태구분코드 */,
    MSTR.MN6_STTS_SECD /* 6월상태구분코드 */,
    MSTR.MN7_STTS_SECD /* 7월상태구분코드 */,
    MSTR.MN8_STTS_SECD /* 8월상태구분코드 */,
    MSTR.MN9_STTS_SECD /* 9월상태구분코드 */,
    MSTR.MN10_STTS_SECD /* 10월상태구분코드 */,
    MSTR.MN11_STTS_SECD /* 11월상태구분코드 */,
    MSTR.MN12_STTS_SECD /* 12월상태구분코드 */,
    MSTR.MN13_STTS_SECD /* 13월상태구분코드 */,
    MN.JRSD_NM /* 소관명 */,
    /*소관명*/ MN.ACNTG_CDNM AS ACNTG_CDNM /* 회계코드명 */,
    /*회계명*/ MN.BLL_NM,
    /*계산서명*/ MN.PROF_RBPRSN_CRT_YMD AS PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    /*신설일*/ MN.PROF_RBPRSN_ABL_YMD AS PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    /*폐지일*/ MN.JBPS_NM AS JBPS_NM /* 직위명 */,
    /*담당자 직위*/ MN.PROF_RBPRSN_MDFR_NM AS PROF_RBPRSN_MDFR_NM /* 증명책임자수정자명 */,
    /*담당자*/ MN.CRU_TELNO AS CRU_TELNO /* 부패전화번호 */,
    /*전화번호*/ MN.OTSD_EXPRT_ADDR AS OTSD_EXPRT_ADDR /* 외부전문가주소 */
FROM TWFAACAV007M MSTR, (SELECT CC.JRSD_CD /* 소관코드 */,
    CC.ACNTG_CD /* 회계코드 */,
    CC.BLL_KDCD /* 계산서종류코드 */,
    CC.PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    CC.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    CC.PROF_RBPRSN_INST_CD /* 증명책임자기관코드 */,
    BB.PERIOD,
    CC.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    BB.JRSD_NM /* 소관명 */,
    /*소관명*/ BB.ACNTG_CDNM AS ACNTG_CDNM /* 회계코드명 */,
    /*회계명*/ BB.BLL_NM,
    CC.PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    /*신설일*/ CC.PROF_RBPRSN_ABL_YMD AS PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    /*폐지일*/ CC.PROF_RBPRSN_JBPS_NM AS PROF_RBPRSN_JBPS_NM /* 증명책임자직위명 */,
    /*담당자 직위*/ CC.PROF_RBPRSN_MDFR_NM AS PROF_RBPRSN_MDFR_NM /* 증명책임자수정자명 */,
    /*담당자*/ CC.PROF_RBPRSN_TELNO AS PROF_RBPRSN_TELNO /* 증명책임자전화번호 */,
    /*전화번호*/ CC.PROF_RBPRSN_ADDR AS PROF_RBPRSN_ADDR /* 증명책임자주소 */
FROM TWFAACAV003M CC, (SELECT A.JRSD_CD /* 소관코드 */,
    A.ACNTG_CD /* 회계코드 */,
    A.BLL_KDCD /* 계산서종류코드 */,
    A.PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    CASE B.RMRK_DTL_CN WHEN '월' THEN #strYm# WHEN '분기' THEN CASE WHEN #strMm# = '01' THEN #PROF_YR#||'01' WHEN #strMm# = '02' THEN #PROF_YR#||'04' WHEN #strMm# = '03' THEN #PROF_YR#||'07' WHEN #strMm# = '04' THEN #PROF_YR#||'10' END WHEN '연' THEN #PROF_YR#||'00' END AS RMRK_DTL_CN /* 비고상세내용 */,
    CASE B.RMRK_DTL_CN WHEN '월' THEN #strYm# WHEN '분기' THEN CASE WHEN #strMm# = '01' THEN #PROF_YR#||'03' WHEN #strMm# = '02' THEN #PROF_YR#||'06' WHEN #strMm# = '03' THEN #PROF_YR#||'09' WHEN #strMm# = '04' THEN #PROF_YR#||'13' END WHEN '연' THEN #PROF_YR#||'13' END AS RMRK_DTL_CN /* 비고상세내용 */,
    B.RMRK_DTL_CN /* 비고상세내용 */,
    C.ACNTG_CDNM AS ACNTG_CDNM /* 회계코드명 */,
    D.ACNTG_CDNM AS ACNTG_CDNM /* 회계코드명 */,
    B.ACNTG_CDNM /* 회계코드명 */
FROM TWFAACAV003M A, TWFAACAV024C B, TWFAACAV024C C, TWFAACAV024C D WHERE 1=1 AND A.MDFCN_SECD NOT IN ('D') AND B.ACNTG_SECD = '30' AND B.ACNTG_CD = A.BLL_KDCD || CASE WHEN A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO= '000' THEN '000' WHEN A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000' THEN 'XXX' END AND C.ACNTG_SECD = '02' AND C.ACNTG_CD = A.JRSD_CD AND D.ACNTG_SECD = '01' AND D.ACNTG_CD = A.ACNTG_CD AND SUBSTR(A.INST_CD,1,3) = #INST_CD# AND SUBSTR(A.INST_CD,4,3) = #strOrg2# AND SUBSTR(A.INST_CD,7,3) = #strOrg3# AND SUBSTR(A.INST_CD,10,3) = #strOrg4# AND A.JRSD_CD = #JRSD_CD# AND A.ACNTG_CD = #ACNTG_CD# AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND A.BLL_KDCD IN ('17','18') AND A.BLL_KDCD IN ('22','23','24') AND A.BLL_KDCD IN ('42','43') AND A.BLL_KDCD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_KDCD ELSE #strBllCd# END AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND A.BLL_KDCD IN ('17','18') AND A.BLL_KDCD IN ('22','23','24') AND A.BLL_KDCD = CASE WHEN #strBllCd# IN ('17','22') THEN A.BLL_KDCD ELSE #strBllCd# END AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND A.BLL_KDCD IN ('17','18') AND A.BLL_KDCD IN ('22','23','24') AND A.BLL_KDCD IN ('42','43') AND A.BLL_KDCD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_KDCD ELSE #strBllCd# END AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' AND A.BLL_KDCD IN ('17','18') AND A.BLL_KDCD IN ('22','23','24') AND A.BLL_KDCD = CASE WHEN #strBllCd# IN ('17','22') THEN A.BLL_KDCD ELSE #strBllCd# END AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' AND A.PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND (A.BLL_KDCD IN ('17','18','19','25') OR (A.BLL_KDCD IN ('22','23','24') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000')) AND A.BLL_KDCD IN ('11','12','13','15','16','20','21','22','23','24','29','41','42') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND A.BLL_KDCD IN ('14','28','30','31','32','33','34','35','55') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' ) BB WHERE BB.JRSD_CD = CC.JRSD_CD AND BB.ACNTG_CD = CC.ACNTG_CD AND BB.BLL_KDCD = CC.BLL_KDCD AND BB.PROF_RBPRSN_SQNO = CC.PROF_RBPRSN_SQNO AND BB.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = CC.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND NVL(CC.PROF_RBPRSN_ABL_YMD,'999999') >= BB.ABLT_DT_PROF_YM AND CC.PROF_RBPRSN_CRT_YMD AND SUBSTR(MN.INST_CD,1,3) = #INST_CD# AND SUBSTR(MN.INST_CD,4,3) = #strOrg2# AND SUBSTR(MN.INST_CD,7,3) = #strOrg3# AND SUBSTR(MN.INST_CD,10,3) = #strOrg4# AND MSTR.JRSD_CD = #JRSD_CD# AND MSTR.ACNTG_CD = #ACNTG_CD# AND MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND MSTR.BLL_KDCD IN ('17','18') AND MSTR.BLL_KDCD IN ('22','23','24') AND MSTR.BLL_KDCD IN ('42','43') AND MSTR.BLL_KDCD = CASE WHEN #strBllCd# IN ('17','22','42') THEN MSTR.BLL_KDCD ELSE #strBllCd# END AND MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND MSTR.BLL_KDCD IN ('17','18') AND MSTR.BLL_KDCD IN ('22','23','24') AND MSTR.BLL_KDCD = CASE WHEN #strBllCd# IN ('17','22') THEN MSTR.BLL_KDCD ELSE #strBllCd# END AND MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND MSTR.BLL_KDCD IN ('17','18') AND MSTR.BLL_KDCD IN ('22','23','24') AND MSTR.BLL_KDCD IN ('42','43') AND MSTR.BLL_KDCD = CASE WHEN #strBllCd# IN ('17','22','42') THEN MSTR.BLL_KDCD ELSE #strBllCd# END AND MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' AND MSTR.BLL_KDCD IN ('17','18') AND MSTR.BLL_KDCD IN ('22','23','24') AND MSTR.BLL_KDCD = CASE WHEN #strBllCd# IN ('17','22') THEN MSTR.BLL_KDCD ELSE #strBllCd# END AND MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' AND MSTR.PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND (MSTR.BLL_KDCD IN ('17','18','19','25') OR (MSTR.BLL_KDCD IN ('22','23','24') AND MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000')) AND MSTR.BLL_KDCD IN ('11','12','13','15','16','20','21','22','23','24','29','41','42') AND MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND MSTR.BLL_KDCD IN ('14','28','30','31','32','33','34','35','55') AND MSTR.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' ) A WHERE 1=1 AND A.MN1_STTS_SECD IN('E','W','D','P') AND A.MN1_STTS_SECD IN('E','W','D','P') AND A.MN2_STTS_SECD IN('E','W','D','P') AND A.MN3_STTS_SECD IN('E','W','D','P') AND A.MN4_STTS_SECD IN('E','W','D','P') AND A.MN5_STTS_SECD IN('E','W','D','P') AND A.MN6_STTS_SECD IN('E','W','D','P') AND A.MN7_STTS_SECD IN('E','W','D','P') AND A.MN8_STTS_SECD IN('E','W','D','P') AND A.MN9_STTS_SECD IN('E','W','D','P') AND A.MN10_STTS_SECD IN('E','W','D','P') AND A.MN11_STTS_SECD IN('E','W','D','P') AND A.MN12_STTS_SECD IN('E','W','D','P') AND A.MN13_STTS_SECD IN('E','W','D','P') AND A.MN1_STTS_SECD IS NULL A.MN1_STTS_SECD IS NULL A.MN2_STTS_SECD IS NULL A.MN3_STTS_SECD IS NULL A.MN4_STTS_SECD IS NULL A.MN5_STTS_SECD IS NULL A.MN6_STTS_SECD IS NULL A.MN7_STTS_SECD IS NULL A.MN8_STTS_SECD IS NULL A.MN9_STTS_SECD IS NULL A.MN10_STTS_SECD IS NULL A.MN11_STTS_SECD IS NULL A.MN12_STTS_SECD IS NULL A.MN13_STTS_SECD IS NULL AND (A.MN1_STTS_SECD &lt;&gt; '*' OR A.MN1_STTS_SECD IS NULL) AND (A.MN1_STTS_SECD &lt;&gt; '*' OR A.MN1_STTS_SECD IS NULL) (A.MN1_STTS_SECD &lt;&gt; '*' OR A.MN1_STTS_SECD IS NULL) (A.MN2_STTS_SECD &lt;&gt; '*' OR A.MN2_STTS_SECD IS NULL) (A.MN3_STTS_SECD &lt;&gt; '*' OR A.MN3_STTS_SECD IS NULL) (A.MN4_STTS_SECD &lt;&gt; '*' OR A.MN4_STTS_SECD IS NULL) (A.MN5_STTS_SECD &lt;&gt; '*' OR A.MN5_STTS_SECD IS NULL) (A.MN6_STTS_SECD &lt;&gt; '*' OR A.MN6_STTS_SECD IS NULL) (A.MN7_STTS_SECD &lt;&gt; '*' OR A.MN7_STTS_SECD IS NULL) (A.MN8_STTS_SECD &lt;&gt; '*' OR A.MN8_STTS_SECD IS NULL) (A.MN9_STTS_SECD &lt;&gt; '*' OR A.MN9_STTS_SECD IS NULL) (A.MN10_STTS_SECD &lt;&gt; '*' OR A.MN10_STTS_SECD IS NULL) (A.MN11_STTS_SECD &lt;&gt; '*' OR A.MN11_STTS_SECD IS NULL) (A.MN12_STTS_SECD &lt;&gt; '*' OR A.MN12_STTS_SECD IS NULL) (A.MN13_STTS_SECD &lt;&gt; '*' OR A.MN13_STTS_SECD IS NULL) ORDER BY PROF_DRTR_SG, PROF_RBPRSN_INST_NM