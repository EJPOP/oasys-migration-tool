SELECT T1.INFO_YR /* 정보년도 */,
    T1.TPOF_CYCL /* 제보차수 */,
    T1.CABT_GP_CD,
    T1.CABT_CD,
    CASE WHEN T1.CABT_GP_CD = '900' THEN '' ELSE F_CODE_NM('1000996',T1.CABT_GP_CD) END AS CABT_GP_CD,
    F_CODE_NM('1000997',T1.CABT_CD) AS F_CODE_NM,
    CASE WHEN T2.JBGD_SECD <= '014' THEN T1.AV_SC_4RK WHEN T2.JBGD_SECD = '187' THEN T1.AV_SC_4RK WHEN T2.JBGD_SECD = '015' THEN T1.AV_SC_5RK WHEN T2.JBGD_SECD IN ('016', '017') THEN T1.AV_SC_67RK ELSE T1.AV_SC_67RK END AS JBGD_SECD /* 직급구분코드 */,
    CASE WHEN T2.JBGD_SECD <= '014' THEN NULL WHEN T2.JBGD_SECD = '187' THEN NULL WHEN T2.JBGD_SECD = '015' THEN T1.OCM_AV_SC_5RK WHEN T2.JBGD_SECD IN ('016', '017') THEN T1.OCM_AV_SC_67RK ELSE T1.OCM_AV_SC_67RK END AS JBGD_SECD /* 직급구분코드 */,
    CASE WHEN T1.CABT_CD = '900' THEN (SELECT NVL(TRUNC(AVG(NVL(CHO_ITM, 0)), 2),0)
FROM TBCSPSAE803D WHERE INFO_YR = #INFO_YR# AND TPOF_CYCL = #TPOF_CYCL# AND TRGT_NOP_ENO = #TRGT_NOP_ENO#) ELSE TRUNC(AVG(NVL(T2.CHO_ITM, 0)), 2) END AS MY_AV_SC, T1.CABT_DF FROM TBCSPSAE801D T1, TBCSPSAE803D T2 WHERE 1=1 AND T1.INFO_YR = T2.INFO_YR(+) AND T1.TPOF_CYCL = T2.TPOF_CYCL(+) AND T1.CABT_GP_CD = T2.CABT_GP_CD(+) AND T1.CABT_CD = T2.CABT_CD(+) AND T1.INFO_YR = #INFO_YR# AND T1.TPOF_CYCL = #TPOF_CYCL# AND T2.TRGT_NOP_ENO(+) = #TRGT_NOP_ENO# GROUP BY T1.INFO_YR, T1.TPOF_CYCL, T1.CABT_GP_CD, T1.CABT_CD, T1.AV_SC_4RK, T1.AV_SC_5RK, T1.AV_SC_67RK, T1.OCM_AV_SC_5RK, T1.OCM_AV_SC_67RK, T2.JBGD_SECD, T1.CABT_DF ORDER BY CABT_GP_CD, CABT_CD