MERGE INTO /*CSPDCP517P203Merge2*/ TB_CSPDCP203M A USING ( SELECT #CLM_SECD# AS CLM_SECD /* 청구구분코드 */,
    #CVLCPT_RCPT_YR# AS CVLCPT_RCPT_YR /* 민원접수년도 */,
    #CVLCPT_RCPT_RCPT# AS CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    #CVPT_DOC_DVSN_CD# AS TPOF_DOC_SECD /* 제보문서구분코드 */,
    #DGE# AS TPOF_CYCL /* 제보차수 */
FROM DUAL ) B ON ( A.CLM_SECD = B.CLM_SECD AND A.CVLCPT_RCPT_YR = B.CVLCPT_RCPT_YR AND A.CVLCPT_RCPT_RCPT = B.CVLCPT_RCPT_RCPT AND A.TPOF_DOC_SECD = B.TPOF_DOC_SECD AND A.TPOF_CYCL = B.TPOF_CYCL ) WHEN MATCHED THEN UPDATE SET TPOF_DOC_CN = #TPOF_DOC_CN# /* 제보문서내용 */, LAST_USER_ID = #LAST_USER_ID# /* 최종사용자아이디 */, LAST_PRCS_DEPT_CD = #LAST_PRCS_DEPT_CD# /* 최종처리부서코드 */, LAST_MENU_ID = #LAST_MENU_ID# /* 최종메뉴아이디 */, LAST_MDFCN_DT = SYSDATE WHEN NOT MATCHED THEN INSERT INSERT ( CLM_SECD ,CVLCPT_RCPT_YR ,CVLCPT_RCPT_RCPT ,CVLCPT_DOC_SQNO ,TPOF_DOC_SECD ,TPOF_DOC_CN ,TPOF_CYCL ,FRST_USER_ID ,LAST_USER_ID ,LAST_PRCS_DEPT_CD ,LAST_MENU_ID ,FRST_REG_DT ,LAST_MDFCN_DT ) VALUES ( #CLM_SECD# ,#CVLCPT_RCPT_YR# ,#CVLCPT_RCPT_RCPT# ,( SELECT NVL(MAX(CVLCPT_DOC_SQNO),0)+1 AS CVLCPT_DOC_SQNO /* 민원문서순번 */
FROM TB_CSPDCP203M WHERE CLM_SECD = #CLM_SECD# AND CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND CVLCPT_RCPT_RCPT = #CVLCPT_RCPT_RCPT# ) ,#CVPT_DOC_DVSN_CD# ,#TPOF_DOC_CN# ,#DGE# ,#FRT_USR_ID# ,#LAST_USER_ID# ,#LAST_PRCS_DEPT_CD# ,#LAST_MENU_ID# ,SYSDATE ,SYSDATE )