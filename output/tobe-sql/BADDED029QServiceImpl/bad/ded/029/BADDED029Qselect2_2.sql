SELECT TER.BZTRP_YR /* 출장년도 */,
    /*출장년도 */ TER.BZTRP_SQNO AS BZTRP_SQNO /* 출장순번 */,
    /*출장순번 */ TER.BZTRVR_ENO AS BZTRVR_ENO /* 출장자직원전산번호 */,
    /*출장자전산번호 */ TER.BZTRVR_NM AS BZTRVR_NM /* 출장자명 */,
    /*출장자성명 */ TER.BZTRVR_JBGD_SECD AS BZTRVR_JBGD_SECD /* 출장자직급구분코드 */,
    /*출장자 직급코드 */ F_CODE_NM('1000173',TER.BZTRVR_JBGD_SECD) AS F_CODE_NM,
    /*직급명 */ TER.EMP_SECD AS EMP_SECD /* 직원구분코드 */,
    /*출장구분코드 */ F_DPT_INFO(BL.OGDP_DEPT_CD,'4') AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    /*소속명 */ NVL(TE.BZTRP_TRVEXP_FDEXP,0) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    /*식비 */ NVL(TE.BTEXP_CRTR_AMT,0) AS BTEXP_CRTR_AMT /* 출장비기준금액 */,
    /*일비 */ NVL(TE.LDG_CST,0) AS LDG_CST /* 숙박비용 */,
    /*숙박비 */ NVL(TE.CPRG_FARE_CST,0) AS CPRG_FARE_CST /* 수도권운임비용 */,
    /*수도권운임비*/ NVL(TE.IN_EXP,0) AS IN_EXP,
    /*국내여비 */ NVL(TE.SPM_CST,0) AS SPM_CST /* 보충비용 */,
    /*보충경비 */ NVL(TE.BZTRP_DCN,0) AS BZTRP_DCN /* 출장일수 */,
    /*출장일수 */ NVL(TFD.RL_FARE_AMT, 0) + NVL(TE.CPRG_FARE_CST,0) AS RL_FARE_AMT /* 철도운임금액 */,
    /*철도비+수도권운임비*/ ( CASE WHEN SITU.BZTRP_TL_ENO = TER.BZTRVR_ENO THEN TER2.LEAD_CST ELSE 0 END) AS LEAD_CST /* 지휘비용 */,
    /*지휘비 */ NVL(NVL(TFD.RL_FARE_AMT,0), 0) + NVL(NVL(TE.CPRG_FARE_CST,0), 0) + NVL(TE.IN_EXP,0) + NVL(TE.SPM_CST,0) + ( CASE WHEN SITU.BZTRP_TL_ENO = TER.BZTRVR_ENO THEN NVL(TER2.LEAD_CST,0) ELSE 0 END) AS RL_FARE_AMT /* 철도운임금액 */
FROM TB_BADDED010L TER , TB_BADDED002M SITU , (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    SUM(NVL(TE0.BZTRP_TRVEXP_FDEXP,0)) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    SUM(NVL(TE0.BTEXP_CRTR_AMT,0)) AS BTEXP_CRTR_AMT /* 출장비기준금액 */,
    SUM(NVL(TE0.LDG_CST,0)) AS LDG_CST /* 숙박비용 */,
    SUM(NVL(TE0.CPRG_FARE_CST,0)) AS CPRG_FARE_CST /* 수도권운임비용 */,
    /*수도권운임비추가 - 2015.05.06 yyh*/ SUM(NVL(TE0.SPM_CST,0)) AS SPM_CST /* 보충비용 */,
    SUM(NVL(TE0.BZTRP_TRVEXP_FDEXP,0)) + SUM(NVL(TE0.BTEXP_CRTR_AMT,0)) + SUM(NVL(TE0.LDG_CST,0)) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    SUM(NVL(TE0.BZTRP_DCN,0)) AS BZTRP_DCN /* 출장일수 */
FROM TBBADDED011L TE0 WHERE 1 = 1 AND BZTRP_YR =#BZTRP_YR# AND BZTRP_SQNO =#BZTRP_SQNO# AND CAL_YN = 'N' GROUP BY BZTRP_YR, BZTRP_SQNO, BZTRVR_ENO ) TE , (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    SUM(LEAD_CST) AS LEAD_CST /* 지휘비용 */
FROM TBBADDED011L WHERE 1 = 1 AND BZTRP_YR = #BZTRP_YR# AND BZTRP_SQNO = #BZTRP_SQNO# AND CAL_YN = 'N' GROUP BY BZTRP_YR, BZTRP_SQNO ) TER2 , (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    SUM(RL_FARE_AMT) AS RL_FARE_AMT /* 철도운임금액 */
FROM TBBADDED017L WHERE 1 = 1 AND BZTRP_YR = #BZTRP_YR# AND BZTRP_SQNO = #BZTRP_SQNO# AND CAL_YN = 'N' GROUP BY BZTRP_YR, BZTRP_SQNO, BZTRVR_ENO ) TFD , (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    MAX(OGDP_DEPT_CD) AS OGDP_DEPT_CD /* 소속부서코드 */
FROM TBBADDED005L WHERE 1 = 1 AND BZTRP_YR = #BZTRP_YR# AND BZTRP_SQNO = #BZTRP_SQNO# GROUP BY BZTRP_YR, BZTRP_SQNO, BZTRVR_ENO ) DBO_BLL_BLNC WHERE 1 = 1 AND TE.BZTRP_YR(+) = TER.BZTRP_YR AND TE.BZTRP_SQNO(+) = TER.BZTRP_SQNO AND TE.BZTRVR_ENO(+) = TER.BZTRVR_ENO AND TFD.BZTRP_YR(+) = TER.BZTRP_YR AND TFD.BZTRP_SQNO(+) = TER.BZTRP_SQNO AND TFD.BZTRVR_ENO(+) = TER.BZTRVR_ENO AND TER2.BZTRP_YR = TER.BZTRP_YR AND TER2.BZTRP_SQNO = TER.BZTRP_SQNO AND SITU.BZTRP_YR = TER.BZTRP_YR AND SITU.BZTRP_SQNO = TER.BZTRP_SQNO AND BL.BZTRP_YR(+) = TER.BZTRP_YR AND BL.BZTRP_SQNO(+) = TER.BZTRP_SQNO AND BL.BZTRVR_ENO(+) = TER.BZTRVR_ENO AND TER.BZTRP_YR = #BZTRP_YR# AND TER.BZTRP_SQNO = #BZTRP_SQNO#