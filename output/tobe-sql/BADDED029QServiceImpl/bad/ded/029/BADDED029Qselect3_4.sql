SELECT CD.CD_NM,
    /*지역명*/ AGGR.MAN_DAY,
    /*연인원*/ AGGR.IN_EXP,
    /*여비*/ AGGR.RL_FARE_AMT AS RL_FARE_AMT /* 철도운임금액 */,
    /*철도비*/ AGGR.SUM_ALL /* 계 */
FROM (SELECT RGN_SECD /* 지역구분코드 */,
    SUM(TE.BZTRP_DCN) AS BZTRP_DCN /* 출장일수 */,
    SUM(TE.BZTRP_TRVEXP_FDEXP)+ SUM(TE.BTEXP_CRTR_AMT) + SUM(TE.LDG_CST) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    NVL(SUM(TFD.RL_FARE_AMT), 0) + NVL(SUM(TE.CPRG_FARE_CST), 0) AS RL_FARE_AMT /* 철도운임금액 */,
    /*2015.05.11 - 수도권운임추가 yyh*/ SUM(TE.BZTRP_TRVEXP_FDEXP)+ SUM(TE.BTEXP_CRTR_AMT) + SUM(TE.LDG_CST) +NVL(SUM(TFD.RL_FARE_AMT), 0) + NVL(SUM(TE.CPRG_FARE_CST), 0) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */
FROM TBBADDED011L TE, (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    BTEXP_SQNO /* 출장비순번 */,
    CAL_YN /* 계산여부 */,
    SUM(RL_FARE_AMT) AS RL_FARE_AMT /* 철도운임금액 */
FROM TBBADDED017L WHERE BZTRP_YR = #BZTRP_YR# /*인자값 출장년도*/ AND BZTRP_SQNO = #BZTRP_SQNO# /*인자값 출장순번*/ GROUP BY BZTRP_YR, BZTRP_SQNO, BZTRVR_ENO, BTEXP_SQNO, CAL_YN ) TFD WHERE TE.BZTRP_YR = #BZTRP_YR# /*인자값 출장년도*/ AND TE.BZTRP_SQNO = #BZTRP_SQNO# /*인자값 출장순번*/ AND TE.CMPTN_YN = 'Y' AND TFD.BZTRP_YR(+) = TE.BZTRP_YR AND TFD.BZTRP_SQNO(+) = TE.BZTRP_SQNO AND TFD.BZTRVR_ENO(+) = TE.BZTRVR_ENO AND TFD.BTEXP_SQNO(+) = TE.BTEXP_SQNO AND TFD.CAL_YN(+) = TE.CAL_YN GROUP BY TE.RGN_SECD) AGGR, TBDCMACM013C CD WHERE CD.CMM_CD_DVSN_CD = '1000023' AND CD.CD = AGGR.RGN_SECD AND CD.CD IN ('1', '2', '3')