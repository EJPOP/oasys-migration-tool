SELECT SUM(BZTRP_TRVEXP_FDEXP) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    /*식비 합계*/ SUM(BTEXP_CRTR_AMT) AS BTEXP_CRTR_AMT /* 출장비기준금액 */,
    /*일비 합계*/ SUM(LDG_CST) AS LDG_CST /* 숙박비용 */,
    /*숙박비 합계*/ SUM(RL_FARE_AMT) AS RL_FARE_AMT /* 철도운임금액 */,
    /*철도비 합계*/ SUM(LDG_DCN) AS LDG_DCN /* 숙박일수 */,
    /*숙박일수 합계*/ SUM(BZTRP_DCN) AS BZTRP_DCN /* 출장일수 */,
    /*출장일수 합계*/ SUM(SUM_ALL) AS SUM_ALL,
    /*지급액 합계*/ MAX(TER.PSON_CNT) AS PSON_CNT /* 출장인원수 합계 */
FROM (SELECT TE.BZTRP_DCN /* 출장일수 */,
    TE.BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    TE.LDG_CST /* 숙박비용 */,
    TE.BTEXP_CRTR_AMT /* 출장비기준금액 */,
    NVL(TFD.RL_FARE_AMT, 0) + NVL(TE.CPRG_FARE_CST, 0) AS RL_FARE_AMT /* 철도운임금액 */,
    /*철도비+수도권운임비 2015.05.07 yyh*/ TE.BZTRP_TRVEXP_FDEXP + TE.LDG_CST + TE.BTEXP_CRTR_AMT + NVL(TFD.RL_FARE_AMT, 0) + NVL(TE.CPRG_FARE_CST, 0) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    TE.LDG_DCN /* 숙박일수 */
FROM TBBADDED011L TE, (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    BTEXP_SQNO /* 출장비순번 */,
    SUM(RL_FARE_AMT) AS RL_FARE_AMT /* 철도운임금액 */
FROM TBBADDED017L WHERE BZTRP_YR = #BZTRP_YR# AND BZTRP_SQNO = #BZTRP_SQNO# AND CAL_YN= 'N' GROUP BY BZTRP_YR, BZTRP_SQNO, BZTRVR_ENO, BTEXP_SQNO ) TFD WHERE TE.BZTRP_YR = #BZTRP_YR# AND TE.BZTRP_SQNO = #BZTRP_SQNO# AND TE.CAL_YN = 'N' AND TFD.BZTRP_YR(+) = TE.BZTRP_YR AND TFD.BZTRP_SQNO(+) = TE.BZTRP_SQNO AND TFD.BZTRVR_ENO(+) = TE.BZTRVR_ENO AND TFD.BTEXP_SQNO(+) = TE.BTEXP_SQNO ) AGGR, (SELECT COUNT(*) AS PSON_CNT
FROM TBBADDED010L WHERE BZTRP_YR = #BZTRP_YR# AND BZTRP_SQNO = #BZTRP_SQNO#) TER