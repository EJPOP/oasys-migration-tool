SELECT DISTINCT F_CODE_NM('1000758',D2.SLCT_DCLR_KDCD) AS F_CODE_NM,
    F_CODE_NM('1000759',D2.SLCT_DCLR_KND_DTL_SECD) AS F_CODE_NM,
    TO_CHAR(D2.SLCT_RCPT_DT, 'YYYY.MM.DD HH:MM') AS CRU_RCPT_DT /* 부패접수일시 */,
    D2.CVLCPT_RCPT_YR||'-청금-'||D2.SLCT_ACTL_RCPT_NO AS NTFCTN_RCPT_SQNO /* 통보접수순번 */,
    D2.SLCT_TTL /* 청탁제목 */,
    D2.SLCT_RLPR_NM /* 청탁관계자명 */,
    'O' AS MAIN_YN,
    CASE WHEN D1.CVLCPT_DCLR_SECD = #CVLCPT_MCA_DCLR_SECD# AND D1.CVLCPT_RCPT_YR = #TPOF_MCA_RCPT_YR# AND D1.CVLCPT_DCLR_RCPT_NO = #CVLCPT_MCA_DCLR_RCPT_NO# THEN 'O' ELSE '' END AS CVLCPT_DCLR_SECD /* 민원신고구분코드 */
FROM TB_CSPDCP819L D1, TB_CSPDCP811M D2 WHERE D1.CVLCPT_DCLR_SECD = D2.CVLCPT_DCLR_SECD AND D1.CVLCPT_RCPT_YR = D2.CVLCPT_RCPT_YR AND D1.CVLCPT_DCLR_RCPT_NO = D2.CVLCPT_DCLR_RCPT_NO AND ((D1.CVLCPT_DCLR_SECD = #CVLCPT_MCA_DCLR_SECD# AND D1.CVLCPT_RCPT_YR = #TPOF_MCA_RCPT_YR# AND D1.CVLCPT_DCLR_RCPT_NO = #CVLCPT_MCA_DCLR_RCPT_NO#) OR (D1.CVLCPT_MCA_DCLR_SECD = #CVLCPT_MCA_DCLR_SECD# AND D1.CVLCPT_MCA_RCPT_YR = #TPOF_MCA_RCPT_YR# AND D1.CVLCPT_MCA_DCLR_RCPT_NO = #CVLCPT_MCA_DCLR_RCPT_NO#)) UNION SELECT DISTINCT F_CODE_NM('1000758',D3.SLCT_DCLR_KDCD) AS F_CODE_NM,
    F_CODE_NM('1000759',D3.SLCT_DCLR_KND_DTL_SECD) AS F_CODE_NM,
    TO_CHAR(D3.SLCT_RCPT_DT, 'YYYY.MM.DD HH:MM') AS CRU_RCPT_DT /* 부패접수일시 */,
    D3.CVLCPT_RCPT_YR||'-청금-'||D3.SLCT_ACTL_RCPT_NO AS CVLCPT_RCPT_YR /* 민원접수년도 */,
    D3.SLCT_TTL /* 청탁제목 */,
    D3.SLCT_RLPR_NM /* 청탁관계자명 */,
    '' AS MAIN_YN,
    CASE WHEN D2.CVLCPT_MCA_DCLR_SECD = #CVLCPT_MCA_DCLR_SECD# AND D2.CVLCPT_MCA_RCPT_YR = #TPOF_MCA_RCPT_YR# AND D2.CVLCPT_MCA_DCLR_RCPT_NO = #CVLCPT_MCA_DCLR_RCPT_NO# THEN 'O' ELSE '' END AS CVLCPT_MCA_DCLR_SECD /* 민원합건신고구분코드 */
FROM TB_CSPDCP819L D1, TB_CSPDCP819L D2, TB_CSPDCP811M D3 WHERE D1.CVLCPT_DCLR_SECD = D2.CVLCPT_DCLR_SECD AND D1.CVLCPT_RCPT_YR = D2.CVLCPT_RCPT_YR AND D1.CVLCPT_DCLR_RCPT_NO = D2.CVLCPT_DCLR_RCPT_NO AND D2.CVLCPT_MCA_DCLR_SECD = D3.CVLCPT_DCLR_SECD AND D2.CVLCPT_MCA_RCPT_YR = D3.CVLCPT_RCPT_YR AND D2.CVLCPT_MCA_DCLR_RCPT_NO = D3.CVLCPT_DCLR_RCPT_NO AND ((D1.CVLCPT_DCLR_SECD =#CVLCPT_MCA_DCLR_SECD# AND D1.CVLCPT_RCPT_YR = #TPOF_MCA_RCPT_YR# AND D1.CVLCPT_DCLR_RCPT_NO = #CVLCPT_MCA_DCLR_RCPT_NO#) OR (D1.CVLCPT_MCA_DCLR_SECD =#CVLCPT_MCA_DCLR_SECD# AND D1.CVLCPT_MCA_RCPT_YR = #TPOF_MCA_RCPT_YR# AND D1.CVLCPT_MCA_DCLR_RCPT_NO = #CVLCPT_MCA_DCLR_RCPT_NO#)) ORDER BY MAIN_YN, CRU_RCPT_DT DESC