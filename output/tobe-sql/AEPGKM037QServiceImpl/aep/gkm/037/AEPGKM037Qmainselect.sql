SELECT KLD_CAT_CD,
    TG_CAT_NM,
    COUNT(KLD_CAT_CD) AS KLD_CAT_CD,
    COUNT(DECODE(KLD_STA_CD, '6', '유통')) AS KLD_STA_CD,
    COUNT(DECODE(KLD_STA_CD, '7', '만기')) AS KLD_STA_CD,
    COUNT(DECODE(KLD_STA_CD, '8', '폐기')) AS KLD_STA_CD
FROM TBAEPGKM001M AS A, TBAEPGKM017M AS B WHERE 1=1 AND A.KLD_CAT_CD = B.TG_CAT_ID A.KLD_CAT_CD IN ( SELECT TG_CAT_ID
FROM TBAEPGKM017M A , ( SELECT SRT_VAL_NM
FROM TBAEPGKM017M WHERE TG_CAT_ID = #KLD_CAT_CD# ) B WHERE A.SRT_VAL_NM LIKE B.SRT_VAL_NM || '%' ) TO_NUMBER(SUBSTR(REG_DMND_YMD, 1, 6)) >= TO_NUMBER(#FROM_DATE#) TO_NUMBER(SUBSTR(REG_DMND_YMD, 1, 6)) GROUP BY KLD_CAT_CD, TG_CAT_NM, B.SRT_VAL_NM ORDER BY SUBSTR(B.SRT_VAL_NM, 0, 3), LENGTH(B.SRT_VAL_NM), TO_NUMBER(B.SRT_VAL_NM)