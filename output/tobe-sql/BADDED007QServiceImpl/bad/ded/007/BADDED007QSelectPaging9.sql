SELECT BBB.PROF_RBPRSN_INST_NM AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    CCC.CD_NM AS INST_SE_NM,
    F_MNG_KND_AUDYRNO(AAA.CVLCPT_ADT_YR, AAA.ADT_NO, AAA.ADT_KDCD, '-') || '(' || AAA.CVLCPT_ADT_STP_SQNO || ')' AS F_MNG_KND_AUDYRNO,
    DDD.CD_NM || '(' || FFF.CD_NM || ')' AS CD_NM,
    EEE.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    TO_CHAR(TO_DATE(AAA.ADT_BGNG_YMD),'YYYY.MM.DD') || '~' || TO_CHAR(TO_DATE(AAA.ADT_END_YMD),'YYYY.MM.DD') AS TO_CHAR,
    AAA.ADT_DCN AS ADT_DCN /* 감사일수 */,
    AAA.IN_PSON_CNT || '(' || AAA.IN_PSON_MAN_CNT || ')' AS IN_PSON_CNT,
    AAA.EXT_PSON_CNT || '(' || AAA.EXT_PSON_MAN_CNT || ')' AS EXT_PSON_CNT,
    AAA.ADT_MTTR_NM AS ADT_MTTR_NM /* 감사사항명 */,
    AAA.INST_CD /* 기관코드 */,
    AAA.BZTRP_YR /* 출장년도 */,
    AAA.BZTRP_SQNO /* 출장순번 */
FROM (SELECT AA.*,
    BB.IN_PSON_CNT,
    BB. AS BB.,
    CC.IN_PSON_MAN_CNT,
    CC. AS CC.,
    CC.ADT_DCN /* 감사일수 */
FROM (SELECT /*+ USE_HASH(A,B,C)*/ A.BZTRP_YR AS BZTRP_YR /* 출장년도 */,
    A.BZTRP_SQNO /* 출장순번 */,
    A.FT_SQNO /* 출장조순번 */,
    A.BZTRP_YR||'-'||A.BZTRP_SQNO||'('||A.FT_SQNO||')' AS BZTRP_YR /* 출장년도 */,
    A.INST_CD /* 기관코드 */,
    A.ADT_BGNG_YMD /* 감사시작일자 */,
    A.ADT_END_YMD /* 감사종료일자 */,
    B.ADT_STP_SQNO /* 감사단계순번 */,
    B.ADT_BZTRP_KDCD /* 감사출장종류코드 */,
    C.ADT_YR /* 감사년도 */,
    C.ADT_NO /* 감사번호 */,
    C.INST_SECD /* 기관구분코드 */,
    C.ADT_KDCD /* 감사종류코드 */,
    C.SPRVSN_DEPT_CD /* 주관부서코드 */,
    C.ADT_MTTR_NM /* 감사사항명 */
FROM TBBADDED008L A , TBBADDED002M B , TBBADDED001M C WHERE 1 = 1 AND A.BZTRP_YR BETWEEN #strBztStYY# AND #strBztEndYY# /*인자값1*/ AND A.ADT_BGNG_YMD BETWEEN #strBztStYY#||#strBztStMM#||#strBztStDD# AND #strBztEndYY#||#strBztEndMM#||#strBztEndDD# /*인자값2*/ AND B.BZTRP_YR = A.BZTRP_YR AND B.BZTRP_SQNO = A.BZTRP_SQNO AND B.BZTRP_SECD = '1' AND C.CVLCPT_ADT_YR = B.REL_ADT_YR AND C.ADT_NO = B.REL_ADT_NO AND A.INST_CD >= #strOrgCdSt# AND A.INST_CD AND SUBSTRING(C.ADT_KDCD, 3, 1) >= #strAudKndCdSt# AND SUBSTRING(C.ADT_KDCD, 3, 1) AND C.INST_SECD = #INST_SECD# /*인자값5*/ ) AA , (SELECT /*+ INDEX(A KBBADBADDED005001) */ BZTRP_YR AS BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    SUM( CASE WHEN A.EMP_SECD = '0' THEN 1 ELSE 0 END) AS EMP_SECD /* 직원구분코드 */,
    SUM( CASE WHEN A.EMP_SECD = '0' THEN 0 ELSE 1 END) AS EMP_SECD /* 직원구분코드 */
FROM (SELECT DISTINCT AS BZTRP_YR,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    EMP_SECD /* 직원구분코드 */
FROM TBBADDED005L) A GROUP BY BZTRP_YR, BZTRP_SQNO ) BB , (SELECT /*+ USE_NL_WITH_INDEX(A, KBBADBADDED005001)*/ A.BZTRP_YR AS BZTRP_YR /* 출장년도 */,
    A.BZTRP_SQNO /* 출장순번 */,
    SUM( CASE WHEN A.EMP_SECD = '0' THEN B.ADT_DCN ELSE 0 END) AS EMP_SECD /* 직원구분코드 */,
    SUM( CASE WHEN A.EMP_SECD = '0' THEN 0 ELSE B.ADT_DCN END) AS EMP_SECD /* 직원구분코드 */,
    MAX(B.ADT_DCN) AS ADT_DCN /* 감사일수 */
FROM TBBADDED005L A , TBBADDED006L B WHERE B.BZTRP_YR = A.BZTRP_YR AND B.BZTRP_SQNO = A.BZTRP_SQNO AND B.FT_SQNO = A.FT_SQNO AND B.BZTRVR_ALTMNT_SQNO = A.BZTRVR_ALTMNT_SQNO GROUP BY A.BZTRP_YR, A.BZTRP_SQNO ) CC WHERE AA.BZTRP_YR = BB.BZTRP_YR(+) AND AA.BZTRP_SQNO = BB.BZTRP_SQNO(+) AND AA.BZTRP_YR = CC.BZTRP_YR(+) AND AA.BZTRP_SQNO = CC.BZTRP_SQNO(+) ) AAA , TBDCMACM015M BBB , (SELECT CD,
    CD_NM
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000119') CCC , (SELECT CD,
    CD_NM
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000007') DDD , TBDCMACM002M EEE , (SELECT CD,
    CD_NM
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000030') FFF WHERE 1=1 AND BBB.INST_CD = AAA.INST_CD AND CCC.CD = AAA.INST_SECD AND DDD.CD = AAA.ADT_KDCD AND EEE.SRECS_DEPT_CD = AAA.SPRVSN_DEPT_CD AND FFF.CD = AAA.ADT_BZTRP_KDCD