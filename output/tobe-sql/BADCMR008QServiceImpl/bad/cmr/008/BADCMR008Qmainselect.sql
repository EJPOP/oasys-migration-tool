SELECT D3.INFO_YR || '-' || D3.LAG_CAT_SNO || '-' || D3.MID_CAT_SNO || '-' || D3.SALL_CAT_SNO AS INFO_YR /* 정보년도 */,
    D3.SALL_CAT_TIT_NM /* 과제명 */,
    F_DPT_INFO(D3.CHR_DPT_CD, '1') AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    D3.CHR_DPT_CD,
    F_USR_INFO(D3.PIC_ID, '2') AS PIC_NM /* 담당자명 */,
    D3.FIRST_HALF_MDF_DH /* 상반기 */,
    D3.SECOND_HALF_MDF_DH /* 하반기 */,
    D3.INFO_YR /* 정보년도 */,
    D3.SALL_CAT_SNO,
    D3.PIC_ID /* 담당자아이디 */,
    NVL(D3.CMPTN_YN, 'N') AS CMPTN_YN /* 완료여부 */,
    D3.INFO_YR || '년 상반기 보고서' AS INFO_YR /* 정보년도 */,
    D3.INFO_YR || '년 하반기 보고서' AS INFO_YR /* 정보년도 */,
    D3.LAG_CAT_TIT_NM /* 대분류 명 */,
    D3.MID_CAT_TIT_NM /* 중분류명 */
FROM ( SELECT D1.SALL_CAT_TIT_NM /* 과제명 */,
    D1.CHR_DPT_CD,
    D1.PIC_ID /* 담당자아이디 */,
    MAX(CASE WHEN D2.REG_YMD BETWEEN #INFO_YR#||'0101' AND #INFO_YR#||'0401' THEN D2.REG_YMD ELSE NULL END) AS REG_YMD /* 등록일자 */,
    MAX(CASE WHEN D2.REG_YMD BETWEEN #INFO_YR#||'0402' AND #INFO_YR#||'1001' THEN D2.REG_YMD ELSE NULL END) AS REG_YMD /* 등록일자 */,
    D1.INFO_YR /* 정보년도 */,
    D1.SALL_CAT_SNO,
    D1.LAG_CAT_SNO,
    D1.MID_CAT_SNO,
    D1.CMPTN_YN /* 완료여부 */,
    (SELECT AS LAG_CAT_TIT_NM
FROM TBBADCMR001M WHERE INFO_YR = D1.INFO_YR AND LAG_CAT_SNO = D1.LAG_CAT_SNO) AS LAG_CAT_TIT_NM /*대분류 명*/ , (SELECT MID_CAT_TIT_NM
FROM TBBADCMR002M WHERE INFO_YR = D1.INFO_YR AND LAG_CAT_SNO = D1.LAG_CAT_SNO AND MID_CAT_SNO = D1.MID_CAT_SNO) AS MID_CAT_TIT_NM /*중분류명*/ FROM TBBADCMR004D D2 , TBBADCMR003M D1 WHERE D2.INFO_YR(+) = D1.INFO_YR AND D2.SALL_CAT_SNO(+) = D1.SALL_CAT_SNO AND D1.INFO_YR = #INFO_YR# AND NVL(D1.CPLT_YN, 'N') = #strCpltYn# GROUP BY D1.INFO_YR, D1.SALL_CAT_SNO, D1.LAG_CAT_SNO, D1.MID_CAT_SNO, D1.PIC_ID, D1.CHR_DPT_CD, D1.SALL_CAT_TIT_NM, D1.CMPTN_YN ORDER BY D1.INFO_YR, D1.SALL_CAT_SNO ) D3