SELECT D1.CVLCPT_ADT_YR AS CVLCPT_ADT_YR /* 민원감사년도 */,
    D1.ADT_NO AS ADT_NO /* 감사번호 */,
    D1.DSPS_RQT_SQNO AS DSPS_RQT_SQNO /* 처분요구순번 */,
    D1.SRECS_REL_INST_CD AS SRECS_REL_INST_CD /* 심사재심의관계기관코드 */,
    F_ORG_INFO(D1.SRECS_REL_INST_CD,'1') AS REL_INST_NM /* 관계기관명 */,
    D2.RLPR_NM AS RLPR_NM /* 관계자명 */,
    D2.RLPR_SQNO AS RLPR_SQNO /* 관계자순번 */,
    D2.HND_NM AS HND_NM /* 조치요구 */,
    CASE WHEN D2.RLPR_SQNO IS NOT NULL THEN D2.IMPL_YMD ELSE D1.IMPL_YMD END AS IMPL_YMD /* 집행일자 */,
    CASE WHEN D2.RLPR_SQNO IS NOT NULL THEN D2.ENFM_SHP_NM ELSE D1.ENFM_SHP_NM END AS RLPR_SQNO /* 관계자순번 */,
    CASE WHEN D2.RLPR_SQNO IS NOT NULL THEN D2.IMPL_DSCTN ELSE D1.IMPL_DSCTN END AS IMPL_DSCTN /* 집행내역 */,
    CASE WHEN D2.RLPR_SQNO IS NOT NULL THEN D2.PNL_AMT ELSE D1.PNL_AMT END AS PNL_AMT /* 추징금액 */,
    CASE WHEN D2.RLPR_SQNO IS NOT NULL THEN D2.CPLT_YN ELSE D1.CPLT_YN END AS CPLT_YN /* 완결여부 */
FROM ( SELECT D1.ADT_YR /* 감사년도 */,
    D1.ADT_NO /* 감사번호 */,
    D1.DSPS_RQT_SQNO /* 처분요구순번 */,
    D1.REL_INST_CD /* 관계기관코드 */,
    D2.IMPL_SQNO /* 집행순번 */,
    D2.IMPL_YMD /* 집행일자 */,
    F_CODE_NM('1000003',D2.IMPL_TPCD) AS F_CODE_NM /* 집행형태 */,
    D2.IMPL_DSCTN /* 집행내역 */,
    D2.PNL_AMT /* 추징금액 */,
    DECODE(D1.CPLT_YN,'Y','O','X') AS CPLT_YN /* 완결여부 */
FROM TBBADEAR006M D1 , TBBADFRE006M D2 WHERE 1=1 AND D1.CVLCPT_ADT_YR = D2.CVLCPT_ADT_YR(+) AND D1.ADT_NO = D2.ADT_NO(+) AND D1.DSPS_RQT_SQNO = D2.DSPS_RQT_SQNO(+) AND D1.SRECS_REL_INST_CD = D2.SRECS_REL_INST_CD(+) ) D1 /*관계기관*/ , ( SELECT D1.ADT_YR /* 감사년도 */,
    D1.ADT_NO /* 감사번호 */,
    D1.DSPS_RQT_SQNO /* 처분요구순번 */,
    D1.REL_INST_CD /* 관계기관코드 */,
    D1.RLPR_SQNO /* 관계자순번 */,
    D1.RLPR_NM /* 관계자명 */,
    D1.ACTN_RQT_KDCD /* 조치요구종류코드 */,
    F_CODE_NM('1000011',D1.ACTN_RQT_KDCD) AS F_CODE_NM,
    D2.IMPL_SQNO /* 집행순번 */,
    D2.IMPL_YMD /* 집행일자 */,
    F_CODE_NM('1000003',D2.IMPL_TPCD) AS F_CODE_NM,
    D2.IMPL_DSCTN /* 집행내역 */,
    D2.PNL_AMT /* 추징금액 */,
    DECODE(D1.CPLT_YN,'Y','O','X') AS CPLT_YN /* 완결여부 */
FROM TBBADEAR007M D1 , TBBADFRE008M D2 WHERE 1=1 AND D1.CVLCPT_ADT_YR = D2.CVLCPT_ADT_YR(+) AND D1.ADT_NO = D2.ADT_NO(+) AND D1.DSPS_RQT_SQNO = D2.DSPS_RQT_SQNO(+) AND D1.SRECS_REL_INST_CD = D2.SRECS_REL_INST_CD(+) AND D1.RLPR_SQNO = D2.RLPR_SQNO(+) ) D2 /*관계자*/ WHERE 1=1 AND D1.CVLCPT_ADT_YR = D2.CVLCPT_ADT_YR(+) AND D1.ADT_NO = D2.ADT_NO(+) AND D1.DSPS_RQT_SQNO = D2.DSPS_RQT_SQNO(+) AND D1.SRECS_REL_INST_CD = D2.SRECS_REL_INST_CD(+) AND D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.ADT_NO = #ADT_NO# AND D1.DSPS_RQT_SQNO = #DSPS_RQT_SQNO# ORDER BY D1.SRECS_REL_INST_CD, D2.RLPR_NM