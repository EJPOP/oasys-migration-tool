SELECT A.LINK_YR /* 연계년도 */,
    A.CRS_CD,
    A.CRS_NM /* 과정명 */,
    A.CRS_CDN /* 과정기수 */,
    A.GRNDS_EXMN_AEX_SQNO /* 현장조사수용비순번 */,
    CAST(A.GRNDS_EXMN_AEX_SQNO AS VARCHAR(10)) AS CAST,
    A.TANE_ID,
    A.INFO_RLPR_NM /* 정보관계자명 */,
    A.INST_CD /* 기관코드 */,
    A.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    A.JBGD_NM /* 직급명 */,
    TRIM(TO_CHAR(A.EDU_EXS, '999,999,999,999')) AS TRIM,
    TRIM(TO_CHAR(A.DMT_EXS, '999,999,999,999')) AS TRIM,
    TRIM(TO_CHAR(A.BZTRP_TRVEXP_FDEXP, '999,999,999,999')) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    TRIM(TO_CHAR((A.EDU_EXS + A.DMT_EXS + A.BZTRP_TRVEXP_FDEXP), '999,999,999,999')) AS TRIM,
    TRIM(TO_CHAR(A.PD_AMT, '999,999,999,999')) AS TRIM,
    TRIM(TO_CHAR((A.PD_AMT - (A.EDU_EXS + A.DMT_EXS + A.BZTRP_TRVEXP_FDEXP)), '999,999,999,999')) AS UNPAID_AMT /* 미납금액 */,
    A.PD_MEAN_CD,
    DECODE(A.PD_MEAN_CD, 1, '은행', '현금') AS PD_MEAN_CD,
    A.PD_YN,
    DECODE(A.PD_YN, 'Y', '납부', '미납') AS PD_YN,
    A.EDU_DVSN_NM,
    A.EDU_CAT_NM,
    A.DMT_UE_YN,
    A.BUS_UE_YN,
    A.SEX_CD,
    A.PD_DT,
    A.SLCT_CVLPR_MPNO /* 청탁민원인휴대전화번호 */,
    A.PD_SMS_SEN_DT,
    A.UNP_SMS_SEN_DT,
    A.EDU_DT,
    A.ACTNO_SCRTY /* 계좌번호보안 */
FROM ( SELECT A.LINK_YR /* 연계년도 */,
    B.EDU_DVSN_CD,
    C.EDU_CAT_CD,
    A.CRS_CD,
    D.CRS_NM /* 과정명 */,
    A.CRS_CDN /* 과정기수 */,
    A.GRNDS_EXMN_AEX_SQNO /* 현장조사수용비순번 */,
    A.TANE_ID,
    A.INFO_RLPR_NM /* 정보관계자명 */,
    A.INST_CD /* 기관코드 */,
    E.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    A.JBGD_NM /* 직급명 */,
    DECODE(NVL(A.EDU_EXS, 0), 0, NVL( (SELECT Z.EDU_EXS
FROM TBCSPSAE113B Z WHERE Z.CRS_CD = A.CRS_CD AND APC_DT = (SELECT MAX(APC_DT)
FROM TBCSPSAE113B X WHERE X.CRS_CD = Z.CRS_CD AND X.APC_DT AND B.EDU_DVSN_CD = #strEDU_DVSN_CD# AND C.EDU_CAT_CD = #strEDU_CAT_CD# AND A.CRS_CD = #strEDU_CRS_CD# AND A.CRS_CDN = #CRS_CDN# AND A.PD_YN = #strPD_YN# AND A.INFO_RLPR_NM LIKE '%' || #strNAM# || '%' ORDER BY A.LINK_YR, A.CRS_CD, A.CRS_CDN, A.GRNDS_EXMN_AEX_SQNO ) A UNION SELECT '' AS LINK_YR /* 연계년도 */,
    '' AS CRS_CD,
    '' AS CRS_NM /* 과정명 */,
    0 AS CRS_CDN,
    0 AS GRNDS_EXMN_AEX_SQNO,
    '' AS SNO2,
    '' AS TANE_ID,
    '' AS INFO_RLPR_NM /* 정보관계자명 */,
    '' AS INST_CD /* 기관코드 */,
    '합계' AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    '' AS JBGD_NM /* 직급명 */,
    TRIM(TO_CHAR(SUM(A.EDU_EXS), '999,999,999,999')) AS TRIM,
    TRIM(TO_CHAR(SUM(A.DMT_EXS), '999,999,999,999')) AS TRIM,
    TRIM(TO_CHAR(SUM(A.BZTRP_TRVEXP_FDEXP), '999,999,999,999')) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    TRIM(TO_CHAR(SUM((A.EDU_EXS + A.DMT_EXS + A.BZTRP_TRVEXP_FDEXP)), '999,999,999,999')) AS TRIM,
    TRIM(TO_CHAR(SUM(A.PD_AMT), '999,999,999,999')) AS TRIM,
    TRIM(TO_CHAR(SUM((A.PD_AMT - (A.EDU_EXS + A.DMT_EXS + A.BZTRP_TRVEXP_FDEXP))), '999,999,999,999')) AS UNPAID_AMT /* 미납금액 */,
    '' AS PD_MEAN_CD,
    '' AS PD_MEAN_NM,
    '' AS PD_YN,
    '' AS PD_YN_NM,
    '' AS EDU_DVSN_NM,
    '' AS EDU_CAT_NM,
    '' AS DMT_UE_YN,
    '' AS BUS_UE_YN,
    '' AS SEX_CD,
    '' AS PD_DT,
    '' AS SLCT_CVLPR_MPNO /* 청탁민원인휴대전화번호 */,
    '' AS PD_SMS_SEN_DT,
    '' AS UNP_SMS_SEN_DT,
    '' AS EDU_DT,
    '' AS ACTNO_SCRTY /* 계좌번호보안 */
FROM ( SELECT A.LINK_YR /* 연계년도 */,
    B.EDU_DVSN_CD,
    C.EDU_CAT_CD,
    A.CRS_CD,
    D.CRS_NM /* 과정명 */,
    A.CRS_CDN /* 과정기수 */,
    A.GRNDS_EXMN_AEX_SQNO /* 현장조사수용비순번 */,
    A.TANE_ID,
    A.INFO_RLPR_NM /* 정보관계자명 */,
    A.INST_CD /* 기관코드 */,
    E.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    A.JBGD_NM /* 직급명 */,
    DECODE(NVL(A.EDU_EXS, 0), 0, NVL( (SELECT Z.EDU_EXS
FROM TBCSPSAE113B Z WHERE Z.CRS_CD = A.CRS_CD AND APC_DT = (SELECT MAX(APC_DT)
FROM TBCSPSAE113B X WHERE X.CRS_CD = Z.CRS_CD AND X.APC_DT AND B.EDU_DVSN_CD = #strEDU_DVSN_CD# AND C.EDU_CAT_CD = #strEDU_CAT_CD# AND A.CRS_CD = #strEDU_CRS_CD# AND A.CRS_CDN = #CRS_CDN# AND A.PD_YN = #strPD_YN# AND A.INFO_RLPR_NM LIKE '%' || #strNAM# || '%' ) A