SELECT A.CRS_CDN /* 과정기수 */,
    D.CRS_NM /* 과정명 */,
    SUBSTR(E.EDU_BGNG_YMD, 0, 4) || '.' || SUBSTR(E.EDU_BGNG_YMD, 5, 2) || '.' || SUBSTR(E.EDU_BGNG_YMD, 7, 2) || ' ~ ' || SUBSTR(E.EDU_END_YMD, 0, 4) || '.' || SUBSTR(E.EDU_END_YMD, 5, 2) || '.' || SUBSTR(E.EDU_END_YMD, 7, 2) AS SUBSTR,
    E.EDU_END_YMD /* 교육종료일자 */,
    A.INFO_RLPR_NM /* 정보관계자명 */,
    A.EDU_EXS,
    A.DMT_EXS,
    A.BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    A.PD_AMT,
    A.UNPAID_AMT /* 미납금액 */,
    SUBSTR(A.PD_DT, 0, 4) || '년 ' || SUBSTR(A.PD_DT, 5, 2) || '월 ' || SUBSTR(A.PD_DT, 7, 2) || '일' AS SUBSTR
FROM TBCSPSAE301D A , TBCSPSAE101C B , TBCSPSAE102C C , TBCSPSAE103C D , TBCSPSAE201D E WHERE B.EDU_DVSN_CD = D.EDU_DVSN_CD AND B.EDU_DVSN_CD = C.EDU_DVSN_CD AND C.EDU_CAT_CD = D.EDU_CAT_CD AND D.CRS_CD = A.CRS_CD AND E.LINK_YR = A.LINK_YR AND E.CRS_CD = A.CRS_CD AND E.CRS_CDN = A.CRS_CDN AND A.PD_YN = 'Y' AND A.LINK_YR BETWEEN #strFromY# AND #strToY# AND SUBSTR(E.EDU_BGNG_YMD, 0, 6) BETWEEN #strFromY# || #strFromM# AND #strToY# || #strToM# AND B.EDU_DVSN_CD = #strEDU_DVSN_CD# AND C.EDU_CAT_CD = #strEDU_CAT_CD# AND A.CRS_CD = #strEDU_CRS_CD# AND A.CRS_CDN = #CRS_CDN# AND A.INFO_RLPR_NM LIKE '%' || #strNAM# || '%' ORDER BY A.LINK_YR, B.EDU_DVSN_CD, C.EDU_CAT_CD, A.CRS_CD, A.CRS_CDN, A.INFO_RLPR_NM