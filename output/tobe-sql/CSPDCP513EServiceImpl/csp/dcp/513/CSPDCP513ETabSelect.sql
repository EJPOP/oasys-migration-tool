SELECT D2.TPOF_RSLT_RPTP_PRCS_RSLT_SECD /* 제보결과보고서처리결과구분코드 */,
    F_DPT_INFO(D1.ETC_LBSVC_MNG_DEPT_CD, '1') AS PRCS_DEPT_NM /* 처리부서명 */,
    D1.ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    D1.PRCS_PIC_ID /* 처리담당자아이디 */,
    F_USR_INFO_BY_ID(D1.PRCS_PIC_ID,'2') AS USER_NM /* 사용자명 */,
    D1.FRST_REG_DT /* 최초등록일시 */,
    D1.TPOF_EXMN_RSLT_UNQ_CN /* 제보조사결과고유내용 */,
    D1.CVLCPT_DOC_ID /* 민원문서아이디 */,
    D1.CLM_SECD /* 청구구분코드 */,
    D1.CVLCPT_RCPT_YR /* 민원접수년도 */,
    D1.CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    D1.TPOF_CYCL /* 제보차수 */,
    D1.CRU_SMG_CVLCPT_PRCS_SECD /* 부패신문고민원처리구분코드 */,
    NVL(D1.SLCT_OPM_NTFCTN_SECD,'N') AS SLCT_OPM_NTFCTN_SECD /* 청탁시행문통보구분코드 */,
    CASE WHEN D1.TPOF_BKMK_ANS_CN IS NULL THEN (SELECT Z.TPOF_DOC_CN AS TPOF_BKMK_ANS_CN /* 제보즐겨찾기답변내용 */
FROM TB_CSPDCP203M Z WHERE D1.CLM_SECD = Z.CLM_SECD AND D1.CVLCPT_RCPT_YR = Z.CVLCPT_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = Z.CVLCPT_RCPT_RCPT AND D1.TPOF_CYCL = Z.TPOF_CYCL AND Z.TPOF_DOC_SECD = 'B4') ELSE D1.TPOF_BKMK_ANS_CN END AS TPOF_BKMK_ANS_CN ,D1.CRU_ANSDOC_DOC_ID ,'첨부파일' AS DOC_NM ,CASE WHEN D6.TPOF_ONR_DOC_MNG_CARD_ID IS NOT NULL THEN 'Y' ELSE 'N' END AS REPORT_YN ,CASE WHEN D1.SLCT_OPM_NTFCTN_SECD ='Y' AND D6.TPOF_OPM_ATRZ_STTS_SECD = '30' THEN 'Y' WHEN D1.SLCT_OPM_NTFCTN_SECD = 'N' THEN 'Y' ELSE 'N' END AS ANS_YN ,D1.CRU_PRCS_RSLT_NTFCTN_YN ,D4.TPOF_RCPT_PATH_SECD ,D4.TPOF_RSLT_NTFCTN_MTHD_SECD ,D4.TPOF_CVLPR_EML_ID ,D5.TPOF_OPM_SQNO ,D5.TPOF_OPM_ATRZ_STTS_SECD ,D5.TPOF_ONR_DOC_MNG_CARD_ID ,CASE WHEN D6.TPOF_OPM_ATRZ_STTS_SECD = '30' THEN 'Y' ELSE 'N' END AS REPORT_RESULT_YN ,TO_CHAR(D6.TPOF_ONR_ATRZ_DMND_DT,'YYYY-MM-DD HH24:MI') AS REPORT_ONR_APV_RQS_DH ,TO_CHAR(D6.ONR_ATRZ_CMPTN_DT,'YYYY-MM-DD HH24:MI') AS REPORT_ONR_APV_CMPT_DH ,CASE WHEN D2.TPOF_RSLT_RPTP_PRCS_RSLT_SECD IN ('81','82','83') THEN '80' ELSE CVLCPT_RSLT_RPTP_PRCS_RSLT_SECD END AS CD1 , CVLCPT_RSLT_RPTP_PRCS_RSLT_SECD AS CD2 , TO_CHAR(D5.ONR_ATRZ_CMPTN_DT,'YYYY-MM-DD HH24:MI') AS ONR_ATRZ_CMPTN_DT , D4.TPOF_STTS_SECD , ( SELECT COUNT(*)
FROM TB_CSPDCP203M Z WHERE Z.CLM_SECD = D1.CLM_SECD AND Z.CVLCPT_RCPT_YR = D1.CVLCPT_RCPT_YR AND Z.CVLCPT_RCPT_RCPT = D1.CVLCPT_RCPT_RCPT AND Z.TPOF_CYCL = D1.TPOF_CYCL ) AS REPORT_CNT FROM TB_CSPDCP401H D1 ,TB_CSPDCP402L D2 ,TB_CSPDCP101M D4 ,TB_CSPDCP301M D5 ,TB_CSPDCP301M D6 WHERE 1=1 AND D4.CVLCPT_CLM_SECD = #CLM_SECD# AND D4.TPOF_RCPT_YR = #CVLCPT_RCPT_YR# AND D4.TPOF_RCPT_NO = #CVLCPT_RCPT_RCPT# AND D4.CVLCPT_CLM_SECD = D1.CLM_SECD AND D4.TPOF_RCPT_YR = D1.CVLCPT_RCPT_YR AND D4.TPOF_RCPT_NO = D1.CVLCPT_RCPT_RCPT AND D1.CLM_SECD = D2.CVLCPT_CLM_SECD AND D1.CVLCPT_RCPT_YR = D2.TPOF_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = D2.TPOF_RCPT_NO AND D1.TPOF_CYCL = D2.TPOF_CYCL AND D1.CLM_SECD = D5.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_YR = D5.TPOF_RCPT_YR(+) AND D1.CVLCPT_RCPT_RCPT = D5.TPOF_RCPT_NO(+) AND D1.TPOF_CYCL = D5.TPOF_CYCL(+) AND D5.TPOF_AVTSMT_SECD(+) = 'B' AND D1.CLM_SECD = D6.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_YR = D6.TPOF_RCPT_YR(+) AND D1.CVLCPT_RCPT_RCPT = D6.TPOF_RCPT_NO(+) AND D1.TPOF_CYCL = D6.TPOF_CYCL(+) AND D6.TPOF_AVTSMT_SECD(+) = 'D' ORDER BY D1.TPOF_CYCL