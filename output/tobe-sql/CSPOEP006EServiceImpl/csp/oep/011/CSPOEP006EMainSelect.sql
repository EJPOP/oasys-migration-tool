SELECT C.LOUNGE_ID,
    C.LOUNGE_SRCH_SEQ,
    C.CFR_RM_INSPC_RNM,
    C.CFR_RM_INSPC_RM_DVSN_CD,
    (CASE WHEN C.DAY1_TIME >='900' THEN '●' || TO_CHAR(DAY1_COUNT) WHEN C.DAY1_TIME 0 THEN TO_CHAR(DAY1_COUNT) ELSE '' END END) AS DAY1_TIME,
    (CASE WHEN C.DAY2_TIME >= '900' THEN '●' || TO_CHAR(DAY2_COUNT) WHEN C.DAY2_TIME 0 THEN TO_CHAR(DAY2_COUNT) ELSE '' END END) AS DAY2_TIME,
    (CASE WHEN C.DAY3_TIME >= '900' THEN '●' || TO_CHAR(DAY3_COUNT) WHEN C.DAY3_TIME 0 THEN TO_CHAR(DAY3_COUNT) ELSE '' END END) AS DAY3_TIME,
    (CASE WHEN C.DAY4_TIME >= '900' THEN '●' || TO_CHAR(DAY4_COUNT) WHEN C.DAY4_TIME 0 THEN TO_CHAR(DAY4_COUNT) ELSE '' END END) AS DAY4_TIME,
    (CASE WHEN C.DAY5_TIME >= '900' THEN '●' || TO_CHAR(DAY5_COUNT) WHEN C.DAY5_TIME 0 THEN TO_CHAR(DAY5_COUNT) ELSE '' END END) AS DAY5_TIME,
    (CASE WHEN C.DAY6_TIME >= '900' THEN '●' || TO_CHAR(DAY6_COUNT) WHEN C.DAY6_TIME 0 THEN TO_CHAR(DAY6_COUNT) ELSE '' END END) AS DAY6_TIME,
    (CASE WHEN C.DAY7_TIME >= '900' THEN '●' || TO_CHAR(DAY7_COUNT) WHEN C.DAY7_TIME 0 THEN TO_CHAR(DAY7_COUNT) ELSE '' END END) AS DAY7_TIME,
    (CASE WHEN C.DAY8_TIME >= '900' THEN '●' || TO_CHAR(DAY8_COUNT) WHEN C.DAY8_TIME 0 THEN TO_CHAR(DAY8_COUNT) ELSE '' END END) AS DAY8_TIME,
    (CASE WHEN C.DAY9_TIME >= '900' THEN '●' || TO_CHAR(DAY9_COUNT) WHEN C.DAY9_TIME 0 THEN TO_CHAR(DAY9_COUNT) ELSE '' END END) AS DAY9_TIME,
    (CASE WHEN C.DAY10_TIME >= '900' THEN '●' || TO_CHAR(DAY10_COUNT) WHEN C.DAY10_TIME 0 THEN TO_CHAR(DAY10_COUNT) ELSE '' END END) AS DAY10_TIME,
    (CASE WHEN C.DAY11_TIME >= '900' THEN '●' || TO_CHAR(DAY11_COUNT) WHEN C.DAY11_TIME 0 THEN TO_CHAR(DAY11_COUNT) ELSE '' END END) AS DAY11_TIME,
    (CASE WHEN C.DAY12_TIME >= '900' THEN '●' || TO_CHAR(DAY12_COUNT) WHEN C.DAY12_TIME 0 THEN TO_CHAR(DAY12_COUNT) ELSE '' END END) AS DAY12_TIME,
    (CASE WHEN C.DAY13_TIME >= '900' THEN '●' || TO_CHAR(DAY13_COUNT) WHEN C.DAY13_TIME 0 THEN TO_CHAR(DAY13_COUNT) ELSE '' END END) AS DAY13_TIME,
    (CASE WHEN C.DAY14_TIME >= '900' THEN '●' || TO_CHAR(DAY14_COUNT) WHEN C.DAY14_TIME 0 THEN TO_CHAR(DAY14_COUNT) ELSE '' END END) AS DAY14_TIME,
    C.DAY1_1,
    C.DAY2_1,
    C.DAY3_1,
    C.DAY4_1,
    C.DAY5_1,
    C.DAY6_1,
    C.DAY7_1,
    C.DAY8_1,
    C.DAY9_1,
    C.DAY10_1,
    C.DAY11_1,
    C.DAY12_1,
    C.DAY13_1,
    C.DAY14_1,
    C.RESERVE_USER_ID
FROM ( SELECT A.LOUNGE_ID,
    A.LOUNGE_SRCH_SEQ,
    A.CFR_RM_INSPC_RNM,
    A.CFR_RM_INSPC_RM_DVSN_CD,
    B.RESERVE_USER_ID,
    (SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT=#SELECTED_DAY# AND (STR_HM >= '0900' OR END_HM >= '1800') AND LOUNGE_ID = A.LOUNGE_ID ) DAY1_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT=#SELECTED_DAY# AND LOUNGE_ID = A.LOUNGE_ID ) DAY1_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#),'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY1_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +1,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A.LOUNGE_ID ) DAY2_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +1,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY2_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +1,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY2_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +2,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A.LOUNGE_ID ) DAY3_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +2,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY3_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +2,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY3_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +3,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A. LOUNGE_ID ) DAY4_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +3,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY4_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +3,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY4_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +4,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A.LOUNGE_ID ) DAY5_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +4,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY5_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +4,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY5_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +5,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A.LOUNGE_ID ) DAY6_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +5,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY6_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +5,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY6_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +6,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A.LOUNGE_ID ) DAY7_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +6,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY7_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +6,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY7_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +7,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A.LOUNGE_ID ) DAY8_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +7,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY8_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +7,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY8_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +8,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A.LOUNGE_ID ) DAY9_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +8,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY9_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +8,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY9_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +9,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A.LOUNGE_ID ) DAY10_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +9,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY10_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +9,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY10_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +10,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A.LOUNGE_ID ) DAY11_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +10,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY11_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +10,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY11_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +11,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A.LOUNGE_ID ) DAY12_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +11,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY12_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +11,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY12_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +12,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A.LOUNGE_ID ) DAY13_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +12,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY13_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +12,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY13_1 ,(SELECT SUM(END_HM - STR_HM)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +13,'YYYYMMDD') AND (STR_HM >= '0900' OR END_HM >= '1800' ) AND LOUNGE_ID = A.LOUNGE_ID ) DAY14_TIME ,(SELECT COUNT(*)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +13,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY14_COUNT ,(SELECT COUNT(RESERVE_USER_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +13,'YYYYMMDD') AND RESERVE_USER_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY14_1 FROM TBCSPOEP011M A /*회의실/조사실 관리 기본*/ ,TBCSPOEP012M B /*회의실/조사실 예약 기본*/ WHERE A.LOUNGE_ID = B.LOUNGE_ID(+) AND A.CFR_RM_INSPC_RM_DVSN_CD NOT IN ('1','2') AND B.RESERVE_USER_ID(+) = #USER_ID# AND A.CFR_RM_INSPC_RM_DVSN_CD = #DVSN_CD# GROUP BY A.LOUNGE_ID ,A.LOUNGE_SRCH_SEQ ,A.CFR_RM_INSPC_RNM,B.RESERVE_USER_ID ,A.CFR_RM_INSPC_RM_DVSN_CD ORDER BY A.CFR_RM_INSPC_RM_DVSN_CD, A.LOUNGE_SRCH_SEQ ) C