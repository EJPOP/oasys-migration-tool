SELECT (SELECT AS CD_NM
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000312' AND CD = B.PFSR_DVSN_CD) AS PFSR_DVSN_NM , B.INFO_RLPR_NM , F.EDU_DVSN_NM , E.EDU_CAT_NM , D.CRS_NM , A.CRS_CDN , C.BLL_SBJCT_NM , (SUBSTRING(A.LCT_DT, 0, 4) || '-' || SUBSTRING(A.LCT_DT, 5, 2) || '-' || SUBSTRING(A.LCT_DT, 7, 2) || '(' || SUBSTRING(UPPER(TO_CHAR(TO_DATE(A.LCT_DT), 'DAY', 'NLS_DATE_LANGUAGE=KOREAN')), 0, 1) || ')') AS LCT_DT , A.HUC_TXT || '(' || G.CONSECUTIVE_LEC || ')' AS HUC , CASE WHEN to_char(to_date(SUBSTR(A.LCT_DT, 0, 8))-to_date(sysdate)) = 0 then '강의일' ELSE to_char(to_date(SUBSTR(A.LCT_DT, 0, 8))-to_date(sysdate)) END D_DAY FROM TBCSPSAE202D A , TBCSPSAE109M B , TBCSPSAE101M C , TBCSPSAE103C D , TBCSPSAE102C E , TBCSPSAE101C F , (SELECT LINK_YR /* 연계년도 */,
    CRS_CD,
    CRS_CDN /* 과정기수 */,
    SUBJ_CD,
    LCT_DT,
    COUNT(LINK_YR) AS LINK_YR /* 연계년도 */
FROM TBCSPSAE202D GROUP BY LINK_YR , CRS_CD , CRS_CDN , SUBJ_CD , LCT_DT HAVING LINK_YR BETWEEN SUBSTR(#strFromYm#, 0, 4) AND SUBSTR(#strToYm#, 0, 4)) G , ( SELECT A.LINK_YR /* 연계년도 */,
    A.CRS_CD,
    A.CRS_CDN /* 과정기수 */,
    A.SUBJ_CD,
    A.LCT_DT,
    MIN(ASG_SNO) AS ASG_SNO
FROM TBCSPSAE202D A GROUP BY A.LINK_YR, A.CRS_CD, A.CRS_CDN, A.SUBJ_CD, A.LCT_DT) H WHERE B.PFSR_ID = A.PFSR_ID AND D.CRS_CD = A.CRS_CD AND E.EDU_CAT_CD = D.EDU_CAT_CD AND F.EDU_DVSN_CD = D.EDU_DVSN_CD AND F.EDU_DVSN_CD = E.EDU_DVSN_CD AND C.SUBJ_CD = A.SUBJ_CD AND G.LINK_YR = A.LINK_YR AND G.CRS_CD = A.CRS_CD AND G.CRS_CDN = A.CRS_CDN AND G.SUBJ_CD = A.SUBJ_CD AND G.LCT_DT = A.LCT_DT AND H.LINK_YR = A.LINK_YR AND H.CRS_CD = A.CRS_CD AND H.CRS_CDN = A.CRS_CDN AND H.SUBJ_CD = A.SUBJ_CD AND A.ASG_SNO = H.ASG_SNO AND A.LCT_DT = H.LCT_DT AND SUBSTR(A.LCT_DT, 0, 8) BETWEEN to_char(sysdate,'yyyymmdd') AND SUBSTR(#strToYm#, 0, 8) AND B.INFO_RLPR_NM LIKE '%' || #strNAM# || '%' ORDER BY A.LCT_DT, B.PFSR_DVSN_CD, B.INFO_RLPR_NM, F.EDU_DVSN_NM, E.EDU_CAT_NM, D.CRS_NM, A.CRS_CDN, C.BLL_SBJCT_NM