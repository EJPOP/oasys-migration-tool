SELECT F_MNG_KND_AUDYRNO(AUD.ADT_YR, AUD.ADT_NO, MIN(AUD.ADT_KDCD), '-') ||'('|| SITU.ADT_STP_SQNO ||')' AS F_MNG_KND_AUDYRNO,
    F_DPT_INFO(MIN(AUD.SPRVSN_DEPT_CD),'1') AS F_DPT_INFO,
    /*주관국과명 */ F_CODE_NM('1000007', MIN(AUD.ADT_KDCD)) AS F_CODE_NM,
    /*감사종류명*/ MIN(AUD.ADT_MTTR_NM) AS ADT_MTTR_NM /* 감사사항명 */,
    /*감사사항*/ TO_CHAR(TO_DATE(MIN(AGGR.ADT_BGNG_YMD)),'YYYY-MM-DD') ||'~'|| TO_CHAR(TO_DATE(MIN(AGGR.ADT_BGNG_YMD)),'YYYY-MM-DD') AS ADT_YMD /* 감사일자 */,
    /*감사기간 from*/ /*F_GET_REL_AUDWRK_CNT(MIN(AGGR.AUD_STR_DT),MAX(AGGR.AUD_END_DT) , MAX(AGGR.ORG_CD)) AS AUD_DCN , */ /*감사실시현황의 ~~일*/ SUM(AGGR.ADT_DCN) AS ADT_DCN /* 감사일수 */,
    /*실일수*/ SUM(AGGR.MAN_DAY) AS MAN_DAY /* 연인원 */
FROM TB_BADDED002M SITU, TB_BADDED001M AUD, (SELECT TTO.BZTRP_YR /* 출장년도 */,
    TTO.BZTRP_SQNO /* 출장순번 */,
    MAX(TTO.INST_CD) AS INST_CD /* 기관코드 */,
    MIN(TTO.ADT_BGNG_YMD) AS ADT_BGNG_YMD /* 감사시작일자 */,
    MAX(TTO.ADT_END_YMD) AS ADT_END_YMD /* 감사종료일자 */,
    SUM(PTD.ADT_DCN) AS ADT_DCN /* 감사일수 */,
    MAX(PTD.ADT_DCN) AS ADT_DCN /* 감사일수 */
FROM TBBADDED006L PTD, TBBADDED008L TTO WHERE TTO.ADT_BGNG_YMD >= #strStrFromDt# /*화면의 감사기간 FROM*/ AND TTO.ADT_BGNG_YMD <= #strStrToDt# /*화면의 감사기간 TO*/ AND TTO.INST_CD = #INST_CD# /*화면의 기관명을 클릭시 기관코드*/ AND PTD.BZTRP_YR = TTO.BZTRP_YR AND PTD.BZTRP_SQNO = TTO.BZTRP_SQNO AND PTD.FT_SQNO = TTO.FT_SQNO AND PTD.FT_TRGT_INST_SQNO = TTO.FT_TRGT_INST_SQNO GROUP BY TTO.BZTRP_YR, TTO.BZTRP_SQNO) AGGR WHERE SITU.REL_ADT_YR = AUD.ADT_YR AND SITU.REL_ADT_NO = AUD.ADT_NO AND SITU.BZTRP_SECD ='1' AND SITU.ADT_BZTRP_KDCD IN ('02') AND AGGR.BZTRP_YR = SITU.BZTRP_YR AND AGGR.BZTRP_SQNO = SITU.BZTRP_SQNO GROUP BY AUD.ADT_YR, AUD.ADT_NO, SITU.ADT_STP_SQNO;