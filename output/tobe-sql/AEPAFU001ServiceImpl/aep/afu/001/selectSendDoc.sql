SELECT C.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    C.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    B.RPTP_KDCD /* 보고서종류코드 */,
    B.RPTP_NM /* 보고서명 */,
    D.DOC_ID /* 문서아이디 */,
    B.DOC_ID /* 문서아이디 */,
    (CASE WHEN D.DOC_ID IS NOT NULL THEN 'N' WHEN C.SRECS_DEPT_CD = '510000' AND E.LDRV_ENO IS NULL THEN 'N' ELSE 'Y' END) AS CVLCPT_DOC_ID /* 문서아이디 */,
    (CASE WHEN C.SRECS_DEPT_CD = '510000' AND E.LDRV_ENO IS NULL THEN '주심위원 지정전' ELSE '' END) AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    A.CVLCPT_ADT_YR /* 민원감사년도 */,
    A.ADT_NO /* 감사번호 */
FROM TBCSPKDE103M_VIEW A INNER JOIN TB_BADDED103M B ON B.ADT_YR = A.CVLCPT_ADT_YR AND B.ADT_NO = A.ADT_NO AND B.RPTP_KDCD = #SLCT_RPTP_KDCD# AND B.DOC_ID = #CVLCPT_DOC_ID# AND ((#SLCT_RPTP_KDCD# = 'A10700900' AND (B.RFRNC_ID = (A.FRS_MDM_SQNO || A.EDOC_SECD) OR B.RFRNC_ID IN (SELECT AA.INCDNT_SQNO /* 사건순번 */
FROM TB_CSPKDE106M AA WHERE AA.CVLCPT_ADT_YR = A.CVLCPT_ADT_YR AND AA.ADT_NO = A.ADT_NO AND AA.FRS_MDM_SQNO = A.FRS_MDM_SQNO )) ) OR (#SLCT_RPTP_KDCD# != 'A10700900' AND (B.RFRNC_YMD = (A.FRS_MDM_SQNO || A.EDOC_SECD) OR B.RFRNC_YMD IN (SELECT AA.INCDNT_SQNO /* 사건순번 */
FROM TB_CSPKDE106M AA WHERE AA.CVLCPT_ADT_YR = A.CVLCPT_ADT_YR AND AA.ADT_NO = A.ADT_NO AND AA.FRS_MDM_SQNO = A.FRS_MDM_SQNO )) )) INNER JOIN (SELECT AA.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    AA.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */
FROM TBDCMACM002M AA WHERE AA.SRECS_DEPT_CD IN ('180130','510000')) C ON (1=1) LEFT OUTER JOIN TB_BADDED111M D ON D.ADT_YR = A.CVLCPT_ADT_YR AND D.ADT_NO = A.ADT_NO AND D.RCPTN_DEPT_CD = C.SRECS_DEPT_CD AND D.RPTP_KDCD = #SLCT_RPTP_KDCD# AND NVL(D.RFRNC_ID, '99999') = NVL(B.RFRNC_ID, '99999') AND NVL(D.RFRNC_YMD, '99999') = NVL(B.RFRNC_YMD, '99999') LEFT OUTER JOIN TB_BADDED116L E ON E.ADT_YR = A.CVLCPT_ADT_YR AND E.ADT_NO = A.ADT_NO AND E.TASK_SECD = '9' AND E.LDRV_SQNO = (SELECT MAX(FRS_MDM_SQNO) AS FRS_MDM_SQNO /* 포렌식매체순번 */
FROM TB_BADDED116L WHERE CVLCPT_ADT_YR = A.CVLCPT_ADT_YR AND ADT_NO = A.ADT_NO AND TASK_SECD = '9') WHERE A.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND A.ADT_NO = #ADT_NO# AND ((#SLCT_RPTP_KDCD# = 'A10700900' AND B.RFRNC_ID = #TPOF_RFRNC_ID# ) OR (#SLCT_RPTP_KDCD# != 'A10700900' AND B.RFRNC_YMD = #TPOF_RFRNC_YMD#))