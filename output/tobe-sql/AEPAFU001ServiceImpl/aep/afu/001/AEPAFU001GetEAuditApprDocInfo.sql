SELECT A.SORT_SQNO /* 정렬순번 */,
    C.ADT_STP_NM /* 감사단계명 */,
    B.RPTP_NM /* 보고서명 */,
    B.RPTP_KDCD /* 보고서종류코드 */,
    A.ATRZ_DMND_ID /* 결재요청아이디 */,
    A.ADT_YR /* 감사년도 */,
    A.ADT_NO /* 감사번호 */,
    A.ADT_STP_SECD /* 감사단계구분코드 */,
    A.DOC_ID /* 문서아이디 */,
    A.ATRZ_SECD /* 결재구분코드 */,
    A.ATRZ_DOC_SECD /* 결재문서구분코드 */,
    F_OPEN_EDIT(B.LNKG_URL_ADDR) AS F_OPEN_EDIT,
    B.RJCT_RSN_CN /* 반려사유내용 */,
    B.RJCT_DOC_ID /* 반려문서아이디 */,
    CASE WHEN TRIM(B.RJCT_RSN_CN) IS NOT NULL THEN 'O' WHEN TRIM(B.RJCT_RSN_CN) IS NULL THEN 'X' END AS TRIM
FROM TB_BADDED109M A INNER JOIN TB_BADDED103M B ON A.ADT_YR = B.ADT_YR AND A.ADT_NO = B.ADT_NO AND A.ADT_STP_SECD = B.ADT_STP_SECD AND A.DOC_ID = B.DOC_ID INNER JOIN TB_BADDED101M C ON A.ADT_YR = C.ADT_YR AND A.ADT_NO = C.ADT_NO AND A.ADT_STP_SECD = C.ADT_STP_SECD WHERE A.ATRZ_DMND_ID = #ATRZ_DMND_ID# AND A.ATRZ_DOC_SECD = #CRU_ATRZ_DOC_SECD# ORDER BY A.SORT_SQNO