INSERT INTO TB_BADDED102M (CVLCPT_ADT_YR, ADT_NO, ADT_STP_SECD, ADT_MAIN_STP_ID, ADT_MAIN_STP_SQNO, ADT_MAIN_SEQ_WDTH_NO, ADT_MAIN_SEQ_VRTC_NO, ADT_DOC_SECD, CMPTN_YN, ADT_KDCD, ADT_GRNT_NO, SLCT_MAIN_TASK_NM, SLCT_LNKG_TYPE_NM, SRECS_LNKG_URL_ADDR, SRECS_SORT_SQNO, FRST_USER_ID, LAST_USER_ID, LAST_PRCS_DEPT_CD, LAST_MENU_ID, FRST_REG_DT, LAST_MDFCN_DT) (SELECT CVLCPT_ADT_YR /* 민원감사년도 */,
    ADT_NO /* 감사번호 */,
    T3.ADT_STP_SECD /* 감사단계구분코드 */,
    ADT_MAIN_STP_ID /* 감사주요단계아이디 */,
    SBCN_DPP_DTL_SQNO AS SBCN_DPP_DTL_SQNO /* 부의처리안상세순번 */,
    ADT_MAIN_SEQ_WDTH_NO /* 감사주요순서가로번호 */,
    ADT_MAIN_SEQ_VRTC_NO /* 감사주요순서세로번호 */,
    ADT_DOC_SECD /* 감사문서구분코드 */,
    CMPTN_YN /* 완료여부 */,
    T2.ADT_KDCD /* 감사종류코드 */,
    ADT_GRNT_NO /* 감사부여번호 */,
    ADT_MAIN_STP_NM AS ADT_MAIN_STP_NM /* 감사주요단계명 */,
    SLCT_LNKG_TYPE_NM /* 청탁연결유형명 */,
    SRECS_LNKG_URL_ADDR /* 심사재심의연결URL주소 */,
    NULL AS SRECS_SORT_SQNO,
    #FNL_USR_ID# AS LAST_USER_ID /* 최종사용자아이디 */,
    #FNL_USR_ID# AS LAST_USER_ID /* 최종사용자아이디 */,
    #FNL_DEAL_DPT_CD# AS LAST_PRCS_DEPT_CD /* 최종처리부서코드 */,
    #FNL_MNU_ID# AS LAST_MENU_ID /* 최종메뉴아이디 */,
    SYSDATE,
    SYSDATE
FROM TB_BADDED112D T1 JOIN TB_BADDED001M T2 USING (CVLCPT_ADT_YR, ADT_NO) JOIN TB_BADDED102B T3 ON SUBSTR(T2.ADT_KDCD,-1) = T3.ADT_KDCD WHERE CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND ADT_NO = #ADT_NO# AND T3.ADT_STP_SECD = 'A1070' AND SUBSTR(T3.ADT_MAIN_STP_ID,0,2) = '70' AND SBCN_DPP_DTL_SQNO NOT IN (SELECT DISTINCT AS ADT_MAIN_STP_SQNO
FROM TB_BADDED102M WHERE CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND ADT_NO = #ADT_NO# AND SUBSTR(ADT_MAIN_STP_ID,0,2) = '70') )