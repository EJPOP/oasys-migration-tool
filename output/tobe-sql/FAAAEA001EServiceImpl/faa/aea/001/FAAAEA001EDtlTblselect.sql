SELECT D1.TBL_NM||' ('||D1.DATA_NOC||')' AS TBL_NM,
    '■'||D1.TBL_DES||CHR(13)||' -'||CASE WHEN D5.COLS IS NOT NULL THEN D5.COLS||'...' ELSE D5.COLS END AS TBL_DES
FROM TBFAAAEA003M D1 LEFT OUTER JOIN TBFAAAEA004M D2 ON D1.UNT_SYS_NM = D2.UNT_SYS_NM AND D1.TBL_ID = D2.TBL_ID AND D1.JRSD_INST_CD = D2.JRSD_INST_CD AND D1.SYS_NM = D2.SYS_NM LEFT OUTER JOIN TBFAAAEA002M D3 ON D2.UNT_SYS_NM = D3.UNT_SYS_NM AND D2.SYS_NM = D3.SYS_NM AND D2.JRSD_INST_CD = D3.JRSD_INST_CD LEFT OUTER JOIN TBFAAAEA001M D4 ON D4.SYS_NM = D3.SYS_NM AND D4.JRSD_INST_CD = D3.JRSD_INST_CD LEFT OUTER JOIN ( SELECT AGGR_CONCAT(COL_NM,', ') AS AGGR_CONCAT,
    TBL_ID /* 테이블아이디 */,
    UNT_SYS_NM,
    SYS_NM,
    JRSD_INST_CD /* 소관기관코드 */
FROM ( SELECT ROW_NUMBER() OVER (PARTITION BY TBL_ID ORDER BY COL_NM DESC) AS ROW_NUMBER,
    TRIM(COL_NM) AS TRIM,
    TBL_ID /* 테이블아이디 */,
    UNT_SYS_NM,
    SYS_NM,
    JRSD_INST_CD /* 소관기관코드 */
FROM TBFAAAEA004M ORDER BY COL_NM DESC ) M WHERE M.RN AND D3.SYS_NM = #strSysNm# AND D4.JRSD_INST_CD = #JRSD_INST_CD# AND D3.UNT_SYS_NM = #strUntSysNm# AND D4.SYS_NM LIKE '%'||#strSearchStr#||'%' AND D3.UNT_SYS_NM LIKE '%'||#strSearchStr#||'%' AND D1.TBL_NM LIKE '%'||#strSearchStr#||'%' AND D2.COL_NM LIKE '%'||#strSearchStr#||'%' AND (D4.SYS_NM LIKE '%'||#strSearchStr#||'%' OR D3.UNT_SYS_NM LIKE '%'||#strSearchStr#||'%' OR D1.TBL_NM LIKE '%'||#strSearchStr#||'%' OR D2.COL_NM LIKE '%'||#strSearchStr#||'%') GROUP BY D1.TBL_NM, D1.DATA_NOC, D1.TBL_DES, D5.COLS;