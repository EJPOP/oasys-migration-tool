SELECT CASE WHEN LENGTH(D1.JRSD_INST_CD) = '12' THEN '[' || D1.JRSD_INST_CD || '] ' || F_ORG_INFO(D1.JRSD_INST_CD, '1') ELSE '[' || D1.JRSD_INST_CD || '] ' || D1.COPT_ORG_NM END AS LENGTH,
    D1.COPT_ORG_NM AS INST_CD,
    F_ORG_INFO(D1.CMO_INST_CD, '1') AS F_ORG_INFO,
    D1.SYS_NM,
    D2.UNT_SYS_NM,
    D3.TBL_NM,
    D3.TBL_ID /* 테이블아이디 */,
    CASE WHEN D5.COLS IS NOT NULL THEN D5.COLS||'...' ELSE D5.COLS END AS COLS,
    D1.OP_DPT_NM,
    D1.OP_CHGR_NM,
    D1.OP_CHGR_CNIF_NM,
    D1.SYS_DES,
    D1.SYS_BGN_DT,
    D1.SYS_END_DT,
    D1.USE_YN /* 사용여부 */,
    D1.URL_AD,
    D1.JRSD_INST_CD /* 소관기관코드 */,
    D1.BAI_ORG_CD,
    D1.CMO_INST_CD /* 소관청기관코드 */,
    CASE WHEN LENGTH(D1.JRSD_INST_CD) = '12' THEN F_ORG_INFO(D1.JRSD_INST_CD, '1') ELSE D1.COPT_ORG_NM END AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */
FROM TBFAAAEA001M D1 LEFT OUTER JOIN TBFAAAEA002M D2 ON D1.SYS_NM = D2.SYS_NM AND D1.JRSD_INST_CD = D2.JRSD_INST_CD LEFT OUTER JOIN TBFAAAEA003M D3 ON D2.UNT_SYS_NM = D3.UNT_SYS_NM AND D2.SYS_NM = D3.SYS_NM AND D2.JRSD_INST_CD = D3.JRSD_INST_CD LEFT OUTER JOIN TBFAAAEA004M D4 ON D3.UNT_SYS_NM = D4.UNT_SYS_NM AND D3.TBL_ID = D4.TBL_ID AND D3.SYS_NM = D4.SYS_NM AND D3.JRSD_INST_CD = D4.JRSD_INST_CD LEFT OUTER JOIN ( SELECT AGGR_CONCAT(COL_NM,', ') AS AGGR_CONCAT,
    TBL_ID /* 테이블아이디 */,
    UNT_SYS_NM,
    SYS_NM,
    JRSD_INST_CD /* 소관기관코드 */
FROM ( SELECT ROW_NUMBER() OVER (PARTITION BY TBL_ID ORDER BY COL_NM DESC) AS ROW_NUMBER,
    TRIM(COL_NM) AS TRIM,
    TBL_ID /* 테이블아이디 */,
    UNT_SYS_NM,
    SYS_NM,
    JRSD_INST_CD /* 소관기관코드 */
FROM TBFAAAEA004M ORDER BY COL_NM DESC ) M WHERE M.RN AND D1.BAI_ORG_CD = #strOrgCd# AND SUBSTRING(D1.BAI_ORG_CD,0,3) = SUBSTR(#strOrgCd#,0,3) AND D1.SYS_NM LIKE '%'||#strSearchNm#||'%' AND (D1.SYS_NM LIKE '%'||#strSearchNm#||'%' OR D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%') AND (D1.SYS_NM LIKE '%'||#strSearchNm#||'%' OR D3.TBL_NM LIKE '%'||#strSearchNm#||'%') AND (D1.SYS_NM LIKE '%'||#strSearchNm#||'%' OR D4.COL_NM LIKE '%'||#strSearchNm#||'%') AND (D1.SYS_NM LIKE '%'||#strSearchNm#||'%' OR D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%' OR D3.TBL_NM LIKE '%'||#strSearchNm#||'%') AND (D1.SYS_NM LIKE '%'||#strSearchNm#||'%' OR D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%' OR D3.TBL_NM LIKE '%'||#strSearchNm#||'%' OR D4.COL_NM LIKE '%'||#strSearchNm#||'%') AND D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%' AND (D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%' OR D3.TBL_NM LIKE '%'||#strSearchNm#||'%') AND (D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%' OR D4.COL_NM LIKE '%'||#strSearchNm#||'%') AND (D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%' OR D3.TBL_NM LIKE '%'||#strSearchNm#||'%' OR D4.COL_NM LIKE '%'||#strSearchNm#||'%') AND (D3.TBL_NM LIKE '%'||#strSearchNm#||'%') AND (D3.TBL_NM LIKE '%'||#strSearchNm#||'%' OR D4.COL_NM LIKE '%'||#strSearchNm#||'%') AND D4.COL_NM LIKE '%'||#strSearchNm#||'%' AND D1.SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) AND (D1.SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D2.UNT_SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO)) AND (D1.SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D3.TBL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO)) AND (D1.SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D4.COL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO)) AND (D1.SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D2.UNT_SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D3.TBL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO)) AND (D1.SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D2.UNT_SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D4.COL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO)) AND (D1.SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D2.UNT_SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D3.TBL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D4.COL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO)) AND D2.UNT_SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) AND (D2.UNT_SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D3.TBL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO)) AND (D2.UNT_SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D4.COL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO)) AND (D2.UNT_SYS_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D3.TBL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D4.COL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO)) AND (D3.TBL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO)) AND (D3.TBL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) OR D4.COL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO)) AND D4.COL_NM IN (SELECT D2.SML_WORD_NM
FROM ( SELECT D1.SML_WORD_NM,
    D1.STND_SEQ_NO
FROM TBFAAAEA007M D1 WHERE D1.SML_WORD_NM = #strSearchNm# ) D1 LEFT OUTER JOIN TBFAAAEA007M D2 ON D1.STND_SEQ_NO = D2.STND_SEQ_NO) GROUP BY D1.JRSD_INST_CD ,D1.COPT_ORG_NM ,D1.CMO_INST_CD ,D1.SYS_NM ,D2.UNT_SYS_NM ,D3.TBL_NM ,D3.TBL_ID ,D1.OP_DPT_NM ,D1.OP_CHGR_NM ,D1.OP_CHGR_CNIF_NM ,D1.SYS_DES ,D1.SYS_BGN_DT ,D1.SYS_END_DT ,D1.USE_YN ,D1.URL_AD ,D1.JRSD_INST_CD ,D1.BAI_ORG_CD ,D1.CMO_INST_CD ,D5.COLS ORDER BY COPT_ORG, D1.SYS_NM, D2.UNT_SYS_NM, D3.TBL_NM