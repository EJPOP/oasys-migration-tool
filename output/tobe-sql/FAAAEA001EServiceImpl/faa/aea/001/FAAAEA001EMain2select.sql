SELECT CASE WHEN LENGTH(D1.JRSD_INST_CD) = '12' THEN '[' || D1.JRSD_INST_CD || '] ' || F_ORG_INFO(D1.JRSD_INST_CD, '1') ELSE '[' || D1.JRSD_INST_CD || '] ' || D1.COPT_ORG_NM END AS LENGTH,
    D1.COPT_ORG_NM AS INST_CD,
    F_ORG_INFO(D1.CMO_INST_CD, '1') AS F_ORG_INFO,
    D1.SYS_NM,
    D2.UNT_SYS_NM,
    D1.OP_DPT_NM,
    D1.OP_CHGR_NM,
    D1.OP_CHGR_CNIF_NM,
    D1.SYS_DES,
    D1.SYS_BGN_DT,
    D1.SYS_END_DT,
    D1.USE_YN /* 사용여부 */,
    D1.URL_AD,
    D1.JRSD_INST_CD /* 소관기관코드 */,
    D1.BAI_ORG_CD,
    D1.CMO_INST_CD /* 소관청기관코드 */,
    CASE WHEN LENGTH(D1.JRSD_INST_CD) = '12' THEN F_ORG_INFO(D1.JRSD_INST_CD, '1') ELSE D1.COPT_ORG_NM END AS LENGTH
FROM TBFAAAEA001M D1 LEFT OUTER JOIN TBFAAAEA002M D2 ON D1.SYS_NM = D2.SYS_NM AND D1.JRSD_INST_CD = D2.JRSD_INST_CD LEFT OUTER JOIN TBFAAAEA003M D3 ON D2.UNT_SYS_NM = D3.UNT_SYS_NM AND D2.SYS_NM = D3.SYS_NM AND D2.JRSD_INST_CD = D3.JRSD_INST_CD LEFT OUTER JOIN TBFAAAEA004M D4 ON D3.UNT_SYS_NM = D4.UNT_SYS_NM AND D3.TBL_ID = D4.TBL_ID AND D3.SYS_NM = D4.SYS_NM AND D3.JRSD_INST_CD = D4.JRSD_INST_CD LEFT OUTER JOIN TBDCMACM015M D5 ON D1.JRSD_INST_CD = D5.INST_CD WHERE 1=1 AND D1.USE_YN = 'Y' AND D1.BAI_ORG_CD = #strOrgCd# AND SUBSTRING(D1.BAI_ORG_CD,0,3) = SUBSTR(#strOrgCd#,0,3) AND D1.SYS_NM LIKE '%'||#strSearchNm#||'%' AND (D1.SYS_NM LIKE '%'||#strSearchNm#||'%' OR D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%') AND (D1.SYS_NM LIKE '%'||#strSearchNm#||'%' OR D3.TBL_NM LIKE '%'||#strSearchNm#||'%') AND (D1.SYS_NM LIKE '%'||#strSearchNm#||'%' OR D4.COL_NM LIKE '%'||#strSearchNm#||'%') AND (D1.SYS_NM LIKE '%'||#strSearchNm#||'%' OR D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%' OR D3.TBL_NM LIKE '%'||#strSearchNm#||'%') AND (D1.SYS_NM LIKE '%'||#strSearchNm#||'%' OR D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%' OR D3.TBL_NM LIKE '%'||#strSearchNm#||'%' OR D4.COL_NM LIKE '%'||#strSearchNm#||'%') AND D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%' AND (D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%' OR D3.TBL_NM LIKE '%'||#strSearchNm#||'%') AND (D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%' OR D4.COL_NM LIKE '%'||#strSearchNm#||'%') AND (D2.UNT_SYS_NM LIKE '%'||#strSearchNm#||'%' OR D3.TBL_NM LIKE '%'||#strSearchNm#||'%' OR D4.COL_NM LIKE '%'||#strSearchNm#||'%') AND (D3.TBL_NM LIKE '%'||#strSearchNm#||'%') AND (D3.TBL_NM LIKE '%'||#strSearchNm#||'%' OR D4.COL_NM LIKE '%'||#strSearchNm#||'%') AND D4.COL_NM LIKE '%'||#strSearchNm#||'%' GROUP BY D1.JRSD_INST_CD ,D1.COPT_ORG_NM ,D1.CMO_INST_CD ,D1.SYS_NM ,D2.UNT_SYS_NM ,D1.OP_DPT_NM ,D1.OP_CHGR_NM ,D1.OP_CHGR_CNIF_NM ,D1.SYS_DES ,D1.SYS_BGN_DT ,D1.SYS_END_DT ,D1.USE_YN ,D1.URL_AD ,D1.JRSD_INST_CD ,D1.BAI_ORG_CD ,D1.CMO_INST_CD ORDER BY COPT_ORG, D1.SYS_NM, D2.UNT_SYS_NM