SELECT A.ATRZ_DOC_NO /* 결재문서번호 */,
    A.TPOF_ATRZ_SECD /* 제보결재구분코드 */,
    A.APV_SNO,
    A.APRVR_ENO /* 결재자직원전산번호 */,
    A.APVR_STA_CD,
    A.APRVR_KDCD /* 결재자종류코드 */,
    A.APVR_SEQ,
    ( SELECT USR.USER_ID AS USER_ID /* 사용자아이디 */
FROM TBDCMACM001M USR WHERE USR.TRGT_NOP_ENO = A.APRVR_ENO) AS USER_ID FROM TBDCMACM023L A WHERE A.ATRZ_DOC_NO = #ATRZ_DOC_NO# AND A.TPOF_ATRZ_SECD = #TPOF_ATRZ_SECD# AND A.APV_SNO IN ( SELECT NVL(MIN(A.APV_SNO),0) AS APV_SNO
FROM TBDCMACM023L A WHERE A.ATRZ_DOC_NO = #ATRZ_DOC_NO# AND A.TPOF_ATRZ_SECD = #TPOF_ATRZ_SECD# AND A.APV_SNO > #CURRENT_APV_SNO# AND A.APV_SNO NOT IN ( SELECT APV_SNO
FROM ( SELECT ATRZ_DOC_NO /* 결재문서번호 */,
    TPOF_ATRZ_SECD /* 제보결재구분코드 */,
    APV_SNO,
    APRVR_ENO /* 결재자직원전산번호 */,
    APRVR_KDCD /* 결재자종류코드 */,
    MIN(APV_DH) AS APV_DH
FROM TBDCMACM023H WHERE APVR_STA_CD = '204' AND ATRZ_DOC_NO = #ATRZ_DOC_NO# AND TPOF_ATRZ_SECD = #TPOF_ATRZ_SECD# GROUP BY ATRZ_DOC_NO,TPOF_ATRZ_SECD,APV_SNO,APRVR_ENO,APRVR_KDCD UNION SELECT AA.ATRZ_DOC_NO /* 결재문서번호 */,
    AA.TPOF_ATRZ_SECD /* 제보결재구분코드 */,
    AA.APV_SNO,
    AA.APRVR_ENO /* 결재자직원전산번호 */,
    AB.APRVR_KDCD /* 결재자종류코드 */,
    AB.HIST_APV_DH
FROM TBDCMACM023L AA ,( SELECT ATRZ_DOC_NO /* 결재문서번호 */,
    TPOF_ATRZ_SECD /* 제보결재구분코드 */,
    APV_SNO,
    APRVR_ENO /* 결재자직원전산번호 */,
    APRVR_KDCD /* 결재자종류코드 */,
    MIN(APV_DH) AS APV_DH
FROM TBDCMACM023H WHERE APRVR_KDCD = '6' AND APVR_STA_CD = '203' AND ATRZ_DOC_NO = #ATRZ_DOC_NO# AND TPOF_ATRZ_SECD = #TPOF_ATRZ_SECD# GROUP BY ATRZ_DOC_NO,TPOF_ATRZ_SECD,APV_SNO,APRVR_ENO,APRVR_KDCD ) AB WHERE AA.ATRZ_DOC_NO = AB.ATRZ_DOC_NO AND AA.TPOF_ATRZ_SECD = AB.TPOF_ATRZ_SECD AND AA.APRVR_ENO = AB.APRVR_ENO AND AA.ATRZ_DOC_NO = #ATRZ_DOC_NO# AND AA.TPOF_ATRZ_SECD = #TPOF_ATRZ_SECD# AND AA.APRVR_KDCD = '6' ) ) )