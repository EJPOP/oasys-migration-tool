SELECT BRD.EVL_YR,
    BRD.EVL_DVSN_CD,
    BRD.SC_GRN_TG_CD,
    BRD.BOARD_ID,
    BRD.POST_SEQ,
    BRD.TITLE,
    BRD.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    BRD.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    BRD.USER_NM /* 사용자명 */,
    NVL(EVL.APRV_YN, 'N') AS APRV_YN /* 승인여부 */,
    BRD.BSC_SC,
    BRD.MIN_SC,
    BRD.MAX_SC,
    BRD.ADD_SC,
    NVL(EVL.EVL_BSC_SC, BRD.BSC_SC) AS EVL_BSC_SC,
    NVL(EVL.EVL_CLU_SC, 0) AS EVL_CLU_SC,
    NVL(EVL.EVL_ADD_SC, 0) AS EVL_ADD_SC,
    TO_NUMBER(NVL(EVL.EVL_BSC_SC, BRD.BSC_SC) + NVL(EVL.EVL_CLU_SC, 0) + NVL(EVL.EVL_ADD_SC, 0)) AS TO_NUMBER
FROM ( SELECT B.EVL_YR,
    B.EVL_DVSN_CD,
    B.SC_GRN_TG_CD,
    C.BSC_SC,
    C.MIN_SC,
    C.MAX_SC,
    C.ADD_SC,
    E.BOARD_ID,
    E.POST_SEQ,
    E.TITLE,
    E.CRE_USER_NAME AS USER_NM,
    F_USR_INFO_BY_ID(E.CRE_USER_ID, '1') AS TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    E.CRE_USER_DEPT_NAME AS CNSTN_MBCMT_DEPT_NM
FROM TBAEPGKM011M A /* 평가기간 */ ,TBAEPGKM012L B /* 평가기간별점수부여대상 */ ,TBAEPGKM006M C /* 점수부여대상 */ ,TBAEPGKM007L D /* 점수부여대상설정 */ ,CTT_POST E /* 게시판 */ WHERE A.EVL_YR = B.EVL_YR AND A.EVL_DVSN_CD = B.EVL_DVSN_CD AND B.SC_GRN_TG_CD = C.SC_GRN_TG_CD AND C.SC_GRN_TG_CD = D.SC_GRN_TG_CD AND D.SET_ID = E.BOARD_ID AND B.SC_GRN_TG_CD = #SC_GRN_TG_CD# /* 질문 */ AND E.PARENT_POST_SEQ IS NOT NULL /* 게시글 질문이 아님 */ AND A.EVL_ACTV_STR_DT = TO_CHAR(E.LAST_UPDATE, 'YYYYMMDD') /* 활동기간내에 등록된 글 */ B.EVL_YR = #EVL_YR# B.EVL_DVSN_CD = #EVL_DVSN_CD# ) AS BRD, ( SELECT EVL_YR,
    EVL_DVSN_CD,
    SC_GRN_TG_CD,
    BRD_NO,
    BRD_BKNO,
    TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    APRV_YN /* 승인여부 */,
    SUM(CASE WHEN SC_CAT_CD = '1' THEN SC END) AS SC_CAT_CD,
    SUM(CASE WHEN SC_CAT_CD = '2' THEN SC END) AS SC_CAT_CD,
    SUM(CASE WHEN SC_CAT_CD = '3' THEN SC END) AS SC_CAT_CD
FROM TBAEPGKM016L WHERE SC_GRN_TG_CD = #SC_GRN_TG_CD# EVL_YR = #EVL_YR# EVL_DVSN_CD = #EVL_DVSN_CD# GROUP BY EVL_YR, EVL_DVSN_CD, SC_GRN_TG_CD, BRD_NO, BRD_BKNO, TRGT_NOP_ENO, APRV_YN ) AS EVL WHERE BRD.EVL_YR = EVL.EVL_YR(+) AND BRD.EVL_DVSN_CD = EVL.EVL_DVSN_CD(+) AND BRD.SC_GRN_TG_CD = EVL.SC_GRN_TG_CD(+) AND BRD.BOARD_ID = EVL.BRD_NO(+) AND BRD.POST_SEQ = EVL.BRD_BKNO(+) AND BRD.TRGT_NOP_ENO = EVL.TRGT_NOP_ENO(+) AND EVL.APRV_YN = 'Y'