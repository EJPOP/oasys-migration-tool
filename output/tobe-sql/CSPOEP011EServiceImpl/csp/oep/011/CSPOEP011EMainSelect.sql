SELECT C.LOUNGE_ID,
    C.LOUNGE_SRCH_SEQ,
    C.LOUNGE_NM,
    C.DAY1_1,
    C.DAY2_1,
    C.DAY3_1,
    C.DAY4_1,
    C.DAY5_1,
    C.DAY6_1,
    C.DAY7_1,
    C.DAY8_1,
    C.DAY9_1,
    C.DAY10_1,
    C.DAY11_1,
    C.DAY12_1,
    C.DAY13_1,
    C.DAY14_1,
    CASE WHEN C.DAY1 > 0 THEN C.DAY1 ELSE NULL END AS DAY1,
    CASE WHEN C.DAY2 > 0 THEN C.DAY2 ELSE NULL END AS DAY2,
    CASE WHEN C.DAY3 > 0 THEN C.DAY3 ELSE NULL END AS DAY3,
    CASE WHEN C.DAY4 > 0 THEN C.DAY4 ELSE NULL END AS DAY4,
    CASE WHEN C.DAY5 > 0 THEN C.DAY5 ELSE NULL END AS DAY5,
    CASE WHEN C.DAY6 > 0 THEN C.DAY6 ELSE NULL END AS DAY6,
    CASE WHEN C.DAY7 > 0 THEN C.DAY7 ELSE NULL END AS DAY7,
    CASE WHEN C.DAY8 > 0 THEN C.DAY8 ELSE NULL END AS DAY8,
    CASE WHEN C.DAY9 > 0 THEN C.DAY9 ELSE NULL END AS DAY9,
    CASE WHEN C.DAY10 > 0 THEN C.DAY10 ELSE NULL END AS DAY10,
    CASE WHEN C.DAY11 > 0 THEN C.DAY11 ELSE NULL END AS DAY11,
    CASE WHEN C.DAY12 > 0 THEN C.DAY12 ELSE NULL END AS DAY12,
    CASE WHEN C.DAY13 > 0 THEN C.DAY13 ELSE NULL END AS DAY13,
    CASE WHEN C.DAY14 > 0 THEN C.DAY14 ELSE NULL END AS DAY14,
    C.RESERVE_USER_ID
FROM ( SELECT A.LOUNGE_ID,
    A.LOUNGE_SRCH_SEQ,
    A.LOUNGE_NM,
    B.RESERVE_USER_ID,
    (SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#),'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#),'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY1_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +1,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY2 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +1,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY2_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +2,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY3 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +2,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY3_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +3,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY4 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +3,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY4_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +4,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY5 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +4,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY5_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +5,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY6 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +5,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY6_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +6,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY7 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +6,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY7_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +7,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY8 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +7,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY8_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +8,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY9 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +8,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY9_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +9,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY10 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +9,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY10_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +10,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY11 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +10,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY11_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +11,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY12 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +11,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY12_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +12,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY13 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +12,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY13_1 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +13,'YYYYMMDD') AND LOUNGE_ID = A.LOUNGE_ID ) DAY14 ,(SELECT COUNT(BOKG_PEN_ID)
FROM TBCSPOEP012M WHERE BOKG_DT= TO_CHAR(TO_DATE(#SELECTED_DAY#) +13,'YYYYMMDD') AND BOKG_PEN_ID = #USER_ID# AND LOUNGE_ID = A.LOUNGE_ID ) DAY14_1 FROM TBCSPOEP011M A /*휴게실 관리 기본*/ ,TBCSPOEP012M B /*휴게실 예약 기본*/ WHERE A.LOUNGE_ID = B.LOUNGE_ID(+) AND B.RESERVE_USER_ID(+) = #USER_ID# GROUP BY A.LOUNGE_ID ,A.LOUNGE_SRCH_SEQ , A.LOUNGE_NM, B.RESERVE_USER_ID ORDER BY A.LOUNGE_SRCH_SEQ ) C