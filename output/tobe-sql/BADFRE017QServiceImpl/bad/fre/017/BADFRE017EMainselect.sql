SELECT ENFM_HIRK_DPT_NM AS ENFM_HIRK_DPT_NM /* 집행상위관리부서 */,
    ENFM_DPT_NM AS ENFM_DPT_NM /* 집행관리부서 */,
    ADT_MTTR_CN AS ADT_MTTR_CN /* 감사사항내용 */,
    DSPS_RQT_KND_CVN || '(' || TO_NUMBER((ASG_ACP + ASG_DTM + RLS_ACP + RLS_DTM),'9,999,999') || '건)' AS DSPS_RQT_KND_CVN /* 처분요구종류코드값명 */,
    ASG_ACP AS ASG_ACP /* 지정접수 */,
    ASG_DTM AS ASG_DTM /* 지정확정 */,
    RLS_ACP AS RLS_ACP /* 해제접수 */,
    RLS_DTM AS RLS_DTM /* 해제확정 */
FROM( SELECT A.ENFM_HIRK_DPT_NM AS ENFM_HIRK_DPT_NM,
    A.ENFM_DPT_NM AS ENFM_DPT_NM,
    A.ADT_MTTR_CN AS ADT_MTTR_CN /* 감사사항내용 */,
    A.DSPS_RQT_KND_CVN AS DSPS_RQT_KND_CVN /* 처분요구종류코드값명 */,
    NVL(SUM(A.ASG_ACP),0) AS ASG_ACP,
    NVL(SUM(A.ASG_DTM),0) AS ASG_DTM,
    NVL(SUM(A.RLS_ACP),0) AS RLS_ACP,
    NVL(SUM(A.RLS_DTM),0) AS RLS_DTM
FROM( SELECT (SELECT F_DPT_INFO(HIRK_DPT_CD , '1')
FROM TBDCMACM002M WHERE SRECS_DEPT_CD = D1.SPRVSN_DEPT_CD) AS ENFM_HIRK_DPT_NM /* 집행상위관리부서 */ ,F_DPT_INFO(D1.SPRVSN_DEPT_CD , '1') AS ENFM_DPT_NM /* 집행관리부서 */ ,'(' || F_MNG_KND_AUDYRNO(D3.CVLCPT_ADT_YR, D3.ADT_NO, D3.ADT_KDCD, '-') || ') ' || D3.ADT_MTTR_NM AS ADT_MTTR_CN /* 감사사항 */ ,F_CODE_NM('1000002', D2.DSPS_RQT_KDCD) AS DSPS_RQT_KND_CVN /* 처분요구종류코드명 */ ,CASE WHEN NVL(D1.CFMTN_YN,'N') != 'Y' AND D1.DSGN_YMD IS NOT NULL AND D1.SRECS_RMV_YMD IS NULL THEN 1 ELSE 0 END AS ASG_ACP /* 지정접수 */ ,CASE WHEN NVL(D1.CFMTN_YN,'N') = 'Y' AND D1.DSGN_YMD IS NOT NULL AND D1.SRECS_RMV_YMD IS NULL THEN 1 ELSE 0 END AS ASG_DTM /* 지정확정 */ ,CASE WHEN NVL(D1.CFMTN_YN,'N') != 'Y' AND D1.SRECS_RMV_YMD IS NOT NULL THEN 1 ELSE 0 END AS RLS_ACP /* 해제접수 */ ,CASE WHEN NVL(D1.CFMTN_YN,'N') = 'Y' AND D1.SRECS_RMV_YMD IS NOT NULL THEN 1 ELSE 0 END AS RLS_DTM /* 해제확정 */ FROM TBBADFRE011M D1 /* 특수관리기본 */ ,TBBADEAR001M D2 /* 처분요구사항기본 */ ,TBBADDED001M D3 /* 감사사항기본 */ WHERE 1=1 AND D1.CVLCPT_ADT_YR = D2.CVLCPT_ADT_YR AND D1.ADT_NO = D2.ADT_NO AND D1.DSPS_RQT_SQNO = D2.DSPS_RQT_SQNO AND D2.CVLCPT_ADT_YR = D3.CVLCPT_ADT_YR AND D2.ADT_NO = D3.ADT_NO AND D1.SPRVSN_DEPT_CD IN (SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TABLE(F_AUTH_DEPT(#strCnb#, #strDptAuth#, '', #strDptCd#))) AND D1.SPRVSN_DEPT_CD = #SPRVSN_DEPT_CD# AND NVL(D1.CFMTN_YN,'N') != 'Y' AND D1.DSGN_YMD IS NOT NULL AND D1.SRECS_RMV_YMD IS NULL AND NVL(D1.CFMTN_YN,'N') = 'Y' AND D1.DSGN_YMD IS NOT NULL AND D1.SRECS_RMV_YMD IS NULL AND NVL(D1.CFMTN_YN,'N') != 'Y' AND D1.SRECS_RMV_YMD IS NOT NULL AND NVL(D1.CFMTN_YN,'N') = 'Y' AND D1.SRECS_RMV_YMD IS NOT NULL AND D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# ) A WHERE 1=1 GROUP BY A.ENFM_HIRK_DPT_NM ,A.ENFM_DPT_NM ,A.ADT_MTTR_CN ,A.DSPS_RQT_KND_CVN ) ORDER BY ENFM_HIRK_DPT_NM ,ENFM_DPT_NM ,ADT_MTTR_CN