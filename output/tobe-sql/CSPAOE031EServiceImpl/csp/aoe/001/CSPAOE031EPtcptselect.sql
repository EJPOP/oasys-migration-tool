SELECT D1.EVL_YR,
    D1.HLYR_DVSN_CD,
    F_USR_INFO(D1.NEVLT_CNB, '2') AS F_USR_INFO,
    D1.NEVLT_CNB,
    F_DPT_INFO(D1.BLT_DPT_CD, '1') AS CRU_OGDP_DEPT_NM /* 부패소속부서명 */,
    F_CODE_NM('1000173', D1.JBGD_SECD) AS JBGD_NM /* 직급명 */,
    D1.BLT_DPT_CD,
    D1.JBGD_SECD /* 직급구분코드 */,
    CASE WHEN D3.NEVLT_CNB IS NOT NULL THEN '평가완료' WHEN D2.NEVLT_CNB IS NOT NULL THEN '평가중' ELSE '미평가' END AS NEVLT_CNB /* 평가진행상황 : 2015.01.26 최원형감사관 요청 */,
    CASE WHEN (SELECT count(*)
FROM TBCSPAOE028M WHERE EVL_YR = #strEvlYr# AND HLYR_DVSN_CD = #strHlyrDvsnCd# AND PTCPT_CNB = D1.NEVLT_CNB) = 0 THEN '미입력' ELSE '입력' END AS PTCPT_DIV FROM TBCSPAOE020D D1 , ( SELECT NEVLT_CNB
FROM TBCSPAOE032M WHERE EVL_YR = #strEvlYr# AND HLYR_DVSN_CD = #strHlyrDvsnCd# AND NEVLT_CNB = #strPtcptCnb# GROUP BY NEVLT_CNB ) D2 /*평가중인 피평가자 목록*/ , ( SELECT NEVLT_CNB
FROM TBCSPAOE035M WHERE EVL_YR = #strEvlYr# AND HLYR_DVSN_CD = #strHlyrDvsnCd# AND CVLCPT_TASK_SECD = '10003' /*관리운영직*/ AND NEVLT_CNB = #strPtcptCnb# GROUP BY NEVLT_CNB ) D3 /*평가완료된 피평가자 목록*/ WHERE D1.NEVLT_CNB = D2.NEVLT_CNB (+) AND D1.NEVLT_CNB = D3.NEVLT_CNB (+) AND D1.EVL_YR = #strEvlYr# AND D1.HLYR_DVSN_CD = #strHlyrDvsnCd# AND D1.NEVLT_CNB = #strPtcptCnb# ORDER BY D1.BLT_DPT_CD, D1.NEVLT_CNB