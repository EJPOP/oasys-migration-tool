SELECT F_DPT_INFO(SUBSTR(SRECS_DEPT_CD,0,3)||'000','1') AS F_DPT_INFO,
    DECODE(SRECS_DEPT_CD,SUBSTR(SRECS_DEPT_CD,0,3)||'000',NULL,F_DPT_INFO(SRECS_DEPT_CD, '1')) AS CRU_OGDP_DEPT_NM /* 부패소속부서명 */,
    F_CODE_NM('1000173', JBGD_SECD) AS JBGD_NM /* 직급명 */,
    RANK_NM_2 /* 직급구분 */,
    F_USR_INFO(NEVLT_CNB, '2') AS F_USR_INFO /* 성명 */,
    NEVLT_CNB /* 전산번호 */,
    SUM_ASC AS SUM_ASC /* 평점 */,
    RANK_NUM AS RANK_NUM /* 직급별 순위 */
FROM ( SELECT D1.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    D2.JBGD_SECD /* 직급구분코드 */,
    D2.RANK_NM_2,
    D1.NEVLT_CNB /* 전산번호 */,
    D1.SUM_ASC,
    RANK() OVER(PARTITION BY D2.JBGD_SECD ORDER BY D1.SUM_ASC DESC) AS RANK /* 직급별 순위 */
FROM ( SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NEVLT_CNB /* 전산번호 */,
    SUM(PSN_TSK_ASC) AS PSN_TSK_ASC
FROM TBCSPAOE035M WHERE 1 = 1 AND EVL_YR = #strEvlYr# AND HLYR_DVSN_CD = #strHlyrDvsnCd# AND CVLCPT_TASK_SECD = '10003' GROUP BY SRECS_DEPT_CD, NEVLT_CNB ) D1 , TBDCMACM001M D2 WHERE D1.NEVLT_CNB = D2.TRGT_NOP_ENO ) Z WHERE 1 = 1 AND SRECS_DEPT_CD = #SRECS_DEPT_CD# ORDER BY JBGD_SECD, RANK_NUM