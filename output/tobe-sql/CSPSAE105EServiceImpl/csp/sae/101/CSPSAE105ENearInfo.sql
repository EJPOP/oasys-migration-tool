SELECT LINK_YR /* 연계년도 */,
    EDU_DVSN_CD,
    EDU_CAT_CD,
    CRS_CD,
    CRS_CDN /* 과정기수 */,
    SV_DT
FROM ( SELECT D1.LINK_YR /* 연계년도 */,
    D1.CRS_CD,
    D1.CRS_CDN /* 과정기수 */,
    T1.EDU_DVSN_CD,
    T2.EDU_CAT_CD,
    TRUNC(TO_DATE(D1.EDU_BGNG_YMD, 'YYYYMMDD') - SYSDATE) AS TRUNC,
    D1.SV_DT
FROM TBCSPSAE201D D1 , TBCSPSAE101C T1 , TBCSPSAE102C T2 , TBCSPSAE103C T3 WHERE D1.EDU_BGNG_YMD > TO_CHAR(SYSDATE, 'YYYYMMDD') AND T3.CRS_CD = D1.CRS_CD AND T2.EDU_CAT_CD = T3.EDU_CAT_CD AND T2.EDU_DVSN_CD = T3.EDU_DVSN_CD AND T1.EDU_DVSN_CD = T2.EDU_DVSN_CD ORDER BY DAY_C, CRS_CDN ) WHERE ROWNUM = 1;