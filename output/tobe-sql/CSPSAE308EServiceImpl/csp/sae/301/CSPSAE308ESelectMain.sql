SELECT A.LINK_YR /* 연계년도 */,
    A.CRS_CD,
    A.CRS_CDN /* 과정기수 */,
    A.GRNDS_EXMN_AEX_SQNO /* 현장조사수용비순번 */,
    A.TANE_ID,
    A.INFO_RLPR_NM /* 정보관계자명 */,
    A.SEX_CD,
    B.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    A.JBGD_NM /* 직급명 */,
    C.DMT_NO,
    NVL(C.USE_STR_DT, E.EDU_BGNG_YMD) AS USE_STR_DT,
    NVL(C.USE_END_DT, E.EDU_END_YMD) AS USE_END_DT,
    D.CRS_NM /* 과정명 */,
    A.EML_ADDR /* 이메일주소 */,
    SUBSTR(E.EDU_BGNG_YMD, 0, 4) || '.' || SUBSTR(E.EDU_BGNG_YMD, 5, 2) || '.' || SUBSTR(E.EDU_BGNG_YMD, 7, 2) || ' ~ ' || SUBSTR(E.EDU_END_YMD, 0, 4) || '.' || SUBSTR(E.EDU_END_YMD, 5, 2) || '.' || SUBSTR(E.EDU_END_YMD, 7, 2) AS SUBSTR,
    A.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    A.OFC_TELNO /* 사무실전화번호 */,
    REPLACE(A.SLCT_CVLPR_MPNO, '-', '') AS SLCT_CVLPR_MPNO /* 청탁민원인휴대전화번호 */,
    A.SNDY_LODG_YN,
    '' AS SMS_MSG,
    '' AS CRU_TELNO /* 부패전화번호 */,
    F.RMN_NM,
    F.ESN,
    NVL(C.USE_YN, 'N') AS USE_YN /* 사용여부 */
FROM TBCSPSAE301D A , TBDCMACM015M B , TBCSPSAE401D C , TBCSPSAE103C D , TBCSPSAE201D E , TBCSPSAE115B F , TBCSPSAE102C G , TBCSPSAE101C H WHERE 1=1 AND B.INST_CD(+) = A.INST_CD AND C.LINK_YR(+) = A.LINK_YR AND C.CRS_CD(+) = A.CRS_CD AND C.CRS_CDN(+) = A.CRS_CDN AND C.TANE_ID(+) = A.TANE_ID AND D.CRS_CD = A.CRS_CD AND G.EDU_CAT_CD = D.EDU_CAT_CD AND G.EDU_DVSN_CD = D.EDU_DVSN_CD AND H.EDU_DVSN_CD = G.EDU_DVSN_CD AND E.LINK_YR = A.LINK_YR AND E.CRS_CD = A.CRS_CD AND E.CRS_CDN = A.CRS_CDN AND F.DMT_NO(+) = C.DMT_NO AND A.DMT_UE_YN = 'Y' AND A.LINK_YR BETWEEN SUBSTR(#EDU_BGNG_YMD#, 0, 4) AND SUBSTR(#strToYm#, 0, 4) AND ((E.EDU_BGNG_YMD = #EDU_BGNG_YMD#) OR (E.EDU_BGNG_YMD >= #EDU_BGNG_YMD# AND E.EDU_BGNG_YMD = #EDU_BGNG_YMD# AND E.EDU_END_YMD AND H.EDU_DVSN_CD = #strEDU_DVSN_CD# AND G.EDU_CAT_CD = #strEDU_CAT_CD# AND A.CRS_CD = #strEDU_CRS_CD# AND A.CRS_CDN = #CRS_CDN# AND A.SEX_CD = #strSEX_CD# AND A.SNDY_LODG_YN = #strSNDY_LODG_YN# ORDER BY A.LINK_YR, A.CRS_CD, A.CRS_CDN, A.GRNDS_EXMN_AEX_SQNO