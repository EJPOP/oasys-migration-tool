/* faa/cav/026/FAACAV025EMainSelect */ SELECT A.JRSD_CD || '-' || A.ACNTG_CD || '-' || A.BLL_KDCD || '-' || A.PROF_RBPRSN_SQNO || '-' || A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS JRSD_CD /* 소관코드 */,
    A.JRSD_CD /* 소관코드 */,
    A.ACNTG_CD /* 회계코드 */,
    A.BLL_KDCD /* 계산서종류코드 */,
    A.PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    F_AV_BLL_COPT_CD_NM (A.JRSD_CD) AS JRSD_NM /* 소관명 */,
    F_AV_ACNT_CD_NM (A.ACNTG_CD) AS ACNTG_CDNM /* 회계코드명 */,
    CASE WHEN (A.BLL_KDCD ='17' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') OR (A.BLL_KDCD='18' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') THEN '관서운영경비출납계산서' WHEN (A.BLL_KDCD='22' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') OR (A.BLL_KDCD='23' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') OR (A.BLL_KDCD='24' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') THEN '기금관서운영경비출납계산서' ELSE B.ACNTG_CDNM END AS BLL_KDCD /* 계산서종류코드 */,
    CASE WHEN A.PROF_RBPRSN_CRT_YMD = '000000' THEN ' ' ELSE SUBSTR(A.PROF_RBPRSN_CRT_YMD,1,4) || '.' || SUBSTR(A.PROF_RBPRSN_CRT_YMD,5,2) || '.' || SUBSTR(A.PROF_RBPRSN_CRT_YMD,7,2) END AS PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    CASE WHEN A.PROF_RBPRSN_ABL_YMD = '999999' THEN ' ' ELSE SUBSTR(A.PROF_RBPRSN_ABL_YMD,1,4) || '.' || SUBSTR(A.PROF_RBPRSN_ABL_YMD,5,2) || '.' || SUBSTR(A.PROF_RBPRSN_ABL_YMD,7,2) END AS PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    C.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    CASE WHEN SUBSTR(A.PROF_RBPRSN_MDFCN_YMD,1,4) = '0000' THEN ' ' ELSE SUBSTR(A.PROF_RBPRSN_MDFCN_YMD,1,4) || '.' || SUBSTR(A.PROF_RBPRSN_MDFCN_YMD,5,2) || '.' || SUBSTR(A.PROF_RBPRSN_MDFCN_YMD,7,2) END AS MDFCN_YMD /* 수정일자 */
FROM TWFAACAV003M A, TWFAACAV024C B, TBDCMACM002M C WHERE A.BLL_KDCD = B.ACNTG_CD AND RPAD(A.PROF_RBPRSN_RB_SECD,3,'0') || RPAD(PROF_RBPRSN_CPD_SECD,3,'0') = C.SRECS_DEPT_CD (+ ) AND B.ACNTG_SECD = '03' AND A.PROF_RBPRSN_INST_NM = #PROF_RBPRSN_INST_NM# AND A.PROF_RBPRSN_INST_CD = #INST_CD#||#strOrgCd2#||#strOrgCd3#||#strOrgCd4# AND A.PROF_RBPRSN_INST_CD BETWEEN #INST_CD#||#strOrgCd2#||#strOrgCd3#||'000' AND #INST_CD#||#strOrgCd2#||#strOrgCd3#||'999' AND A.PROF_RBPRSN_INST_CD BETWEEN #INST_CD#||#strOrgCd2#||'000000' AND #INST_CD#||#strOrgCd2#||'999999' AND A.PROF_RBPRSN_INST_CD BETWEEN #INST_CD#||'000000000' AND #INST_CD#||'999999999' AND MDFCN_SECD = #MDFCN_SECD# AND MDFCN_SECD != 'D' AND MDFCN_SECD = #MDFCN_SECD# AND A.JRSD_CD LIKE '%'||#strCoptCd#||'%' AND A.ACNTG_CD LIKE '%'||#strAcntCd#||'%' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' AND A.BLL_KDCD IN ('17','18') AND A.BLL_KDCD IN ('22','23','24') AND A.BLL_KDCD IN ('42','43') AND A.BLL_KDCD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_KDCD ELSE #strBllCd# END AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND A.BLL_KDCD IN ('17','18') AND A.BLL_KDCD IN ('22','23','24') AND A.BLL_KDCD = CASE WHEN #strBllCd# IN ('17','22') THEN A.BLL_KDCD ELSE #strBllCd# END AND A.BLL_KDCD IN ('17','18') AND A.BLL_KDCD IN ('22','23','24') AND A.BLL_KDCD IN ('42','43') AND A.BLL_KDCD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_KDCD ELSE #strBllCd# END AND A.PROF_RBPRSN_SQNO LIKE '%'||#strProfDrtrSrno#||'%' AND SUBSTR(A.PROF_RBPRSN_CRT_YMD,1,4) = #strCreDt1# AND SUBSTR(A.PROF_RBPRSN_CRT_YMD,5,2) = #strCreDt2# AND SUBSTR(A.PROF_RBPRSN_ABL_YMD,1,7) LIKE '%'||#strAbltDt1#||#strAbltDt2#||'%' AND RPAD(A.PROF_RBPRSN_CPD_SECD,3,0) = #strDivCd# AND RPAD(A.PROF_RBPRSN_RB_SECD,3,0) = #strBrCd# AND SUBSTR(A.PROF_RBPRSN_MDFCN_YMD,1,4) >= #strMdfDt1# AND SUBSTR(A.PROF_RBPRSN_MDFCN_YMD,5,2) >= #strMdfDt2# AND SUBSTR(A.PROF_RBPRSN_MDFCN_YMD,7,2) >= #strMdfDt3# ORDER BY ACCMN_ID