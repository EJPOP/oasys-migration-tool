SELECT A.JRSD_CD /* 소관코드 */,
    A.ACNTG_CD /* 회계코드 */,
    A.BLL_KDCD /* 계산서종류코드 */,
    A.PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    A.JRSD_CD || '-' || A.ACNTG_CD || '-' || A.BLL_KDCD || '-' || A.PROF_RBPRSN_SQNO || '-' || A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS JRSD_CD /* 소관코드 */,
    /*증명자부호*/ PROF_RBPRSN_INST_NM AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    /*기관명*/ F_AV_BLL_COPT_CD_NM (A.JRSD_CD) AS F_AV_BLL_COPT_CD_NM,
    /*소관명*/ F_AV_ACNT_CD_NM (A.ACNTG_CD) AS ACNTG_CDNM /* 회계코드명 */,
    /*회계명*/ CASE WHEN (A.BLL_KDCD ='17' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') OR (A.BLL_KDCD='18' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') THEN '관서운영경비출납계산서' WHEN (A.BLL_KDCD='22' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') OR (A.BLL_KDCD='23' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') OR (A.BLL_KDCD='24' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO!= '000') THEN '기금관서운영경비출납계산서' ELSE B.ACNTG_CDNM END AS BLL_KDCD /* 계산서종류코드 */,
    /*계산서명*/ CASE WHEN A.PROF_RBPRSN_CRT_YMD = '000000' THEN ' ' ELSE SUBSTR(A.PROF_RBPRSN_CRT_YMD, 1, 4) || '.' || SUBSTR(A.PROF_RBPRSN_CRT_YMD, 5, 2) || '.' || SUBSTR(A.PROF_RBPRSN_CRT_YMD, 7, 2) END AS PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    /*지정년월*/ CASE WHEN A.PROF_RBPRSN_ABL_YMD = '999999' THEN ' ' ELSE SUBSTR(A.PROF_RBPRSN_ABL_YMD, 1, 4) || '.' || SUBSTR(A.PROF_RBPRSN_ABL_YMD, 5, 2) || '.' || SUBSTR(A.PROF_RBPRSN_ABL_YMD, 7, 2) END AS PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    /*폐지년월*/ JBPS_NM AS JBPS_NM /* 직위명 */,
    /*증명책임자 직위*/ SUBSTR(A.PROF_RBPRSN_MDFCN_YMD,1,4)||'.'||SUBSTR(A.PROF_RBPRSN_MDFCN_YMD,5,2)||'.'||SUBSTR(A.PROF_RBPRSN_MDFCN_YMD,7,2) AS MDFCN_YMD /* 수정일자 */,
    /*작업일자*/ CASE WHEN A.PROF_RBPRSN_LINK_DT IS NULL THEN ' ' ELSE SUBSTR(A.PROF_RBPRSN_LINK_DT, 1, 4)||'.'||SUBSTR(A.PROF_RBPRSN_LINK_DT, 6, 2)||'.'||SUBSTR(A.PROF_RBPRSN_LINK_DT, 9, 2) END AS PROF_RBPRSN_LINK_DT /* 증명책임자연계일시 */
FROM TWFAACAV003M A, TWFAACAV024C B, TBDCMACM002M C WHERE A.BLL_KDCD = B.ACNTG_CD AND RPAD(A.PROF_RBPRSN_RB_SECD,3,'0') || RPAD(PROF_RBPRSN_CPD_SECD,3,'0') = C.SRECS_DEPT_CD (+ ) AND B.ACNTG_SECD = '03' AND A.JRSD_CD NOT IN ('301','069','155') AND A.BLL_KDCD NOT IN ('41', '42', '43') AND A.PROF_RBPRSN_MDFCN_YMD >= #strStartDt# AND A.PROF_RBPRSN_MDFCN_YMD AND SUBSTR(A.PROF_RBPRSN_ABL_YMD, 1, 4) >= #strABltDt# ORDER BY ACCMN_ID