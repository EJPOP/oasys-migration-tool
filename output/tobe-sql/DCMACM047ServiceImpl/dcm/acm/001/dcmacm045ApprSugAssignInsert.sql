MERGE INTO TBDCMACM023L A USING ( SELECT #ATRZ_DOC_NO# AS ATRZ_DOC_NO /* 결재문서번호 */,
    #TPOF_ATRZ_SECD# AS TPOF_ATRZ_SECD /* 제보결재구분코드 */,
    #APVR_CNB# AS APRVR_ENO /* 결재자직원전산번호 */,
    #APVR_SEQ# AS #APVR_SEQ#
FROM DUAL ) B ON ( A.ATRZ_DOC_NO = B.ATRZ_DOC_NO AND A.TPOF_ATRZ_SECD = B.TPOF_ATRZ_SECD AND A.APRVR_ENO = B.APRVR_ENO AND A.APVR_SEQ = B.APVR_SEQ ) WHEN NOT MATCHED THEN INSERT INSERT ( ATRZ_DOC_NO , TPOF_ATRZ_SECD , APRVR_ENO , APRVR_DEPT_CD , APRVR_JBGD_SECD , APRVR_JBPS_SECD , APRVR_KDCD , APV_SNO , APVR_STA_CD , APV_DH , APV_OPIN , LAST_MENU_ID , FRST_USER_ID , LAST_USER_ID , LAST_PRCS_DEPT_CD , FRST_REG_DT , LAST_MDFCN_DT ,APVR_SEQ ,ONR_PST_NM ,VACANCY_CD ) VALUES ( #ATRZ_DOC_NO# , #TPOF_ATRZ_SECD# , #APVR_CNB# , #APVR_DPT_CD# , #APVR_RANK_CD# , #APVR_PST_CD# , #APVR_KND_CD# , #APV_SNO# , #APVR_STA_CD# , CASE WHEN SUBSTR(#APVR_STA_CD#,0,1) = '3' THEN NULL WHEN SUBSTR(#APVR_STA_CD#,0,1) <> '1' THEN NVL(#APV_DH#,TO_CHAR(SYSDATE,'yyyymmddhh24mIss')) ELSE NULL END , #APV_OPIN# , #FNL_MNU_ID# , #FRT_USR_ID# , #FNL_USR_ID# , #FNL_DEAL_DPT_CD# , SYSDATE , SYSDATE , (SELECT NVL(COUNT(*),0)+1
FROM TBDCMACM023L WHERE ATRZ_DOC_NO = #ATRZ_DOC_NO# AND TPOF_ATRZ_SECD = #TPOF_ATRZ_SECD#) , #ONR_PST_NM# , #VACANCY_CD# )