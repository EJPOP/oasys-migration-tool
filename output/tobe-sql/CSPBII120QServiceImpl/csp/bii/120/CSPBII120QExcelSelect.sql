SELECT /* csp.bii.service.impl.CSPBII120QServiceImpl.CSPBII120QMainSelect */ A.INFO_YR || '-' || A.INFO_SQNO AS INFO_YR /* 정보년도 */,
    A.SBMSN_YMD /* 제출일자 */,
    A.PRSNR_PBADMS_STD_SECD /* 제출자행정표준구분코드 */,
    (SELECT B.USER_NM AS USER_NM /* 사용자명 */
FROM TBDCMACM001M B WHERE B.TRGT_NOP_ENO = A.PRSNR_ENO) AS PRSNR_NM , CASE WHEN SUBSTR(F_CODE_NM('1000097', A.INFO_SECD), 1, 2) is not null THEN '(' || SUBSTR(F_CODE_NM('1000097', A.INFO_SECD), 1, 2) || ')' || A.DSPS_RQT_NM ELSE A.DSPS_RQT_NM END AS DSPS_RQT_NM , (SELECT B.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */
FROM TBDCMACM015M B WHERE B.INST_CD = A.REL_INST_CD) AS REL_ORG_NM , A.ETC_LBSVC_MNG_DEPT_CD , (SELECT B.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */
FROM TBDCMACM002M B WHERE B.SRECS_DEPT_CD = A.ETC_LBSVC_MNG_DEPT_CD) AS PRCS_DEPT_NM , F_CODE_NM('1000039', A.PRCS_DRCTN_SECD) AS HNDL_ORD_NM , A.ADT_INFO_PRGRS_STTS_SECD , F_CODE_NM('1000085', A.ADT_INFO_PRGRS_STTS_SECD) AS AUD_INF_PRSS_STA_NM , A.CMPTN_YMD , F_CODE_NM('1000042', A.PRCS_RSLT_SECD) AS HNDL_RSLT_NM , A.RLS_YN , A.INFO_YR , A.FRS_MDM_SQNO , F_DPT_INFO(A.PRSNR_DEPT_CD,'1') AS PRSNR_DEPT_NM , F_CODE_NM('1000173',A.PRSNR_JBGD_SECD) AS PRSR_RANK_NM , A.PRCS_YMD , F_USR_INFO(A.PRCS_PIC_ENO,'2') AS PRCS_PIC_NM , F_CODE_NM('1000173',A.PRCS_JBGD_SECD) AS PRCS_PIC_JBGD_NM , A.PRCS_PIC_ENO , DECODE(A.RLS_YN,'1','공개','2','비공개') AS OPEN_NM , F_CODE_NM('1000040', A.SRC_SECD) as SRC_DVSN_NM ,CLCT_SECD , (SELECT E.SPCF_ADT_MTTR_NM /* 특정감사사항명 */
FROM TB_CSPBII140M E WHERE E.SPCF_INFO_CLCT_NO = A.CLCT_SECD) AS CLC_DVSN_NM ,F_CODE_NM('1000097', A.INFO_SECD) AS INF_DVSN_NM ,NTFCTN_RCPT_YMD ,TRNF_YMD ,TRNF_RCPT_YMD ,F_CODE_NM('1000459',A.PRSNR_DEPT_TPCD) AS DPT_TP_NM , nvl(A.UTLZ_SCR,0) AS UTLZ_SCR /* 활용가능성 */ , nvl(A.CSIT_SCR,0) AS CSIT_SCR /* 충실성 */ , nvl(A.RLBT_SCR,0) AS RLBT_SCR /* 신뢰성 */ , nvl(A.UTLZ_SCR,0) + nvl(A.CSIT_SCR,0) + nvl(A.RLBT_SCR,0) AS TOT_CNT ,DECODE(A.BFR_EVL_SECD, '10','상','20','중','30','하','') AS BFR_EVL_SECD ,F_USR_INFO(A.OVRL_PIC_ENO,'2') AS BLE_CHGR_NAM ,A.HNDT_YMD ,(SELECT F_CODE_NM('1000852',GEN_ADMN_DVSN_CD)
FROM TBDCMACM001M S1 WHERE A.PRSNR_ENO = S1.TRGT_NOP_ENO ) AS GEN_ADMN_DVSN_NM FROM TB_CSPBII100M A WHERE 1=1 AND A.INFO_YR >= #strStrYe# AND A.INFO_YR &lt;= #strEndYe# AND A.FRS_MDM_SQNO >= #strStrSrno# AND A.FRS_MDM_SQNO &lt;= #strEndSrno# AND (A.DSPS_RQT_NM LIKE '%' || #strSrhTxt# || '%' OR EXISTS (SELECT 1
FROM TB_CSPBII101L B WHERE INSTR(B.SRCH_ADT_INFO_CN, #strSrhTxt#, 1, 1) > 0 AND B.INFO_YR = A.INFO_YR AND B.FRS_MDM_SQNO = A.FRS_MDM_SQNO)) AND A.$STRDTDVSNCD$ >= #strStrDt# AND A.$STRDTDVSNCD$ &lt;= #strEndDt# AND ((A.TRNF_YMD BETWEEN #strTrnfStrDt# AND #strTrnfEndDt#) OR (substr(TRNF_YMD,0,4) AND A.$STRDTDVSNCD$ &lt;= #strEndDt# AND A.$STRDTDVSNCD2$ >= #strStrDt2# AND A.$STRDTDVSNCD2$ &lt;= #strEndDt2# AND (A.REL_INST_CD LIKE SUBSTR(##N/A#, 0, INSTR(##N/A#, '000') -1) || '%' OR A.#N/A LIKE SUBSTR(##N/A#, 0, INSTR(##N/A#, '000') -1) || '%' OR A.#N/A LIKE SUBSTR(##N/A#, 0, INSTR(##N/A#, '000') -1) || '%') AND (A.REL_INST_CD = ##N/A# OR A.#N/A = ##N/A# OR A.#N/A = ##N/A#) AND (A.REL_INST_CD BETWEEN ##N/A# AND ##N/A# OR A.#N/A BETWEEN ##N/A# AND ##N/A# OR A.#N/A BETWEEN ##N/A# AND ##N/A#) AND (A.REL_INST_CD LIKE SUBSTR(##N/A#, 0, INSTR(##N/A#, '000') -1) || '%' OR A.#N/A LIKE SUBSTR(##N/A#, 0, INSTR(##N/A#, '000') -1) || '%' OR A.#N/A LIKE SUBSTR(##N/A#, 0, INSTR(##N/A#, '000') -1) || '%') AND (A.REL_INST_CD = ##N/A# OR A.#N/A = ##N/A# OR A.#N/A = ##N/A#) (SELECT B.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */
FROM TBDCMACM015M B WHERE B.INST_CD = A.REL_INST_CD) like '%'||#strStrRelOrgNm#||'%' AND A.INFO_SECD = #INFO_SECD# AND EXISTS (SELECT 1
FROM TB_CSPBII130L B /* 감사정보관련자내역 */ WHERE B.INFO_RLPR_NM = #RLPR_NM# AND B.INFO_YR = A.INFO_YR AND B.FRS_MDM_SQNO = A.FRS_MDM_SQNO UNION ALL SELECT 1
FROM TB_CSPBII120L B /* 감사정보관련처분내역 */ , TB_BADEAR007M C /* 관계자기본 */ WHERE B.CVLCPT_ADT_YR = C.CVLCPT_ADT_YR AND B.ADT_NO = C.ADT_NO AND C.RLPR_NM = #RLPR_NM# AND B.INFO_YR = A.INFO_YR AND B.FRS_MDM_SQNO = A.FRS_MDM_SQNO) AND CASE WHEN #PRCS_DRCTN_SECD# IS NULL AND #PRCS_DRCTN_SECD# IS NULL AND #PRCS_DRCTN_SECD# IS NULL THEN '1' WHEN A.PRCS_DRCTN_SECD = #PRCS_DRCTN_SECD# THEN '1' WHEN A.PRCS_DRCTN_SECD = #PRCS_DRCTN_SECD# THEN '1' WHEN A.PRCS_DRCTN_SECD = #PRCS_DRCTN_SECD# THEN '1' ELSE '0' END = '1' AND A.CLCT_SECD = #CLCT_SECD# AND A.SRC_SECD = #SRC_SECD# AND A.PRSNR_DEPT_CD LIKE NVL(SUBSTR(#strSmtDptCd#, 0, INSTR(#strSmtDptCd#, '0000') -1), #strSmtDptCd#) || '%' AND A.ETC_LBSVC_MNG_DEPT_CD LIKE NVL(SUBSTR(#strHndlDptCd#, 0, INSTR(#strHndlDptCd#, '0000') -1), #strHndlDptCd#) || '%' AND A.ADT_DEPT_CD LIKE NVL(SUBSTR(#strPopDptCd#, 0, INSTR(#strPopDptCd#, '0000') -1), #strPopDptCd#) || '%' AND EXISTS (SELECT 1
FROM TB_CSPBII120L B /* 감사정보관련처분내역 */ , TB_BADEAR002D C /* 처분요구사항상세 */ WHERE B.CVLCPT_ADT_YR = C.CVLCPT_ADT_YR AND B.ADT_NO = C.ADT_NO AND B.DSPS_RQT_SQNO = C.DSPS_RQT_SQNO AND C.ENFC_DEPT_CD LIKE NVL(SUBSTR(#strEnfDptCd#, 0, INSTR(#strEnfDptCd#, '0000') -1), #strEnfDptCd#) || '%' AND B.INFO_YR = A.INFO_YR AND B.FRS_MDM_SQNO = A.FRS_MDM_SQNO) AND A.PRSNR_ENO = #PRSNR_ENO# AND A.PRCS_PIC_ENO = #PRCS_PIC_ENO# AND A.ADTR_ENO = #ADTR_ENO# AND EXISTS (SELECT 1
FROM TB_CSPBII120L B /* 감사정보관련처분내역 */ , TB_BADEAR004M C /* 감사자기본 */ WHERE B.CVLCPT_ADT_YR = C.CVLCPT_ADT_YR AND B.ADT_NO = C.ADT_NO AND B.DSPS_RQT_SQNO = C.DSPS_RQT_SQNO AND C.EXTT_ID = #EXTT_ID# AND B.INFO_YR = A.INFO_YR AND B.FRS_MDM_SQNO = A.FRS_MDM_SQNO) AND CASE WHEN #PRCS_RSLT_SECD# IS NULL AND #PRCS_RSLT_SECD# IS NULL AND #PRCS_RSLT_SECD# IS NULL AND #PRCS_RSLT_SECD# IS NULL AND #PRCS_RSLT_SECD# IS NULL AND #PRCS_RSLT_SECD# IS NULL AND #PRCS_RSLT_SECD# IS NULL THEN '1' WHEN A.PRCS_RSLT_SECD = #PRCS_RSLT_SECD# THEN '1' WHEN A.PRCS_RSLT_SECD = #PRCS_RSLT_SECD# THEN '1' WHEN A.PRCS_RSLT_SECD = #PRCS_RSLT_SECD# THEN '1' WHEN A.PRCS_RSLT_SECD = #PRCS_RSLT_SECD# THEN '1' WHEN A.PRCS_RSLT_SECD = #PRCS_RSLT_SECD# THEN '1' WHEN A.PRCS_RSLT_SECD = #PRCS_RSLT_SECD# THEN '1' WHEN A.PRCS_RSLT_SECD = #PRCS_RSLT_SECD# THEN '1' ELSE '0' END = '1' AND CASE WHEN #strPrssSta1# IS NULL AND #strPrssSta2# IS NULL AND #strPrssSta3# IS NULL AND #strPrssSta4# IS NULL AND #strPrssSta5# IS NULL AND #strPrssSta6# IS NULL AND #strPrssSta7# IS NULL AND #strPrssSta8# IS NULL AND #strPrssSta9# IS NULL AND #strPrssSta10# IS NULL AND #strPrssSta11# IS NULL AND #strPrssSta12# IS NULL AND #strPrssSta13# IS NULL AND #strPrssSta14# IS NULL AND #strPrssSta15# IS NULL THEN '1' WHEN #strPrssSta1# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('05') THEN '1' WHEN #strPrssSta2# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('10') THEN '1' WHEN #strPrssSta3# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('13') THEN '1' WHEN #strPrssSta4# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('20') THEN '1' WHEN #strPrssSta5# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('15') THEN '1' WHEN #strPrssSta6# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('21', '22', '23','24','30','31','32') THEN '1' WHEN #strPrssSta7# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('99') THEN '1' WHEN #strPrssSta8# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('10', '13') THEN '1' WHEN #strPrssSta9# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('15') THEN '1' WHEN #strPrssSta10# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('21', '22', '23','24','30','31','32') THEN '1' WHEN #strPrssSta11# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('99') THEN '1' WHEN #strPrssSta12# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('05') THEN '1' WHEN #strPrssSta13# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('02') THEN '1' WHEN #strPrssSta14# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('02') THEN '1' WHEN #strPrssSta15# = 'Y' AND A.ADT_INFO_PRGRS_STTS_SECD IN ('20') THEN '1' ELSE '0' END = '1' 감사정보 검색 팝업화면에서 사용]--> AND A.UTL_ADT_SC > 0 AND A.PRSR_CNB IN (SELECT CNB FROM TBDCMACM001M WHERE GEN_ADMN_DVSN_CD = #strGEN_ADMN_DVSN_CD#) AND A.BLE_CHGR_CNB = #strBLE_CHGR_CNB# ORDER BY A.YE DESC, A.SRNO DESC