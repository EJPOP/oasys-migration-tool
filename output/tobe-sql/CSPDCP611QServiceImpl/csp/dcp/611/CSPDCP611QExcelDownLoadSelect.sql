SELECT D2.TPOF_KND_SECD /* 제보종류구분코드 */,
    (SELECT F_CODE_NM('1000599', S1.USR_DFN_TXT_1)
FROM TBDCMACM013C S1 WHERE S1.CMM_CD_DVSN_CD = '1000047' AND S1.CD = D1.CRU_KDCD) AS CVPT_KND_DVSN_NM ,D1.CRU_KDCD ,F_CODE_NM('1000047', D1.CRU_KDCD) AS CVPT_KND_NM ,TO_CHAR(D1.CRU_RCPT_DT, 'YYYY-MM-DD HH:MM') AS CRU_RCPT_DT ,D1.CVLCPT_RCPT_YR ,D1.CVLCPT_RCPT_RCPT ,D1.CVLCPT_RCPT_YR ||'-민원-'||D1.TPOF_ACTL_RCPT_NO AS ACP_YR_NO ,D1.RSCH_ASMT_TTL ,D1.TPOF_CVLPR_NM ,F_DPT_INFO(D2.TPOF_PRCS_DEPT_CD, '1') AS ETC_LBSVC_MNG_DEPT_CD ,(SELECT S2.USER_NM /* 사용자명 */
FROM TBDCMACM001M S2 WHERE USER_ID = D2.TPOF_PRCS_PIC_ID) AS USER_NM ,D1.CRU_PRCS_PRCS_STTS ,F_CODE_NM('1000361',D1.CRU_PRCS_PRCS_STTS) AS PRCS_NM ,D4.ORG_NMS AS INST_CD ,F_CODE_NM('1000754', D3.TPOF_PRCS_SECD) AS CVPT_HNLD_DVSN_NM ,F_CODE_NM('1000051', D3.TPOF_BFR_CVLCPT_PRCS_SECD) AS T_CVPT_HNLD_DVSN_NM ,TO_CHAR(D2.TPOF_LAST_PRCS_DT, 'YYYY-MM-DD') AS TPOF_LAST_PRCS_DT ,TO_CHAR(D2.TPOF_LAST_HNDT_DT, 'YYYY-MM-DD') AS CRU_LAST_HNDT_DT ,( SELECT DECODE(COUNT(*),0,1,COUNT(*))
FROM TB_CSPDCP101M S1 WHERE S1.CVLCPT_CLM_SECD = '1' AND S1.TPOF_CVLPR_NM = D1.TPOF_CVLPR_NM AND S1.TPOF_CVLPR_MPNO = D1.SLCT_CVLPR_MPNO ) AS JEBOCNT ,F_CODE_NM('1000056',D1.CRU_RCPT_PATH_SECD) AS ACP_RUT_NM ,D4.COPT_ORG_NM ,(SELECT F_CODE_NM('1000053',S1.TPOF_RSLT_RPTP_PRCS_RSLT_SECD) AS TPOF_RSLT_RPTP_PRCS_RSLT_SECD /* 제보결과보고서처리결과구분코드 */
FROM TB_CSPDCP402L S1 WHERE (S1.CVLCPT_CLM_SECD, S1.TPOF_RCPT_YR, S1.TPOF_RCPT_NO, S1.TPOF_CYCL) IN (SELECT S2.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    S2.TPOF_RCPT_YR /* 제보접수년도 */,
    S2.TPOF_RCPT_NO /* 제보접수번호 */,
    MIN(S2.TPOF_CYCL) AS TPOF_CYCL /* 제보차수 */
FROM TB_CSPDCP402L S2 WHERE S2.CLM_SECD = D1.CLM_SECD AND S2.CVLCPT_RCPT_YR = D2.TPOF_RCPT_YR AND S2.CVLCPT_RCPT_RCPT = D2.TPOF_RCPT_NO GROUP BY S2.CLM_SECD, S2.CVLCPT_RCPT_YR, S2.CVLCPT_RCPT_RCPT ) ) AS RSLT_RPRT_HNDL_RSLT_NM ,F_DPT_INFO(D3.TPOF_ADT_REF_DATA_TRNF_DEPT_CD,'1') AS AUD_RFR_MTRL_TRNF_DPT_NM ,F_DPT_INFO(D3.TPOF_TRNF_DEPT_CD,'1') AS TRNF_DPT_NM ,F_DPT_INFO(D1.CRU_RCPT_DEPT_CD,'1') AS ACP_DPT_NM ,D11.ORG_NMS AS TRNF_ORG_NM ,D1.SLCT_CVLPR_CONM_NM ,F_USR_INFO_BY_ID(D2.TPOF_BAI_PIC_ID,'2') AS BAI_CHGR_NM ,NVL(PUB_DVSN_NM,'미분류') AS PUB_DVSN_NM FROM TB_CSPDCP101M D1 ,TB_CSPDCP201M D2 ,TB_CSPDCP205L D3 ,(SELECT S1.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    S1.TPOF_RCPT_YR /* 제보접수년도 */,
    S1.TPOF_RCPT_NO /* 제보접수번호 */,
    AGGR_CONCAT( DECODE(S1.TPOF_OCRN_INST_CD,'10',S2.PROF_RBPRSN_INST_NM,'20',S1.TPOF_INST_NM), '/') AS AGGR_CONCAT,
    AGGR_CONCAT((SELECT AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */
FROM TBDCMACM015M WHERE INST_CD = S1.SLCT_JRSD_SG_SECD||'000000000'),'/') AS COPT_ORG_NM , AGGR_CONCAT(CASE WHEN S1.SLCT_PBNST_SECD = '10' THEN '국가기관' WHEN S1.SLCT_PBNST_SECD IN ('20', '21','22', '23') THEN '지방자치단체' WHEN S1.SLCT_PBNST_SECD IN ('30', '31', '32', '33') THEN '공공기관' WHEN S1.SLCT_PBNST_SECD = '40' THEN '기타단체' ELSE '미분류' END ,'/')AS PUB_DVSN_NM FROM TBCSPDCP206L S1 ,TBDCMACM015M S2 WHERE S1.INST_CD = S2.INST_CD(+) AND S1.CVLCPT_CLM_SECD = '1' AND S1.CVLCPT_INST_DSCTN_SECD = '1' GROUP BY S1.CVLCPT_CLM_SECD, S1.TPOF_RCPT_YR, S1.TPOF_RCPT_NO ) D4 ,TB_CSPDCP102M D5 ,(SELECT S1.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    S1.TPOF_RCPT_YR /* 제보접수년도 */,
    S1.TPOF_RCPT_NO /* 제보접수번호 */,
    AGGR_CONCAT (S2.PROF_RBPRSN_INST_NM, '/') AS AGGR_CONCAT
FROM TBCSPDCP206L S1 ,TBDCMACM015M S2 WHERE S1.INST_CD = S2.INST_CD(+) AND S1.CVLCPT_CLM_SECD = '1' AND S1.CVLCPT_INST_DSCTN_SECD IN ('2','3') GROUP BY S1.CVLCPT_CLM_SECD, S1.TPOF_RCPT_YR, S1.TPOF_RCPT_NO ) D11 WHERE D1.CLM_SECD = '1' AND D1.CLM_SECD = D2.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D2.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D2.TPOF_RCPT_YR(+) AND D1.CLM_SECD = D3.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D3.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D3.TPOF_RCPT_YR(+) AND D1.CLM_SECD = D4.CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D4.CVLCPT_RCPT_RCPT(+) AND D1.CVLCPT_RCPT_YR = D4.CVLCPT_RCPT_YR(+) AND D1.CLM_SECD = D5.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D5.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D5.TPOF_RCPT_YR(+) AND D1.CLM_SECD = D11.CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D11.CVLCPT_RCPT_RCPT(+) AND D1.CVLCPT_RCPT_YR = D11.CVLCPT_RCPT_YR(+) AND D3.TPOF_SQNO(+) = '1' AND D2.TPOF_KND_SECD = #TPOF_KND_SECD# AND TO_CHAR(CRU_RCPT_DT, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT# AND TO_CHAR(D2.TPOF_LAST_PRCS_DT, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT# AND D1.RSCH_ASMT_TTL LIKE '%'||#TIT_NM#||'%' AND D5.TPOF_CN LIKE '%'||#TIT_NM#||'%' AND D1.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND D1.TPOF_ACTL_RCPT_NO = #TPOF_ACTL_RCPT_NO# AND (D1.TPOF_CVLPR_NM LIKE '%'||#CVPTR_NM#||'%' OR D1.SLCT_CVLPR_RPRSV_NM LIKE '%'||#CVPTR_NM#||'%') AND D1.TPOF_CVLPR_NM IN (SELECT S1.TPOF_CVLPR_NM /* 제보민원인명 */
FROM TB_CSPDCP101M S1 WHERE 1=1 AND S1.CVLCPT_CLM_SECD = D1.CLM_SECD AND S1.TPOF_RCPT_NO = D1.CVLCPT_RCPT_RCPT AND S1.TPOF_RCPT_YR = D1.CVLCPT_RCPT_YR GROUP BY S1.TPOF_CVLPR_NM HAVING COUNT(*) > #BANBOKCNT# ) AND D1.CRU_TELNO = #CRU_TELNO# AND D1.SLCT_CVLPR_MPNO = #SLCT_CVLPR_MPNO# AND D1.CRU_PRCS_PRCS_STTS = #CRU_PRCS_PRCS_STTS# AND D1.CRU_KDCD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strCVPT_KND_CD# ||',' AS #STRCVPT_KND_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND D1.SLCT_CLMT_KDCD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strREQR_KND_CD# ||',' AS #STRREQR_KND_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND D1.CRU_RCPT_PATH_SECD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strACP_RUT_CD# ||',' AS #STRACP_RUT_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND D1.CRU_MNG_TPCD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strMNG_TYP_CD# ||',' AS #STRMNG_TYP_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND NVL(D2.TPOF_PRCS_DEPT_CD,D1.CRU_RCPT_DEPT_CD) = #HNDL_DPT_CD# AND D2.TPOF_PRCS_PIC_ID = #PRCS_PIC_ID# NVL(D2.TPOF_PASV_PBADMS_YN,'N') = #strPASV_ADMN_YN# (D1.OTSD_EXPRT_ADDR LIKE '%'||#strAD#||'%' OR D1.CRU_CVLPR_DADDR LIKE '%'||#strAD#||'%') (D1.CLM_SECD,D1.CVLCPT_RCPT_YR,D1.CVLCPT_RCPT_RCPT) IN ( SELECT CLM_SECD /* 청구구분코드 */,
    CVLCPT_RCPT_YR /* 민원접수년도 */,
    CVLCPT_RCPT_RCPT /* 민원접수번호 */
FROM TB_CSPDCP206L WHERE CVLCPT_INST_DSCTN_SECD = '1' AND INST_CD = #INST_CD# ) (D1.CLM_SECD,D1.CVLCPT_RCPT_YR,D1.CVLCPT_RCPT_RCPT) IN ( SELECT CLM_SECD /* 청구구분코드 */,
    CVLCPT_RCPT_YR /* 민원접수년도 */,
    CVLCPT_RCPT_RCPT /* 민원접수번호 */
FROM TB_CSPDCP206L WHERE CVLCPT_INST_DSCTN_SECD IN ('2','3') AND INST_CD = #INST_CD# ) D3.TPOF_TRNF_DEPT_CD = #TRNF_DEPT_CD# AND D1.CRU_HMPG_APLY_NO = #CRU_HMPG_APLY_NO# AND D1.CRU_SMG_CVLCPT_APLY_NO = #CRU_SMG_CVLCPT_APLY_NO# AND D3.TPOF_PRCS_SECD = #SLCT_PRCS_PRCS#