SELECT D2.TPOF_KND_SECD /* 제보종류구분코드 */,
    D8.USR_DFN_TXT_2,
    D1.CRU_KDCD /* 부패종류코드 */,
    D8.CD_NM,
    TO_CHAR(D1.CRU_RCPT_DT, 'YYYY-MM-DD HH24:MI') AS CRU_RCPT_DT /* 부패접수일시 */,
    D1.CVLCPT_RCPT_YR /* 민원접수년도 */,
    D1.CVLCPT_RCPT_RCPT /* 민원접수번호 */,
    D1.CLM_SECD /* 청구구분코드 */,
    D1.TPOF_ACTL_RCPT_NO /* 제보실제접수번호 */,
    DECODE(D1.TPOF_ACTL_RCPT_NO, NULL,'',D1.CVLCPT_RCPT_YR ||'-민원-'||D1.TPOF_ACTL_RCPT_NO) AS TPOF_ACTL_RCPT_NO /* 제보실제접수번호 */,
    D1.RSCH_ASMT_TTL /* 연구과제제목 */,
    DECODE(D1.SLCT_CLMT_KDCD,'1',D1.TPOF_CVLPR_NM,'2',D1.SLCT_CVLPR_RPRSV_NM,'3',D1.SLCT_CVLPR_RPRSV_NM,'4',D1.TPOF_CVLPR_NM) AS TPOF_CVLPR_NM /* 제보민원인명 */,
    F_DPT_INFO(D2.TPOF_PRCS_DEPT_CD, '1') AS ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    (SELECT S2.USER_NM AS USER_NM /* 사용자명 */
FROM TBDCMACM001M S2 WHERE USER_ID = D2.TPOF_PRCS_PIC_ID) AS USER_NM ,D1.CRU_PRCS_PRCS_STTS ,F_CODE_NM('1000361',D1.CRU_PRCS_PRCS_STTS) AS PRCS_NM ,D4.ORG_NMS AS INST_CD ,F_CODE_NM('1000754', D3.TPOF_PRCS_SECD) AS CVPT_HNLD_DVSN_NM ,F_CODE_NM('1000051', D3.TPOF_BFR_CVLCPT_PRCS_SECD) AS T_CVPT_HNLD_DVSN_NM ,TO_CHAR(D2.TPOF_LAST_PRCS_DT, 'YYYY-MM-DD') AS TPOF_LAST_PRCS_DT ,TO_CHAR(D2.TPOF_LAST_HNDT_DT, 'YYYY-MM-DD') AS CRU_LAST_HNDT_DT ,CASE WHEN D6.CNT > 0 THEN 'O' ELSE 'X' END AS HNDL_YN ,CASE WHEN D7.CNT > 0 THEN 'O' ELSE 'X' END AS BOGO_YN ,F_DPT_INFO(D1.CRU_RCPT_DEPT_CD,'1') AS ACP_DPT_NM ,F_CODE_NM('1000056',D1.CRU_RCPT_PATH_SECD) AS ACP_RUT_NM ,D1.SLCT_CLMT_KDCD ,(SELECT F_CODE_NM('1000053',S1.TPOF_RSLT_RPTP_PRCS_RSLT_SECD) AS TPOF_RSLT_RPTP_PRCS_RSLT_SECD /* 제보결과보고서처리결과구분코드 */
FROM TB_CSPDCP402L S1 WHERE (S1.CLM_SECD, S1.CVLCPT_RCPT_YR, S1.CVLCPT_RCPT_RCPT, S1.TPOF_CYCL) IN (SELECT S2.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    S2.TPOF_RCPT_YR /* 제보접수년도 */,
    S2.TPOF_RCPT_NO /* 제보접수번호 */,
    MIN(S2.TPOF_CYCL) AS TPOF_CYCL /* 제보차수 */
FROM TB_CSPDCP402L S2 WHERE S2.CLM_SECD = D1.CLM_SECD AND S2.CVLCPT_RCPT_YR = D2.TPOF_RCPT_YR AND S2.CVLCPT_RCPT_RCPT = D2.TPOF_RCPT_NO GROUP BY S2.CLM_SECD, S2.CVLCPT_RCPT_YR, S2.CVLCPT_RCPT_RCPT ) ) AS RSLT_RPRT_HNDL_RSLT_NM ,D1.SLCT_CVLPR_CONM_NM ,F_USR_INFO_BY_ID(D2.TPOF_BAI_PIC_ID,'2') AS BAI_CHGR_NM FROM TB_CSPDCP101M D1 ,TB_CSPDCP201M D2 ,TB_CSPDCP205L D3 ,(SELECT S1.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    S1.TPOF_RCPT_YR /* 제보접수년도 */,
    S1.TPOF_RCPT_NO /* 제보접수번호 */,
    AGGR_CONCAT( DECODE(S1.TPOF_OCRN_INST_CD,'10',S2.PROF_RBPRSN_INST_NM,'20',S1.TPOF_INST_NM), '/') AS AGGR_CONCAT
FROM TBCSPDCP206L S1 ,TBDCMACM015M S2 WHERE S1.INST_CD = S2.INST_CD(+) AND S1.CLM_SECD = '1' AND S1.CVLCPT_INST_DSCTN_SECD = '1' GROUP BY S1.CLM_SECD, S1.CVLCPT_RCPT_YR, S1.CVLCPT_RCPT_RCPT ) D4 ,TB_CSPDCP102M D5 ,(SELECT S5.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    S5.TPOF_RCPT_YR /* 제보접수년도 */,
    S5.TPOF_RCPT_NO /* 제보접수번호 */,
    COUNT(*) AS CNT
FROM TBCSPDCP203M S5 WHERE S5.TPOF_CYCL IS NULL AND S5.TPOF_DOC_SECD = 'A1' GROUP BY S5.CLM_SECD, S5.CVLCPT_RCPT_YR, S5.CVLCPT_RCPT_RCPT ) D6 ,(SELECT S6.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    S6.TPOF_RCPT_YR /* 제보접수년도 */,
    S6.TPOF_RCPT_NO /* 제보접수번호 */,
    COUNT(*) AS CNT
FROM TBCSPDCP203M S6 WHERE S6.TPOF_CYCL IS NOT NULL AND S6.TPOF_DOC_SECD = 'B1' GROUP BY S6.CLM_SECD, S6.CVLCPT_RCPT_YR, S6.CVLCPT_RCPT_RCPT) D7 ,TBDCMACM013C D8 WHERE 1=1 AND D1.CLM_SECD = '1' AND D1.CLM_SECD = D2.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D2.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D2.TPOF_RCPT_YR(+) AND D1.CLM_SECD = D4.CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D4.CVLCPT_RCPT_RCPT(+) AND D1.CVLCPT_RCPT_YR = D4.CVLCPT_RCPT_YR(+) AND D1.CLM_SECD = D5.CVLCPT_CLM_SECD AND D1.CVLCPT_RCPT_RCPT = D5.TPOF_RCPT_NO AND D1.CVLCPT_RCPT_YR = D5.TPOF_RCPT_YR AND D1.CLM_SECD = D6.CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D6.CVLCPT_RCPT_RCPT(+) AND D1.CVLCPT_RCPT_YR = D6.CVLCPT_RCPT_YR(+) AND D1.CLM_SECD = D7.CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D7.CVLCPT_RCPT_RCPT(+) AND D1.CVLCPT_RCPT_YR = D7.CVLCPT_RCPT_YR(+) AND D1.CLM_SECD = D3.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D3.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D3.TPOF_RCPT_YR(+) AND D3.TPOF_SQNO(+) = 1 AND D8.CMM_CD_DVSN_CD = '1000047' AND D8.CD <> '000000000' AND D1.CRU_KDCD = D8.CD AND TO_CHAR(D1.CRU_RCPT_DT, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT# AND D2.TPOF_KND_SECD = #TPOF_KND_SECD# AND TO_CHAR(D2.TPOF_LAST_PRCS_DT, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT# AND TO_CHAR(D1.FRST_REG_DT, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT# AND D1.RSCH_ASMT_TTL LIKE '%'||#TIT_NM#||'%' AND D5.TPOF_CN LIKE '%'||#TIT_NM#||'%' AND D1.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND D1.TPOF_ACTL_RCPT_NO = #TPOF_ACTL_RCPT_NO# AND (D1.TPOF_CVLPR_NM LIKE '%'||#CVPTR_NM#||'%' OR D1.SLCT_CVLPR_RPRSV_NM LIKE '%'||#CVPTR_NM#||'%') AND (D1.TPOF_CVLPR_NM, D1.SLCT_CVLPR_MPNO) IN ( SELECT S1.TPOF_CVLPR_NM /* 제보민원인명 */,
    S1.TPOF_CVLPR_MPNO /* 제보민원인휴대전화번호 */
FROM TB_CSPDCP101M S1 WHERE 1=1 AND S1.CLM_SECD = '1' AND S1.SLCT_CVLPR_MPNO IS NOT NULL GROUP BY S1.TPOF_CVLPR_NM , S1.SLCT_CVLPR_MPNO HAVING COUNT(*) > #BANBOKCNT# ) AND REPLACE(D1.CRU_TELNO, '-', '') LIKE '%'||#TNB#||'%' AND REPLACE(D1.SLCT_CVLPR_MPNO, '-', '') LIKE '%'||#HPN#||'%' AND D1.CRU_PRCS_PRCS_STTS = #CRU_PRCS_PRCS_STTS# AND D1.CRU_KDCD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strCVPT_KND_CD# ||',' AS #STRCVPT_KND_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND D1.SLCT_CLMT_KDCD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strREQR_KND_CD# ||',' AS #STRREQR_KND_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND D1.CRU_RCPT_PATH_SECD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strACP_RUT_CD# ||',' AS #STRACP_RUT_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND D1.CRU_MNG_TPCD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strMNG_TYP_CD# ||',' AS #STRMNG_TYP_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND NVL(D2.TPOF_PRCS_DEPT_CD,D1.CRU_RCPT_DEPT_CD) = #HNDL_DPT_CD# AND D2.TPOF_PRCS_PIC_ID = #PRCS_PIC_ID# NVL(D2.TPOF_PASV_PBADMS_YN,'N') = #strPASV_ADMN_YN# (D1.OTSD_EXPRT_ADDR LIKE '%'||#strAD#||'%' OR D1.CRU_CVLPR_DADDR LIKE '%'||#strAD#||'%') (D1.CLM_SECD,D1.CVLCPT_RCPT_YR,D1.CVLCPT_RCPT_RCPT) IN ( SELECT CLM_SECD /* 청구구분코드 */,
    CVLCPT_RCPT_YR /* 민원접수년도 */,
    CVLCPT_RCPT_RCPT /* 민원접수번호 */
FROM TB_CSPDCP206L WHERE CVLCPT_INST_DSCTN_SECD = '1' AND INST_CD = #INST_CD# ) (D1.CLM_SECD,D1.CVLCPT_RCPT_YR,D1.CVLCPT_RCPT_RCPT) IN ( SELECT CLM_SECD /* 청구구분코드 */,
    CVLCPT_RCPT_YR /* 민원접수년도 */,
    CVLCPT_RCPT_RCPT /* 민원접수번호 */
FROM TB_CSPDCP206L WHERE CVLCPT_INST_DSCTN_SECD IN ('2','3') AND INST_CD = #INST_CD# ) (D1.CLM_SECD,D1.CVLCPT_RCPT_YR,D1.CVLCPT_RCPT_RCPT) IN ( SELECT CLM_SECD /* 청구구분코드 */,
    CVLCPT_RCPT_YR /* 민원접수년도 */,
    CVLCPT_RCPT_RCPT /* 민원접수번호 */
FROM TB_CSPDCP205L WHERE TRNF_DEPT_CD = #TRNF_DEPT_CD# AND FRS_MDM_SQNO=1 ) AND D1.CRU_HMPG_APLY_NO = #CRU_HMPG_APLY_NO# AND D1.CRU_SMG_CVLCPT_APLY_NO = #CRU_SMG_CVLCPT_APLY_NO# AND D3.TPOF_PRCS_SECD = #SLCT_PRCS_PRCS#