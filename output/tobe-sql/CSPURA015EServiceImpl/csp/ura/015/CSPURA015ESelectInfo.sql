WITH DATA AS ( SELECT DISTINCT C.RSCH_YR AS RSCH_YR /* 연구년도 */,
    C.RSCH_PIC_PIC /* 연구담당자직원전산번호 */,
    NVL(A.CNT, 0) AS CNT,
    NVL(B.CNT, 0) AS CNT
FROM ( SELECT COUNT(A.RSCH_YR) AS RSCH_YR /* 연구년도 */,
    A.RSCH_YR /* 연구년도 */,
    B.RSCH_PIC_PIC /* 연구담당자직원전산번호 */
FROM TBCSPURA008M A , TBCSPURA009D B WHERE B.RSCH_YR = A.RSCH_YR AND B.RSCH_ASMT_SQNO = A.RSCH_ASMT_SQNO AND B.RSCH_ROLE_ROLE = '1' GROUP BY A.RSCH_YR, B.TRGT_NOP_ENO ) A , ( SELECT COUNT(A.RSCH_YR) AS RSCH_YR /* 연구년도 */,
    A.RSCH_YR /* 연구년도 */,
    B.RSCH_PIC_PIC /* 연구담당자직원전산번호 */
FROM TBCSPURA008M A , TBCSPURA009D B WHERE B.RSCH_YR = A.RSCH_YR AND B.RSCH_ASMT_SQNO = A.RSCH_ASMT_SQNO AND B.RSCH_ROLE_ROLE = '2' GROUP BY A.RSCH_YR, B.TRGT_NOP_ENO ) B, TB_CSPURA009D C WHERE C.RSCH_YR = A.RSCH_YR(+) AND C.TRGT_NOP_ENO = A.TRGT_NOP_ENO(+) AND C.RSCH_YR = B.RSCH_YR(+) AND C.TRGT_NOP_ENO = B.TRGT_NOP_ENO(+) ) SELECT (SELECT AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */
FROM TBDCMACM002M WHERE SRECS_DEPT_CD = (SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TBDCMACM001M WHERE TRGT_NOP_ENO = B.TRGT_NOP_ENO)) AS CNSTN_MBCMT_DEPT_NM , (SELECT USER_NM /* 사용자명 */
FROM TBDCMACM001M WHERE TRGT_NOP_ENO = B.TRGT_NOP_ENO) AS USER_NM , (SELECT CD_NM
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000173' AND CD = (SELECT JBGD_SECD /* 직급구분코드 */
FROM TBDCMACM001M WHERE TRGT_NOP_ENO = B.TRGT_NOP_ENO)) AS JBGD_NM , (SELECT ROLE1
FROM DATA D1 WHERE D1.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND D1.RSCH_YR = A.RSCH_YR) AS ROLE1 , (SELECT ROLE2
FROM DATA D1 WHERE D1.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND D1.RSCH_YR = A.RSCH_YR) AS ROLE2 , (SELECT ROLE1
FROM DATA D1 WHERE D1.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND D1.RSCH_YR = A.RSCH_YR) + (SELECT ROLE2
FROM DATA D1 WHERE D1.TRGT_NOP_ENO = B.TRGT_NOP_ENO AND D1.RSCH_YR = A.RSCH_YR) AS TOT , B.RSCH_ROLE_ROLE , A.RSCH_SE_CN , A.RSCH_ASMT_TTL , A.RSCH_TYPE_TYPE , A.RSCH_PRD_CN , A.RSCH_MCNT , A.RSCH_RT , C.RSCH_PLAN_PLAN_PRFMNC , C.RSCH_MN1_MN1_PT , C.RSCH_MN2_MN2_PT , C.RSCH_MN3_MN3_PT , C.RSCH_MN4_MN4_PT , C.RSCH_MN5_MN5_PT , C.RSCH_MN6_MN6_PT , C.RSCH_MN7_MN7_PT , C.RSCH_MN8_MN8_PT , C.RSCH_MN9_MN9_PT , C.RSCH_MN10_MN10_PT , C.RSCH_MN11_MN11_PT , RSCH_MN12_MN12_PT , RSCH_MN1_MN1_PT , RSCH_MN2_MN2_PT , RSCH_MN3_MN3_PT , RSCH_MN4_MN4_PT , RSCH_MN5_MN5_PT , RSCH_MN6_MN6_PT , RSCH_MN7_MN7_PT , RSCH_MN8_MN8_PT , RSCH_MN9_MN9_PT , RSCH_MN10_MN10_PT , RSCH_MN11_MN11_PT , RSCH_MN12_MN12_PT , A.RMRK_CN , A.RSCH_YR , A.RSCH_ASMT_SQNO FROM TB_CSPURA008M A , TB_CSPURA009D B , TB_CSPURA010D C WHERE B.RSCH_YR = A.RSCH_YR AND B.RSCH_ASMT_SQNO = A.RSCH_ASMT_SQNO AND C.RSCH_YR = A.RSCH_YR AND C.RSCH_SQNO = A.RSCH_ASMT_SQNO AND A.RSCH_YR = #RSCH_YR# AND B.TRGT_NOP_ENO IN (SELECT TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBDCMACM001M WHERE SRECS_DEPT_CD = #SRECS_DEPT_CD#) AND B.RSCH_ROLE_ROLE = #RSCH_ROLE_ROLE# AND A.RSCH_TYPE_TYPE LIKE '%' || #strTASK_TYP_NM# || '%' AND B.TRGT_NOP_ENO IN (SELECT TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBDCMACM001M WHERE USER_NM LIKE '%' || #strUSR_NAM# || '%') AND A.RSCH_ASMT_TTL LIKE '%' || #strSTD_TASK_NM# || '%' AND A.RMRK_CN LIKE '%' || #strRMK_SBJ# || '%' ORDER BY A.RSCH_YR, CNSTN_MBCMT_DEPT_NM,JBGD_NM, USER_NM, A.RSCH_RT, A.RSCH_ASMT_TTL, C.RSCH_PLAN_PLAN_PRFMNC