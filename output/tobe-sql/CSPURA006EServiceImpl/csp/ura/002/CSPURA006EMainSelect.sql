SELECT C.OTSD_EXPRT_REG_YR /* 외부전문가등록년도 */,
    C.OTSD_EXPRT_SQNO /* 외부전문가순번 */,
    C.EXTL_EPRT_DVSN_NM,
    D1.OTSD_EXPRT_NM /* 외부전문가명 */,
    D1.OTSD_EXPRT_DEPT_NM /* 외부전문가부서명 */,
    D1.OTSD_EXPRT_JBPS_NM /* 외부전문가직위명 */,
    D1.OTSD_EXPRT_MJR_NM /* 외부전문가전공명 */,
    D1.OTSD_EXPRT_WRC_TELNO /* 외부전문가직장전화번호 */,
    D1.OTSD_EXPRT_HOME_TELNO /* 외부전문가자택전화번호 */,
    D1.OTSD_EXPRT_MPNO /* 외부전문가휴대전화번호 */,
    D1.OTSD_EXPRT_FAX_NO /* 외부전문가팩스번호 */,
    D1.OTSD_EXPRT_EML_NM /* 외부전문가이메일명 */,
    D1.OTSD_EXPRT_ZIP AS OTSD_EXPRT_ZIP /* 외부전문가우편번호 */,
    D1.OTSD_EXPRT_RDNM_ADDR /* 외부전문가도로명주소 */,
    D1.OTSD_EXPRT_ADDR /* 외부전문가주소 */,
    D1.OTSD_EXPRT_RDNM_DADDR /* 외부전문가도로명상세주소 */,
    D1.OTSD_EXPRT_DADDR /* 외부전문가상세주소 */,
    D1.OTSD_EXPRT_RGTR_ENO /* 외부전문가등록자직원전산번호 */,
    D1.OTSD_EXPRT_USE_YN /* 외부전문가사용여부 */,
    D1.OTSD_EXPRT_RMRK_CN /* 외부전문가비고내용 */,
    TO_CHAR(D1.FRST_REG_DT,'YYYYMMDD') AS FRST_REG_DT /* 최초등록일시 */,
    C.OTSD_EXPRT_SECD /* 외부전문가구분코드 */
FROM ( SELECT OTSD_EXPRT_REG_YR /* 외부전문가등록년도 */,
    OTSD_EXPRT_SQNO /* 외부전문가순번 */,
    AGGR_CONCAT( B.CD_NM, '/') AS AGGR_CONCAT,
    AGGR_CONCAT( A.OTSD_EXPRT_SECD, '/') AS OTSD_EXPRT_SECD /* 외부전문가구분코드 */
FROM TBCSPURA004D A , TBDCMACM013C B WHERE A.OTSD_EXPRT_SECD = B.CD AND B.CMM_CD_DVSN_CD = '1000265' AND A.OTSD_EXPRT_REG_YR = #OTSD_EXPRT_REG_YR# AND (A.OTSD_EXPRT_REG_YR, A.OTSD_EXPRT_SQNO) IN (SELECT OTSD_EXPRT_REG_YR /* 외부전문가등록년도 */,
    OTSD_EXPRT_SQNO /* 외부전문가순번 */
FROM TBCSPURA004D Z WHERE Z.OTSD_EXPRT_SECD = #OTSD_EXPRT_SECD#) GROUP BY OTSD_EXPRT_REG_YR, OTSD_EXPRT_SQNO ) C, TB_CSPURA003M D1 WHERE 1=1 AND C.OTSD_EXPRT_REG_YR = D1.OTSD_EXPRT_REG_YR AND C.OTSD_EXPRT_SQNO = D1.OTSD_EXPRT_SQNO AND D1.OTSD_EXPRT_NM like '%'||#EXTL_EPRT_NAM#||'%' AND D1.OTSD_EXPRT_RMRK_CN LIKE '%'||#EXTL_EPRT_RMK#||'%' AND D1.OTSD_EXPRT_REG_YR = #OTSD_EXPRT_REG_YR# AND D1.OTSD_EXPRT_DEPT_NM LIKE '%'||#DPT_NM#||'%' ORDER BY C.OTSD_EXPRT_REG_YR DESC, TO_NUMBER(C.OTSD_EXPRT_SQNO) DESC