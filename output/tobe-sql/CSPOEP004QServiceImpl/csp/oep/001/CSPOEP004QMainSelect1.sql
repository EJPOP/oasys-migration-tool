SELECT A.YYYYMM,
    TO_CHAR(A.TOTAL1, 'FM999,999') || CHR(13)|| CHR(10)|| '('|| TO_CHAR(A.TOTAL_NOP, 'FM999,999')||')' AS TO_CHAR,
    TO_CHAR(A.A1, 'FM999,999') || CHR(13)|| CHR(10)|| '('|| TO_CHAR(A.AA1, 'FM999,999')||')' AS TO_CHAR,
    TO_CHAR(A.B1, 'FM999,999') || CHR(13)|| CHR(10)|| '('|| TO_CHAR(A.BB1, 'FM999,999')||')' AS TO_CHAR,
    TO_CHAR(A.C1, 'FM999,999') || CHR(13)|| CHR(10)|| '('|| TO_CHAR(A.CC1, 'FM999,999')||')' AS TO_CHAR,
    TO_CHAR(A.D1, 'FM999,999') || CHR(13)|| CHR(10)|| '('|| TO_CHAR(A.DD1, 'FM999,999')||')' AS TO_CHAR,
    TO_CHAR(A.E1, 'FM999,999') || CHR(13)|| CHR(10)|| '('|| TO_CHAR(A.EE1, 'FM999,999')||')' AS TO_CHAR,
    TO_CHAR(A.F1, 'FM999,999') || CHR(13)|| CHR(10)|| '('|| TO_CHAR(A.FF1, 'FM999,999')||')' AS TO_CHAR,
    #yy1#||'-'||#mm1# AS #YY1#,
    #yy2#||'-'||#mm2# AS #YY2#
FROM( SELECT NVL2(SUBSTR(VI_DT, 0, 6),SUBSTR(VI_DT, 0, 6),'합계') AS NVL2,
    COUNT(VI_PPS_CD) AS VI_PPS_CD,
    SUM(TPOF_NOPE) AS TPOF_NOPE /* 제보인원수 */,
    SUM(CASE WHEN VI_PPS_CD = '1' THEN 1 ELSE 0 END) AS VI_PPS_CD,
    SUM(CASE WHEN VI_PPS_CD = '1' THEN TPOF_NOPE ELSE 0 END) AS VI_PPS_CD,
    SUM(CASE WHEN VI_PPS_CD = '2' THEN 1 ELSE 0 END) AS VI_PPS_CD,
    SUM(CASE WHEN VI_PPS_CD = '2' THEN TPOF_NOPE ELSE 0 END) AS VI_PPS_CD,
    SUM(CASE WHEN VI_PPS_CD = '3' THEN 1 ELSE 0 END) AS VI_PPS_CD,
    SUM(CASE WHEN VI_PPS_CD = '3' THEN TPOF_NOPE ELSE 0 END) AS VI_PPS_CD,
    SUM(CASE WHEN VI_PPS_CD = '4' THEN 1 ELSE 0 END) AS VI_PPS_CD,
    SUM(CASE WHEN VI_PPS_CD = '4' THEN TPOF_NOPE ELSE 0 END) AS VI_PPS_CD,
    SUM(CASE WHEN VI_PPS_CD = '5' THEN 1 ELSE 0 END) AS VI_PPS_CD,
    SUM(CASE WHEN VI_PPS_CD = '5' THEN TPOF_NOPE ELSE 0 END) AS VI_PPS_CD,
    SUM(CASE WHEN VI_PPS_CD = '6' THEN 1 ELSE 0 END) AS VI_PPS_CD,
    SUM(CASE WHEN VI_PPS_CD = '6' THEN TPOF_NOPE ELSE 0 END) AS VI_PPS_CD
FROM TBCSPOEP001M WHERE 1=1 AND SUBSTR(VI_DT, 0, 6) >= #yy1#||#mm1# AND SUBSTR(VI_DT, 0, 6) <= #yy2#||#mm2# GROUP BY ROLLUP (SUBSTR(VI_DT, 0, 6)) ) A