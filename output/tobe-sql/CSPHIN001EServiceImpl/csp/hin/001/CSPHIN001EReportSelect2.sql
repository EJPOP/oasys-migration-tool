SELECT TO_CHAR(TO_DATE(#fromYmd#),'YYYY-MM-DD') AS TO_CHAR,
    TO_CHAR(TO_DATE(#toYmd#),'YYYY-MM-DD') AS TO_CHAR,
    THN_RANK_NM,
    CNT1,
    CNT2,
    CNT3,
    CNT4,
    CNT5,
    CNT6,
    CNT7,
    CNT8,
    CNT9,
    CNT10,
    CNT11,
    CNT12,
    CNT13,
    CNT14,
    CNT15,
    CNT99,
    (CNT1+CNT2+CNT3+CNT4+CNT5+CNT6+CNT7+CNT8+CNT9+CNT10+CNT11+CNT12+CNT13+CNT14+CNT15+CNT99) AS CNT1
FROM ( SELECT NVL2(THN_RANK_CD,F_CODE_NM('1000173',A.THN_RANK_CD),'합계') AS NVL2,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '01' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '02' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '03' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '04' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '05' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '06' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '07' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '08' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '09' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '10' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '11' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '12' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '13' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '14' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '15' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD,
    SUM(CASE WHEN A.GEN_MNG_TRN_DVSN_CD = '99' THEN 1 ELSE 0 END) AS GEN_MNG_TRN_DVSN_CD
FROM TBCSPHIN001M A WHERE 1=1 AND A.TRN_STR_DT &gt;= #fromYmd# AND A.TRN_END_DT &lt;= #toYmd# GROUP BY ROLLUP(A.THN_RANK_CD) ) ORDER BY THN_RANK_NM