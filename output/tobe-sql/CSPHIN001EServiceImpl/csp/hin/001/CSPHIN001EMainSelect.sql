SELECT /*+ INDEX(B KBDCMDCMACM001001) */F_DPT_INFO(B.SRECS_DEPT_CD, '1') AS CNSTN_MBCMT_DEPT_NM, A.TRN_PEN_CNB, B.USER_NM AS USR_NAME, F_CODE_NM('1000173', B.JBGD_SECD) AS JBGD_NM, /* 현직급 */ A.TRN_STR_DT, A.TRN_END_DT, TO_CHAR(TO_DATE(A.TRN_STR_DT), 'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(A.TRN_END_DT), 'YYYY-MM-DD') || ' (' || CASE WHEN TO_DATE(A.TRN_END_DT,'YYYYMMDD') - TO_DATE(A.TRN_STR_DT,'YYYYMMDD') AND #stdDt# BETWEEN A.TRN_STR_DT AND A.TRN_END_DT AND A.TRN_STR_DT &lt;= #strDt# AND A.TRN_STR_DT &gt;= #strDt# AND A.TRN_END_DT &lt;= #endDt# AND A.TRN_END_DT &gt;= #endDt# AND A.GEN_MNG_TRN_DVSN_CD = #trnDvsnCd# /* 훈련구분 */ AND A.TRN_STR_DT &gt;= #fromYmd# AND A.TRN_END_DT &lt;= #toYmd# AND #fromTrnDay# &lt; TO_DATE(A.TRN_END_DT,'YYYYMMDD') - TO_DATE(A.TRN_STR_DT,'YYYYMMDD') /* 훈련일수FROM */ AND #toTrnDay# &gt; TO_DATE(A.TRN_END_DT,'YYYYMMDD') - TO_DATE(A.TRN_STR_DT,'YYYYMMDD') /* 훈련일수TO */ AND (A.TRN_TXT LIKE '%' || #searchBox# || '%' OR F_CODE_NM('1000181', A.TRN_BR_CD_1) LIKE '%' || #searchBox# || '%' OR F_CODE_NM('1000181', A.TRN_BR_CD_2) LIKE '%' || #searchBox# || '%' OR F_CODE_NM('1000181', A.TRN_BR_CD_3) LIKE '%' || #searchBox# || '%' OR B.USER_NM LIKE '%' || #searchBox# || '%') ORDER BY A.TRN_END_DT DESC