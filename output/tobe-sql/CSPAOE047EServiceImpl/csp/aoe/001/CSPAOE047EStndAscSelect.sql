SELECT ROUND( case when #strAudStepYn# = 'Y' then CASE WHEN #strSytTrtmYn# = 'Y' THEN NVL(F_GET_CAL(D2.SYT_TRTM_STND_ASC_FML_TXT, '200'), 0) ELSE NVL(F_GET_CAL(D2.IDVT_TRTM_STND_ASC_FML_TXT, '200'), 0) END when #strAudStepYn# = 'N' then NVL(F_GET_CAL(D2.STND_ASC_FML_TXT, '200'), 0) end, 2) AS ROUND /* 표준평점 */
FROM( SELECT D2.EVL_YR,
    D2.HLYR_DVSN_CD,
    D2.ADT_KDCD /* 감사종류코드 */,
    D2.STND_ASC_FML_TXT,
    /*국단장 이전 표준평점수식*/ D2.SYT_TRTM_STND_ASC_FML_TXT,
    /*심의실 이후 종합처리안 표준평점수식*/ D2.IDVT_TRTM_STND_ASC_FML_TXT /* 심의실 이후 개별처리안 표준평점수식 */
FROM TBCSPAOE004M D1 , TBCSPAOE044M D2 WHERE D1.EVL_YR = D2.EVL_YR AND D1.HLYR_DVSN_CD = D2.HLYR_DVSN_CD AND D1.CVLCPT_TASK_SECD = D2.CVLCPT_TASK_SECD AND D1.ADT_KDCD = D2.ADT_KDCD AND D1.EVL_YR = #strEvlYr# AND D1.HLYR_DVSN_CD = #strHlyrDvsnCd# AND D1.CVLCPT_TASK_SECD = #CVLCPT_TASK_SECD# AND D1.ADT_KDCD = #ADT_KDCD# AND #strMndyCnt# BETWEEN D2.MNDY_CNT_1 AND D2.MNDY_CNT_2 ) D2 /*표준평점 수식*/