SELECT D2.EVL_YR,
    D2.HLYR_DVSN_CD,
    D2.CVLCPT_TASK_SECD /* 민원업무구분코드 */,
    D2.AUD_TSK_KND_CD,
    D2.CVLCPT_ADT_YR /* 민원감사년도 */,
    D2.TSK_NO,
    D3.TSK_NM,
    D2.TSK_ASC,
    D2.EVL_STEP_CD,
    D2.EVL_CMTR_DVSN_CD,
    D2.TSK_ASC,
    F_DPT_INFO(D3.CHR_DPT_CD, '1') AS TKCG_DEPT_NM /* 담당부서명 */
FROM TBCSPAOE029M D2 LEFT JOIN TBCSPAOE033M D1 ON D1.EVL_YR = D2.EVL_YR AND D1.HLYR_DVSN_CD = D2.HLYR_DVSN_CD AND D1.CVLCPT_TASK_SECD = D2.CVLCPT_TASK_SECD AND D1.CVLCPT_ADT_YR = D2.CVLCPT_ADT_YR AND D1.TSK_NO = D2.TSK_NO , TBCSPAOE024M D3 WHERE D2.EVL_YR = D3.EVL_YR AND D2.HLYR_DVSN_CD = D3.HLYR_DVSN_CD AND D2.AUD_TSK_KND_CD = D3.TASK_KDCD AND D2.CVLCPT_ADT_YR = D3.EVL_YR AND D2.TSK_NO = D3.TSK_NO AND D2.EVL_YR = #strEvlYr# AND D2.HLYR_DVSN_CD = #strHlyrDvsnCd# AND D2.CVLCPT_TASK_SECD = '10001' /*감사외업무평점*/ AND D2.EVL_CMTR_DVSN_CD IN ('CD08','CD10','CD12','CD14','CD16','CD18','CD20','CD22','CD24','CD26','CD28','CD30','CD32') D2.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# D2.TSK_NO = #strTskNo# D3.TSK_NM LIKE '%'||#strAudSbjNm#||'%' GROUP BY D2.EVL_YR, D2.HLYR_DVSN_CD, D2.CVLCPT_TASK_SECD, D2.AUD_TSK_KND_CD, D2.CVLCPT_ADT_YR, D2.TSK_NO, D3.TSK_NM, D2.TSK_ASC, D2.EVL_STEP_CD, D2.EVL_CMTR_DVSN_CD, D2.SYT_EVL_RK_CD, D2.SYT_EVL_ADVL_VAL, D3.CHR_DPT_CD ORDER BY D3.CHR_DPT_CD