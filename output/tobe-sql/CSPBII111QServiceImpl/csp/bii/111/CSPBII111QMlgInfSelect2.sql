SELECT /* csp.bii.service.impl.CSPBII111QServiceImpl.CSPBII111QMlgInfSelect */ SUM(AA.SBMSN_WHOL_SCR) AS SBMSN_WHOL_SCR /* 제출전체점수 */,
    SUM(AA.UTLZ_WHOL_SCR) AS UTLZ_WHOL_SCR /* 활용전체점수 */,
    SUM(AA.RLBT_WHOL_SCR) AS RLBT_WHOL_SCR /* 신뢰성전체점수 */,
    SUM(AA.CSIT_TSC) AS CSIT_TSC /* 충실성총점 */,
    MAX(AA.SMT_DEL_CPT) AS SMT_DEL_CPT /* 폐기건수 */,
    MAX(AA.SBMSN_NOCS) AS SBMSN_NOCS /* 제출건수 */,
    MAX(AA.SMT_NOC_CPT) AS SMT_NOC_CPT /* 제출건수(평가완료) */,
    MAX(AA.SMT_DEL_CPT) + MAX(AA.SBMSN_NOCS) + MAX(AA.SMT_NOC_CPT) AS SMT_DEL_CPT,
    MAX(SBMSN_SCR_RNK) AS SBMSN_SCR_RNK /* 제출점수순위 */
FROM ( SELECT nvl(UTLZ_WHOL_SCR,0) AS UTLZ_WHOL_SCR /* 활용전체점수 */,
    nvl(RLBT_WHOL_SCR,0) AS RLBT_WHOL_SCR /* 신뢰성전체점수 */,
    nvl(CSIT_TSC,0) AS CSIT_TSC /* 충실성총점 */,
    nvl(SBMSN_WHOL_SCR,0) AS SBMSN_WHOL_SCR /* 제출전체점수 */,
    (SELECT count(*)
FROM TBCSPBII100M M WHERE M.PRSNR_ENO = #TRGT_NOP_ENO# AND M.ADT_INFO_PRGRS_STTS_SECD NOT IN ('15','20','99') AND M.SBMSN_YMD BETWEEN #strStrSmtDt# AND #strEndSmtDt# AND M.ADT_INFO_PRGRS_STTS_SECD >= '05') AS SBMSN_NOCS /* 제출건수(평가중) */ , (SELECT count(*)
FROM TBCSPBII100M M WHERE M.PRSNR_ENO = #TRGT_NOP_ENO# AND M.ADT_INFO_PRGRS_STTS_SECD IN ('15','20','99') AND M.SBMSN_YMD BETWEEN #strStrSmtDt# AND #strEndSmtDt# AND M.ADT_INFO_PRGRS_STTS_SECD >= '05' AND M.PRCS_DRCTN_SECD != '7') AS SMT_NOC_CPT /* 제출건수(평가완료) */ , (SELECT count(*)
FROM TBCSPBII100M M WHERE M.PRSNR_ENO = #TRGT_NOP_ENO# AND M.ADT_INFO_PRGRS_STTS_SECD IN ('15','20','99') AND M.SBMSN_YMD BETWEEN #strStrSmtDt# AND #strEndSmtDt# AND M.ADT_INFO_PRGRS_STTS_SECD >= '05' AND M.PRCS_DRCTN_SECD = '7' ) AS SMT_DEL_CPT /* 폐기건수 */ , SBMSN_SCR_RNK FROM TBCSPBII160L A WHERE A.INFO_YR = REGEXP_SUBSTR(#strYeQrDvsnCd#, '[^|]+', 1, 1) AND A.INFO_MLG_QTR_SECD = REGEXP_SUBSTR(#strYeQrDvsnCd#, '[^|]+', 1, 2) AND A.TRGT_NOP_ENO = #TRGT_NOP_ENO# ) AA