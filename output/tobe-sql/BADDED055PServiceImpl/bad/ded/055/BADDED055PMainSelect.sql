SELECT *
FROM ( SELECT D1.BZTRP_YR AS BZTRP_YR /* 출장년도 */,
    D1.BZTRP_SQNO AS BZTRP_SQNO /* 출장순번 */,
    D1.BZTRVR_ENO AS BZTRVR_ENO /* 출장자직원전산번호 */,
    D1.PCT_NM_DISP AS PCT_NM_DISP,
    D1.JBGD_NM AS JBGD_NM /* 직급명 */,
    NVL(D1.BTEXP_CRTR_AMT,0) - NVL(D2.BTEXP_CRTR_AMT,0) AS BTEXP_CRTR_AMT /* 출장비기준금액 */,
    NVL(D1.LDG_CST,0) - NVL(D2.LDG_CST,0) AS LDG_CST /* 숙박비용 */,
    NVL(D1.BZTRP_TRVEXP_FDEXP,0) - NVL(D2.BZTRP_TRVEXP_FDEXP,0) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    NVL(D1.CPRG_FARE_CST,0) - NVL(D2.CPRG_FARE_CST,0) AS CPRG_FARE_CST /* 수도권운임비용 */,
    NVL(D1.SPM_CST,0) - NVL(D2.SPM_CST,0) AS SPM_CST /* 보충비용 */,
    NVL(D1.BZTRP_DCN,0) - NVL(D2.BZTRP_DCN,0) AS BZTRP_DCN /* 출장일수 */,
    NVL(D1.RL_FARE_AMT,0) - NVL(D2.RL_FARE_AMT,0) AS RL_FARE_AMT /* 철도운임금액 */,
    NVL(D1.LEAD_CST,0) - NVL(D2.LEAD_CST,0) AS LEAD_CST /* 지휘비용 */,
    NVL(D1.ADT_ACTV_ACTC_AMT,0) - NVL(D2.ADT_ACTV_ACTC_AMT,0) AS ADT_ACTV_ACTC_AMT /* 감사활동수용금액 */,
    NVL(D1.SUM_COST,0) - NVL(D2.SUM_COST,0) AS SUM_COST /* 국내여비 */,
    NVL(D1.ALL_COST,0) - NVL(D2.ALL_COST,0) AS ALL_COST /* 합계 */,
    '' AS CLCLN_YN /* 정산여부 */,
    D1.MAX_SNO AS MAX_SNO /* 이력변경번호 */,
    D1.CLCLN_CHG_RSN_CN AS CLCLN_CHG_RSN_CN /* 정산변경사유내용 */,
    D3.REL_ADT_YR AS REL_ADT_YR /* 관계감사년도 */,
    D3.REL_ADT_NO AS REL_ADT_NO /* 관계감사번호 */,
    D3.ADT_STP_SQNO AS ADT_STP_SQNO /* 감사단계순번 */
FROM ( SELECT D2.*,
    MAX_SNO,
    CLCLN_CHG_RSN_CN /* 정산변경사유내용 */
FROM ( SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    MAX(BZTRP_CLCLN_SQNO) AS BZTRP_CLCLN_SQNO /* 출장정산순번 */,
    MAX(CLCLN_CHG_RSN_CN) AS CLCLN_CHG_RSN_CN /* 정산변경사유내용 */
FROM TBBADDED019H WHERE BZTRP_YR = #BZTRP_YR# AND BZTRP_SQNO = #BZTRP_SQNO# AND NVL(CLCLN_YN,'N') = 'N' GROUP BY BZTRP_YR , BZTRP_SQNO , BZTRVR_ENO ) D1 , VADED001 D2 WHERE 1=1 AND D1.BZTRP_YR = D2.BZTRP_YR AND D1.BZTRP_SQNO = D2.BZTRP_SQNO AND D1.BZTRVR_ENO = D2.BZTRVR_ENO AND D1.MAX_SNO = D2.BZTRP_CLCLN_SQNO AND D1.BZTRP_YR = #BZTRP_YR# AND D1.BZTRP_SQNO = #BZTRP_SQNO# ) D1 , ( SELECT D2.*
FROM ( SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    MAX(BZTRP_CLCLN_SQNO) AS BZTRP_CLCLN_SQNO /* 출장정산순번 */
FROM TBBADDED019H WHERE BZTRP_YR = #BZTRP_YR# AND BZTRP_SQNO = #BZTRP_SQNO# AND NVL(CLCLN_YN,'N') = 'Y' GROUP BY BZTRP_YR , BZTRP_SQNO , BZTRVR_ENO ) D1 , VADED001 D2 WHERE 1=1 AND D1.BZTRP_YR = D2.BZTRP_YR AND D1.BZTRP_SQNO = D2.BZTRP_SQNO AND D1.BZTRVR_ENO = D2.BZTRVR_ENO AND D1.MAX_SNO = D2.BZTRP_CLCLN_SQNO AND D1.BZTRP_YR = #BZTRP_YR# AND D1.BZTRP_SQNO = #BZTRP_SQNO# ) D2 , TBBADDED002M D3 WHERE 1=1 AND D1.BZTRP_YR = D2.BZTRP_YR(+) AND D1.BZTRP_SQNO = D2.BZTRP_SQNO(+) AND D1.BZTRVR_ENO = D2.BZTRVR_ENO(+) AND D1.BZTRP_YR = D3.BZTRP_YR AND D1.BZTRP_SQNO = D3.BZTRP_SQNO ) WHERE 1=1 AND BTEXP_CRTR_AMT <>0 OR LDG_CST<>0 OR BZTRP_TRVEXP_FDEXP<>0 OR SPM_CST<>0 OR BZTRP_DCN<>0 OR RL_FARE_AMT<>0 OR LEAD_CST<>0 OR ADT_ACTV_ACTC_AMT<>0 OR SUM_COST<>0 OR ALL_COST<>0 OR CPRG_FARE_CST <> 0 ORDER BY BZTRVR_ENO