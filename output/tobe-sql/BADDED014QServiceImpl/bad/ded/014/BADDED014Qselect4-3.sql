SELECT TER.BZTRP_YR /* 출장년도 */,
    TER.BZTRP_SQNO /* 출장순번 */,
    TER.BZTRVR_ENO /* 출장자직원전산번호 */,
    TER.BZTRVR_NM /* 출장자명 */,
    F_CODE_NM('1000173',TER.BZTRVR_JBGD_SECD) AS F_CODE_NM,
    TE.BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    TE.LDG_CST /* 숙박비용 */,
    TE.BTEXP_CRTR_AMT /* 출장비기준금액 */,
    NVL(TE.CPRG_FARE_CST,0) AS CPRG_FARE_CST /* 수도권운임비용 */,
    /*수도권운임비추가 - 2015.05.06 yyh*/ NVL(TFD.RL_FARE_AMT, 0) + NVL(TE.CPRG_FARE_CST,0) AS RL_FARE_AMT /* 철도운임금액 */,
    TE.BZTRP_TRVEXP_FDEXP + TE.LDG_CST + TE.BTEXP_CRTR_AMT + NVL(TE.CPRG_FARE_CST,0) + NVL(TFD.RL_FARE_AMT, 0) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    /*수도권운임비추가 - 2015.05.06 yyh*/ TE.LDG_DCN AS LDG_DCN /* 숙박일수 */,
    F_CODE_NM('1000001',TE.RGN_CD) || (SELECT '(' || SUBSTR(F_CODE_NM('1000727',CPRG_DSTNC_SECD),4) || ')' AS RGN_CD /* 지역코드 */
FROM TB_BADDED014B WHERE DPTRE_RGN_SECD = TER.DPTRE_RGN_SECD AND ARVL_RGN_KDCD = TE.RGN_CD AND CPRG_DSTNC_SECD != '90' AND ROWNUM = 1) AS LCL_NM, TE.BZTRP_DCN, TE.BZTRP_BGNG_YMD, TE.BZTRP_END_YMD, F_DPT_INFO(BL.OGDP_DEPT_CD,'4') CNSTN_MBCMT_DEPT_NM FROM TB_BADDED010L TER, TB_BADDED011L TE, (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    BTEXP_SQNO /* 출장비순번 */,
    SUM(RL_FARE_AMT) AS RL_FARE_AMT /* 철도운임금액 */
FROM TBBADDED017L WHERE BZTRP_YR = #BZTRP_YR# AND BZTRP_SQNO = #BZTRP_SQNO# AND CAL_YN= 'N' GROUP BY BZTRP_YR, BZTRP_SQNO, BZTRVR_ENO, BTEXP_SQNO ) TFD, (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    MAX(OGDP_DEPT_CD) AS OGDP_DEPT_CD /* 소속부서코드 */
FROM TBBADDED005L WHERE BZTRP_YR = #BZTRP_YR# AND BZTRP_SQNO = #BZTRP_SQNO# GROUP BY BZTRP_YR, BZTRP_SQNO, BZTRVR_ENO) DBO_BLL_BLNC WHERE TER.BZTRP_YR = #BZTRP_YR# AND TER.BZTRP_SQNO = #BZTRP_SQNO# AND BL.BZTRP_YR(+) = TER.BZTRP_YR AND BL.BZTRP_SQNO(+) = TER.BZTRP_SQNO AND BL.BZTRVR_ENO(+) = TER.BZTRVR_ENO AND TE.BZTRP_YR = TER.BZTRP_YR AND TE.BZTRP_SQNO = TER.BZTRP_SQNO AND TE.BZTRVR_ENO = TER.BZTRVR_ENO AND TE.CAL_YN = 'N' AND TFD.BZTRP_YR(+) = TE.BZTRP_YR AND TFD.BZTRP_SQNO(+) = TE.BZTRP_SQNO AND TFD.BZTRVR_ENO(+) = TE.BZTRVR_ENO AND TFD.BTEXP_SQNO(+) = TE.BTEXP_SQNO AND TER.BZTRVR_ENO = #BZTRVR_ENO# ORDER BY TE.BZTRP_BGNG_YMD DESC ,TE.BZTRP_END_YMD /* 정렬추가 - 2018.03.05 yyh */