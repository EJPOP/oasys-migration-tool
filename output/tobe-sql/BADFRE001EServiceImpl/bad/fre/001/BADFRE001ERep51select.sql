SELECT '처분요구' AS TITLE,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '1' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '2' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '310' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) <> 0 ) then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '320' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) = 0 ) then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '5' or MASTER.DSPS_RQT_KDCD = '630' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '611' then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 2) = '62' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '610' then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '7' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '8' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '1' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '2' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '310' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) <> 0 ) then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '320' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) = 0 ) then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '5' or MASTER.DSPS_RQT_KDCD = '630' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '611' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 2) = '62' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '610' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '7' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '8' then 1 else 0 end, 0)),0) AS SUBSTR
FROM TB_BADEAR001M master, TB_BADEAR002D detail WHERE 1=1 AND MASTER.ADT_YR = DETAIL.ADT_YR AND MASTER.ADT_NO = DETAIL.ADT_NO AND MASTER.DSPS_RQT_SQNO = DETAIL.DSPS_RQT_SQNO AND SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) NOT IN ('4','9') AND DETAIL.ADT_YR = #CVLCPT_ADT_YR# AND DETAIL.ADT_NO = #ADT_NO# AND DETAIL.IMPL_MNG_JRSD_DEPT_CD = #IMPL_MNG_JRSD_DEPT_CD# UNION ALL SELECT '금번이행' AS TITLE,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '1' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '2' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '310' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) <> 0 ) then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '320' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) = 0 ) then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '5' or MASTER.DSPS_RQT_KDCD = '630' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '611' then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 2) = '62' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '610' then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '7' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '8' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '1' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '2' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '310' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) <> 0 ) then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '320' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) = 0 ) then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '5' or MASTER.DSPS_RQT_KDCD = '630' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '611' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 2) = '62' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '610' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '7' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '8' then 1 else 0 end, 0)),0) AS SUBSTR
FROM TB_BADEAR001M master, TB_BADEAR002D detail WHERE 1=1 AND MASTER.ADT_YR = DETAIL.ADT_YR AND MASTER.ADT_NO = DETAIL.ADT_NO AND MASTER.DSPS_RQT_SQNO = DETAIL.DSPS_RQT_SQNO AND SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) NOT IN ('4','9') AND DETAIL.ADT_YR = #CVLCPT_ADT_YR# AND DETAIL.ADT_NO = #ADT_NO# AND DETAIL.IMPL_MNG_JRSD_DEPT_CD = #IMPL_MNG_JRSD_DEPT_CD# AND DETAIL.CFMTN_STTS_SECD = '1' AND DETAIL.CFMTN_YN = 'Y' AND NVL(DETAIL.DSPS_RQT_ATRZ_STTS_SECD,'1') IN ('','1','4','5') UNION ALL SELECT '전번까지 이행' AS TITLE,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '1' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '2' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '310' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) <> 0 ) then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '320' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) = 0 ) then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '5' or MASTER.DSPS_RQT_KDCD = '630' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '611' then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 2) = '62' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '610' then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '7' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '8' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '1' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '2' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '310' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) <> 0 ) then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '320' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) = 0 ) then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '5' or MASTER.DSPS_RQT_KDCD = '630' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '611' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 2) = '62' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '610' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '7' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '8' then 1 else 0 end, 0)),0) AS SUBSTR
FROM TB_BADEAR001M master, TB_BADEAR002D detail WHERE 1=1 AND MASTER.ADT_YR = DETAIL.ADT_YR AND MASTER.ADT_NO = DETAIL.ADT_NO AND MASTER.DSPS_RQT_SQNO = DETAIL.DSPS_RQT_SQNO AND SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) NOT IN ('4','9') AND DETAIL.ADT_YR = #CVLCPT_ADT_YR# AND DETAIL.ADT_NO = #ADT_NO# AND DETAIL.IMPL_MNG_JRSD_DEPT_CD = #IMPL_MNG_JRSD_DEPT_CD# AND NVL(DETAIL.CFMTN_STTS_SECD,'0') = '2' UNION ALL SELECT '이행 계' AS TITLE,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '1' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '2' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '310' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) <> 0 ) then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '320' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) = 0 ) then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '5' or MASTER.DSPS_RQT_KDCD = '630' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '611' then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 2) = '62' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '610' then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '7' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '8' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '1' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '2' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '310' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) <> 0 ) then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '320' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) = 0 ) then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '5' or MASTER.DSPS_RQT_KDCD = '630' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '611' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 2) = '62' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '610' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '7' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '8' then 1 else 0 end, 0)),0) AS SUBSTR
FROM TB_BADEAR001M master, TB_BADEAR002D detail WHERE 1=1 AND MASTER.ADT_YR = DETAIL.ADT_YR AND MASTER.ADT_NO = DETAIL.ADT_NO AND MASTER.DSPS_RQT_SQNO = DETAIL.DSPS_RQT_SQNO AND SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) NOT IN ('4','9') AND DETAIL.ADT_YR = #CVLCPT_ADT_YR# AND DETAIL.ADT_NO = #ADT_NO# AND DETAIL.IMPL_MNG_JRSD_DEPT_CD = #IMPL_MNG_JRSD_DEPT_CD# AND (( NVL(DETAIL.CFMTN_YN,'N') = 'Y' AND NVL(DETAIL.CFMTN_STTS_SECD,'0') = '1' AND NVL(DETAIL.DSPS_RQT_ATRZ_STTS_SECD,'1') IN ('','1','4','5') ) OR (NVL(DETAIL.CFMTN_STTS_SECD,'0') = '2') ) UNION ALL SELECT '미이행사항' AS TITLE,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '1' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '2' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '310' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) <> 0 ) then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '320' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) = 0 ) then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '5' or MASTER.DSPS_RQT_KDCD = '630' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '611' then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 2) = '62' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when MASTER.DSPS_RQT_KDCD = '610' then 1 else 0 end, 0)),0) AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '7' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '8' then 1 else 0 end, 0)),0) AS SUBSTR,
    NVL(sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '1' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '2' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '310' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) <> 0 ) then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '320' or (MASTER.DSPS_RQT_KDCD = '391' and NVL(DETAIL.PNRT_PRSRV_AMT, 0) = 0 ) then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '5' or MASTER.DSPS_RQT_KDCD = '630' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '611' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 2) = '62' then 1 else 0 end, 0)) + sum(NVL(case when MASTER.DSPS_RQT_KDCD = '610' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '7' then 1 else 0 end, 0)) + sum(NVL(case when SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) = '8' then 1 else 0 end, 0)),0) AS SUBSTR
FROM TB_BADEAR001M master, TB_BADEAR002D detail WHERE 1=1 AND MASTER.ADT_YR = DETAIL.ADT_YR AND MASTER.ADT_NO = DETAIL.ADT_NO AND MASTER.DSPS_RQT_SQNO = DETAIL.DSPS_RQT_SQNO AND SUBSTR(MASTER.DSPS_RQT_KDCD, 1, 1) NOT IN ('4','9') AND DETAIL.ADT_YR = #CVLCPT_ADT_YR# AND DETAIL.ADT_NO = #ADT_NO# AND DETAIL.IMPL_MNG_JRSD_DEPT_CD = #IMPL_MNG_JRSD_DEPT_CD# AND NVL(DETAIL.CFMTN_YN,'N') <> 'Y' AND NVL(DETAIL.DSPS_RQT_ATRZ_STTS_SECD,'1') IN ('','1','4','5')