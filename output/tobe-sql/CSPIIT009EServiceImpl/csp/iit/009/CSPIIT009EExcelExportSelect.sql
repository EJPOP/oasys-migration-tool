SELECT A.PC_MNG_CD,
    /*PC관리코드*/ F_CODE_NM('1000306',A.PC_SE_CAT_CD) AS F_CODE_NM,
    /*PC용도분류코드*/ F_CODE_NM('1000307',A.PSSN_DVSN_CD) AS F_CODE_NM,
    /*소유구분코드*/ F_CODE_NM('1000305',A.PC_USE_DVSN_CD) AS F_CODE_NM,
    /*PC사용구분코드*/ F_CODE_NM('1000144',A.SRECS_DEPT_CD) AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    F_USR_INFO(A.TRGT_NOP_ENO,'2') AS USER_NM /* 사용자명 */,
    /*전산번호*/ F_CODE_NM('1000173' , f_usr_info(A.TRGT_NOP_ENO,'3')) AS JBGD_NM /* 직급명 */,
    F_CODE_NM('1000170',A.PC_KND_CD) AS F_CODE_NM,
    /*PC종류코드*/ ( SELECT AS PC_EQP_NM
FROM TBCSPIIT011C Z WHERE A.PC_EQP_CD = Z.PC_EQP_CD) AS PC_EQP_CD, /*PC장비코드*/ A.PC_SRNO, /*시리얼번호*/ TO_CHAR(TO_DATE(A.ITDC_DT),'YYYY-MM-DD') AS ITDC_DT, /*도입일*/ TO_CHAR(TO_DATE(A.ISL_DT),'YYYY-MM-DD') AS ISL_DT, /*설치일*/ TO_CHAR(TO_DATE(A.STRG_DT),'YYYY-MM-DD') AS STRG_DT, /*보관일*/ TO_CHAR(TO_DATE(A.ABRG_DT),'YYYY-MM-DD') AS ABRG_DT, /*폐기일*/ A.PC_MNG_RMK, /*비고*/ F_CODE_NM('1000800',MNT_DVSN_CD) AS MNT_DVSN_NM,/*모니터1*/ F_CODE_NM('1000800',MNT_DVSN_CD2) AS MNT_DVSN_NM2, /*모니터2*/ (NVL2(A.IP_AD_1, A.IP_AD_1 || '.', '') || NVL2(A.IP_AD_2, A.IP_AD_2 || '.', '') || NVL2(A.IP_AD_3, A.IP_AD_3 || '.', '') || NVL2(A.IP_AD_4, A.IP_AD_4 , '') ) AS PC_IP, /*IP*/ A.TRGT_NOP_ENO, A.SRECS_DEPT_CD, CASE WHEN SUBSTR(A.SRECS_DEPT_CD,0,3)||'000' = A.SRECS_DEPT_CD THEN F_DPT_INFO(A.SRECS_DEPT_CD,'1') ELSE F_DPT_INFO(SUBSTR(A.SRECS_DEPT_CD,0,3)||'000','1') END AS H_DPT_NM, B.USR_DFN_TXT_3, A.ASST_NO, A.ETC_MTTR_CN FROM TBCSPIIT005M A /*PC장비관리테이블*/ ,TBDCMACM013C B WHERE 1=1 AND A.SRECS_DEPT_CD = B.CD(+) AND B.CMM_CD_DVSN_CD(+) = '1000144' AND A.PC_KND_CD = #strPC_KND_CD# AND A.PC_USE_DVSN_CD = #strPC_USE_DVSN_CD# AND A.PC_USE_DVSN_CD IN ('F','K','Y') AND A.SRECS_DEPT_CD = #SRECS_DEPT_CD# AND A.PC_EQP_CD = #strPC_EQP_CD# AND UPPER(A.PC_MNG_CD) LIKE '%'||UPPER(#strPC_MNG_CD#)||'%' AND A.IP_AD_1 = #strIP_AD_1# AND A.PC_SE_CAT_CD = #strPC_SE_CAT_CD# AND A.PSSN_DVSN_CD = #strPSSN_DVSN_CD# AND (F_USR_INFO(A.TRGT_NOP_ENO,'2') LIKE '%'||#strSEARCH_NM#||'%' OR A.TRGT_NOP_ENO LIKE '%'||#strSEARCH_NM#||'%' OR UPPER(A.PC_MNG_RMK) LIKE '%'||UPPER(#strSEARCH_NM#)||'%' OR UPPER(ETC_MTTR_CN) LIKE '%'||UPPER(#strSEARCH_NM#)||'%' OR UPPER(A.PC_MNG_CD) LIKE '%' ||UPPER(#strSEARCH_NM#)||'%' OR UPPER(A.ASST_NO) LIKE '%' ||UPPER(#strSEARCH_NM#)||'%' OR (NVL2(A.IP_AD_1, A.IP_AD_1 || '.', '') || NVL2(A.IP_AD_2, A.IP_AD_2 || '.', '') || NVL2(A.IP_AD_3, A.IP_AD_3 || '.', '') || NVL2(A.IP_AD_4, A.IP_AD_4 , '') ) LIKE '%'|| #strSEARCH_NM# ||'%') AND A.MNT_DVSN_CD = #strMNT_DVSN_CD# /*도입 시작일 20170707 EUNOK*/ AND TO_CHAR(TO_DATE(ITDC_DT),'YYYYMMDD') >= #strINS_DT# /*도입 종료일 20170707 EUNOK*/ AND TO_CHAR(TO_DATE(ITDC_DT),'YYYYMMDD') ORDER BY B.USR_DFN_TXT_3 ASC