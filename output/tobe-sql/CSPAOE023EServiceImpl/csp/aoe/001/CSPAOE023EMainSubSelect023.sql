SELECT D3.CVLCPT_ADT_YR /* 민원감사년도 */,
    D3.TSK_NO /* 업무번호 */,
    D3.TYPE1_DOC_TYP_CD /* 예비조사계획서 문서유형코드 */,
    CASE WHEN D3.TYPE1_DOC_TYP_CD = 'SP-OE-001' THEN (SELECT D1.CVLCPT_DOC_ID AS CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPAOE040M D1 WHERE D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-001' AND ROWNUM = 1) END AS TYPE1_DOC_ID /*예비조사계획서 문서ID*/, CASE WHEN D3.TYPE1_DOC_TYP_CD = 'SP-OE-001' THEN (SELECT D2.ENAIS_ATCH_FILE_NM /* ENAIS첨부파일명 */
FROM TBCSPAOE040M D1 , UBKERAPP.ECM_FILE_LIST_VIEW D2 WHERE D1.CVLCPT_DOC_ID = D2.CVLCPT_DOC_ID AND D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-001' AND ROWNUM = 1) END AS TYPE1_FILE_NM /*예비조사계획서 첨부파일명*/ , D3.TYPE2_DOC_TYP_CD /*실지감사계획서 문서유형코드*/, CASE WHEN D3.TYPE2_DOC_TYP_CD = 'SP-OE-002' THEN (SELECT D1.CVLCPT_DOC_ID AS CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPAOE040M D1 WHERE D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-002' AND ROWNUM = 1) END AS TYPE2_DOC_ID /*실지감사계획서 문서ID*/, CASE WHEN D3.TYPE2_DOC_TYP_CD = 'SP-OE-002' THEN (SELECT D2.ENAIS_ATCH_FILE_NM /* ENAIS첨부파일명 */
FROM (SELECT D1.CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPAOE040M D1 WHERE D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-002' ) D1, UBKERAPP.ECM_FILE_LIST_VIEW D2 WHERE D1.CVLCPT_DOC_ID = D2.CVLCPT_DOC_ID AND ROWNUM = 1) END AS TYPE2_FILE_NM /*실지감사계획서 첨부파일명*/, D3.TYPE3_DOC_TYP_CD /*귀청보고서 문서유형코드*/, CASE WHEN D3.TYPE3_DOC_TYP_CD = 'SP-OE-003' THEN (SELECT D1.CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPAOE040M D1 WHERE D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-003' AND ROWNUM = 1) END AS TYPE3_DOC_ID /*귀청보고서 문서ID*/, CASE WHEN D3.TYPE3_DOC_TYP_CD = 'SP-OE-003' THEN (SELECT D2.ENAIS_ATCH_FILE_NM /* ENAIS첨부파일명 */
FROM (SELECT D1.CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPAOE040M D1 WHERE D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-003' ) D1, UBKERAPP.ECM_FILE_LIST_VIEW D2 WHERE D1.CVLCPT_DOC_ID = D2.CVLCPT_DOC_ID AND ROWNUM = 1) END AS TYPE3_FILE_NM /*귀청보고서 첨부파일명*/, D3.TYPE4_DOC_TYP_CD /*기여율배분계획서 문서유형코드*/ , CASE WHEN D3.TYPE4_DOC_TYP_CD = 'SP-OE-004' THEN (SELECT D1.CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPAOE040M D1 WHERE D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-004' AND ROWNUM = 1) END AS TYPE4_DOC_ID /*기여율배분계획서 문서ID*/, CASE WHEN D3.TYPE4_DOC_TYP_CD = 'SP-OE-004' THEN (SELECT D2.ENAIS_ATCH_FILE_NM /* ENAIS첨부파일명 */
FROM TBCSPAOE040M D1 , UBKERAPP.ECM_FILE_LIST_VIEW D2 WHERE D1.CVLCPT_DOC_ID = D2.CVLCPT_DOC_ID AND D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-004' AND ROWNUM = 1) END AS TYPE4_FILE_NM /*기여율배분계획서 첨부파일명*/, D3.TYPE5_DOC_TYP_CD /*감사결과보고서 문서유형코드*/, CASE WHEN D3.TYPE5_DOC_TYP_CD = 'SP-OE-005' THEN (SELECT D1.CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPAOE040M D1 WHERE D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-005' AND ROWNUM = 1) END AS TYPE5_DOC_ID /*감사결과보고서 문서ID*/, CASE WHEN D3.TYPE5_DOC_TYP_CD = 'SP-OE-005' THEN (SELECT D2.ENAIS_ATCH_FILE_NM /* ENAIS첨부파일명 */
FROM (SELECT D1.CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPAOE040M D1 WHERE D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-005' ) D1, UBKERAPP.ECM_FILE_LIST_VIEW D2 WHERE D1.CVLCPT_DOC_ID = D2.CVLCPT_DOC_ID AND ROWNUM = 1) END AS TYPE5_FILE_NM /*감사결과보고서 첨부파일명*/, D3.TYPE6_DOC_TYP_CD /*변경사항대조표 문서유형코드*/ , CASE WHEN D3.TYPE6_DOC_TYP_CD = 'SP-OE-006' THEN (SELECT D1.CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPAOE040M D1 WHERE D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-006' AND ROWNUM = 1) END AS TYPE6_DOC_ID /*변경사항대조표 문서ID*/, CASE WHEN D3.TYPE6_DOC_TYP_CD = 'SP-OE-006' THEN (SELECT D2.ENAIS_ATCH_FILE_NM /* ENAIS첨부파일명 */
FROM TBCSPAOE040M D1 , UBKERAPP.ECM_FILE_LIST_VIEW D2 WHERE D1.CVLCPT_DOC_ID = D2.CVLCPT_DOC_ID AND D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-006' AND ROWNUM = 1) END AS TYPE6_FILE_NM /*변경사항대조표 첨부파일명*/, D3.TYPE7_DOC_TYP_CD /*변경의결사항대조표 문서유형코드*/, CASE WHEN D3.TYPE7_DOC_TYP_CD = 'SP-OE-007' THEN (SELECT D1.CVLCPT_DOC_ID /* 민원문서아이디 */
FROM TBCSPAOE040M D1 WHERE D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-007' AND ROWNUM = 1) END AS TYPE7_DOC_ID /*변경의결사항대조표 문서ID*/, CASE WHEN D3.TYPE7_DOC_TYP_CD = 'SP-OE-007' THEN (SELECT D2.ENAIS_ATCH_FILE_NM /* ENAIS첨부파일명 */
FROM TBCSPAOE040M D1 , UBKERAPP.ECM_FILE_LIST_VIEW D2 WHERE D1.CVLCPT_DOC_ID = D2.CVLCPT_DOC_ID AND D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# AND D1.ADT_PLAN_DOC_TPCD = 'SP-OE-007' AND ROWNUM = 1) END AS TYPE7_FILE_NM /*변경의결사항대조표 첨부파일명*/, '' AS ECM_FILE_INFO1 /*ECM 첨부파일정보(XML)*/, '' AS ECM_FILE_INFO2 /*ECM 첨부파일정보(XML)*/, '' AS ECM_FILE_INFO3 /*ECM 첨부파일정보(XML)*/, '' AS ECM_FILE_INFO4 /*ECM 첨부파일정보(XML)*/, '' AS ECM_FILE_INFO5 /*ECM 첨부파일정보(XML)*/, '' AS ECM_FILE_INFO6 /*ECM 첨부파일정보(XML)*/, '' AS ECM_FILE_INFO7 /*ECM 첨부파일정보(XML)*/ FROM (SELECT #CVLCPT_ADT_YR# AS CVLCPT_ADT_YR /* 민원감사년도 */,
    #strTskNo# AS #STRTSKNO#,
    'SP-OE-001' AS TYPE1_DOC_TYP_CD,
    'SP-OE-002' AS TYPE2_DOC_TYP_CD,
    'SP-OE-003' AS TYPE3_DOC_TYP_CD,
    'SP-OE-004' AS TYPE4_DOC_TYP_CD,
    'SP-OE-005' AS TYPE5_DOC_TYP_CD,
    'SP-OE-006' AS TYPE6_DOC_TYP_CD,
    'SP-OE-007' AS TYPE7_DOC_TYP_CD
FROM DUAL ) D3