SELECT D1.CVLCPT_ADT_YR /* 민원감사년도 */,
    D1.TSK_NO /* 감사번호 */,
    D1.ADT_STP_SECD /* 감사단계구분코드 */,
    NVL(D1.STAD_PRD_DCN, D3.STAD_PRD_DCN) AS STAD_PRD_DCN /* 기준기간수 */,
    D1.LUNH_DT /* 착수일 */,
    D1.CMPTN_YMD /* 완료일자 */,
    CASE WHEN D1.ADT_STP_SECD = '10000' THEN '첨부 요망' WHEN D1.ADT_STP_SECD = '10001' THEN '첨부 요망' WHEN D1.ADT_STP_SECD = '10004' THEN '첨부 요망' WHEN D1.ADT_STP_SECD = '10010' THEN '첨부 요망' ELSE '' END AS ADT_STP_SECD /* 감사단계구분코드 */,
    D1.DLAY_DT_NM /* 지연일명 */,
    NVL(D1.DLAY_ADD_DCN,0) AS DLAY_ADD_DCN /* 지연가산일수 */,
    NVL(D1.EXET_DCN,0) AS EXET_DCN /* 면책일 */,
    (SELECT TO_CHAR(MAX(TO_NUMBER(EVL_STR_DT)))
FROM TBCSPAOE001M WHERE SYSDATE BETWEEN EVL_STR_DT AND EVL_END_DT) AS EVL_STR_DT , (SELECT TO_CHAR(MAX(TO_NUMBER(EVL_END_DT)))
FROM TBCSPAOE001M WHERE SYSDATE BETWEEN EVL_STR_DT AND EVL_END_DT) AS EVL_END_DT FROM TBCSPAOE022M D1 , TBCSPAOE021M D2 , (SELECT ADT_KDCD /* 감사종류코드 */,
    ADT_STP_SECD /* 감사단계구분코드 */,
    STAD_PRD_DCN
FROM TBCSPAOE008D A WHERE 1 = 1 AND A.EVL_YR = (SELECT MAX(EVL_YR)
FROM TBCSPAOE001M) AND A.HLYR_DVSN_CD = (SELECT MAX(HLYR_DVSN_CD)
FROM TBCSPAOE001M WHERE EVL_YR = (SELECT MAX(EVL_YR)
FROM TBCSPAOE001M))) D3 WHERE 1=1 AND D1.CVLCPT_ADT_YR = D2.CVLCPT_ADT_YR AND D1.TSK_NO = D2.TSK_NO AND D2.ADT_KDCD = D3.ADT_KDCD AND D1.ADT_STP_SECD = D3.ADT_STP_SECD AND D1.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D1.TSK_NO = #strTskNo# /* AND (D1.AUD_STEP_CD NOT IN ('10007') OR D1.AUD_STEP_CD IS NULL ) 신규 추가 2016-05-20 삭제 2019.05.10 */ D2.ADT_MTTR_NM = #ADT_MTTR_NM# ORDER BY D1.CVLCPT_ADT_YR, D1.TSK_NO, D1.ADT_STP_SECD ASC