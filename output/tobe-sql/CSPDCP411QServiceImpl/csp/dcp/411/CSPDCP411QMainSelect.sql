SELECT A.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    A.TPOF_RCPT_YR /* 제보접수년도 */,
    A.TPOF_RCPT_NO /* 제보접수번호 */,
    A.TPOF_ACTL_RCPT_NO /* 제보실제접수번호 */,
    A.TPOF_RCPT_YR||'-민원-'||A.TPOF_ACTL_RCPT_NO AS NTFCTN_RCPT_SQNO /* 통보접수순번 */,
    A.TPOF_KDCD /* 제보종류코드 */,
    CASE WHEN ( SELECT COUNT(*)
FROM TB_CSPDCP105L S1 WHERE S1.CLM_SECD = A.CLM_SECD AND S1.CVLCPT_RCPT_YR = A.CVLCPT_RCPT_YR AND S1.CVLCPT_RCPT_RCPT = A.CVLCPT_RCPT_RCPT ) > 0 THEN A.RSCH_ASMT_TTL||'(합건 : '||A.TPOF_ACTL_RCPT_NO||', '||( SELECT AGGR_CONCAT( S3.TPOF_ACTL_RCPT_NO, ', ')||' )' AS TPOF_ACTL_RCPT_NO /* 제보실제접수번호 */
FROM TB_CSPDCP105L S2, TB_CSPDCP101M S3 WHERE A.CLM_SECD = S2.CVLCPT_CLM_SECD AND A.CVLCPT_RCPT_YR = S2.TPOF_RCPT_YR AND A.CVLCPT_RCPT_RCPT = S2.TPOF_RCPT_NO AND S2.TPOF_MCA_CLM_SECD = S3.CVLCPT_CLM_SECD AND S2.TPOF_MCA_RCPT_YR = S3.TPOF_RCPT_YR AND S2.TPOF_MCA_CVLCPT_RCPT_NO = S3.TPOF_RCPT_NO) ELSE A.RSCH_ASMT_TTL END AS RSCH_ASMT_TTL ,A.SLCT_CLMT_KDCD ,A.CRU_RCPT_PATH_SECD ,DECODE(A.SLCT_CLMT_KDCD,'1',A.TPOF_CVLPR_NM,'2',A.SLCT_CVLPR_RPRSV_NM,'3',A.SLCT_CVLPR_RPRSV_NM,'4',A.TPOF_CVLPR_NM) AS TPOF_CVLPR_NM ,TO_CHAR(A.CRU_RCPT_DT,'YYYY-MM-DD HH24:MI') AS CRU_RCPT_DT ,A.CRU_PRCS_PRCS_STTS ,A.CRU_RCPT_DT ,TO_CHAR(C.TPOF_LAST_PRCS_DT,'YYYY-MM-DD HH24:MI') AS TPOF_LAST_PRCS_DT ,( SELECT TO_CHAR(TO_DATE(TO_CHAR(D.ONR_ATRZ_CMPTN_DT, 'YYYYMMDD'), 'YYYYMMDD') + NVL( S1.USR_DFN_TXT_2, 30), 'YYYY-MM-DD') AS ONR_ATRZ_CMPTN_DT /* 온나라결재완료일시 */
FROM TBDCMACM013C S1, TB_CSPDCP205L D3 WHERE S1.CMM_CD_DVSN_CD = '1000754' AND S1.CD != '000000000' AND S1.CD = D3.TPOF_PRCS_SECD AND A.CLM_SECD = D3.CVLCPT_CLM_SECD AND A.CVLCPT_RCPT_YR = D3.TPOF_RCPT_YR AND A.CVLCPT_RCPT_RCPT = D3.TPOF_RCPT_NO AND (D3.CVLCPT_CLM_SECD, D3.TPOF_RCPT_NO, D3.TPOF_RCPT_YR, D3.TPOF_SQNO ) IN ( SELECT Z.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    Z.TPOF_RCPT_NO /* 제보접수번호 */,
    Z.TPOF_RCPT_YR /* 제보접수년도 */,
    MIN(Z.TPOF_SQNO) AS TPOF_SQNO /* 제보순번 */
FROM TB_CSPDCP205L Z WHERE A.CLM_SECD = Z.CLM_SECD AND A.CVLCPT_RCPT_RCPT = Z.CVLCPT_RCPT_RCPT AND A.CVLCPT_RCPT_YR = Z.CVLCPT_RCPT_YR GROUP BY Z.CLM_SECD, Z.CVLCPT_RCPT_RCPT, Z.CVLCPT_RCPT_YR )) AS HNDL_LIMIT__DT ,F_DPT_INFO(A.CRU_RCPT_DEPT_CD,'1') AS ACP_DPT_NM ,F_CODE_NM('1000056',A.CRU_RCPT_PATH_SECD) AS ACP_RUT_NM ,TO_CHAR(A.TPOF_DISCON_DT,'YYYY-MM-DD HH24:MI') AS TPOF_DISCON_DT ,A.SLCT_DISCON_DMND_YN FROM TB_CSPDCP101M A ,TB_CSPDCP102M B ,TB_CSPDCP201M C ,TB_CSPDCP301M D WHERE 1=1 AND A.CLM_SECD = '1' AND A.CLM_SECD = B.CVLCPT_CLM_SECD AND A.CVLCPT_RCPT_YR = B.TPOF_RCPT_YR AND A.CVLCPT_RCPT_RCPT = B.TPOF_RCPT_NO AND A.CLM_SECD = C.CLM_SECD AND A.CVLCPT_RCPT_YR = C.CVLCPT_RCPT_YR AND A.CVLCPT_RCPT_RCPT = C.CVLCPT_RCPT_RCPT AND A.CLM_SECD = D.CVLCPT_CLM_SECD(+) AND A.CVLCPT_RCPT_YR = D.TPOF_RCPT_YR(+) AND A.CVLCPT_RCPT_RCPT = D.TPOF_RCPT_NO(+) AND D.TPOF_AVTSMT_SECD(+) = 'C' AND D.TPOF_OPM_ATRZ_STTS_SECD(+) = '30' AND (A.CLM_SECD, A.CVLCPT_RCPT_YR, A.CVLCPT_RCPT_RCPT) NOT IN ( SELECT CVLCPT_MCA_CLM_SECD /* 민원합건청구구분코드 */,
    TPOF_MCA_RCPT_YR /* 제보합건접수년도 */,
    CVLCPT_MCA_CVLCPT_RCPT_NO /* 민원합건민원접수번호 */
FROM TB_CSPDCP105L ) AND C.ETC_LBSVC_MNG_DEPT_CD = #ETC_LBSVC_MNG_DEPT_CD# AND C.PRCS_PIC_ID = #PRCS_PIC_ID# AND TO_CHAR(A.CRU_RCPT_DT,'YYYYMMDD') &gt;= #strACP_DHS# AND TO_CHAR(A.CRU_RCPT_DT,'YYYYMMDD') &lt;= #strACP_DHE# AND A.CRU_PRCS_PRCS_STTS = #CRU_PRCS_PRCS_STTS# AND A.RSCH_ASMT_TTL LIKE '%'||#strTIT_NM#||'%' AND B.TPOF_CN LIKE '%'||#strTIT_NM#||'%' AND A.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND A.TPOF_ACTL_RCPT_NO = #TPOF_ACTL_RCPT_NO# AND A.CRU_SMG_CVLCPT_APLY_NO = #CRU_SMG_CVLCPT_APLY_NO# AND (A.TPOF_CVLPR_NM LIKE '%'||#strCVPTR_NM#||'%' OR A.SLCT_CVLPR_RPRSV_NM LIKE '%'||#strCVPTR_NM#||'%') AND A.SLCT_CLMT_KDCD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strREQR_KND_CD# ||',' AS #STRREQR_KND_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND A.CRU_KDCD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strCVPT_KND_CD# ||',' AS #STRCVPT_KND_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND A.CRU_RCPT_PATH_SECD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strACP_RUT_CD# ||',' AS #STRACP_RUT_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND A.CRU_MNG_TPCD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strMNG_TYP_CD# ||',' AS #STRMNG_TYP_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND C.SLCT_PASV_PBADMS_YN = 'Y' AND ( C.SLCT_PASV_PBADMS_YN = 'N' OR C.SLCT_PASV_PBADMS_YN IS NULL ) AND C.SLCT_RFRNC_YN = 'Y' AND ( C.SLCT_RFRNC_YN = 'N' OR C.SLCT_RFRNC_YN IS NULL ) AND A.CRU_PRCS_PRCS_STTS IN ('50','60','70','80') AND A.CRU_PRCS_PRCS_STTS NOT IN ('50','60','70','80') ORDER BY A.CVLCPT_RCPT_YR DESC, A.TPOF_ACTL_RCPT_NO DESC