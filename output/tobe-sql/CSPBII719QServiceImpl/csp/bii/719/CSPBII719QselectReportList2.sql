SELECT to_char(add_months(to_date(#strStrDt#),-12),'yyyy-mm-dd')||'~'||to_char(add_months(to_date(#strEndDt#),-12),'yyyy-mm-dd') AS INFO_YR /* 정보년도 */,
    SUM(CASE WHEN ADT_INFO_PRGRS_STTS_SECD >= '10' THEN 1 ELSE 0 END ) AS ADT_INFO_PRGRS_STTS_SECD /* 감사정보진행상태구분코드 */,
    SUM( CASE WHEN ADT_INFO_PRGRS_STTS_SECD >= '10' AND INFO_SECD = '1' AND PRCS_DRCTN_SECD = '6' THEN 1 ELSE 0 END) AS ADT_INFO_PRGRS_STTS_SECD /* 감사정보진행상태구분코드 */,
    SUM( CASE WHEN ADT_INFO_PRGRS_STTS_SECD >= '10' AND INFO_SECD = '1' AND PRCS_DRCTN_SECD = '3' THEN 1 ELSE 0 END) AS ADT_INFO_PRGRS_STTS_SECD /* 감사정보진행상태구분코드 */,
    SUM( CASE WHEN ADT_INFO_PRGRS_STTS_SECD >= '10' AND INFO_SECD = '1' AND PRCS_DRCTN_SECD = '4' THEN 1 ELSE 0 END) AS ADT_INFO_PRGRS_STTS_SECD /* 감사정보진행상태구분코드 */,
    SUM( CASE WHEN ADT_INFO_PRGRS_STTS_SECD >= '10' AND INFO_SECD = '4' AND PRCS_DRCTN_SECD = '6' THEN 1 ELSE 0 END) AS ADT_INFO_PRGRS_STTS_SECD /* 감사정보진행상태구분코드 */,
    SUM( CASE WHEN ADT_INFO_PRGRS_STTS_SECD >= '10' AND INFO_SECD = '4' AND PRCS_DRCTN_SECD = '3' THEN 1 ELSE 0 END) AS ADT_INFO_PRGRS_STTS_SECD /* 감사정보진행상태구분코드 */,
    SUM( CASE WHEN ADT_INFO_PRGRS_STTS_SECD >= '10' AND INFO_SECD = '4' AND PRCS_DRCTN_SECD = '5' THEN 1 ELSE 0 END) AS ADT_INFO_PRGRS_STTS_SECD /* 감사정보진행상태구분코드 */,
    SUM( CASE WHEN ADT_INFO_PRGRS_STTS_SECD >= '10' AND INFO_SECD = '2' AND PRCS_DRCTN_SECD = '5' THEN 1 ELSE 0 END) AS ADT_INFO_PRGRS_STTS_SECD /* 감사정보진행상태구분코드 */,
    SUM( CASE WHEN ADT_INFO_PRGRS_STTS_SECD >= '10' AND INFO_SECD = '3' AND PRCS_DRCTN_SECD = '5' THEN 1 ELSE 0 END) AS ADT_INFO_PRGRS_STTS_SECD /* 감사정보진행상태구분코드 */,
    SUM( CASE WHEN ADT_INFO_PRGRS_STTS_SECD >= '10' AND PRCS_DRCTN_SECD = '7' THEN 1 ELSE 0 END) AS ADT_INFO_PRGRS_STTS_SECD /* 감사정보진행상태구분코드 */,
    SUM( CASE WHEN ADT_INFO_PRGRS_STTS_SECD >= '10' AND ((PRCS_DRCTN_SECD NOT IN ('3','4','6','7') AND INFO_SECD = '1') OR (PRCS_DRCTN_SECD NOT IN ('3','5','6','7') AND INFO_SECD = '4') OR (PRCS_DRCTN_SECD NOT IN ('5','7') AND INFO_SECD = '2') OR (PRCS_DRCTN_SECD NOT IN ('5','7') AND INFO_SECD = '3') OR (INFO_SECD NOT IN ('1','2','3','4') AND PRCS_DRCTN_SECD IS NOT NULL)) THEN 1 ELSE 0 END) AS ADT_INFO_PRGRS_STTS_SECD /* 감사정보진행상태구분코드 */,
    SUM( CASE WHEN ADT_INFO_PRGRS_STTS_SECD >= '10' AND PRCS_DRCTN_SECD IS NULL THEN 1 ELSE 0 END) AS ADT_INFO_PRGRS_STTS_SECD /* 감사정보진행상태구분코드 */
FROM TB_CSPBII170M WHERE SBMSN_YMD BETWEEN to_char(add_months(to_date(#strStrDt#),-12),'yyyymmdd') AND to_char(add_months(to_date(#strEndDt#),-12) ,'yyyymmdd')