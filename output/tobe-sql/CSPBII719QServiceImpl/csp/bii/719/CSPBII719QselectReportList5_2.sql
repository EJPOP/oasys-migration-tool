SELECT *
FROM ( SELECT NVL2(CD,CD,'총계') AS NVL2,
    NVL2(SRECS_DEPT_CD,MAX(CNSTN_MBCMT_DEPT_NM),NVL2(CD,'국별소계','총계')) AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    SUM(CNT) AS CNT,
    SUM(C0) AS C0,
    SUM(P0) AS P0,
    SUM(A0) AS A0,
    SUM(C1) AS C1,
    SUM(P1) AS P1,
    SUM(A1) AS A1,
    SUM(C2) AS C2,
    SUM(P2) AS P2,
    SUM(C3) AS C3,
    SUM(P3) AS P3,
    SUM(A3) AS A3,
    SUM(C4) AS C4,
    SUM(P4) AS P4,
    SUM(C5) AS C5,
    SUM(P5) AS P5,
    SUM(C6) AS C6,
    SUM(P6) AS P6,
    SUM(A6) AS A6,
    SUM(C7) AS C7,
    SUM(P7) AS P7,
    SUM(C8) AS C8
FROM ( SELECT SUBSTR(D.SRECS_DEPT_CD, 0, 3) AS SUBSTR,
    D.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    D.ABR_DPT_NM_1 AS CNSTN_MBCMT_DEPT_NM,
    NVL(A.CNT, 0) AS CNT,
    NVL((B.C1 + B.C2 + B.C3 + B.C4 + B.C5 + B.C6 + B.C7), 0) AS C1,
    NVL((B.P1 + B.P2 + B.P3 + B.P4 + B.P5 + B.P6 + B.P7), 0) AS P1,
    NVL((B.A1 + B.A3 + B.A6), 0) AS A1,
    NVL(B.C1, 0) AS C1,
    NVL(B.A1, 0) AS A1,
    NVL(B.P1, 0) AS P1,
    NVL(B.C2, 0) AS C2,
    NVL(B.P2, 0) AS P2,
    NVL(B.C3, 0) AS C3,
    NVL(B.A3, 0) AS A3,
    NVL(B.P3, 0) AS P3,
    NVL(B.C4, 0) AS C4,
    NVL(B.P4, 0) AS P4,
    NVL(B.C5, 0) AS C5,
    NVL(B.P5, 0) AS P5,
    NVL(B.C6, 0) AS C6,
    NVL(B.A6, 0) AS A6,
    NVL(B.P6, 0) AS P6,
    NVL(B.C7, 0) AS C7,
    NVL(B.P7, 0) AS P7,
    NVL(C.C8, 0) AS C8
FROM ( SELECT A.ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    COUNT(*) AS CNT
FROM ( SELECT A.INFO_YR /* 정보년도 */,
    A.INFO_SQNO /* 정보순번 */,
    A.PRCS_DEPT_CD /* 처리부서코드 */
FROM TBCSPBII170M A WHERE PRCS_RSLT_SECD = '31' AND A.CMPTN_YMD BETWEEN #strStrDt# AND #strEndDt# ) A WHERE 1=1 GROUP BY ETC_LBSVC_MNG_DEPT_CD ) A, ( SELECT A.ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    SUM(A.C1) AS C1,
    SUM(A.A1) AS A1,
    SUM(A.P1) AS P1,
    SUM(A.C2) AS C2,
    SUM(A.P2) AS P2,
    SUM(A.C3) AS C3,
    SUM(A.A3) AS A3,
    SUM(A.P3) AS P3,
    SUM(A.C4) AS C4,
    SUM(A.P4) AS P4,
    SUM(A.C5) AS C5,
    SUM(A.P5) AS P5,
    SUM(A.C6) AS C6,
    SUM(A.A6) AS A6,
    SUM(A.P6) AS P6,
    SUM(A.C7) AS C7,
    SUM(A.P7) AS P7
FROM ( SELECT A.INFO_YR /* 정보년도 */,
    A.INFO_SQNO /* 정보순번 */,
    A.PRCS_DEPT_CD /* 처리부서코드 */,
    B.ADT_YR /* 감사년도 */,
    B.ADT_NO /* 감사번호 */,
    B.DSPS_RQT_SQNO /* 처분요구순번 */,
    C.DSPS_RQT_KDCD /* 처분요구종류코드 */,
    CASE WHEN SUBSTR(C.DSPS_RQT_KDCD,0,1) = '1' THEN 1 ELSE 0 END AS SUBSTR,
    CASE WHEN SUBSTR(C.DSPS_RQT_KDCD,0,1) = '2' THEN 1 ELSE 0 END AS SUBSTR,
    CASE WHEN C.DSPS_RQT_KDCD IN ('310','320') THEN 1 ELSE 0 END AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    CASE WHEN C.DSPS_RQT_KDCD = '410' THEN 1 ELSE 0 END AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    CASE WHEN SUBSTR(C.DSPS_RQT_KDCD,0,1) IN ( '5','6','8') THEN 1 ELSE 0 END AS SUBSTR,
    CASE WHEN C.DSPS_RQT_KDCD IN ('390','391','395','396','490','495') THEN 1 ELSE 0 END AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    CASE WHEN SUBSTR(C.DSPS_RQT_KDCD,0,1) = '7' THEN 1 ELSE 0 END AS SUBSTR,
    CASE WHEN SUBSTR(C.DSPS_RQT_KDCD ,0,1) = '1' THEN NVL(D.PNRT_PRSRV_AMT,0) + NVL(D.RMBR_AMT,0) + NVL(D.SPLP_AMT,0) + NVL(D.BGT_RTRC_AMT,0) + NVL(D.INCM_INCRS_AMT,0) + NVL(D.PPL_BRDN_RDT_AMT,0) + NVL(D.IJS_AMT,0) + NVL(D.SELF_PRCS_RQT_AMT,0) ELSE 0 END AS SUBSTR,
    CASE WHEN C.DSPS_RQT_KDCD IN ('310','320') THEN NVL(D.PNRT_PRSRV_AMT,0) + NVL(D.RMBR_AMT,0) + NVL(D.SPLP_AMT,0) + NVL(D.BGT_RTRC_AMT,0) + NVL(D.INCM_INCRS_AMT,0) + NVL(D.PPL_BRDN_RDT_AMT,0) + NVL(D.IJS_AMT,0) + NVL(D.SELF_PRCS_RQT_AMT,0) ELSE 0 END AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    CASE WHEN C.DSPS_RQT_KDCD IN ('390','391','395','396','490','495') THEN NVL(D.PNRT_PRSRV_AMT,0) + NVL(D.RMBR_AMT,0) + NVL(D.SPLP_AMT,0) + NVL(D.BGT_RTRC_AMT,0) + NVL(D.INCM_INCRS_AMT,0) + NVL(D.PPL_BRDN_RDT_AMT,0) + NVL(D.IJS_AMT,0) + NVL(D.SELF_PRCS_RQT_AMT,0) ELSE 0 END AS DSPS_RQT_KDCD /* 처분요구종류코드 */,
    CASE WHEN SUBSTR(C.DSPS_RQT_KDCD,0,1) = '1' THEN NVL((SELECT COUNT(*) AS DSPS_RQT_KDCD /* 처분요구종류코드 */
FROM TBBADEAR007M E WHERE B.CVLCPT_ADT_YR = E.CVLCPT_ADT_YR AND B.ADT_NO = E.ADT_NO AND B.DSPS_RQT_SQNO = E.DSPS_RQT_SQNO),0) ELSE 0 END AS P1 ,CASE WHEN SUBSTR(C.DSPS_RQT_KDCD,0,1) = '2' THEN NVL((SELECT COUNT(*)
FROM TBBADEAR007M E WHERE B.CVLCPT_ADT_YR = E.CVLCPT_ADT_YR AND B.ADT_NO = E.ADT_NO AND B.DSPS_RQT_SQNO = E.DSPS_RQT_SQNO),0) ELSE 0 END AS P2 ,CASE WHEN C.DSPS_RQT_KDCD IN ('310','320') THEN NVL((SELECT COUNT(*)
FROM TBBADEAR007M E WHERE B.CVLCPT_ADT_YR = E.CVLCPT_ADT_YR AND B.ADT_NO = E.ADT_NO AND B.DSPS_RQT_SQNO = E.DSPS_RQT_SQNO),0) ELSE 0 END AS P3 ,CASE WHEN C.DSPS_RQT_KDCD = '410' THEN NVL((SELECT COUNT(*)
FROM TBBADEAR007M E WHERE B.CVLCPT_ADT_YR = E.CVLCPT_ADT_YR AND B.ADT_NO = E.ADT_NO AND B.DSPS_RQT_SQNO = E.DSPS_RQT_SQNO),0) ELSE 0 END AS P4 ,CASE WHEN SUBSTR(C.DSPS_RQT_KDCD,0,1) IN('5','6','8') THEN NVL((SELECT COUNT(*)
FROM TBBADEAR007M E WHERE B.CVLCPT_ADT_YR = E.CVLCPT_ADT_YR AND B.ADT_NO = E.ADT_NO AND B.DSPS_RQT_SQNO = E.DSPS_RQT_SQNO),0) ELSE 0 END AS P5 ,CASE WHEN C.DSPS_RQT_KDCD IN ('390','391','395','396','490','495') THEN NVL((SELECT COUNT(*)
FROM TBBADEAR007M E WHERE B.CVLCPT_ADT_YR = E.CVLCPT_ADT_YR AND B.ADT_NO = E.ADT_NO AND B.DSPS_RQT_SQNO = E.DSPS_RQT_SQNO),0) ELSE 0 END AS P6 ,CASE WHEN SUBSTR(C.DSPS_RQT_KDCD,0,1) = '7' THEN NVL((SELECT COUNT(*)
FROM TBBADEAR007M E WHERE B.CVLCPT_ADT_YR = E.CVLCPT_ADT_YR AND B.ADT_NO = E.ADT_NO AND B.DSPS_RQT_SQNO = E.DSPS_RQT_SQNO),0) ELSE 0 END AS P7 FROM TBCSPBII170M A, TBCSPBII174L B, TBBADEAR001M C, TBBADEAR002D D WHERE 1=1 AND A.CMPTN_YMD BETWEEN #strStrDt# AND #strEndDt# AND A.INFO_YR = B.INFO_YR AND A.FRS_MDM_SQNO = B.FRS_MDM_SQNO AND B.CVLCPT_ADT_YR = C.CVLCPT_ADT_YR AND B.ADT_NO = C.ADT_NO AND B.DSPS_RQT_SQNO = C.DSPS_RQT_SQNO AND B.CVLCPT_ADT_YR = D.CVLCPT_ADT_YR AND B.ADT_NO = D.ADT_NO AND B.DSPS_RQT_SQNO = D.DSPS_RQT_SQNO AND A.PRCS_RSLT_SECD IN ('31','32') ) A WHERE 1=1 GROUP BY ETC_LBSVC_MNG_DEPT_CD ) B , ( SELECT A.ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    COUNT(*) AS C8
FROM ( SELECT A.INFO_YR /* 정보년도 */,
    A.INFO_SQNO /* 정보순번 */,
    A.PRCS_DEPT_CD /* 처리부서코드 */
FROM TBCSPBII170M A WHERE PRCS_RSLT_SECD = '34' AND A.CMPTN_YMD BETWEEN #strStrDt# AND #strEndDt# ) A WHERE 1=1 GROUP BY ETC_LBSVC_MNG_DEPT_CD ) C , TBDCMACM002M D WHERE 1=1 AND D.SRECS_DEPT_CD = A.ETC_LBSVC_MNG_DEPT_CD(+) AND D.SRECS_DEPT_CD = B.ETC_LBSVC_MNG_DEPT_CD(+) AND D.SRECS_DEPT_CD = C.ETC_LBSVC_MNG_DEPT_CD(+) /*AND SUBSTR(D.DPT_CD, 4, 6) != '000' */ ORDER BY CD, SRECS_DEPT_CD ASC ) GROUP BY ROLLUP( CD, SRECS_DEPT_CD) ORDER BY DECODE(CD,'총계','000',CD), DECODE(CNSTN_MBCMT_DEPT_NM,'국별소계','000',SRECS_DEPT_CD) ASC ) WHERE CNT <> 0 OR C0 <> 0 OR P0 <> 0 OR A0 <> 0 OR C8 <> 0