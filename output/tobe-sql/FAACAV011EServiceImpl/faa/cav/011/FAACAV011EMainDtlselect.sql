/* faa/cav/011/FAACAV011EMainDtlselect */ WITH DATA AS ( SELECT MNSUM_YM /* 월계연월 */,
    #N/A /* 대사금액1 */,
    #N/A /* 대사금액2 */,
    #N/A /* 대사금액3 */,
    #N/A /* 대사금액4 */,
    #N/A /* 대사금액5 */,
    #N/A /* 대사금액6 */,
    #N/A /* 대사금액7 */,
    #N/A /* 대사금액8 */
FROM TWFAACAV010L WHERE MNSUM_YM BETWEEN #strYr#||'01' AND #strYr#||'13' AND MNSUM_SECD = #MNSUM_SECD# AND ACTNO_SCRTY = #ACTNO_SCRTY# AND ACNT_SBJCT_SECD = #ACNT_SBJCT_SECD# ) SELECT MNSUM_YM AS MNSUM_YM /* 월계연월 */,
    #N/A /* 대사금액1 */,
    #N/A /* 대사금액2 */,
    #N/A /* 대사금액3 */,
    #N/A /* 대사금액4 */,
    #N/A /* 대사금액5 */,
    #N/A /* 대사금액6 */,
    #N/A /* 대사금액7 */,
    #N/A /* 대사금액8 */,
    ( CASE WHEN SUBSTR(MNSUM_YM, 5, 2) BETWEEN '01' AND '03' THEN 1 WHEN SUBSTR(MNSUM_YM, 5, 2) BETWEEN '04' AND '06' THEN 21 WHEN SUBSTR(MNSUM_YM, 5, 2) BETWEEN '07' AND '09' THEN 31 WHEN SUBSTR(MNSUM_YM, 5, 2) BETWEEN '10' AND '13' THEN 41 ELSE 0 END ) AS SUBSTR
FROM DATA UNION ALL SELECT '1 분기계' AS MNSUM_YM /* 월계연월 */,
    MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'01' AND #strYr#||'03'), #N/A, 0)) AS CMP_AMT1 ,MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'01' AND #strYr#||'03'), #N/A, 0)) AS CMP_AMT2 ,MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'01' AND #strYr#||'03'), #N/A, 0)) AS CMP_AMT3 ,SUM(#N/A) AS CMP_AMT4 ,SUM(#N/A) AS CMP_AMT5 ,SUM(#N/A) AS CMP_AMT6 ,SUM(#N/A) AS CMP_AMT7 ,SUM(#N/A) AS CMP_AMT8 ,11 AS SORT FROM DATA WHERE MNSUM_YM BETWEEN #strYr# ||'01' AND #strYr#||'03' UNION ALL SELECT '2 분기계' AS MNSUM_YM /* 월계연월 */,
    MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'04' AND #strYr#||'06'), #N/A, 0)) AS CMP_AMT1 ,MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'04' AND #strYr#||'06'), #N/A, 0)) AS CMP_AMT2 ,MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'04' AND #strYr#||'06'), #N/A, 0)) AS CMP_AMT3 ,SUM(#N/A) AS CMP_AMT4 ,SUM(#N/A) AS CMP_AMT5 ,SUM(#N/A) AS CMP_AMT6 ,SUM(#N/A) AS CMP_AMT7 ,SUM(#N/A) AS CMP_AMT8 ,22 AS SORT FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'04' AND #strYr#||'06' UNION ALL SELECT '3 분기계' AS MNSUM_YM /* 월계연월 */,
    MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'07' AND #strYr#||'09'), #N/A, 0)) AS CMP_AMT1 ,MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'07' AND #strYr#||'09'), #N/A, 0)) AS CMP_AMT2 ,MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'07' AND #strYr#||'09'), #N/A, 0)) AS CMP_AMT3 ,SUM(#N/A) AS CMP_AMT4 ,SUM(#N/A) AS CMP_AMT5 ,SUM(#N/A) AS CMP_AMT6 ,SUM(#N/A) AS CMP_AMT7 ,SUM(#N/A) AS CMP_AMT8 ,33 AS SORT FROM DATA WHERE MNSUM_YM BETWEEN #strYr# ||'07' AND #strYr# ||'09' UNION ALL SELECT '4 분기계' AS MNSUM_YM /* 월계연월 */,
    MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'10' AND #strYr#||'13'), #N/A, 0)) AS CMP_AMT1 ,MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'10' AND #strYr#||'13'), #N/A, 0)) AS CMP_AMT2 ,MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'10' AND #strYr#||'13'), #N/A, 0)) AS CMP_AMT3 ,SUM(#N/A) AS CMP_AMT4 ,SUM(#N/A) AS CMP_AMT5 ,SUM(#N/A) AS CMP_AMT6 ,SUM(#N/A) AS CMP_AMT7 ,SUM(#N/A) AS CMP_AMT8 ,44 AS SORT FROM DATA WHERE MNSUM_YM BETWEEN #strYr# ||'10' AND #strYr# ||'13' UNION ALL SELECT '총계' AS MNSUM_YM /* 월계연월 */,
    MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'01' AND #strYr#||'13'), #N/A, 0)) AS CMP_AMT1 ,MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'01' AND #strYr#||'13'), #N/A, 0)) AS CMP_AMT2 ,MAX(DECODE(MNSUM_YM, (SELECT MAX(MNSUM_YM) AS MNSUM_YM /* 월계연월 */
FROM DATA WHERE MNSUM_YM BETWEEN #strYr#||'01' AND #strYr#||'13'), #N/A, 0)) AS CMP_AMT3 ,SUM(#N/A) AS CMP_AMT4 ,SUM(#N/A) AS CMP_AMT5 ,SUM(#N/A) AS CMP_AMT6 ,SUM(#N/A) AS CMP_AMT7 ,SUM(#N/A) AS CMP_AMT8 ,55 AS SORT FROM DATA ORDER BY SORT, MNSUM_YM