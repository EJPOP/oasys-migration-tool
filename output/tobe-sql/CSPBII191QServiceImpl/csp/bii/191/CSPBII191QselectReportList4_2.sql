SELECT *
FROM ( SELECT NVL2(CD,CD,'총계') AS NVL2,
    NVL2(SRECS_DEPT_CD,MAX(CNSTN_MBCMT_DEPT_NM),NVL2(CD,'국별소계','총계')) AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    SUM(SUM1) AS SUM1,
    SUM(T1) AS T1,
    SUM(T2) AS T2,
    SUM(SUM2) AS SUM2,
    SUM(C1) AS C1,
    SUM(C2) AS C2,
    SUM(C3) AS C3,
    SUM(C4) AS C4,
    SUM(C5) AS C5,
    SUM(C6) AS C6,
    SUM(TOTAL) AS TOTAL
FROM ( SELECT SUBSTR(A.SRECS_DEPT_CD, 0, 3) AS SUBSTR,
    A.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    A.ABR_DPT_NM_1 AS CNSTN_MBCMT_DEPT_NM,
    NVL(A1.SUM1, 0) AS SUM1,
    NVL(A1.T1, 0) AS T1,
    NVL(A1.T2, 0) AS T2,
    NVL(B1.SUM2, 0) AS SUM2,
    NVL(B1.C1, 0) AS C1,
    NVL(B1.C2, 0) AS C2,
    NVL(B1.C3, 0) AS C3,
    NVL(B1.C4, 0) AS C4,
    NVL(B1.C5, 0) AS C5,
    NVL(B1.C6, 0) AS C6,
    NVL(C1.TOTAL, 0) AS TOTAL
FROM TBDCMACM002M A, (SELECT A.ETC_LBSVC_MNG_DEPT_CD /* 기타용역관리부서코드 */,
    (A.T1+A.T2) AS T1,
    A.T1,
    A.T2
FROM ( SELECT ETC_LBSVC_MNG_DEPT_CD ,SUM(CASE WHEN (TRNF_YMD BETWEEN #TRNF_YMD# AND #strEndDt# AND PRCS_DRCTN_SECD NOT IN ('5') ) OR (PRCS_DRCTN_SECD = '5' AND TRNF_YMD BETWEEN #TRNF_YMD# AND #strEndDt# AND CMPTN_YMD BETWEEN #TRNF_YMD# AND #strEndDt# AND PRCS_RSLT_SECD IN ('31','32','34')) THEN 1 ELSE 0 END) AS T1 /* 처리대상_당해년도이송 */ ,SUM(CASE WHEN (TRNF_YMD = #TRNF_YMD#) AND PRCS_DRCTN_SECD NOT IN ('5')) OR (PRCS_DRCTN_SECD ='5' AND TRNF_YMD #strEndDt#) AND PRCS_DRCTN_SECD NOT IN ('5','7') GROUP BY ETC_LBSVC_MNG_DEPT_CD ) C1 WHERE 1=1 AND A.SRECS_DEPT_CD = A1.ETC_LBSVC_MNG_DEPT_CD(+) AND A.SRECS_DEPT_CD = B1.ETC_LBSVC_MNG_DEPT_CD(+) AND A.SRECS_DEPT_CD = C1.ETC_LBSVC_MNG_DEPT_CD(+) /*AND SUBSTR(A.DPT_CD, 4, 6) != '000'*/ ORDER BY CD, SRECS_DEPT_CD ASC ) GROUP BY ROLLUP( CD, SRECS_DEPT_CD) ORDER BY DECODE(CD,'총계','000',CD), DECODE(CNSTN_MBCMT_DEPT_NM,'국별소계','000',SRECS_DEPT_CD) ASC ) WHERE SUM1 <> 0 OR SUM2 <> 0 OR TOTAL <> 0