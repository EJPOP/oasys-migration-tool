SELECT NVL(SUM(PSON.CNT), 0) AS CNT,
    NVL(SUM(PSON.INTERNAL_CNT), 0) AS INTERNAL_CNT,
    NVL(SUM(PSON.SUGUN_CNT), 0) AS SUGUN_CNT,
    NVL(SUM(PSON.CHA_CNT), 0) AS CHA_CNT,
    NVL(SUM(PSON.EXPERT_CNT), 0) AS EXPERT_CNT,
    NVL(SUM(PSON.CHA1_CNT), 0) AS CHA1_CNT,
    NVL(SUM(PSON.CHA_CNT), 0) + NVL(SUM(PSON.EXPERT_CNT), 0) + NVL(SUM(PSON.CHA1_CNT), 0) AS CHA_CNT
FROM TB_BADDED002M SITU, TB_BADDED001M AUD, (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    SUM( CASE WHEN AS1.EMP_SECD = '0' THEN 1 END) AS EMP_SECD /* 직원구분코드 */,
    SUM( CASE WHEN AS1.EMP_SECD = '1' THEN 1 END) AS EMP_SECD /* 직원구분코드 */,
    SUM( CASE WHEN AS1.EMP_SECD = '2' THEN 1 END) AS EMP_SECD /* 직원구분코드 */,
    SUM( CASE WHEN AS1.EMP_SECD = '3' THEN 1 END) AS EMP_SECD /* 직원구분코드 */,
    SUM( CASE WHEN AS1.EMP_SECD = '9' THEN 1 END) AS EMP_SECD /* 직원구분코드 */,
    COUNT(*) AS CNT
FROM (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    EMP_SECD /* 직원구분코드 */
FROM TBBADDED005L WHERE BZTRP_BGNG_YMD = #ADT_BGNG_YMD# GROUP BY BZTRP_YR, BZTRP_SQNO, BZTRVR_ENO, EMP_SECD) AS1 GROUP BY BZTRP_YR, BZTRP_SQNO) PSON WHERE AUD.ADT_YR = SITU.REL_ADT_YR AND AUD.ADT_NO = SITU.REL_ADT_NO AND PSON.BZTRP_YR(+) = SITU.BZTRP_YR AND PSON.BZTRP_SQNO(+) = SITU.BZTRP_SQNO AND SITU.BZTRP_SECD ='1' AND SITU.ADT_BGNG_YMD = #ADT_BGNG_YMD# /* 감찰담당관실은 조회시 제외하며, 로그인 한 담당자가 감찰담당관일때만 포함하여 모두 보임 - 2016.01.04 yyh */ AND AUD.SPRVSN_DEPT_CD != '100100'