SELECT COUNT(*) AS ALL_SUM,
    NVL(SUM(PSON.CNT),0) AS CNT,
    NVL(SUM(PSON.EXT_CNT),0) AS EXT_CNT,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '1' THEN 1 END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '2' THEN 1 END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '3' THEN 1 END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '4' THEN 1 END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '6' THEN 1 END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) not in ('1','2','3','4','6') THEN 1 END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '1' THEN PSON.CNT END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '2' THEN PSON.CNT END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '3' THEN PSON.CNT END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '4' THEN PSON.CNT END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) not in ('1','2','3','4','6') THEN PSON.CNT END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '6' THEN PSON.CNT END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '1' THEN PSON.EXT_CNT END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '2' THEN PSON.EXT_CNT END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '3' THEN PSON.EXT_CNT END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '4' THEN PSON.EXT_CNT END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) not in ('1','2','3','4','6') THEN PSON.EXT_CNT END),0) AS SUBSTRB,
    NVL(SUM(CASE WHEN SUBSTRB(AUD.ADT_KDCD,3,1) = '6' THEN PSON.EXT_CNT END),0) AS SUBSTRB,
    (select case to_char(to_date(#ADT_BGNG_YMD#, 'YYYYMMDD'), 'd') when 1 then '일' when 2 then '월' when 3 then '화' when 4 then '수' when 5 then '목' when 6 then '금' when 7 then '토' end AS TO_CHAR
from dual) AS STR_DATE FROM TB_BADDED002M SITU, TB_BADDED001M AUD, (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    SUM(CASE WHEN AS1.EMP_SECD != '0' THEN 1 END) AS EMP_SECD /* 직원구분코드 */,
    COUNT(*) AS CNT
FROM (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    EMP_SECD /* 직원구분코드 */
FROM TBBADDED005L WHERE BZTRP_BGNG_YMD = #ADT_BGNG_YMD# GROUP BY BZTRP_YR ,BZTRP_SQNO ,BZTRVR_ENO ,EMP_SECD) AS1 GROUP BY BZTRP_YR, BZTRP_SQNO) PSON WHERE AUD.ADT_YR = SITU.REL_ADT_YR AND AUD.ADT_NO = SITU.REL_ADT_NO AND PSON.BZTRP_YR(+) = SITU.BZTRP_YR AND PSON.BZTRP_SQNO(+) = SITU.BZTRP_SQNO AND SITU.BZTRP_SECD ='1' AND SITU.ADT_BGNG_YMD = #ADT_BGNG_YMD# /* 감찰담당관실은 조회시 제외하며, 로그인 한 담당자가 감찰담당관일때만 포함하여 모두 보임 - 2016.01.04 yyh */ AND AUD.SPRVSN_DEPT_CD != '100100'