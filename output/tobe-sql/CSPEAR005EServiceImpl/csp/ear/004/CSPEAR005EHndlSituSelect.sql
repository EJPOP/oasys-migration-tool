SELECT C.RPT_TERM_YMD /* 보고기한일자 */,
    C.RB_PRCS_TERM_YMD /* 소관국처리기한일자 */,
    C.AJMT_PIC_ATRZ_TERM_YMD /* 조정담당자결재기한일자 */,
    C.AJMT_OFER_ATRZ_TERM_YMD /* 조정담당관결재기한일자 */,
    C.DLRM_ATRZ_TERM_YMD /* 심의실결재기한일자 */,
    C.PSD_DHD_ATRZ_TERM_YMD /* 총장차장결재기한일자 */,
    C.LDRV_MBCMT_ATRZ_TERM_YMD /* 주심위원위원결재기한일자 */,
    C.ENFC_ATRZ_TERM_YMD /* 시행결재기한일자 */,
    C.DAG_RPT_YMD /* 귀청보고일자 */,
    C.AB_ATRZ_YMD /* 감사국결재일자 */,
    C.AJMT_OFER_ATRZ_YMD /* 조정담당관결재일자 */,
    C.AJMT_DDG_ATRZ_YMD /* 조정심의관결재일자 */,
    C.JDAF_SRNG_OFER_ATRZ_YMD /* 법무심사담당관결재일자 */,
    C.OW_DHD_ATRZ_YMD /* 사무차장결재일자 */,
    C.LDRV_MBCMT_ATRZ_YMD /* 주심위원위원결재일자 */,
    C.ENFC_ATRZ_YMD /* 시행결재일자 */,
    (CASE WHEN TRIM(C.DAG_RPT_YMD) IS NOT NULL THEN /*귀청보고일이 있는 경우*/ CASE WHEN TRIM(C.RPT_TERM_YMD) IS NULL THEN '0' ELSE TO_CHAR(TO_DATE(C.DAG_RPT_YMD) - TO_DATE(C.RPT_TERM_YMD)) END ELSE CASE WHEN TRIM(C.RPT_TERM_YMD) IS NULL THEN '0' ELSE TO_CHAR(TO_DATE(SYSDATE) - TO_DATE(C.RPT_TERM_YMD)) END END) AS TRIM /* 귀청보고지연일수 */,
    CASE WHEN TRIM(DAG_RPT_YMD) IS NOT NULL AND TRIM(RB_PRCS_TERM_YMD) IS NOT NULL THEN /*귀청보고일이 있는 */ CASE WHEN TRIM(AB_ATRZ_YMD) IS NULL THEN TO_CHAR(TO_DATE(SYSDATE) - TO_DATE(RB_PRCS_TERM_YMD)) ELSE TO_CHAR(TO_DATE(AB_ATRZ_YMD) - TO_DATE(RB_PRCS_TERM_YMD)) END ELSE '-' END AS TRIM /* 감사국과지연일수 */,
    (CASE WHEN TRIM(C.AB_ATRZ_YMD) IS NOT NULL THEN /*감사국과결재일이 있는 경우*/ CASE WHEN TRIM(C.AJMT_OFER_ATRZ_YMD) IS NULL THEN TO_CHAR(TO_DATE(SYSDATE) - TO_DATE(C.AJMT_PIC_ATRZ_TERM_YMD)) ELSE TO_CHAR(TO_DATE(C.AJMT_OFER_ATRZ_YMD) - TO_DATE(C.AJMT_PIC_ATRZ_TERM_YMD)) END ELSE '-' END) AS TRIM /* 조정담당자지연일수 */,
    (CASE WHEN TRIM(C.AJMT_OFER_ATRZ_YMD) IS NOT NULL /*조정담당자결재일이 있는 경우*/ THEN CASE WHEN TRIM(C.AJMT_DDG_ATRZ_YMD) IS NULL THEN TO_CHAR(TO_DATE(SYSDATE) - TO_DATE(C.AJMT_OFER_ATRZ_TERM_YMD)) ELSE TO_CHAR(TO_DATE(C.AJMT_DDG_ATRZ_YMD) - TO_DATE(C.AJMT_OFER_ATRZ_TERM_YMD)) END ELSE '-' END) AS TRIM /* 조정담당관지연일수 */,
    CASE WHEN TRIM(AB_ATRZ_YMD) IS NOT NULL AND TRIM(DLRM_ATRZ_TERM_YMD) IS NOT NULL THEN /*조정담당관결재일이 있는 경우*/ CASE WHEN TRIM(JDAF_SRNG_OFER_ATRZ_YMD) IS NULL THEN TO_CHAR(TO_DATE(SYSDATE) - TO_DATE(DLRM_ATRZ_TERM_YMD)) ELSE TO_CHAR(TO_DATE(JDAF_SRNG_OFER_ATRZ_YMD) - TO_DATE(DLRM_ATRZ_TERM_YMD)) END ELSE '-' END AS TRIM /* 심의실장지연일수 */,
    CASE WHEN TRIM(JDAF_SRNG_OFER_ATRZ_YMD) IS NOT NULL AND TRIM(PSD_DHD_ATRZ_TERM_YMD) IS NOT NULL THEN /*법무심사관(심의실장)결재일이 있는 경우*/ CASE WHEN TRIM(OW_DHD_ATRZ_YMD) IS NULL THEN TO_CHAR(TO_DATE(SYSDATE) - TO_DATE(PSD_DHD_ATRZ_TERM_YMD)) ELSE TO_CHAR(TO_DATE(OW_DHD_ATRZ_YMD) - TO_DATE(PSD_DHD_ATRZ_TERM_YMD)) END ELSE '-' END AS TRIM /* 총차장지연일수 */,
    CASE WHEN TRIM(OW_DHD_ATRZ_YMD) IS NOT NULL AND TRIM(LDRV_MBCMT_ATRZ_TERM_YMD) IS NOT NULL THEN /*사무차장결재일이 있는경우*/ CASE WHEN TRIM(LDRV_MBCMT_ATRZ_YMD) IS NULL THEN TO_CHAR(TO_DATE(SYSDATE) - TO_DATE(LDRV_MBCMT_ATRZ_TERM_YMD)) ELSE TO_CHAR(TO_DATE(LDRV_MBCMT_ATRZ_YMD) - TO_DATE(LDRV_MBCMT_ATRZ_TERM_YMD)) END ELSE '-' END AS TRIM /* 주심위원지연일수 */,
    CASE WHEN TRIM(LDRV_MBCMT_ATRZ_YMD) IS NOT NULL THEN /*주심위원결재일이 있는 경우*/ CASE WHEN TRIM(ENFC_ATRZ_YMD) IS NULL THEN CASE WHEN TRIM(ENFC_ATRZ_TERM_YMD) IS NULL THEN '0' ELSE TO_CHAR(TO_DATE(SYSDATE) - TO_DATE(ENFC_ATRZ_TERM_YMD)) END ELSE CASE WHEN TRIM(ENFC_ATRZ_TERM_YMD) IS NULL THEN '0' ELSE TO_CHAR(TO_DATE(ENFC_ATRZ_YMD) - TO_DATE(ENFC_ATRZ_TERM_YMD)) END END ELSE '-' END AS TRIM /* 시행지연일수 */
FROM TB_BADDED030L D2, TB_BADDED001M B, TB_BADDED003M C WHERE D2.ACADT_DSCTN_NM_2 = #DSPS_RQT_NM_2# AND D2.ACADT_DSCTN_NM_1 = #DSPS_RQT_NM_1# AND D2.ACADT_DSCTN_NM_3 = #DSPS_RQT_NM_3# AND B.ADT_YR = D2.ADT_YR AND B.ADT_NO = D2.ADT_NO AND B.ADT_YR = C.ADT_YR AND B.ADT_NO = C.ADT_NO AND SUBSTR(B.ADT_KDCD,'3','1') <> '5'