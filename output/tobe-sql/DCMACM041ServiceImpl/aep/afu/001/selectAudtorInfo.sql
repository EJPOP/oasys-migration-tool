SELECT D1.ADTR_ENO /* 감사인직원전산번호 */,
    D2.RPTP_NM /* 보고서명 */,
    D2.RPTP_KDCD /* 보고서종류코드 */,
    F_MNG_KND_AUDYRNO(D2.ADT_YR, D2.ADT_NO, D2.ADT_KDCD, '-') AS ADT_CLSF_NO /* 감사분류번호 */,
    (SELECT ST.ADT_MTTR_NM AS ADT_MTTR_NM /* 감사사항명 */
FROM TB_BADDED001M ST WHERE ST.CVLCPT_ADT_YR = D2.CVLCPT_ADT_YR AND ST.ADT_NO = D2.ADT_NO) AS ADT_MTTR_NM FROM TB_BADDED031L D1 INNER JOIN TB_BADDED103M D2 ON D2.CVLCPT_ADT_YR = D1.SRECS_ADT_YR AND D2.ADT_NO = D1.SRECS_ADT_NO WHERE D2.SRECS_ATRZ_DMND_ID = #ATRZ_DMND_ID# AND D1.ADTR_SECD IN ('1' ,'2') GROUP BY D1.TRGT_NOP_ENO, D2.SRECS_RPTP_NM, D2.CVLCPT_ADT_YR, D2.ADT_NO, D2.ADT_KDCD, D2.SRECS_RPTP_KDCD UNION ALL SELECT D1.SRECS_PRCS_PIC_SECD AS SRECS_PRCS_PIC_SECD /* 심사재심의처리담당자구분코드 */,
    D2.SRECS_RPTP_NM /* 심사재심의보고서명 */,
    D2.SRECS_RPTP_KDCD /* 심사재심의보고서종류코드 */,
    D2.SRECS_RCPT_YR || '-' || DECODE(D2.SRECS_RCPT_SECD, '1','심사','재심') || '-' || D2.SRECS_RCPT_SQNO AS ADT_CLSF_NO /* 감사분류번호 */,
    D1.SRECS_NM AS SRECS_NM /* 심사재심의명 */
FROM TB_BADFRE012M D1 INNER JOIN TB_BADFRE103M D2 ON D2.SRECS_RCPT_YR = D1.SRECS_RCPT_YR AND D2.SRECS_RCPT_SECD = D1.SRECS_RCPT_SECD AND D2.SRECS_RCPT_SQNO = D1.SRECS_RCPT_SQNO WHERE D2.SRECS_ATRZ_DMND_ID = #ATRZ_DMND_ID# GROUP BY D1.SRECS_PRCS_PIC_SECD, D2.SRECS_RPTP_NM, D2.SRECS_RPTP_KDCD, D2.SRECS_RCPT_YR, D2.SRECS_RCPT_SECD, D2.SRECS_RCPT_SQNO, D1.SRECS_NM