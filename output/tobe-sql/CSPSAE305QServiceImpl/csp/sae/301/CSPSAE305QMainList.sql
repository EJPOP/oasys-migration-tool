WITH CRS_DATA AS ( SELECT A.LINK_YR /* 연계년도 */,
    A.LINK_YR || #strM# AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    A.LCT_RM_NO,
    A.CRS_CDN /* 과정기수 */,
    A.CRS_CD,
    A.USE_STR_DT,
    A.USE_END_DT,
    A.USE_STR_HM,
    A.USE_END_HM,
    A.ASG_YN,
    ( '제 ' || A.CRS_CDN || '기' || CHR(13) || CHR(10) || (SELECT AS CRS_NM /* 과정명 */
FROM TBCSPSAE103C WHERE CRS_CD = A.CRS_CD) || CHR(13) || CHR(10) || SUBSTR(A.USE_STR_DT, 0, 4) || '.' || SUBSTR(A.USE_STR_DT, 5, 2) || '.' || SUBSTR(A.USE_STR_DT, 7, 2) || ' ~ ' || SUBSTR(A.USE_END_DT, 0, 4) || '.' || SUBSTR(A.USE_END_DT, 5, 2) || '.' || SUBSTR(A.USE_END_DT, 7, 2) || CHR(13) || CHR(10) || SUBSTR(A.USE_STR_HM, 0, 2) || ':' || SUBSTR(A.USE_STR_HM, 3, 2) || ' ~ ' || SUBSTR(A.USE_END_HM, 0, 2) || ':' || SUBSTR(A.USE_END_HM, 3, 2) || CHR(13) || CHR(10) ) AS TOOLTIP FROM TBCSPSAE203D A WHERE A.LINK_YR = #LINK_YR# AND (SUBSTR(A.USE_STR_DT, 5, 2) = #strM# OR SUBSTR(A.USE_END_DT, 5, 2) = #strM#) ) , MAX_TIME_DATA AS ( SELECT MIN(HUC_STR_HM) AS HUC_STR_HM,
    MAX(HUC_END_HM) AS HUC_END_HM
FROM TBCSPSAE111B ) SELECT D62.CD_NM,
    D60.LCT_RM_NO,
    D60.LCT_RM_NM,
    D61.CRS_CD_01,
    D61.CRS_CD_02,
    D61.CRS_CD_03,
    D61.CRS_CD_04,
    D61.CRS_CD_05,
    D61.CRS_CD_06,
    D61.CRS_CD_07,
    D61.CRS_CD_08,
    D61.CRS_CD_09,
    D61.CRS_CD_10,
    D61.CRS_CD_11,
    D61.CRS_CD_12,
    D61.CRS_CD_13,
    D61.CRS_CD_14,
    D61.CRS_CD_15,
    D61.CRS_CD_16,
    D61.CRS_CD_17,
    D61.CRS_CD_18,
    D61.CRS_CD_19,
    D61.CRS_CD_20,
    D61.CRS_CD_21,
    D61.CRS_CD_22,
    D61.CRS_CD_23,
    D61.CRS_CD_24,
    D61.CRS_CD_25,
    D61.CRS_CD_26,
    D61.CRS_CD_27,
    D61.CRS_CD_28,
    D61.CRS_CD_29,
    D61.CRS_CD_30,
    D61.CRS_CD_31,
    D61.CRS_CDN_01,
    D61.CRS_CDN_02,
    D61.CRS_CDN_03,
    D61.CRS_CDN_04,
    D61.CRS_CDN_05,
    D61.CRS_CDN_06,
    D61.CRS_CDN_07,
    D61.CRS_CDN_08,
    D61.CRS_CDN_09,
    D61.CRS_CDN_10,
    D61.CRS_CDN_11,
    D61.CRS_CDN_12,
    D61.CRS_CDN_13,
    D61.CRS_CDN_14,
    D61.CRS_CDN_15,
    D61.CRS_CDN_16,
    D61.CRS_CDN_17,
    D61.CRS_CDN_18,
    D61.CRS_CDN_19,
    D61.CRS_CDN_20,
    D61.CRS_CDN_21,
    D61.CRS_CDN_22,
    D61.CRS_CDN_23,
    D61.CRS_CDN_24,
    D61.CRS_CDN_25,
    D61.CRS_CDN_26,
    D61.CRS_CDN_27,
    D61.CRS_CDN_28,
    D61.CRS_CDN_29,
    D61.CRS_CDN_30,
    D61.CRS_CDN_31,
    D61.TOOLTIP_01,
    D61.TOOLTIP_02,
    D61.TOOLTIP_03,
    D61.TOOLTIP_04,
    D61.TOOLTIP_05,
    D61.TOOLTIP_06,
    D61.TOOLTIP_07,
    D61.TOOLTIP_08,
    D61.TOOLTIP_09,
    D61.TOOLTIP_10,
    D61.TOOLTIP_11,
    D61.TOOLTIP_12,
    D61.TOOLTIP_13,
    D61.TOOLTIP_14,
    D61.TOOLTIP_15,
    D61.TOOLTIP_16,
    D61.TOOLTIP_17,
    D61.TOOLTIP_18,
    D61.TOOLTIP_19,
    D61.TOOLTIP_20,
    D61.TOOLTIP_21,
    D61.TOOLTIP_22,
    D61.TOOLTIP_23,
    D61.TOOLTIP_24,
    D61.TOOLTIP_25,
    D61.TOOLTIP_26,
    D61.TOOLTIP_27,
    D61.TOOLTIP_28,
    D61.TOOLTIP_29,
    D61.TOOLTIP_30,
    D61.TOOLTIP_31,
    NVL(D61.YN_01, 'Ｘ') AS YN_01,
    NVL(D61.YN_02, 'Ｘ') AS YN_02,
    NVL(D61.YN_03, 'Ｘ') AS YN_03,
    NVL(D61.YN_04, 'Ｘ') AS YN_04,
    NVL(D61.YN_05, 'Ｘ') AS YN_05,
    NVL(D61.YN_06, 'Ｘ') AS YN_06,
    NVL(D61.YN_07, 'Ｘ') AS YN_07,
    NVL(D61.YN_08, 'Ｘ') AS YN_08,
    NVL(D61.YN_09, 'Ｘ') AS YN_09,
    NVL(D61.YN_10, 'Ｘ') AS YN_10,
    NVL(D61.YN_11, 'Ｘ') AS YN_11,
    NVL(D61.YN_12, 'Ｘ') AS YN_12,
    NVL(D61.YN_13, 'Ｘ') AS YN_13,
    NVL(D61.YN_14, 'Ｘ') AS YN_14,
    NVL(D61.YN_15, 'Ｘ') AS YN_15,
    NVL(D61.YN_16, 'Ｘ') AS YN_16,
    NVL(D61.YN_17, 'Ｘ') AS YN_17,
    NVL(D61.YN_18, 'Ｘ') AS YN_18,
    NVL(D61.YN_19, 'Ｘ') AS YN_19,
    NVL(D61.YN_20, 'Ｘ') AS YN_20,
    NVL(D61.YN_21, 'Ｘ') AS YN_21,
    NVL(D61.YN_22, 'Ｘ') AS YN_22,
    NVL(D61.YN_23, 'Ｘ') AS YN_23,
    NVL(D61.YN_24, 'Ｘ') AS YN_24,
    NVL(D61.YN_25, 'Ｘ') AS YN_25,
    NVL(D61.YN_26, 'Ｘ') AS YN_26,
    NVL(D61.YN_27, 'Ｘ') AS YN_27,
    NVL(D61.YN_28, 'Ｘ') AS YN_28,
    NVL(D61.YN_29, 'Ｘ') AS YN_29,
    NVL(D61.YN_30, 'Ｘ') AS YN_30,
    NVL(D61.YN_31, 'Ｘ') AS YN_31
FROM TBCSPSAE114C D60 , TBDCMACM013C D62 , ( SELECT D50.LINK_YR /* 연계년도 */,
    D50.CVLCPT_RCPT_YM /* 민원접수연월 */,
    D50.LCT_RM_NO,
    D50.CRS_CD_01,
    D50.CRS_CD_02,
    D50.CRS_CD_03,
    D50.CRS_CD_04,
    D50.CRS_CD_05,
    D50.CRS_CD_06,
    D50.CRS_CD_07,
    D50.CRS_CD_08,
    D50.CRS_CD_09,
    D50.CRS_CD_10,
    D50.CRS_CD_11,
    D50.CRS_CD_12,
    D50.CRS_CD_13,
    D50.CRS_CD_14,
    D50.CRS_CD_15,
    D50.CRS_CD_16,
    D50.CRS_CD_17,
    D50.CRS_CD_18,
    D50.CRS_CD_19,
    D50.CRS_CD_20,
    D50.CRS_CD_21,
    D50.CRS_CD_22,
    D50.CRS_CD_23,
    D50.CRS_CD_24,
    D50.CRS_CD_25,
    D50.CRS_CD_26,
    D50.CRS_CD_27,
    D50.CRS_CD_28,
    D50.CRS_CD_29,
    D50.CRS_CD_30,
    D50.CRS_CD_31,
    D50.CRS_CDN_01,
    D50.CRS_CDN_02,
    D50.CRS_CDN_03,
    D50.CRS_CDN_04,
    D50.CRS_CDN_05,
    D50.CRS_CDN_06,
    D50.CRS_CDN_07,
    D50.CRS_CDN_08,
    D50.CRS_CDN_09,
    D50.CRS_CDN_10,
    D50.CRS_CDN_11,
    D50.CRS_CDN_12,
    D50.CRS_CDN_13,
    D50.CRS_CDN_14,
    D50.CRS_CDN_15,
    D50.CRS_CDN_16,
    D50.CRS_CDN_17,
    D50.CRS_CDN_18,
    D50.CRS_CDN_19,
    D50.CRS_CDN_20,
    D50.CRS_CDN_21,
    D50.CRS_CDN_22,
    D50.CRS_CDN_23,
    D50.CRS_CDN_24,
    D50.CRS_CDN_25,
    D50.CRS_CDN_26,
    D50.CRS_CDN_27,
    D50.CRS_CDN_28,
    D50.CRS_CDN_29,
    D50.CRS_CDN_30,
    D50.CRS_CDN_31,
    D50.TOOLTIP_01,
    D50.TOOLTIP_02,
    D50.TOOLTIP_03,
    D50.TOOLTIP_04,
    D50.TOOLTIP_05,
    D50.TOOLTIP_06,
    D50.TOOLTIP_07,
    D50.TOOLTIP_08,
    D50.TOOLTIP_09,
    D50.TOOLTIP_10,
    D50.TOOLTIP_11,
    D50.TOOLTIP_12,
    D50.TOOLTIP_13,
    D50.TOOLTIP_14,
    D50.TOOLTIP_15,
    D50.TOOLTIP_16,
    D50.TOOLTIP_17,
    D50.TOOLTIP_18,
    D50.TOOLTIP_19,
    D50.TOOLTIP_20,
    D50.TOOLTIP_21,
    D50.TOOLTIP_22,
    D50.TOOLTIP_23,
    D50.TOOLTIP_24,
    D50.TOOLTIP_25,
    D50.TOOLTIP_26,
    D50.TOOLTIP_27,
    D50.TOOLTIP_28,
    D50.TOOLTIP_29,
    D50.TOOLTIP_30,
    D50.TOOLTIP_31,
    D51.YN_01,
    D51.YN_02,
    D51.YN_03,
    D51.YN_04,
    D51.YN_05,
    D51.YN_06,
    D51.YN_07,
    D51.YN_08,
    D51.YN_09,
    D51.YN_10,
    D51.YN_11,
    D51.YN_12,
    D51.YN_13,
    D51.YN_14,
    D51.YN_15,
    D51.YN_16,
    D51.YN_17,
    D51.YN_18,
    D51.YN_19,
    D51.YN_20,
    D51.YN_21,
    D51.YN_22,
    D51.YN_23,
    D51.YN_24,
    D51.YN_25,
    D51.YN_26,
    D51.YN_27,
    D51.YN_28,
    D51.YN_29,
    D51.YN_30,
    D51.YN_31
FROM ( SELECT D2.LINK_YR /* 연계년도 */,
    D2.CVLCPT_RCPT_YM /* 민원접수연월 */,
    D2.LCT_RM_NO,
    AGGR_CONCAT( D2.CRS_CD_01, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_02, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_03, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_04, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_05, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_06, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_07, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_08, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_09, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_10, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_11, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_12, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_13, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_14, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_15, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_16, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_17, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_18, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_19, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_20, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_21, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_22, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_23, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_24, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_25, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_26, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_27, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_28, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_29, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_30, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CD_31, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_01, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_02, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_03, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_04, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_05, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_06, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_07, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_08, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_09, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_10, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_11, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_12, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_13, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_14, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_15, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_16, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_17, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_18, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_19, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_20, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_21, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_22, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_23, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_24, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_25, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_26, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_27, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_28, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_29, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_30, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.CRS_CDN_31, '@' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_01, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_02, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_03, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_04, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_05, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_06, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_07, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_08, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_09, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_10, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_11, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_12, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_13, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_14, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_15, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_16, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_17, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_18, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_19, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_20, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_21, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_22, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_23, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_24, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_25, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_26, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_27, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_28, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_29, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_30, '' ) AS AGGR_CONCAT,
    AGGR_CONCAT( D2.TOOLTIP_31, '' ) AS AGGR_CONCAT
FROM ( SELECT D1.LINK_YR /* 연계년도 */,
    D1.CVLCPT_RCPT_YM /* 민원접수연월 */,
    D1.LCT_RM_NO,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '01' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '02' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '03' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '04' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '05' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '06' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '07' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '08' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '09' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '10' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '11' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '12' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '13' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '14' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '15' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '16' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '17' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '18' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '19' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '20' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '21' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '22' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '23' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '24' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '25' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '26' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '27' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '28' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '29' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '30' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '31' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CD ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '01' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '02' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '03' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '04' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '05' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '06' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '07' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '08' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '09' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '10' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '11' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '12' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '13' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '14' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '15' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '16' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '17' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '18' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '19' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '20' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '21' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '22' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '23' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '24' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '25' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '26' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '27' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '28' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '29' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '30' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '31' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN CRS_CDN ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '01' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '02' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '03' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '04' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '05' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '06' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '07' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '08' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '09' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '10' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '11' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '12' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '13' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '14' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '15' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '16' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '17' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '18' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '19' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '20' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '21' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '22' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '23' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '24' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '25' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '26' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '27' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '28' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '29' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '30' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */,
    ( CASE WHEN D1.CVLCPT_RCPT_YM || '31' BETWEEN D1.USE_STR_DT AND D1.USE_END_DT THEN TOOLTIP ELSE NULL END ) AS CVLCPT_RCPT_YM /* 민원접수연월 */
FROM CRS_DATA D1 ) D2 GROUP BY D2.LINK_YR , D2.CVLCPT_RCPT_YM , D2.LCT_RM_NO ) D50 , ( SELECT D4.LINK_YR /* 연계년도 */,
    D4.CVLCPT_RCPT_YM /* 민원접수연월 */,
    D4.LCT_RM_NO,
    (CASE WHEN SUM(CNT_01) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_01) THEN '○' ELSE '' END ) AS CNT_01,
    (CASE WHEN SUM(CNT_02) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_02) THEN '○' ELSE '' END ) AS CNT_02,
    (CASE WHEN SUM(CNT_03) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_03) THEN '○' ELSE '' END ) AS CNT_03,
    (CASE WHEN SUM(CNT_04) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_04) THEN '○' ELSE '' END ) AS CNT_04,
    (CASE WHEN SUM(CNT_05) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_05) THEN '○' ELSE '' END ) AS CNT_05,
    (CASE WHEN SUM(CNT_06) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_06) THEN '○' ELSE '' END ) AS CNT_06,
    (CASE WHEN SUM(CNT_07) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_07) THEN '○' ELSE '' END ) AS CNT_07,
    (CASE WHEN SUM(CNT_08) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_08) THEN '○' ELSE '' END ) AS CNT_08,
    (CASE WHEN SUM(CNT_09) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_09) THEN '○' ELSE '' END ) AS CNT_09,
    (CASE WHEN SUM(CNT_10) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_10) THEN '○' ELSE '' END ) AS CNT_10,
    (CASE WHEN SUM(CNT_11) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_11) THEN '○' ELSE '' END ) AS CNT_11,
    (CASE WHEN SUM(CNT_12) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_12) THEN '○' ELSE '' END ) AS CNT_12,
    (CASE WHEN SUM(CNT_13) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_13) THEN '○' ELSE '' END ) AS CNT_13,
    (CASE WHEN SUM(CNT_14) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_14) THEN '○' ELSE '' END ) AS CNT_14,
    (CASE WHEN SUM(CNT_15) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_15) THEN '○' ELSE '' END ) AS CNT_15,
    (CASE WHEN SUM(CNT_16) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_16) THEN '○' ELSE '' END ) AS CNT_16,
    (CASE WHEN SUM(CNT_17) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_17) THEN '○' ELSE '' END ) AS CNT_17,
    (CASE WHEN SUM(CNT_18) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_18) THEN '○' ELSE '' END ) AS CNT_18,
    (CASE WHEN SUM(CNT_19) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_19) THEN '○' ELSE '' END ) AS CNT_19,
    (CASE WHEN SUM(CNT_20) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_20) THEN '○' ELSE '' END ) AS CNT_20,
    (CASE WHEN SUM(CNT_21) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_21) THEN '○' ELSE '' END ) AS CNT_21,
    (CASE WHEN SUM(CNT_22) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_22) THEN '○' ELSE '' END ) AS CNT_22,
    (CASE WHEN SUM(CNT_23) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_23) THEN '○' ELSE '' END ) AS CNT_23,
    (CASE WHEN SUM(CNT_24) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_24) THEN '○' ELSE '' END ) AS CNT_24,
    (CASE WHEN SUM(CNT_25) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_25) THEN '○' ELSE '' END ) AS CNT_25,
    (CASE WHEN SUM(CNT_26) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_26) THEN '○' ELSE '' END ) AS CNT_26,
    (CASE WHEN SUM(CNT_27) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_27) THEN '○' ELSE '' END ) AS CNT_27,
    (CASE WHEN SUM(CNT_28) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_28) THEN '○' ELSE '' END ) AS CNT_28,
    (CASE WHEN SUM(CNT_29) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_29) THEN '○' ELSE '' END ) AS CNT_29,
    (CASE WHEN SUM(CNT_30) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_30) THEN '○' ELSE '' END ) AS CNT_30,
    (CASE WHEN SUM(CNT_31) = 0 THEN 'Ｘ' WHEN COUNT(D4.CRU_SORT_SQNO) >= SUM(CNT_31) THEN '○' ELSE '' END ) AS CNT_31
FROM ( SELECT D3.LINK_YR , D3.CVLCPT_RCPT_YM , D3.LCT_RM_NO , D1.CRU_SORT_SQNO , MAX( CASE WHEN ( D3.CVLCPT_RCPT_YM || '01' BETWEEN D3.USE_STR_DT AND D3.USE_END_DT ) AND D1.HUC_STR_HM >= D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM = D3.USE_STR_HM AND D1.HUC_END_HM AND D60.LCT_RM_DVSN_CD = #strLctRmDvsn# AND D60.LCT_RM_NM LIKE '%' || #strLctRmNm# ||'%' ORDER BY LCT_RM_NO