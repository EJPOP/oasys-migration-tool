MERGE INTO TB_CSPDCP817M A USING ( SELECT #CVLCPT_DCLR_SECD# AS CVLCPT_DCLR_SECD /* 민원신고구분코드 */,
    #CVLCPT_RCPT_YR# AS CVLCPT_RCPT_YR /* 민원접수년도 */,
    #CVLCPT_DCLR_RCPT_NO# AS CVLCPT_DCLR_RCPT_NO /* 민원신고접수번호 */,
    '104' AS SLCT_DOC_SECD /* 청탁문서구분코드 */
FROM DUAL ) B ON ( A.SLCT_DCLR_SECD = B.CVLCPT_DCLR_SECD AND A.SLCT_RCPT_YR = B.CVLCPT_RCPT_YR AND A.SLCT_DCLR_RCPT_NO = B.CVLCPT_DCLR_RCPT_NO AND A.SLCT_DOC_SECD = B.SLCT_DOC_SECD ) WHEN MATCHED THEN UPDATE SET SLCT_DOC_CN = #SLCT_DOC_CN# /* 청탁문서내용 */, LAST_USER_ID = #LAST_USER_ID# /* 최종사용자아이디 */, LAST_PRCS_DEPT_CD = #LAST_PRCS_DEPT_CD# /* 최종처리부서코드 */, LAST_MENU_ID = #LAST_MENU_ID# /* 최종메뉴아이디 */, LAST_MDFCN_DT = SYSDATE WHEN NOT MATCHED THEN INSERT INSERT ( CVLCPT_DCLR_SECD ,CVLCPT_RCPT_YR ,CVLCPT_DCLR_RCPT_NO ,CVLCPT_DOC_SQNO ,SLCT_DOC_SECD ,SLCT_DOC_CN ,FRST_USER_ID ,LAST_USER_ID ,LAST_PRCS_DEPT_CD ,LAST_MENU_ID ,FRST_REG_DT ,LAST_MDFCN_DT ) VALUES ( #CVLCPT_DCLR_SECD# ,#CVLCPT_RCPT_YR# ,#CVLCPT_DCLR_RCPT_NO# ,( SELECT NVL(MAX(CVLCPT_DOC_SQNO),0)+1 AS CVLCPT_DOC_SQNO /* 민원문서순번 */
FROM TB_CSPDCP817M WHERE CVLCPT_DCLR_SECD = #CVLCPT_DCLR_SECD# AND CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND CVLCPT_DCLR_RCPT_NO = #CVLCPT_DCLR_RCPT_NO# ) ,'104' ,#SLCT_DOC_CN# ,#FRT_USR_ID# ,#LAST_USER_ID# ,#LAST_PRCS_DEPT_CD# ,#LAST_MENU_ID# ,SYSDATE ,SYSDATE )