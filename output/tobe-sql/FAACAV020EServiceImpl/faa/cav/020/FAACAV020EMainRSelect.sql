/* faa/cav/020/FAACAV020EMainRSelect */ SELECT JRSD_CD||'-'||ACNTG_CD||'-'||BLL_KDCD||'-'||PROF_RBPRSN_SQNO||'-'||GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS 증명책임자부호 AS JRSD_CD /* 소관코드 */,
    SUBSTR(PROF_YM, 1, 4) || '. ' || SUBSTR(PROF_YM, 5, 2) || '. 'AS 증명년월 AS PROF_YM /* 증명연월 */,
    JRSD_CD /* 소관코드 */,
    ACNTG_CD /* 회계코드 */,
    BLL_KDCD /* 계산서종류코드 */,
    PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    F_AV_ACCMN_NM(JRSD_CD, ACNTG_CD ,BLL_KDCD ,PROF_RBPRSN_SQNO ,GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO) AS 기관명 AS JRSD_CD /* 소관코드 */,
    TO_CHAR(CRU_RCPT_DT, 'YYYY. MM. DD HH24:MI:SS' ) AS 수신일시 AS CRU_RCPT_DT /* 부패접수일시 */,
    SUBSTR(RSNANS_RCPT_YMD, 1, 4) || '. ' || SUBSTR(RSNANS_RCPT_YMD, 5, 2) || '. ' || SUBSTR(RSNANS_RCPT_YMD, 7) AS 사유서접수일 AS RSNANS_RCPT_YMD /* 사유서접수일자 */,
    RSN_CN AS 사유요약 AS RSN_CN /* 사유내용 */,
    BLL_CLR_ID /* 계산서접수자아이디 */,
    RSN_TPCD /* 사유유형코드 */,
    F_AV_BLL_CD_NM(BLL_KDCD, GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO) AS F_AV_BLL_CD_NM,
    F_AV_BLL_COPT_CD_NM(JRSD_CD) AS JRSD_NM /* 소관명 */,
    F_AV_ACCMN_NM(JRSD_CD,ACNTG_CD,BLL_KDCD,PROF_RBPRSN_SQNO,GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO) AS F_AV_ACCMN_NM
FROM TWFAACAV056L A WHERE 1=1 /*증명월이 없으면 */ AND PROF_YM BETWEEN #strYr#||'00' AND #strYr#||'13' AND PROF_YM = #PROF_YM# AND JRSD_CD = #JRSD_CD# AND ACNTG_CD = #ACNTG_CD# AND 1 = CASE WHEN #JRSD_CD# IS NOT NULL OR #ACNTG_CD# IS NOT NULL THEN CASE WHEN #PROF_RBPRSN_SQNO# IS NOT NULL THEN CASE WHEN #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# IS NOT NULL THEN CASE WHEN A.BLL_KDCD = #BLL_KDCD# AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# THEN '1' END ELSE CASE WHEN A.BLL_KDCD = #BLL_KDCD# THEN '1' END END ELSE CASE WHEN #BLL_KDCD# IN ('17', '18') THEN CASE WHEN #strFildSsecYn# = 'N' THEN CASE WHEN A.BLL_KDCD IN ('17', '18') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' THEN '1' END ELSE CASE WHEN #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# IS NOT NULL THEN CASE WHEN A.BLL_KDCD IN ('17', '18') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# THEN '1' END ELSE CASE WHEN A.BLL_KDCD IN ('17', '18') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' THEN '1' END END END WHEN #BLL_KDCD# = '19' THEN CASE WHEN #strFildSsecYn# = 'N' THEN CASE WHEN A.BLL_KDCD = '19' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' THEN '1' END ELSE CASE WHEN #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# IS NOT NULL THEN CASE WHEN A.BLL_KDCD = '19' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# THEN '1' END ELSE CASE WHEN A.BLL_KDCD = '19' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' THEN '1' END END END WHEN #BLL_KDCD# IN ('22', '23', '24') THEN CASE WHEN #strFildSsecYn# = 'N' THEN CASE WHEN A.BLL_KDCD IN ('22', '23', '24') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' THEN '1' END ELSE CASE WHEN #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# IS NOT NULL THEN CASE WHEN A.BLL_KDCD IN ('22', '23', '24') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# THEN '1' END ELSE CASE WHEN A.BLL_KDCD IN ('22', '23', '24') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' THEN '1' END END END WHEN #BLL_KDCD# IN ('42', '43') THEN CASE WHEN #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# IS NOT NULL THEN CASE WHEN A.BLL_KDCD IN ('42', '43') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# THEN '1' END ELSE CASE WHEN A.BLL_KDCD IN ('42', '43') THEN '1' END END ELSE CASE WHEN #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# IS NOT NULL THEN CASE WHEN A.BLL_KDCD = #BLL_KDCD# AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# THEN '1' END ELSE CASE WHEN A.BLL_KDCD = #BLL_KDCD# THEN '1' END END END END ELSE CASE WHEN #PROF_RBPRSN_SQNO# IS NOT NULL THEN CASE WHEN #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# IS NOT NULL THEN CASE WHEN A.BLL_KDCD = #BLL_KDCD# AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# THEN '1' END ELSE CASE WHEN A.BLL_KDCD = #BLL_KDCD# THEN '1' END END ELSE CASE WHEN #BLL_KDCD# IN ('17', '18') THEN CASE WHEN #strFildSsecYn# = 'N' THEN CASE WHEN A.BLL_KDCD IN ('17', '18') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' THEN '1' END ELSE CASE WHEN #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# IS NOT NULL THEN CASE WHEN A.BLL_KDCD IN ('17', '18') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# THEN '1' END ELSE CASE WHEN A.BLL_KDCD IN ('17', '18') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' THEN '1' END END END WHEN #BLL_KDCD# = '19' THEN CASE WHEN #strFildSsecYn# = 'N' THEN CASE WHEN A.BLL_KDCD = '19' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' THEN '1' END ELSE CASE WHEN #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# IS NOT NULL THEN CASE WHEN A.BLL_KDCD = '19' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# THEN '1' END ELSE CASE WHEN A.BLL_KDCD = '19' AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' THEN '1' END END END WHEN #BLL_KDCD# IN ('22', '23', '24') THEN CASE WHEN #strFildSsecYn# = 'N' THEN CASE WHEN A.BLL_KDCD IN ('22', '23', '24') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = '000' THEN '1' END ELSE CASE WHEN #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# IS NOT NULL THEN CASE WHEN A.BLL_KDCD IN ('22', '23', '24') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# THEN '1' END ELSE CASE WHEN A.BLL_KDCD IN ('22', '23', '24') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO &lt;&gt; '000' THEN '1' END END END WHEN #BLL_KDCD# IN ('42', '43') THEN CASE WHEN #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# IS NOT NULL THEN CASE WHEN A.BLL_KDCD IN ('42', '43') AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# THEN '1' END ELSE CASE WHEN A.BLL_KDCD IN ('42', '43') THEN '1' END END ELSE CASE WHEN #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# IS NOT NULL THEN CASE WHEN A.BLL_KDCD = #BLL_KDCD# AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# THEN '1' END ELSE CASE WHEN A.BLL_KDCD = #BLL_KDCD# THEN '1' END END END END END AND PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# ORDER BY JRSD_CD, ACNTG_CD, BLL_KDCD, PROF_RBPRSN_SQNO, GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO