SELECT B.IMPL_TPCD /* 집행유형코드 */,
    B.ENFO_TYPE_NM,
    B.VIOL_SECD /* 비위구분코드 */,
    B.VIOL_NM /* 비위명 */,
    NVL(A.CNT0, 0) AS CNT0
FROM ( SELECT A.IMPL_TPCD /* 집행유형코드 */,
    A.VIOL_SECD /* 비위구분코드 */,
    SUM(A.CNT0) AS CNT0
FROM ( SELECT A.IMPL_TPCD /* 집행유형코드 */,
    B.VIOL_SECD /* 비위구분코드 */,
    A.RLPR_JBGD_SECD /* 관계자직급구분코드 */,
    1
FROM TBBADGDA001L A, /* 통보사항관계자내역 */ TBBADGDA001M B /* 통보사항 기본*/ WHERE 1=1 AND A.INST_CD = B.INST_CD AND A.NTFCTN_SECD = B.NTFCTN_SECD AND A.NTFCTN_SQNO = B.NTFCTN_SQNO AND A.NTFCTN_SECD = '1' AND A.RLPR_JBGD_SECD BETWEEN '00' AND '10' AND B.NTFCTN_RCPT_YMD BETWEEN #strStrDt# AND #strEndDt# AND B.STT_RCPT_STTS_SECD != '51' AND (B.PRCS_OPNN_SECD IS NULL OR B.PRCS_OPNN_SECD != '8') /* 처리결과가 참고자료는 제외 - 2015.06.30 */ AND B.SRECS_DEPT_CD IN (SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TABLE(F_AUTH_DEPT(#strCnb#, #strDptAuth#, '', #strDptCd#))) AND B.SRECS_DEPT_CD = #SRECS_DEPT_CD# ) A GROUP BY A.IMPL_TPCD, A.VIOL_SECD ) A, ( SELECT A.CD AS IMPL_TPCD,
    A.CD_NM,
    B.CD AS VIOL_SECD,
    B.CD_NM AS VIOL_NM
FROM TBDCMACM013C A, /* 공통코드 */ TBDCMACM013C B /* 공통코드 */ WHERE 1=1 AND A.CMM_CD_DVSN_CD = '1000003' AND A.CD IN ('210', '220', '230', '260', '270') AND B.CMM_CD_DVSN_CD = '1000241' AND B.CD != '000000000' ) B WHERE 1=1 AND A.IMPL_TPCD (+)= B.IMPL_TPCD AND A.VIOL_SECD (+)= B.VIOL_SECD ORDER BY IMPL_TPCD, VIOL_SECD