SELECT CASE WHEN A.SRECS_DEPT_CD IS NULL THEN '계' ELSE (SELECT AS SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TBDCMACM002M WHERE SRECS_DEPT_CD = A.SRECS_DEPT_CD) END AS SE_NM, TO_CHAR(NVL(SUM(A.CNT1),0) + NVL(SUM(A.CNT2),0) + NVL(SUM(A.CNT3),0) ,'999,999,999,999') AS TOT, TO_CHAR(NVL(SUM(CNT1),0),'999,999,999,999') AS TOT_1, TO_CHAR(NVL(SUM(CNT2),0),'999,999,999,999') AS TOT_2, TO_CHAR(NVL(SUM(CNT3),0),'999,999,999,999') AS TOT_3 FROM ( SELECT SUBSTR(SRECS_DEPT_CD,0,3) || '000' AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    DECODE(A.NTFCTN_SECD, '1', 1) AS NTFCTN_SECD /* 통보구분코드 */,
    DECODE(A.NTFCTN_SECD, '2', 1) AS NTFCTN_SECD /* 통보구분코드 */,
    0
FROM TBBADGDA001M A, ( SELECT INST_CD /* 기관코드 */,
    NTFCTN_SECD /* 통보구분코드 */,
    NTFCTN_SQNO /* 통보순번 */,
    COUNT(*) AS PSON_CNT
FROM TBBADGDA001L WHERE 1=1 GROUP BY INST_CD, NTFCTN_SECD, NTFCTN_SQNO) B WHERE 1=1 AND A.INST_CD = B.INST_CD (+) AND A.NTFCTN_SECD = B.NTFCTN_SECD (+) AND A.NTFCTN_SQNO = B.NTFCTN_SQNO (+) AND A.STT_RCPT_STTS_SECD != '51' AND (A.PRCS_OPNN_SECD IS NULL OR A.PRCS_OPNN_SECD != '8') AND ((A.NTFCTN_RCPT_YMD BETWEEN #strStrDt# AND #strEndDt#) OR (#strStrDt# > A.NTFCTN_RCPT_YMD AND (#strStrDt# A.NTFCTN_RCPT_YMD AND (#strStrDt# <= A.CPLT_YMD OR A.CPLT_YMD IS NULL ) ) ) AND CASE WHEN (A.CPLT_YMD BETWEEN #strStrDt# AND #strEndDt#) THEN '' ELSE '1' END = '1' AND A.SRECS_DEPT_CD IN (SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TABLE(F_AUTH_DEPT(#strCnb#, #strDptAuth#, '', #strDptCd#))) AND A.SRECS_DEPT_CD = (CASE WHEN #strDptCd2# IS NULL THEN A.SRECS_DEPT_CD ELSE #strDptCd2# END) ) A GROUP BY ROLLUP(A.SRECS_DEPT_CD) ORDER BY CASE WHEN A.SRECS_DEPT_CD IS NULL THEN 1 ELSE 2 END ,(SELECT DPT_SNO
FROM TBDCMACM002M WHERE SRECS_DEPT_CD = A.SRECS_DEPT_CD)