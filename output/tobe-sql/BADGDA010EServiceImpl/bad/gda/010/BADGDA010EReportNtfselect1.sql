SELECT CASE WHEN B.STAT_CD = 'A' THEN '총접수계' WHEN B.STAT_CD = 'B' THEN '이월건수' WHEN B.STAT_CD = 'C' THEN '신규접수건수' WHEN B.STAT_CD = 'D' THEN '처리건수' WHEN B.STAT_CD = 'E' THEN '처리중건수' END AS STAT_CD,
    TO_CHAR(NVL(SUM(A.CNT1),0) + NVL(SUM(A.CNT2),0) + NVL(SUM(A.CNT3),0) + NVL(SUM(A.CNT4),0),'999,999,999,999') AS TO_CHAR,
    /* 범죄 및 징계만 인원수를 보여준다 - 2015.07.14 yyh */ /* TO_CHAR(NVL(SUM(A.PSON_CNT1),0) + NVL(SUM(A.PSON_CNT2),0),'999,999,999,999') AS PSON_CNT0, */ TO_CHAR(NVL(SUM(A.PSON_CNT1),0),'999,999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(SUM(CNT1),0),'999,999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(SUM(PSON_CNT1),0),'999,999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(SUM(CNT2),0),'999,999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(SUM(PSON_CNT2),0),'999,999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(SUM(CNT3),0),'999,999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(SUM(CNT4),0),'999,999,999,999') AS TO_CHAR
FROM ( SELECT CASE WHEN (A.NTFCTN_RCPT_YMD BETWEEN #strStrDt# AND #strEndDt#) THEN 'C' ELSE 'B' END AS NTFCTN_RCPT_YMD /* 통보접수일자 */,
    DECODE(A.NTFCTN_SECD, '1', 1) AS NTFCTN_SECD /* 통보구분코드 */,
    DECODE(A.NTFCTN_SECD, '1', B.PSON_CNT) AS NTFCTN_SECD /* 통보구분코드 */,
    DECODE(A.NTFCTN_SECD, '2', 1) AS NTFCTN_SECD /* 통보구분코드 */,
    DECODE(A.NTFCTN_SECD, '2', B.PSON_CNT) AS NTFCTN_SECD /* 통보구분코드 */,
    0,
    0
FROM TBBADGDA001M A, ( SELECT INST_CD /* 기관코드 */,
    NTFCTN_SECD /* 통보구분코드 */,
    NTFCTN_SQNO /* 통보순번 */,
    COUNT(*) AS PSON_CNT
FROM TBBADGDA001L WHERE 1=1 GROUP BY INST_CD, NTFCTN_SECD, NTFCTN_SQNO) B WHERE 1=1 AND A.INST_CD = B.INST_CD (+ ) AND A.NTFCTN_SECD = B.NTFCTN_SECD (+) AND A.NTFCTN_SQNO = B.NTFCTN_SQNO (+) AND A.STT_RCPT_STTS_SECD != '51' AND (A.PRCS_OPNN_SECD IS NULL OR A.PRCS_OPNN_SECD != '8') /* 처리결과가 참고자료는 제외 - 2015.06.30 */ AND ((A.NTFCTN_RCPT_YMD BETWEEN #strStrDt# AND #strEndDt#) OR (#strStrDt# > A.NTFCTN_RCPT_YMD AND (#strStrDt# A.NTFCTN_RCPT_YMD AND (#strStrDt# A.NTFCTN_RCPT_YMD AND (#strStrDt# A.NTFCTN_RCPT_YMD AND (#strStrDt# A.NTFCTN_RCPT_YMD AND (#strStrDt# A.NTFCTN_RCPT_YMD AND (#strStrDt# <= A.CPLT_YMD OR A.CPLT_YMD IS NULL ) ) ) AND A.SRECS_DEPT_CD IN (SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */
FROM TABLE(F_AUTH_DEPT(#strCnb#, #strDptAuth#, '', #strDptCd#))) AND A.SRECS_DEPT_CD = (CASE WHEN #strDptCd2# IS NULL THEN A.SRECS_DEPT_CD ELSE #strDptCd2# END) ) A, (SELECT CHR(64+LEVEL) AS CHR
FROM DUAL CONNECT BY LEVEL < 6) B WHERE A.STAT_CD (+)= B.STAT_CD GROUP BY B.STAT_CD ORDER BY B.STAT_CD