SELECT L1.PRCS_OPNN_SECD /* 처리의견구분코드 */,
    F_CODE_NM('1000200', L1.PRCS_OPNN_SECD) AS F_CODE_NM,
    TO_CHAR(NVL(M1.CNT1, 0),'999,999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(M1.CNT2, 0),'999,999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(M2.CNT3, 0),'999,999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(M2.CNT4, 0),'999,999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(M1.CNT1, 0)+NVL(M1.CNT2, 0)+NVL(M2.CNT3, 0)+NVL(M2.CNT4, 0),'999,999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(M1.PSON_CNT1, 0),'999,999,999,999') AS TO_CHAR,
    TO_CHAR(NVL(M1.PSON_CNT2, 0),'999,999,999,999') AS TO_CHAR /* , TO_CHAR(NVL(M1.PSON_CNT1, 0) + NVL(M1.PSON_CNT2, 0),'999,999,999,999') AS PSON_CNT_TOT */,
    TO_CHAR(NVL(M1.PSON_CNT1, 0),'999,999,999,999') AS TO_CHAR
FROM ( SELECT S1.PRCS_OPNN_SECD /* 처리의견구분코드 */,
    SUM( CASE WHEN S1.NTFCTN_SECD = '1' THEN 1 ELSE 0 END ) AS NTFCTN_SECD /* 통보구분코드 */,
    SUM( CASE WHEN S1.NTFCTN_SECD = '1' THEN S2.PSON_CNT ELSE 0 END ) AS NTFCTN_SECD /* 통보구분코드 */,
    SUM( CASE WHEN S1.NTFCTN_SECD = '2' THEN 1 ELSE 0 END ) AS NTFCTN_SECD /* 통보구분코드 */,
    SUM( CASE WHEN S1.NTFCTN_SECD = '2' THEN S2.PSON_CNT ELSE 0 END ) AS NTFCTN_SECD /* 통보구분코드 */
FROM TBBADGDA001M S1 ,(SELECT INST_CD /* 기관코드 */,
    NTFCTN_SECD /* 통보구분코드 */,
    NTFCTN_SQNO /* 통보순번 */,
    COUNT(*) AS PSON_CNT
FROM TBBADGDA001L WHERE 1=1 GROUP BY INST_CD ,NTFCTN_SECD ,NTFCTN_SQNO) S2 WHERE 1 = 1 AND S1.INST_CD = S2.INST_CD (+ ) AND S1.NTFCTN_SECD = S2.NTFCTN_SECD (+) AND S1.NTFCTN_SQNO = S2.NTFCTN_SQNO (+) AND S1.STT_RCPT_STTS_SECD != '51' AND S1.PRCS_OPNN_SECD != '8' /* 처리결과가 참고자료는 제외 - 2015.06.30 */ AND ((S1.NTFCTN_RCPT_YMD BETWEEN #strStrDt# AND #strEndDt#) OR (#strStrDt# > S1.NTFCTN_RCPT_YMD AND (#strStrDt# AND S1.SRECS_DEPT_CD = #SRECS_DEPT_CD# GROUP BY S1.PRCS_OPNN_SECD ) M1 , ( SELECT S1.PRCS_OPNN_SECD /* 처리의견구분코드 */,
    SUM( CASE WHEN S1.NTFCTN_STT_NTFCTN_SECD = '100' THEN 1 ELSE 0 END ) AS NTFCTN_STT_NTFCTN_SECD /* 통보법령통보구분코드 */,
    SUM( CASE WHEN S1.NTFCTN_STT_NTFCTN_SECD = '200' THEN 1 ELSE 0 END ) AS NTFCTN_STT_NTFCTN_SECD /* 통보법령통보구분코드 */
FROM TBBADGDA004M S1 WHERE 1 = 1 AND S1.STT_RCPT_STTS_SECD != '51' AND S1.PRCS_OPNN_SECD != '8' /* 처리결과가 참고자료는 제외 - 2015.06.30 */ AND ((S1.NTFCTN_RCPT_YMD BETWEEN #strStrDt# AND #strEndDt#) OR (#strStrDt# > S1.NTFCTN_RCPT_YMD AND (#strStrDt# AND S1.SRECS_DEPT_CD = #SRECS_DEPT_CD# GROUP BY S1.PRCS_OPNN_SECD ) M2 , ( SELECT LEVEL AS PRCS_OPNN_SECD
FROM DUAL CONNECT BY LEVEL < 11 ) L1 WHERE 1 = 1 AND L1.PRCS_OPNN_SECD = M1.PRCS_OPNN_SECD(+) AND L1.PRCS_OPNN_SECD = M2.PRCS_OPNN_SECD(+) AND L1.PRCS_OPNN_SECD != '8' ORDER BY L1.PRCS_OPNN_SECD