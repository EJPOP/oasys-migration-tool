SELECT A.WRT_YMD /* 작성일자 */,
    (A.MOP_STF_CNT_1_1 + A.NOMOP_TMPTR_STF_CNT_1_1 + A.OW_ATC_ASO_CNT_1_1) AS MOP_STF_CNT_1_1,
    (A.MOP_STF_CNT_2_1 + A.NOMOP_TMPTR_STF_CNT_2_1 + A.OW_ATC_ASO_CNT_2_1) AS MOP_STF_CNT_2_1,
    (A.MOP_STF_CNT_3_1 + A.NOMOP_TMPTR_STF_CNT_3_1 + A.OW_ATC_ASO_CNT_3_1) AS MOP_STF_CNT_3_1,
    ((A.MOP_STF_CNT_5_1 + A.MOP_STF_CNT_6_1 + A.MOP_STF_CNT_7_1) + A.NOMOP_TMPTR_STF_CNT_4_1 + OW_ATC_ASO_CNT_5_1+OW_ATC_ASO_CNT_6_1+OW_ATC_ASO_CNT_7_1) AS MOP_STF_CNT_5_1,
    (A.MOP_STF_CNT_5_1 + A.NOMOP_TMPTR_STF_CNT_5_1 + A.OW_ATC_ASO_CNT_5_1) AS MOP_STF_CNT_5_1,
    (A.MOP_STF_CNT_6_1 + A.NOMOP_TMPTR_STF_CNT_6_1 + A.OW_ATC_ASO_CNT_6_1) AS MOP_STF_CNT_6_1,
    (A.MOP_STF_CNT_7_1 + A.NOMOP_TMPTR_STF_CNT_7_1 + A.OW_ATC_ASO_CNT_7_1) AS MOP_STF_CNT_7_1,
    ((A.MOP_STF_CNT_1_1 - (A.MOP_STF_CNT_2_1 + A.MOP_STF_CNT_3_1 + A.MOP_STF_CNT_5_1 + A.MOP_STF_CNT_6_1 + A.MOP_STF_CNT_7_1)) + (A.NOMOP_TMPTR_STF_CNT_1_1 - (A.NOMOP_TMPTR_STF_CNT_2_1 + A.NOMOP_TMPTR_STF_CNT_3_1 + A.NOMOP_TMPTR_STF_CNT_4_1)) + (A.OW_ATC_ASO_CNT_1_1 - (A.OW_ATC_ASO_CNT_2_1+OW_ATC_ASO_CNT_5_1+OW_ATC_ASO_CNT_6_1+OW_ATC_ASO_CNT_7_1))) AS MOP_STF_CNT_1_1,
    A.MOP_STF_CNT_1_1,
    A.MOP_STF_CNT_2_1,
    A.MOP_STF_CNT_3_1,
    (A.MOP_STF_CNT_5_1 + A.MOP_STF_CNT_6_1 + A.MOP_STF_CNT_7_1) AS MOP_STF_CNT_5_1,
    A.MOP_STF_CNT_5_1,
    A.MOP_STF_CNT_6_1,
    A.MOP_STF_CNT_7_1,
    (A.MOP_STF_CNT_1_1 - (A.MOP_STF_CNT_2_1+A.MOP_STF_CNT_3_1+A.MOP_STF_CNT_5_1+A.MOP_STF_CNT_6_1+A.MOP_STF_CNT_7_1)) AS MOP_STF_CNT_1_1,
    A.NOMOP_TMPTR_STF_CNT_1_1,
    A.NOMOP_TMPTR_STF_CNT_2_1,
    A.NOMOP_TMPTR_STF_CNT_3_1,
    A.NOMOP_TMPTR_STF_CNT_4_1,
    A.NOMOP_TMPTR_STF_CNT_5_1,
    A.NOMOP_TMPTR_STF_CNT_6_1,
    A.NOMOP_TMPTR_STF_CNT_7_1,
    (A.NOMOP_TMPTR_STF_CNT_1_1 - (A.NOMOP_TMPTR_STF_CNT_2_1+A.NOMOP_TMPTR_STF_CNT_3_1+ A.NOMOP_TMPTR_STF_CNT_4_1)) AS NOMOP_TMPTR_STF_CNT_1_1,
    A.OW_ATC_ASO_CNT_1_1,
    A.OW_ATC_ASO_CNT_2_1,
    A.OW_ATC_ASO_CNT_3_1,
    (OW_ATC_ASO_CNT_5_1+OW_ATC_ASO_CNT_6_1+OW_ATC_ASO_CNT_7_1) AS OW_ATC_ASO_CNT_5_1,
    A.OW_ATC_ASO_CNT_5_1,
    A.OW_ATC_ASO_CNT_6_1,
    A.OW_ATC_ASO_CNT_7_1,
    (A.OW_ATC_ASO_CNT_1_1 - (A.OW_ATC_ASO_CNT_2_1 +OW_ATC_ASO_CNT_5_1+OW_ATC_ASO_CNT_6_1+OW_ATC_ASO_CNT_7_1)) AS OW_ATC_ASO_CNT_1_1,
    B.WRT_YMD AS WRT_YMD /* 작성일자 */,
    NVL(B.NOP_CNT_1,0) AS NOP_CNT_1,
    NVL(B.NOP_CNT_2,0) AS NOP_CNT_2,
    NVL(B.NOP_CNT_3,0) AS NOP_CNT_3,
    NVL(B.NOP_CNT_4,0) AS NOP_CNT_4,
    NVL(B.NOP_CNT_5,0) AS NOP_CNT_5,
    NVL(B.NOP_CNT_6,0) AS NOP_CNT_6,
    NVL(B.NOP_CNT_7,0) AS NOP_CNT_7,
    NVL(B.NOP_CNT_8,0) AS NOP_CNT_8,
    NVL(B.MOP_STF_CNT_1,0) AS MOP_STF_CNT_1,
    NVL(B.MOP_STF_CNT_2,0) AS MOP_STF_CNT_2,
    NVL(B.MOP_STF_CNT_3,0) AS MOP_STF_CNT_3,
    NVL(B.MOP_STF_CNT_4,0) AS MOP_STF_CNT_4,
    NVL(B.MOP_STF_CNT_5,0) AS MOP_STF_CNT_5,
    NVL(B.MOP_STF_CNT_6,0) AS MOP_STF_CNT_6,
    NVL(B.MOP_STF_CNT_7,0) AS MOP_STF_CNT_7,
    NVL(B.MOP_STF_CNT_8,0) AS MOP_STF_CNT_8,
    NVL(B.NOMOP_TMPTR_STF_CNT_1,0) AS NOMOP_TMPTR_STF_CNT_1,
    NVL(B.NOMOP_TMPTR_STF_CNT_2,0) AS NOMOP_TMPTR_STF_CNT_2,
    NVL(B.NOMOP_TMPTR_STF_CNT_3,0) AS NOMOP_TMPTR_STF_CNT_3,
    NVL(B.NOMOP_TMPTR_STF_CNT_4,0) AS NOMOP_TMPTR_STF_CNT_4,
    NVL(B.NOMOP_TMPTR_STF_CNT_5,0) AS NOMOP_TMPTR_STF_CNT_5,
    NVL(B.NOMOP_TMPTR_STF_CNT_6,0) AS NOMOP_TMPTR_STF_CNT_6,
    NVL(B.NOMOP_TMPTR_STF_CNT_7,0) AS NOMOP_TMPTR_STF_CNT_7,
    NVL(B.NOMOP_TMPTR_STF_CNT_8,0) AS NOMOP_TMPTR_STF_CNT_8,
    NVL(B.OW_ATC_ASO_CNT_1,0) AS OW_ATC_ASO_CNT_1,
    NVL(B.OW_ATC_ASO_CNT_2,0) AS OW_ATC_ASO_CNT_2,
    NVL(B.OW_ATC_ASO_CNT_3,0) AS OW_ATC_ASO_CNT_3,
    NVL(B.OW_ATC_ASO_CNT_4,0) AS OW_ATC_ASO_CNT_4,
    NVL(B.OW_ATC_ASO_CNT_5,0) AS OW_ATC_ASO_CNT_5,
    NVL(B.OW_ATC_ASO_CNT_6,0) AS OW_ATC_ASO_CNT_6,
    NVL(B.OW_ATC_ASO_CNT_7,0) AS OW_ATC_ASO_CNT_7,
    NVL(B.OW_ATC_ASO_CNT_8,0) AS OW_ATC_ASO_CNT_8,
    B.NOP_MDF_DH AS NOP_MDF_DH
FROM ( SELECT (SELECT #BZTRP_BGNG_YMD# AS WRT_YMD /* 작성일자 */
FROM DUAL ) AS WRT_YMD , (/* 당원직원 총원 */ SELECT COUNT(*)
FROM TBDCMACM001M T1 ,TBDCMACM002M T2 WHERE 1=1 AND T1.SRECS_DEPT_CD <> '880880' AND T1.SRECS_DEPT_CD = T2.SRECS_DEPT_CD AND T2.LOC_DVSN_CD = 'I' AND T1.CRNT_DPT_APM_DT IS NOT NULL AND T1.USER_ID NOT LIKE 'test%' AND T1.HDOF_SECD LIKE 'A%' AND T1.RQS_STA_CD = '3' AND T1.USR_DVSN_CD = '1' ) AS MOP_STF_CNT_1_1, (/* 당원직원 감사출장 */ SELECT COUNT(1)
FROM ( SELECT DISTINCT B.BZTRVR_ENO AS BZTRVR_ENO /* 출장자직원전산번호 */
FROM TBBADDED002M A, TBBADDED011L B, TBDCMACM002M C, TBDCMACM001M D WHERE 1=1 AND A.BZTRP_YR = B.BZTRP_YR AND A.BZTRP_SQNO = B.BZTRP_SQNO AND B.BZTRP_BGNG_YMD = #BZTRP_BGNG_YMD# AND A.BZTRP_SECD = '1' AND B.BZTRVR_ENO = D.TRGT_NOP_ENO AND D.SRECS_DEPT_CD = C.SRECS_DEPT_CD AND LOC_DVSN_CD = 'I' AND DPT_TP_CD_2 = 'A' AND D.USR_DVSN_CD ='1' ) ) AS MOP_STF_CNT_2_1, (/* 당원직원 일반출장 */ SELECT COUNT(1)
FROM ( SELECT DISTINCT B.BZTRVR_ENO AS BZTRVR_ENO /* 출장자직원전산번호 */
FROM TBBADDED002M A, TBBADDED011L B, TBDCMACM002M C, TBDCMACM001M D WHERE 1=1 AND A.BZTRP_YR = B.BZTRP_YR AND A.BZTRP_SQNO = B.BZTRP_SQNO AND B.BZTRP_BGNG_YMD = #BZTRP_BGNG_YMD# AND A.BZTRP_SECD = '2' AND B.BZTRVR_ENO = D.TRGT_NOP_ENO AND D.SRECS_DEPT_CD = C.SRECS_DEPT_CD AND LOC_DVSN_CD = 'I' AND DPT_TP_CD_2 = 'A' AND D.USR_DVSN_CD ='1' ) ) AS MOP_STF_CNT_3_1, (/* 파견 */ SELECT COUNT(*)
FROM TBDCMACM001M T1, TBDCMACM002M T2 WHERE HDOF_SECD LIKE 'AAB' AND T1.SRECS_DEPT_CD = T2.SRECS_DEPT_CD AND T1.RQS_STA_CD = '3' AND T2.LOC_DVSN_CD = 'I' AND USR_DVSN_CD ='1' ) AS MOP_STF_CNT_5_1, (/* 휴가자 */ SELECT COUNT(1)
FROM TBDCMACM001M T1, TBDCMACM002M T2 WHERE VAC_YN = 'Y' AND T1.SRECS_DEPT_CD = T2.SRECS_DEPT_CD AND T1.RQS_STA_CD = '3' AND T2.LOC_DVSN_CD = 'I' AND USR_DVSN_CD ='1' ) AS MOP_STF_CNT_6_1, (/* 휴직자 */ SELECT COUNT(*)
FROM TBDCMACM001M T1 , TBDCMACM002M T2 WHERE HDOF_SECD LIKE 'AB%' AND T1.SRECS_DEPT_CD = T2.SRECS_DEPT_CD AND T1.RQS_STA_CD = '3' AND T2.LOC_DVSN_CD = 'I' AND T1.USR_DVSN_CD ='1' ) AS MOP_STF_CNT_7_1, (/* 수견 */ SELECT COUNT(1)
FROM TBDCMACM001M T1 , TBDCMACM002M T2 WHERE T1.SRECS_DEPT_CD = T2.SRECS_DEPT_CD AND RQS_STA_CD = '3' AND USR_DVSN_CD = '2' AND T2.LOC_DVSN_CD = 'I' ) AS NOMOP_TMPTR_STF_CNT_1_1, (/* 수견 감사출장 */ SELECT COUNT(1)
FROM ( SELECT DISTINCT B.BZTRVR_ENO AS BZTRVR_ENO /* 출장자직원전산번호 */
FROM TBBADDED002M A, TBBADDED011L B, TBDCMACM002M C, TBDCMACM001M D WHERE 1=1 AND A.BZTRP_YR = B.BZTRP_YR AND A.BZTRP_SQNO = B.BZTRP_SQNO AND B.BZTRP_BGNG_YMD = #BZTRP_BGNG_YMD# AND A.BZTRP_SECD = '1' AND B.BZTRVR_ENO = D.TRGT_NOP_ENO AND D.SRECS_DEPT_CD = C.SRECS_DEPT_CD AND LOC_DVSN_CD = 'I' AND DPT_TP_CD_2 = 'A' AND D.USR_DVSN_CD ='2' )) AS NOMOP_TMPTR_STF_CNT_2_1, (/* 수견 일반출장 */ SELECT COUNT(1)
FROM ( SELECT DISTINCT B.BZTRVR_ENO AS BZTRVR_ENO /* 출장자직원전산번호 */
FROM TBBADDED002M A, TBBADDED011L B, TBDCMACM002M C, TBDCMACM001M D WHERE 1=1 AND A.BZTRP_YR = B.BZTRP_YR AND A.BZTRP_SQNO = B.BZTRP_SQNO AND B.BZTRP_BGNG_YMD = #BZTRP_BGNG_YMD# AND A.BZTRP_SECD = '2' AND B.BZTRVR_ENO = D.TRGT_NOP_ENO AND D.SRECS_DEPT_CD = C.SRECS_DEPT_CD AND LOC_DVSN_CD = 'I' AND DPT_TP_CD_2 = 'A' AND D.USR_DVSN_CD ='2' ) ) AS NOMOP_TMPTR_STF_CNT_3_1, 0 AS NOMOP_TMPTR_STF_CNT_4_1, 0 AS NOMOP_TMPTR_STF_CNT_5_1, 0 AS NOMOP_TMPTR_STF_CNT_6_1, 0 AS NOMOP_TMPTR_STF_CNT_7_1, (/* 사무 보조원 등(차출) */ SELECT COUNT(1)
FROM TBDCMACM001M T1, TBDCMACM002M T2 WHERE T1.SRECS_DEPT_CD = T2.SRECS_DEPT_CD AND T1.USR_DVSN_CD IN ('3','4') AND RQS_STA_CD = '3' AND UPPER(USER_ID) NOT LIKE 'TEST%' AND T2.LOC_DVSN_CD = 'I' ) AS OW_ATC_ASO_CNT_1_1, 0 AS OW_ATC_ASO_CNT_2_1, 0 AS OW_ATC_ASO_CNT_3_1, 0 AS OW_ATC_ASO_CNT_4_1, (SELECT COUNT(*)
FROM TBDCMACM909O WHERE HDOF_SECD LIKE 'AAB%') AS OW_ATC_ASO_CNT_5_1, 0 AS OW_ATC_ASO_CNT_6_1, (SELECT COUNT(*)
FROM TBDCMACM909O WHERE HDOF_SECD LIKE 'AB%') AS OW_ATC_ASO_CNT_7_1 FROM DUAL ) A, TBCSPMWF001M B WHERE A.WRT_YMD = B.WRT_YMD(+) AND B.WRT_YMD(+) = #BZTRP_BGNG_YMD#