SELECT A.CVLCPT_RCPT_YR /* 민원접수년도 */,
    A.ACP_CNT,
    A.CNT1,
    A.CNT2,
    A.CNT3,
    A.CNT4,
    A.CNT5,
    A.CNT55,
    A.CNT6,
    A.CNT7,
    A.CNT8,
    A.CNT9,
    A.CNT10,
    ROUND(A.AVG_DAY1) AS ROUND,
    ROUND(A.AVG_DAY2) AS ROUND,
    ROUND(A.AVG_DAY3) AS ROUND,
    ROUND(A.RTE) AS ROUND
FROM ( SELECT A.CVLCPT_RCPT_YR /* 민원접수년도 */,
    A.ACP_CNT,
    (A.CNT2+A.CNT3+A.CNT4+A.CNT5+A.CNT55+A.CNT6+A.CNT7) AS CNT2,
    A.CNT2,
    A.CNT3,
    A.CNT4,
    A.CNT5,
    A.CNT55,
    A.CNT6,
    A.CNT7,
    (A.CNT10+A.CNT9) AS CNT10,
    A.CNT9,
    A.CNT10,
    DECODE(DAY1_CNT,0,0,A.DAY1/A.DAY1_CNT) AS DAY1_CNT,
    DECODE(DAY1_CNT,0,0,A.DAY2/A.DAY1_CNT) AS DAY1_CNT,
    DECODE(DAY1_CNT,0,0,A.DAY3/A.DAY1_CNT) AS DAY1_CNT,
    DECODE((A.CNT2+A.CNT3+A.CNT4+A.CNT9),0,0,((A.CNT2+A.CNT3+A.CNT9)/(A.CNT2+A.CNT3+A.CNT4+A.CNT9))*100) AS CNT2
FROM ( SELECT A.TPOF_RCPT_YR /* 제보접수년도 */,
    COUNT(*) AS ACP_CNT,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD ='06' THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD ='07' THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD IN ('02','04') THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD ='03' AND (B.PREI_RJTN_RSN_SECD IS NULL OR B.PREI_RJTN_RSN_SECD <> '0300' ) THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD ='03' AND B.PREI_RJTN_RSN_SECD = '0300' THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD ='08' THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD ='05' THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD IN ('150','160') THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD IN ('20','23','30','110','120','125','130','140') THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '01' THEN TO_DATE(RVW_RPT_ATRZ_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '02' THEN TO_DATE(RVW_RPT_ATRZ_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '03' THEN TO_DATE(RVW_RPT_ATRZ_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '04' THEN TO_DATE(RVW_RPT_ATRZ_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN A.TPOF_STTS_SECD ='170' AND PREI_RJTN_YN = 'Y' THEN TO_DATE(PREI_ATRZ_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD = '08' THEN TO_DATE(TO_CHAR(A.TPOF_DISCON_DT,'YYYYMMDD')) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) ELSE 0 END) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '01' THEN 1 WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '02' THEN 1 WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '03' THEN 1 WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '04' THEN 1 WHEN A.TPOF_STTS_SECD ='170' AND PREI_RJTN_YN = 'Y' THEN 1 WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD = '08' THEN 1 ELSE 0 END) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '01' THEN TO_DATE(RVW_RSLT_RPLY_YMD) - TO_DATE(RVW_RPT_ATRZ_YMD) WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '02' THEN TO_DATE(RVW_RSLT_RPLY_YMD) - TO_DATE(RVW_RPT_ATRZ_YMD) WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '03' THEN TO_DATE(RVW_RSLT_RPLY_YMD) - TO_DATE(RVW_RPT_ATRZ_YMD) WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '04' THEN TO_DATE(RVW_RSLT_RPLY_YMD) - TO_DATE(RVW_RPT_ATRZ_YMD) WHEN A.TPOF_STTS_SECD ='170' AND PREI_RJTN_YN = 'Y' THEN TO_DATE(PREI_RPLY_YMD) - TO_DATE(PREI_ATRZ_YMD) WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD = '08' THEN TO_DATE(TO_CHAR(A.TPOF_DISCON_DT,'YYYYMMDD')) - TO_DATE(TO_CHAR(A.TPOF_DISCON_DT,'YYYYMMDD')) ELSE 0 END) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    SUM(CASE WHEN ADT_RSLT_SECD = '02' THEN TO_DATE(ADT_RSLT_RPLY_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN ADT_RSLT_SECD = '03' THEN TO_DATE(ADT_RSLT_RPLY_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN ADT_RSLT_SECD = '04' THEN TO_DATE(ADT_RSLT_RPLY_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN ADT_RSLT_SECD = '06' THEN TO_DATE(ADT_RSLT_RPLY_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN ADT_RSLT_SECD = '07' THEN TO_DATE(ADT_RSLT_RPLY_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN ADT_RSLT_SECD = '08' THEN TO_DATE(TO_CHAR(A.TPOF_DISCON_DT,'YYYYMMDD')) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) ELSE 0 END) AS ADT_RSLT_SECD /* 감사결과구분코드 */
FROM TBCSPDCP101M A, TBCSPEAR001M B WHERE A.CLM_SECD = '2' AND A.CLM_SECD = B.CLM_SECD (+) AND A.CVLCPT_RCPT_YR = B.CVLCPT_RCPT_YR (+) AND A.CVLCPT_RCPT_RCPT = B.CVLCPT_RCPT_RCPT(+) AND A.CRU_PRCS_PRCS_STTS NOT IN ('10','21') AND TO_CHAR(A.CRU_RCPT_DT,'YYYYMMDD') &gt; #strDTS# AND TO_CHAR(A.CRU_RCPT_DT,'YYYYMMDD') &lt; #strDTE# AND (B.ADT_RSLT_RPLY_YMD &gt; #strDTS# OR TO_CHAR(A.TPOF_DISCON_DT,'YYYYMMDD') &gt; #strDTS#) AND (B.ADT_RSLT_RPLY_YMD &lt; #strDTE# OR TO_CHAR(A.TPOF_DISCON_DT,'YYYYMMDD') &lt; #strDTE#) GROUP BY A.CVLCPT_RCPT_YR ) A UNION ALL SELECT A.CVLCPT_RCPT_YR /* 민원접수년도 */,
    A.ACP_CNT,
    (A.CNT2+A.CNT3+A.CNT4+A.CNT5+A.CNT55+A.CNT6+A.CNT7) AS CNT2,
    A.CNT2,
    A.CNT3,
    A.CNT4,
    A.CNT5,
    A.CNT55,
    A.CNT6,
    A.CNT7,
    (A.CNT10+A.CNT9) AS CNT10,
    A.CNT9,
    A.CNT10,
    DECODE(DAY1_CNT,0,0,A.DAY1/A.DAY1_CNT) AS DAY1_CNT,
    DECODE(DAY1_CNT,0,0,A.DAY2/A.DAY1_CNT) AS DAY1_CNT,
    DECODE(DAY1_CNT,0,0,A.DAY3/A.DAY1_CNT) AS DAY1_CNT,
    DECODE((A.CNT2+A.CNT3+A.CNT4+A.CNT9),0,0,((A.CNT2+A.CNT3+A.CNT9)/(A.CNT2+A.CNT3+A.CNT4+A.CNT9))*100) AS CNT2
FROM ( SELECT '합계' AS CVLCPT_RCPT_YR /* 민원접수년도 */,
    COUNT(*) AS ACP_CNT,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD ='06' THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD ='07' THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD IN ('02','04') THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD ='03' AND (B.PREI_RJTN_RSN_SECD IS NULL OR B.PREI_RJTN_RSN_SECD <> '0300' ) THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD ='03' AND B.PREI_RJTN_RSN_SECD = '0300' THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD ='08' THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD ='05' THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD IN ('150','160') THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    NVL(SUM(CASE WHEN A.TPOF_STTS_SECD IN ('20','23','30','110','120','125','130','140') THEN 1 ELSE 0 END),0) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '01' THEN TO_DATE(RVW_RPT_ATRZ_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '02' THEN TO_DATE(RVW_RPT_ATRZ_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '03' THEN TO_DATE(RVW_RPT_ATRZ_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '04' THEN TO_DATE(RVW_RPT_ATRZ_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN A.TPOF_STTS_SECD ='170' AND PREI_RJTN_YN = 'Y' THEN TO_DATE(PREI_ATRZ_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD = '08' THEN TO_DATE(TO_CHAR(A.TPOF_DISCON_DT,'YYYYMMDD')) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) ELSE 0 END) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '01' THEN 1 WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '02' THEN 1 WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '03' THEN 1 WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '04' THEN 1 WHEN A.TPOF_STTS_SECD ='170' AND PREI_RJTN_YN = 'Y' THEN 1 WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD = '08' THEN 1 ELSE 0 END) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    SUM(CASE WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '01' THEN TO_DATE(RVW_RSLT_RPLY_YMD) - TO_DATE(RVW_RPT_ATRZ_YMD) WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '02' THEN TO_DATE(RVW_RSLT_RPLY_YMD) - TO_DATE(RVW_RPT_ATRZ_YMD) WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '03' THEN TO_DATE(RVW_RSLT_RPLY_YMD) - TO_DATE(RVW_RPT_ATRZ_YMD) WHEN A.TPOF_STTS_SECD ='170' AND RVW_RSLT_SECD = '04' THEN TO_DATE(RVW_RSLT_RPLY_YMD) - TO_DATE(RVW_RPT_ATRZ_YMD) WHEN A.TPOF_STTS_SECD ='170' AND PREI_RJTN_YN = 'Y' THEN TO_DATE(PREI_RPLY_YMD) - TO_DATE(PREI_ATRZ_YMD) WHEN A.TPOF_STTS_SECD ='170' AND ADT_RSLT_SECD = '08' THEN TO_DATE(TO_CHAR(A.TPOF_DISCON_DT,'YYYYMMDD')) - TO_DATE(TO_CHAR(A.TPOF_DISCON_DT,'YYYYMMDD')) ELSE 0 END) AS TPOF_STTS_SECD /* 제보상태구분코드 */,
    SUM(CASE WHEN ADT_RSLT_SECD = '02' THEN TO_DATE(ADT_RSLT_RPLY_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN ADT_RSLT_SECD = '03' THEN TO_DATE(ADT_RSLT_RPLY_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN ADT_RSLT_SECD = '04' THEN TO_DATE(ADT_RSLT_RPLY_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN ADT_RSLT_SECD = '06' THEN TO_DATE(ADT_RSLT_RPLY_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN ADT_RSLT_SECD = '07' THEN TO_DATE(ADT_RSLT_RPLY_YMD) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) WHEN ADT_RSLT_SECD = '08' THEN TO_DATE(TO_CHAR(A.TPOF_DISCON_DT,'YYYYMMDD')) - TO_DATE(TO_CHAR(CRU_RCPT_DT,'YYYYMMDD')) ELSE 0 END) AS ADT_RSLT_SECD /* 감사결과구분코드 */
FROM TBCSPDCP101M A, TBCSPEAR001M B WHERE A.CLM_SECD = '2' AND A.CLM_SECD = B.CLM_SECD (+) AND A.CVLCPT_RCPT_YR = B.CVLCPT_RCPT_YR (+) AND A.CVLCPT_RCPT_RCPT = B.CVLCPT_RCPT_RCPT(+) AND A.CRU_PRCS_PRCS_STTS NOT IN ('10','21') AND TO_CHAR(A.CRU_RCPT_DT,'YYYYMMDD') &gt; #strDTS# AND TO_CHAR(A.CRU_RCPT_DT,'YYYYMMDD') &lt; #strDTE# AND (B.ADT_RSLT_RPLY_YMD &gt; #strDTS# OR TO_CHAR(A.TPOF_DISCON_DT,'YYYYMMDD') &gt; #strDTS#) AND (B.ADT_RSLT_RPLY_YMD &lt; #strDTE# OR TO_CHAR(A.TPOF_DISCON_DT,'YYYYMMDD') &lt; #strDTE#) ) A ) A