SELECT T1.CVLCPT_SECD /* 민원구분코드 */,
    T1.CVLCPT_RCPT_YR /* 민원접수년도 */,
    T1.CVLCPT_RCPT_NO /* 민원접수번호 */,
    T1.CVLCPT_MSG_SQNO /* 민원메시지순번 */,
    CASE WHEN T2.CUR_STATE = '0' THEN '전송요구' WHEN T2.CUR_STATE IN ('1','2') THEN '전송중' WHEN T2.CUR_STATE = '3' THEN '전송완료' ELSE NULL END AS CUR_STATE,
    TO_CHAR(T2.RSLT_DATE,'YYYY-MM-DD HH24:MI') AS TO_CHAR,
    TO_CHAR(T2.REQ_DATE,'YYYY-MM-DD HH24:MI') AS TO_CHAR,
    CASE WHEN T2.RSLT_CODE IS NULL THEN '전송중' WHEN T2.RSLT_CODE = '100' THEN '전송성공' ELSE '전송실패' END AS RSLT_CODE,
    T2.RSLT_CODE2,
    T2.CALL_TO,
    T2.CALL_FROM,
    T3.MMS_BODY
FROM TB_CSPCOR106H T1 ,MSG_DATA T2 ,MMS_CONTENTS_INFO T3 WHERE T1.CVLCPT_MSG_SQNO = T2.CVLCPT_MSG_SQNO AND T2.CONT_SEQ = T3.CONT_SEQ AND T1.CVLCPT_SECD = #CVLCPT_SECD# AND T1.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND T1.CVLCPT_RCPT_NO = #CVLCPT_RCPT_NO# ORDER BY T1.CVLCPT_MSG_SQNO DESC