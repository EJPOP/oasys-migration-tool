SELECT D2.ADT_YR /* 감사년도 */,
    D2.ADT_NO /* 감사번호 */,
    D3.CVLCPT_ADT_YR /* 민원감사년도 */,
    D3.ADT_NO /* 감사번호 */,
    F_MNG_KND_AUDYRNO(D2.ADT_YR, D2.ADT_NO, D2.ADT_KDCD, '-') AS ADT_CLSF_NO /* 감사분류번호 */,
    D2.ADT_KDCD /* 감사종류코드 */,
    F_CODE_NM('1000007',D2.ADT_KDCD) AS F_CODE_NM,
    D2.ADT_MTTR_NM /* 감사사항명 */,
    TO_DATE(D1.ADT_BGNG_YMD, 'YYYY-MM-DD') || ' ~ ' || TO_DATE(D1.ADT_END_YMD, 'YYYY-MM-DD') AS ADT_YMD /* 감사일자 */,
    D1.ADT_DCN /* 감사일수 */,
    F_DPT_INFO(D2.SPRVSN_DEPT_CD,'1') AS F_DPT_INFO,
    /*주관부서명*/ D3.SEL_YN,
    D3.RMRK_CN /* 비고내용 */,
    D2.ADT_RPRS_INST_CD /* 감사대표기관코드 */,
    F_ORG_INFO(D2.ADT_RPRS_INST_CD,'1') AS F_ORG_INFO,
    D1.ADT_BGNG_YMD /* 감사시작일자 */,
    D1.ADT_END_YMD /* 감사종료일자 */,
    D2.SPRVSN_DEPT_CD /* 주관부서코드 */,
    D3.CVLCPT_DOC_ID /* 민원문서아이디 */,
    F_CODE_NM('1000975',D3.SUP_YN) AS F_CODE_NM
FROM TB_BADDED002M D1 ,TB_BADDED001M D2 ,TBCSPIIT023M D3 WHERE D1.ADT_BGNG_YMD >= '20210201' AND D2.ADT_YR = D3.CVLCPT_ADT_YR(+) AND D2.ADT_NO = D3.ADT_NO(+) AND D2.ADT_YR = D1.REL_ADT_YR(+) AND D2.ADT_NO = D1.REL_ADT_NO(+) AND NOT SUBSTR(F_CODE_NM('1000007',D2.ADT_KDCD),1,2)='서면' AND NOT SUBSTR(F_CODE_NM('1000007',D2.ADT_KDCD),1,2)='확인' AND SUBSTR(D2.ADT_YR,1,4) = #strYr# AND (D2.ADT_MTTR_NM LIKE '%'||#strSEARCH_NM#||'%' OR D3.RMRK_CN LIKE '%'||#strSEARCH_NM#||'%' OR F_ORG_INFO(D2.ADT_RPRS_INST_CD,'1') LIKE '%'||#strSEARCH_NM#||'%') AND D3.SEL_YN = #strChk_SEL_YN# AND D3.SEL_YN = #strChk_SEL_YN# AND D3.SEL_YN = #strChk_SEL_YN# AND D2.SPRVSN_DEPT_CD = #SPRVSN_DEPT_CD# AND D3.SUP_YN = #strSUP_YN# AND D3.SUP_YN = #strSUP_YN#