DECLARE BEGIN INSERT INTO TBAEPGKM004L (KNB, TRGT_NOP_ENO, STRG_KLD_SNO, CTG_ID, STRG_KLD_DVSN_CD, FRST_USER_ID, LAST_USER_ID, LAST_PRCS_DEPT_CD, LAST_MENU_ID, FRST_REG_DT, LAST_MDFCN_DT) SELECT KNB,
    TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    ( SELECT NVL(MAX(STRG_KLD_SNO), 0)
FROM TBAEPGKM004L WHERE TRGT_NOP_ENO = #TRGT_NOP_ENO#) + (ROWNUM-1) AS STRG_KLD_SNO , #strCtgId# AS CTG_ID , 'BM' AS STRG_KLD_DVSN_CD , #FRT_USR_ID# , #FNL_USR_ID# , #FNL_DEAL_DPT_CD# , #FNL_MNU_ID# , SYSDATE , SYSDATE FROM TBAEPGKM002L WHERE TRGT_NOP_ENO = #TRGT_NOP_ENO# KNB IN TRIM(#strKnb[]#) ; DELETE TBAEPGKM002L WHERE TRGT_NOP_ENO = #TRGT_NOP_ENO# KNB IN TRIM(#strKnb[]#) ; END ;