SELECT F_USR_INFO(B.LAG_INV_CNB,'2') AS F_USR_INFO /* 대출자명 */,
    F_DPT_INFO(F_USR_INFO(B.LAG_INV_CNB,'5'), '1') AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    F_CODE_NM('1000173', F_USR_INFO(B.LAG_INV_CNB, '3')) AS F_CODE_NM /* 직급명 */,
    TO_CHAR(TO_DATE(B.BOO_LEND_DT),'YYYY-MM-DD') AS TO_CHAR /* 대출일자 */,
    TO_CHAR(TO_DATE(B.BOO_REN_DT), 'YYYY-MM-DD') AS TO_CHAR /* 도서반납일 */,
    DECODE(B.BOO_REN_YN_CD,'0',TO_CHAR(TO_DATE(B.BOO_REN_APT_DT),'YYYY-MM-DD'),'') AS BOO_REN_YN_CD /* 도서반납예정일 */,
    A.BOO_NO /* 도서번호 */,
    SUBSTR(A.CAT_SYM_NM,1,1)||'-'||SUBSTR(A.CAT_SYM_NM,2,3)||'-'||SUBSTR(A.CAT_SYM_NM,5,3) AS SUBSTR /* 분류기호명 */,
    A.BOO_TIT_NM /* 도서제목명 */,
    A.RSCH_RPTP_AUT_NM /* 연구보고서저자명 */,
    DECODE(NVL(B.BOO_REN_YN_CD,'1'),'1','반납','대출중') AS BOO_REN_YN_CD
FROM TBCSPQBO001M A , TBCSPQBO002H B WHERE 1=1 AND A.COPT_CAT_CD = B.COPT_CAT_CD AND A.BOO_KND_CD = B.BOO_KND_CD AND A.BOO_NO = B.BOO_NO AND A.CAT_SYM_NM = B.CAT_SYM_NM AND A.BOO_VLE_NO = B.BOO_VLE_NO AND A.COPT_CAT_CD = #strCOPT_CAT_CD# AND A.BOO_NO &gt;= #strBOO_NOS# AND A.BOO_NO &lt;= #strBOO_NOE# AND A.BAR_CD = #strBAR_CD# AND B.BOO_LEND_DT &gt;= #strBOO_LEND_DTS# AND B.BOO_LEND_DT &lt;= #strBOO_LEND_DTE# AND B.BOO_REN_APT_DT &gt;= #strBOO_REN_APT_DTS# AND B.BOO_REN_APT_DT &lt;= #strBOO_REN_APT_DTE# AND A.BOO_KND_CD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strBOO_KND_CD# ||',' AS #STRBOO_KND_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND A.CAT_SYM_NM &gt;= #strCAT_SYM_NMS1#||#strCAT_SYM_NMS2#||#strCAT_SYM_NMS3# AND A.CAT_SYM_NM &lt;= #strCAT_SYM_NME1#||#strCAT_SYM_NME2#||#strCAT_SYM_NME3# AND B.LAG_INV_CNB IN (SELECT TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBDCMACM001M WHERE USER_NM LIKE '%'||#strLAG_INV_CNB#||'%') AND B.LAG_INV_CNB IN (SELECT TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBDCMACM001M WHERE SRECS_DEPT_CD = #SRECS_DEPT_CD#) AND BOO_TIT_NM like '%'||#strBOO_TIT_NM1#||'%' AND (BOO_TIT_NM like '%'||#strBOO_TIT_NM1#||'%' AND BOO_TIT_NM like '%'||#strBOO_TIT_NM3#||'%') AND (BOO_TIT_NM like '%'||#strBOO_TIT_NM1#||'%' OR BOO_TIT_NM like '%'||#strBOO_TIT_NM3#||'%') AND (BOO_TIT_NM like '%'||#strBOO_TIT_NM1#||'%' AND BOO_TIT_NM like '%'||#strBOO_TIT_NM2#||'%') AND (BOO_TIT_NM like '%'||#strBOO_TIT_NM1#||'%' OR BOO_TIT_NM like '%'||#strBOO_TIT_NM2#||'%') AND (BOO_TIT_NM like '%'||#strBOO_TIT_NM1#||'%' AND BOO_TIT_NM like '%'||#strBOO_TIT_NM2#||'%' AND BOO_TIT_NM like '%'||#strBOO_TIT_NM3#||'%') AND (BOO_TIT_NM like '%'||#strBOO_TIT_NM1#||'%' AND (BOO_TIT_NM like '%'||#strBOO_TIT_NM2#||'%' OR BOO_TIT_NM like '%'||#strBOO_TIT_NM3#||'%')) AND ( (BOO_TIT_NM like '%'||#strBOO_TIT_NM1#||'%' OR BOO_TIT_NM like '%'||#strBOO_TIT_NM2#||'%') AND BOO_TIT_NM like '%'||#strBOO_TIT_NM3#||'%') AND (BOO_TIT_NM like '%'||#strBOO_TIT_NM1#||'%' OR BOO_TIT_NM like '%'||#strBOO_TIT_NM2#||'%' OR BOO_TIT_NM like '%'||#strBOO_TIT_NM3#||'%') AND B.BOO_REN_YN_CD = '0' AND A.BOO_LEND_DVSN_CD = '0' AND (B.BOO_REN_YN_CD = '1' OR B.BOO_REN_YN_CD IS NULL ) AND B.BOO_REN_DT &gt;= #strBOO_REN_DTS# AND B.BOO_REN_DT &lt;= #strBOO_REN_DTE#