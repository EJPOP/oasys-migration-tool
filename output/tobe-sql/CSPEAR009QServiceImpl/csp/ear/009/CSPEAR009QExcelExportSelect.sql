SELECT DECODE(D1.CVLCPT_CLM_SECD ,'2','국민','3','공익') AS CLM_SE_NM /* 청구구분명 */,
    CASE WHEN D1.TPOF_STTS_SECD = '110' THEN F_CODE_NM('1000361','30') WHEN D1.TPOF_STTS_SECD IN ('150','160') AND D3.PRGRS_STP_SECD NOT IN ('02','03','04','05','06','07','08','09') THEN '감사실시에정' WHEN D1.TPOF_STTS_SECD IN ('150','160') AND D3.PRGRS_STP_SECD ='02' THEN '감사실시중' WHEN D1.TPOF_STTS_SECD IN ('150','160') AND D3.PRGRS_STP_SECD = '03' THEN '귀청보고' WHEN D1.TPOF_STTS_SECD IN ('150','160') AND D3.PRGRS_STP_SECD IN ('04','05','06','07','08','09') THEN '처리안작성중' ELSE F_CODE_NM('1000361', D1.TPOF_STTS_SECD) END AS PRCS_NM /* 처리명 */,
    D1.TPOF_RCPT_DT /* 제보접수일시 */,
    DECODE(D1.TPOF_CLMT_KDCD,'1',D1.TPOF_CVLPR_NM,'2',D1.TPOF_CVLPR_RPRSV_NM,'3',D1.TPOF_CVLPR_RPRSV_NM,'4',D1.TPOF_CVLPR_NM) AS TPOF_CVLPR_NM /* 제보민원인명 */,
    D1.TPOF_NM /* 제보명 */,
    D2.TRNF_YMD /* 이송일자 */,
    F_DPT_INFO(D2.TRNF_DEPT_CD,'1') AS F_DPT_INFO,
    DECODE(D2.RVW_RSLT_SECD,'01',TO_CHAR(TO_DATE(D2.RVW_RSLT_RPLY_YMD),'YYYY-MM-DD'), '' ) AS RVW_RSLT_RPLY_YMD /* 검토결과회신일자 */,
    DECODE(D4.ACADT_BGNG_YMD,NULL,'',TO_CHAR(TO_DATE(D4.ACADT_BGNG_YMD),'YYYY-MM-DD')||'-'||TO_CHAR(TO_DATE(D4.ACADT_END_YMD),'YYYY-MM-DD') ||'('||D4.ACADT_ENFRC_DCN ||')') AS ACADT_BGNG_YMD /* 실지감사시작일자 */,
    ( SELECT CASE WHEN COUNT(*) > 1 THEN F_ORG_INFO(MIN(INST_CD),'1')||'외 '|| TO_CHAR(COUNT(*)-1)||'건' ELSE F_ORG_INFO(MIN(INST_CD),'1') AS 1
FROM TB_BADDED002M Z1, TB_BADDED008L Z2 WHERE D3.ADT_YR = Z1.REL_ADT_YR AND D3.ADT_NO = Z1.REL_ADT_NO AND Z1.BZTRP_YR = Z2.BZTRP_YR AND Z1.BZTRP_SQNO = Z2.BZTRP_SQNO) AS INST_CONT , F_DPT_INFO(D2.PRCS_DEPT_CD,'1') AS PRCS_DEPT_NM , F_USR_INFO_BY_ID(D2.PRCS_PIC_ID,'2') AS SRECS_PRCS_PIC_NM FROM TB_CSPDCP101M D1 , TB_CSPEAR001M D2 , TB_BADDED001M D3 , TB_BADDED003M D4 WHERE D1.CVLCPT_CLM_SECD = D2.CLM_SECD(+) AND D1.TPOF_RCPT_YR = D2.CLM_YR(+) AND D1.TPOF_RCPT_NO = D2.CLM_RCPT_NO(+) AND D1.CVLCPT_CLM_SECD = D3.CLM_SECD(+) AND D1.TPOF_RCPT_YR = D3.INFO_RCPT_YR(+) AND D1.TPOF_RCPT_NO = D3.CVLCPT_NO(+) AND D3.ADT_YR = D4.ADT_YR(+) AND D3.ADT_NO = D4.ADT_NO(+) AND D1.CVLCPT_CLM_SECD IN ('2','3') AND D1.TPOF_STTS_SECD NOT IN ('21','170') AND (TO_CHAR(D1.TPOF_RCPT_DT,'YYYYMMDD') &gt; #strDTS# OR D1.TPOF_RCPT_DT IS NULL) AND (TO_CHAR(D1.TPOF_RCPT_DT,'YYYYMMDD') &lt; #strDTE# OR D1.TPOF_RCPT_DT IS NULL)