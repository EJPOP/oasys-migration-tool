INSERT INTO TBCSPAOE023M (CVLCPT_ADT_YR, TSK_NO, ADT_STP_SECD, PTCPT_CNB, BLT_DPT_CD, DPT_DVSN_CD, JBGD_SECD, FRST_USER_ID, LAST_USER_ID, LAST_PRCS_DEPT_CD, LAST_MENU_ID, FRST_REG_DT, LAST_MDFCN_DT) SELECT DISTINCT E.CVLCPT_ADT_YR AS CVLCPT_ADT_YR /* 민원감사년도 */,
    E.ADT_NO /* 감사번호 */,
    #strAudStepCd# AS ADT_STP_SECD /* 감사단계구분코드 */,
    B.BZTRVR_ENO /* 출장자직원전산번호 */,
    MAX(B.OGDP_DEPT_CD) AS OGDP_DEPT_CD /* 소속부서코드 */,
    ' ' /* 부서구분코드 */,
    MIN(F.JBGD_SECD) AS JBGD_SECD /* 직급구분코드 */,
    ' ',
    ' ',
    ' ',
    'CSPAOE023E',
    SYSDATE,
    SYSDATE
FROM TB_BADDED005L B , TB_BADDED002M D , TB_BADDED001M E , TBDCMACM001M F WHERE 1 = 1 AND B.EMP_SECD = '0' AND D.BZTRP_YR = B.BZTRP_YR AND D.BZTRP_SQNO = B.BZTRP_SQNO AND D.BZTRP_SECD = '1' AND E.CVLCPT_ADT_YR = D.REL_ADT_YR AND E.ADT_NO = D.REL_ADT_NO AND B.BZTRVR_ENO = F.TRGT_NOP_ENO AND (TRIM(F.JBPS_CD) NOT IN ('0013600','0065600','0069300') OR F.JBPS_CD IS NULL OR F.JBPS_CD = ' ') /*과장, 연구원, 연구관 제외*/ AND D.ADT_BZTRP_KDCD = (SELECT MAX(ADT_BZTRP_KDCD) AS ADT_BZTRP_KDCD /* 감사출장종류코드 */
FROM TB_BADDED002M WHERE REL_ADT_YR = #CVLCPT_ADT_YR# AND REL_ADT_NO = #ADT_NO# AND ADT_BZTRP_KDCD IN ('01','02')) AND E.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND E.ADT_NO = #ADT_NO# GROUP BY E.CVLCPT_ADT_YR, E.ADT_NO, B.BZTRVR_ENO