SELECT USE_DH,
    COUNT(USE_DH) AS USE_DH
FROM (SELECT SUBSTR(TO_CHAR(LOGIN_DATE,'YYYYMMDDHH24MISS'),0,8) AS SUBSTR
FROM PTL_LOG WHERE TO_CHAR(LOGIN_DATE,'YYYYMMDDHH24MISS') BETWEEN #strFrom#||'000000' AND #strTo#||'235959' AND ACTION_TYPE ='LOGIN' GROUP BY SUBSTR(TO_CHAR(LOGIN_DATE,'YYYYMMDDHH24MISS'),0,8), TRGT_NOP_ENO ) A GROUP BY USE_DH ORDER BY USE_DH DESC