WITH AA AS ( SELECT ASST_DATA_ATCH_SQNO /* 보조자료첨부순번 */,
    CASE WHEN ASST_DATA_ATCH_SQNO BETWEEN 1000 AND 1999 THEN '(소계1)' WHEN ASST_DATA_ATCH_SQNO BETWEEN 2000 AND 2999 THEN '(소계2)' WHEN ASST_DATA_ATCH_SQNO BETWEEN 3000 AND 3999 THEN '(소계3)' WHEN ASST_DATA_ATCH_SQNO BETWEEN 4000 AND 4999 THEN '(소계4)' WHEN ASST_DATA_ATCH_SQNO BETWEEN 5000 AND 5999 THEN '(소계5)' WHEN ASST_DATA_ATCH_SQNO BETWEEN 6000 AND 6999 THEN '(소계6)' WHEN ASST_DATA_ATCH_SQNO BETWEEN 7000 AND 7999 THEN '(소계7)' WHEN ASST_DATA_ATCH_SQNO BETWEEN 8000 AND 8999 THEN '(소계8)' WHEN ASST_DATA_ATCH_SQNO BETWEEN 9000 AND 9999 THEN '(소계9)' END AS ASST_DATA_ATCH_SQNO /* 보조자료첨부순번 */,
    TO_NUMBER((SUBSTRB(ASST_DATA_ATCH_CN,62,15))) AS TO_NUMBER
FROM TWFAACAV009L WHERE ASST_DATA_ATCH_SECD = 'ATC270203' ) SELECT '' AS JRSD_CD /* 소관코드 */,
    '' AS ACNTG_CD /* 회계코드 */,
    '' AS BLL_KDCD /* 계산서종류코드 */,
    '' AS PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    '' AS GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    '' AS FULL_PROF_DRTR_SRNO,
    '' AS PROF_YM /* 증명연월 */,
    '' AS ASST_DATA_ATCH_SECD /* 보조자료첨부구분코드 */,
    0 AS FRS_MDM_SQNO,
    '' AS SUM_SE_ID /* 합계구분아이디 */,
    RPAD(LPAD(GRP,20,' '),61,' ') AS RPAD,
    TO_NUMBER(LPAD(SUM(AMT),15,'0')) AS TO_NUMBER,
    '' AS TXT2,
    '' AS CFMTN_YN /* 확정여부 */,
    '' AS CRU_PRCS_STTS_SECD /* 부패처리상태구분코드 */,
    CASE WHEN GRP = '(소계1)' THEN '1000' WHEN GRP = '(소계2)' THEN '2000' WHEN GRP = '(소계3)' THEN '3000' WHEN GRP = '(소계4)' THEN '4000' WHEN GRP = '(소계5)' THEN '5000' WHEN GRP = '(소계6)' THEN '6000' WHEN GRP = '(소계7)' THEN '7000' WHEN GRP = '(소계8)' THEN '8000' WHEN GRP = '(소계9)' THEN '9000' END AS ASST_DATA_ATCH_SQNO /* 보조자료첨부순번 */,
    '' AS FRST_REG_DT /* 최초등록일시 */,
    '' AS FRST_USER_ID /* 최초사용자아이디 */,
    '' AS LAST_MDFCN_DT /* 최종수정일시 */,
    '' AS LAST_USER_ID /* 최종사용자아이디 */,
    '' AS LAST_PRCS_DEPT_CD /* 최종처리부서코드 */,
    '' AS LAST_MENU_ID /* 최종메뉴아이디 */
FROM AA WHERE 1 = 1 GROUP BY GRP UNION ALL SELECT JRSD_CD /* 소관코드 */,
    ACNTG_CD /* 회계코드 */,
    BLL_KDCD /* 계산서종류코드 */,
    PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    JRSD_CD||'-'||ACNTG_CD||'-'||BLL_KDCD||'-'||PROF_RBPRSN_SQNO||'-'||GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS JRSD_CD /* 소관코드 */,
    PROF_YM /* 증명연월 */,
    ASST_DATA_ATCH_SECD /* 보조자료첨부구분코드 */,
    FRS_MDM_SQNO /* 포렌식매체순번 */,
    SUM_SE_ID /* 합계구분아이디 */,
    SUBSTRB(ASST_DATA_ATCH_CN,1,61) AS SUBSTRB,
    TO_NUMBER(SUBSTRB(ASST_DATA_ATCH_CN,62,15)) AS TO_NUMBER,
    TRIM(SUBSTRB(ASST_DATA_ATCH_CN,77,200)) AS TRIM,
    CFMTN_YN /* 확정여부 */,
    CRU_PRCS_STTS_SECD /* 부패처리상태구분코드 */,
    ASST_DATA_ATCH_SQNO /* 보조자료첨부순번 */,
    FRST_REG_DT /* 최초등록일시 */,
    FRST_USER_ID /* 최초사용자아이디 */,
    LAST_MDFCN_DT /* 최종수정일시 */,
    LAST_USER_ID /* 최종사용자아이디 */,
    LAST_PRCS_DEPT_CD /* 최종처리부서코드 */,
    LAST_MENU_ID /* 최종메뉴아이디 */
FROM TWFAACAV009L WHERE ASST_DATA_ATCH_SECD = 'ATC270203' AND SUM_SE_ID != '49' ORDER BY ASST_DATA_ATCH_SQNO