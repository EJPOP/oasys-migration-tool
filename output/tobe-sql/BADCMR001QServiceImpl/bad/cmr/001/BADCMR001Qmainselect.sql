SELECT SRECS_DEPT_CD /* 심사재심의부서코드 */,
    F_DPT_INFO(SRECS_DEPT_CD, '1') AS CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    NVL(SUM(DETP_ALL), 0) AS DETP_ALL /* 합계 */,
    NVL(SUM(DETP01), 0) AS DETP01 /* 1과 */,
    NVL(SUM(DETP02), 0) AS DETP02 /* 2과 */,
    NVL(SUM(DETP03), 0) AS DETP03 /* 3과 */,
    NVL(SUM(DETP04), 0) AS DETP04 /* 4과 */,
    NVL(SUM(DETP05), 0) AS DETP05 /* 5과 */,
    NVL(SUM(DETP06), 0) AS DETP06 /* 6과 */,
    NVL(SUM(DETP07), 0) AS DETP07 /* 7과 */,
    #INFO_YR# AS #INFO_YR#,
    #strCpltYn# AS #STRCPLTYN#
FROM (SELECT CHR_DPT_CD /* 담당부서코드 */,
    SUBSTR(CHR_DPT_CD, 1, 3) || '000' AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    1,
    CASE WHEN D2.CRU_SORT_SQNO = '1' THEN 1 END AS CRU_SORT_SQNO /* 부패정렬순번 */,
    CASE WHEN D2.CRU_SORT_SQNO = '2' THEN 1 END AS CRU_SORT_SQNO /* 부패정렬순번 */,
    CASE WHEN D2.CRU_SORT_SQNO = '3' THEN 1 END AS CRU_SORT_SQNO /* 부패정렬순번 */,
    CASE WHEN D2.CRU_SORT_SQNO = '4' THEN 1 END AS CRU_SORT_SQNO /* 부패정렬순번 */,
    CASE WHEN D2.CRU_SORT_SQNO = '5' THEN 1 END AS CRU_SORT_SQNO /* 부패정렬순번 */,
    CASE WHEN D2.CRU_SORT_SQNO = '6' THEN 1 END AS CRU_SORT_SQNO /* 부패정렬순번 */,
    CASE WHEN D2.CRU_SORT_SQNO = '7' THEN 1 END AS CRU_SORT_SQNO /* 부패정렬순번 */
FROM TBBADCMR003M D1 ,TBDCMACM002M D2 WHERE 1=1 AND INFO_YR = #INFO_YR# AND CHR_DPT_CD IS NOT NULL /*널인 데이터도 있다*/ AND D1.CHR_DPT_CD = D2.SRECS_DEPT_CD AND NVL(CPLT_YN, 'N') = #strCpltYn# ) WHERE 1=1 GROUP BY SRECS_DEPT_CD ORDER BY SRECS_DEPT_CD