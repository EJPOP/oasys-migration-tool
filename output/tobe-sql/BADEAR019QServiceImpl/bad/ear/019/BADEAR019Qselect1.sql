/*쿼리명 : SQL_Sum*/ select sum(A1 + B1 + C1 + D1 + D4 + E1 + E2 + F1 + G1 + H1 + I1 + J1 + K1 + L1 + M1 + N1) AS A1,
    /*합계 건수*/ sum(A2 + C2 + D2 + D5 + J2 + N2) AS A2,
    /*합계 금액(상)*/ sum(B2 + K2 + L2 + M2) AS B2,
    /*합계 인원*/ sum(A3 + C3 + D3 + D6 + J3 + N3) AS A3 /* 합계 금액(하) */
from ( select case when SUBSTR(KIKGU, 1, 1) = '1' then '1' when SUBSTR(KIKGU, 1, 1) = '2' then '2' when SUBSTR(KIKGU, 1, 1) = '3' then '3' else '4' end AS SUBSTR,
    sum(case when CHBCD = '110' then NVL(GUNSU,0) else 0 end) AS CHBCD,
    sum(case when CHBCD = '110' then NVL(AM1,0) else 0 end) AS CHBCD,
    sum(case when CHBCD = '110' then NVL(AM2,0) + NVL(AM3,0) else 0 end) AS CHBCD,
    sum(case when CHBCD = '210' then NVL(GUNSU,0) else 0 end) AS CHBCD,
    sum(case when CHBCD = '210' then NVL(MAN,0) else 0 end) AS CHBCD,
    sum( case when CHBCD = '310' then NVL(GUNSU,0) else case when CHBCD = '320' then NVL(GUNSU,0) else 0 end end) AS CHBCD,
    sum( case when CHBCD = '310' then NVL(AM1,0) else case when CHBCD = '320' then NVL(AM1,0) else 0 end end) AS CHBCD,
    sum( case when CHBCD = '310' then NVL(AM2,0) + NVL(AM3,0) else case when CHBCD = '320' then NVL(AM2,0) + NVL(AM3,0) else 0 end end) AS CHBCD,
    sum( case when CHBCD = '390' then NVL(GUNSU,0) else case when CHBCD = '391' then NVL(GUNSU,0) else 0 end end) AS CHBCD,
    sum( case when CHBCD = '390' then NVL(AM1,0) else case when CHBCD = '391' then NVL(AM1,0) else 0 end end) AS CHBCD,
    sum( case when CHBCD = '390' then NVL(AM2,0) + NVL(AM3,0) else case when CHBCD = '391' then NVL(AM2,0) + NVL(AM3,0) else 0 end end) AS CHBCD,
    sum( case when CHBCD = '395' then NVL(GUNSU,0) else case when CHBCD = '396' then NVL(GUNSU,0) else 0 end end) AS CHBCD,
    sum( case when CHBCD = '395' then NVL(AM1,0) else case when CHBCD = '396' then NVL(AM1,0) else 0 end end) AS CHBCD,
    sum( case when CHBCD = '395' then NVL(AM2,0) + NVL(AM3,0) else case when CHBCD = '396' then NVL(AM2,0) + NVL(AM3,0) else 0 end end) AS CHBCD,
    sum( case when CHBCD = '410' then NVL(GUNSU,0) else case when CHBCD = '490' then NVL(GUNSU,0) else 0 end end) AS CHBCD,
    sum(case when CHBCD = '495' then NVL(GUNSU,0) else 0 end) AS CHBCD,
    sum(case when CHBCD = '510' then NVL(GUNSU,0) else 0 end) AS CHBCD,
    sum(case when CHBCD = '520' then NVL(GUNSU,0) else 0 end) AS CHBCD,
    sum(case when CHBCD = '530' then NVL(GUNSU,0) else 0 end) AS CHBCD,
    sum(case when CHBCD = '611' then NVL(GUNSU,0) else 0 end) AS CHBCD,
    sum(case when CHBCD in ('610', '630') then NVL(GUNSU,0) else 0 end) AS CHBCD,
    /* 통보 */ sum(case when CHBCD in ('610', '630') then NVL(AM1,0) else 0 end) AS CHBCD,
    sum(case when CHBCD in ('610', '630') then NVL(AM2,0) + NVL(AM3,0) else 0 end) AS CHBCD,
    sum(case when CHBCD = '623' then NVL(GUNSU,0) else 0 end) AS CHBCD,
    /* 통보(비위) - 623 */ sum(case when CHBCD = '623' then NVL(MAN,0) else 0 end) AS CHBCD,
    sum(case when CHBCD in ('620', '621') then NVL(GUNSU,0) else 0 end) AS CHBCD,
    /* 통보(인사) - 620 */ sum(case when CHBCD in ('620', '621') then NVL(MAN,0) else 0 end) AS CHBCD,
    sum(case when CHBCD IN ('710', '720', '730') then NVL(GUNSU,0) else 0 end) AS CHBCD,
    /* 고발 - 710,720,730 */ sum(case when CHBCD IN ('710', '720', '730') then NVL(MAN,0) else 0 end) AS CHBCD,
    sum(case when CHBCD = '625' then NVL(GUNSU,0) else 0 end) AS CHBCD,
    /* 통보(시정완료):625 추가 - 2017.01.20 yyh*/ sum(case when CHBCD = '625' then NVL(AM1,0) else 0 end) AS CHBCD,
    sum(case when CHBCD = '625' then NVL(AM2,0) + NVL(AM3,0) else 0 end) AS CHBCD /* sum(case when CHBCD = '610' then NVL(GUNSU,0) else 0 end) as J1, sum( case when CHBCD = '620' then NVL(GUNSU,0) else case when CHBCD = '621' then NVL(GUNSU,0) else 0 end end) as K1, sum( case when CHBCD = '620' then NVL(MAN,0) else case when CHBCD = '621' then NVL(MAN,0) else 0 end end) as K2, sum( case when CHBCD = '710' then NVL(GUNSU,0) else case when CHBCD = '720' then NVL(GUNSU,0) else case when CHBCD = '730' then NVL(GUNSU,0) else 0 end end end) as L1, sum( case when CHBCD = '710' then NVL(MAN,0) else case when CHBCD = '720' then NVL(MAN,0) else case when CHBCD = '730' then NVL(MAN,0) else 0 end end end) as L2, sum( case when CHBCD = '623' then NVL(GUNSU,0) else 0 end) as M1, sum( case when CHBCD = '623' then NVL(MAN,0) else 0 end) as M2 */
from (select YYMM, KIKGU, SOKIK, (case when CHB_CD 0 then '390' when CHB_CD 0 then '395' when CHB_CD 0 then 1 end),0) + NVL(sum(case when CHB_CD TO-BE: 소관기관기본에서 추출*/ MASTER.DSPS_RQT_KDCD as CHB_CD, NVL(DETAIL.TPOF_NOPE, 0) as CHB_SU, NVL(DETAIL.PNRT_PRSRV_AMT, 0) as CAM1 , NVL(DETAIL.RMBR_AMT, 0) as CAM2 , NVL(DETAIL.SPLP_AMT, 0) as CAM3 from TBBADEAR001M master, TBBADEAR002D detail where MASTER.CVLCPT_ADT_YR = DETAIL.CVLCPT_ADT_YR and MASTER.ADT_NO = DETAIL.ADT_NO and MASTER.DSPS_RQT_SQNO = DETAIL.DSPS_RQT_SQNO and DETAIL.ENFC_YMD is not null and DETAIL.CFMTN_STTS_SECD != '0' /* 확정일자 기준 추가 - 2017.03.21 yyh*/ /* 시행일자 기준 */ and DETAIL.ENFC_YMD between #strFromDt# and #strToDt# /*화면의 기간 인자값*/ /* 확정일자 기준 */ and DETAIL.IMPL_WHLS_CFMTN_YMD between #strFromDt# and #strToDt# /*화면의 기간 인자값*/ ) a group by YYMM, KIKGU, SOKIK, (case when CHB_CD 0 then '390' when CHB_CD 0 then '395' when CHB_CD < '800' and CHB_CD in ('390','391') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0 then '391' when CHB_CD < '800' and CHB_CD in ('395','396') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0 then '396' else null end) ) STKIKW_F group by (case when SUBSTR(KIKGU, 1, 1) = '1' then '1' when SUBSTR(KIKGU, 1, 1) = '2' then '2' when SUBSTR(KIKGU, 1, 1) = '3' then '3' else '4' end) ) STKIKW_F_SUM