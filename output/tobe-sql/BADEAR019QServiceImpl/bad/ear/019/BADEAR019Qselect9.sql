SELECT A.ADT_YR /* 감사년도 */,
    A.ADT_NO /* 감사번호 */,
    A.DSPS_RQT_SQNO /* 처분요구순번 */,
    F_MNG_KND_AUDYRNO(A.ADT_YR, A.ADT_NO, C.ADT_KDCD, '-') || '(' || A.DSPS_RQT_SQNO || ')' AS F_MNG_KND_AUDYRNO /* 처분번호 */,
    C.ADT_MTTR_NM /* 감사사항명 */,
    TO_CHAR(TO_DATE(B.ENFC_YMD),'YYYY.MM.DD') AS ENFC_YMD /* 시행일자 */,
    F_DPT_INFO(B.IMPL_MNG_JRSD_DEPT_CD,'1') AS F_DPT_INFO /* 집행관리국과 */,
    DSPS_RQT_NM /* 처분요구명 */,
    D2.HND_NM AS HND_NM /* 조치요구 */,
    CASE WHEN D2.RLPR_SQNO IS NOT NULL THEN D2.ENFM_SHP_NM ELSE D1.ENFM_SHP_NM END AS RLPR_SQNO /* 관계자순번 */,
    F_ORG_INFO(B.CMO_INST_CD,'1') AS F_ORG_INFO /* 소관청 */,
    F_ORG_INFO(D1.SRECS_REL_INST_CD,'1') AS REL_INST_NM /* 관계기관명 */,
    OCPT_NM /* 직종명 */,
    JBGD_NM /* 직급명 */,
    D2.RLPR_NM AS RLPR_NM /* 관계자명 */,
    DECODE(B.CFMTN_STTS_SECD, '2', '확정', '1', DECODE(B.DSPS_RQT_ATRZ_STTS_SECD, '3', '완결', '미결') , '') AS CFMTN_STTS_SECD /* 확정상태구분코드 */,
    TO_CHAR(TO_DATE(B.IMPL_WHLS_CFMTN_YMD),'YYYY.MM.DD') AS IMPL_WHLS_CFMTN_YMD /* 집행전말확정일자 */
from TB_BADEAR001M A ,TB_BADEAR002D B ,TB_BADDED001M C ,( SELECT D1.ADT_YR /* 감사년도 */,
    D1.ADT_NO /* 감사번호 */,
    D1.DSPS_RQT_SQNO /* 처분요구순번 */,
    D1.REL_INST_CD /* 관계기관코드 */,
    D2.IMPL_SQNO /* 집행순번 */,
    D2.IMPL_YMD /* 집행일자 */,
    F_CODE_NM('1000003',D2.IMPL_TPCD) AS F_CODE_NM /* 집행형태 */,
    DECODE(D1.CPLT_YN,'Y','O','X') AS CPLT_YN /* 완결여부 */
FROM TBBADEAR006M D1 , TBBADFRE006M D2 WHERE 1=1 AND D1.CVLCPT_ADT_YR = D2.CVLCPT_ADT_YR(+) AND D1.ADT_NO = D2.ADT_NO(+) AND D1.DSPS_RQT_SQNO = D2.DSPS_RQT_SQNO(+) AND D1.SRECS_REL_INST_CD = D2.SRECS_REL_INST_CD(+) ) D1 /*관계기관*/ , ( SELECT D1.ADT_YR /* 감사년도 */,
    D1.ADT_NO /* 감사번호 */,
    D1.DSPS_RQT_SQNO /* 처분요구순번 */,
    D1.REL_INST_CD /* 관계기관코드 */,
    D1.RLPR_SQNO /* 관계자순번 */,
    D1.RLPR_NM /* 관계자명 */,
    D1.ACTN_RQT_KDCD /* 조치요구종류코드 */,
    F_CODE_NM('1000011',D1.ACTN_RQT_KDCD) AS F_CODE_NM,
    F_CODE_NM('1000057',OCPT_SECD) AS OCPT_NM /* 직종명 */,
    F_CODE_NM('1000058',JBGD_SECD) AS JBGD_NM /* 직급명 */,
    D2.IMPL_SQNO /* 집행순번 */,
    D2.IMPL_YMD /* 집행일자 */,
    F_CODE_NM('1000003',D2.IMPL_TPCD) AS F_CODE_NM,
    D2.PNL_AMT /* 추징금액 */,
    DECODE(D1.CPLT_YN,'Y','O','X') AS CPLT_YN /* 완결여부 */
FROM TBBADEAR007M D1 , TBBADFRE008M D2 WHERE 1=1 AND D1.CVLCPT_ADT_YR = D2.CVLCPT_ADT_YR(+) AND D1.ADT_NO = D2.ADT_NO(+) AND D1.DSPS_RQT_SQNO = D2.DSPS_RQT_SQNO(+) AND D1.SRECS_REL_INST_CD = D2.SRECS_REL_INST_CD(+) AND D1.RLPR_SQNO = D2.RLPR_SQNO(+) ) D2 /*관계자*/ where 1=1 and A.ADT_YR = B.ADT_YR and A.ADT_NO = B.ADT_NO and A.DSPS_RQT_SQNO = B.DSPS_RQT_SQNO and A.ADT_YR = C.ADT_YR and A.ADT_NO = C.ADT_NO AND A.ADT_YR = D1.CVLCPT_ADT_YR and A.ADT_NO = D1.ADT_NO and A.DSPS_RQT_SQNO = D1.DSPS_RQT_SQNO AND D1.CVLCPT_ADT_YR = D2.CVLCPT_ADT_YR(+) AND D1.ADT_NO = D2.ADT_NO(+) AND D1.DSPS_RQT_SQNO = D2.DSPS_RQT_SQNO(+) AND D1.SRECS_REL_INST_CD = D2.SRECS_REL_INST_CD(+) AND B.CFMTN_STTS_SECD IN ('1','2') AND B.ENFC_YMD BETWEEN #strFromDt# AND #strToDt# /*시행기간*/ AND B.IMPL_WHLS_CFMTN_YMD <= #strStdDt# /*기준일자*/ ORDER BY CVLCPT_ADT_YR DESC, ADT_NO DESC, DSPS_RQT_SQNO DESC