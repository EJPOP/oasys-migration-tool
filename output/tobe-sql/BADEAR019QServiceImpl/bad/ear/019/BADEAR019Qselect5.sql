select BB.NM AS NM,
    NVL(AA.C_TOT,0) + NVL(AA.A_TOT,0) + NVL(AA.B_TOT,0) AS C_TOT,
    NVL(AA.C_TOT,0) AS C_TOT,
    NVL(AA.C_1,0) AS C_1,
    NVL(AA.C_2,0) AS C_2,
    NVL(AA.C_3,0) AS C_3,
    NVL(AA.C_4,0) AS C_4,
    NVL(AA.A_TOT,0) AS A_TOT,
    NVL(AA.A_1,0) AS A_1,
    NVL(AA.A_2,0) AS A_2,
    NVL(AA.A_3,0) AS A_3,
    NVL(AA.A_4,0) AS A_4,
    NVL(AA.B_TOT,0) AS B_TOT,
    NVL(AA.B_1,0) AS B_1,
    NVL(AA.B_2,0) AS B_2,
    NVL(AA.B_3,0) AS B_3,
    NVL(AA.B_4,0) AS B_4
from (select RELPSN.ACTN_RQT_KDCD /* 조치요구종류코드 */,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) = '1' then 1 else 0 end) AS SUBSTR,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) = '1' then (case when RELPSN.JBGD_SECD in ('01','02','03','04','05') then 1 else 0 end) else 0 end) AS SUBSTR,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) = '1' then (case when RELPSN.JBGD_SECD in ('06','07') then 1 else 0 end) else 0 end) AS SUBSTR,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) = '1' then (case when RELPSN.JBGD_SECD in ('08','09') then 1 else 0 end) else 0 end) AS SUBSTR,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) = '1' then (case when RELPSN.JBGD_SECD between '01' and '09' then 0 else 1 end) else 0 end) AS SUBSTR /* 지방자치단체 */,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) = '2' then 1 else 0 end) AS SUBSTR,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) = '2' then (case when RELPSN.JBGD_SECD in ('01','02','03','04','05') then 1 else 0 end) else 0 end) AS SUBSTR,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) = '2' then (case when RELPSN.JBGD_SECD in ('06','07') then 1 else 0 end) else 0 end) AS SUBSTR,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) = '2' then (case when RELPSN.JBGD_SECD in ('08','09') then 1 else 0 end) else 0 end) AS SUBSTR,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) = '2' then (case when RELPSN.JBGD_SECD between '01' and '09' then 0 else 1 end) else 0 end) AS SUBSTR /* 정부투자기관 및 기타단체 */,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) not in ('1','2') or MASTER.INST_SECD is null then 1 else 0 end) AS SUBSTR,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) not in ('1','2') or MASTER.INST_SECD is null then (case when RELPSN.JBGD_SECD in ('61','62','63') then 1 else 0 end) else 0 end) AS SUBSTR,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) not in ('1','2') or MASTER.INST_SECD is null then (case when RELPSN.JBGD_SECD in ('64','65') then 1 else 0 end) else 0 end) AS SUBSTR,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) not in ('1','2') or MASTER.INST_SECD is null then (case when RELPSN.JBGD_SECD = '66' then 1 else 0 end) else 0 end) AS SUBSTR,
    sum(case when SUBSTR(MASTER.INST_SECD,1,1) not in ('1','2') or MASTER.INST_SECD is null then (case when RELPSN.JBGD_SECD between '61' and '66' then 0 else 1 end) else 0 end) AS SUBSTR
from TBBADEAR001M master ,TBBADEAR002D detail ,TBBADEAR007M relpsn where 1=1 and MASTER.CVLCPT_ADT_YR = DETAIL.CVLCPT_ADT_YR and MASTER.ADT_NO = DETAIL.ADT_NO and MASTER.DSPS_RQT_SQNO = DETAIL.DSPS_RQT_SQNO and MASTER.CVLCPT_ADT_YR = RELPSN.CVLCPT_ADT_YR and MASTER.ADT_NO = RELPSN.ADT_NO and MASTER.DSPS_RQT_SQNO = RELPSN.DSPS_RQT_SQNO and MASTER.DSPS_RQT_KDCD in ('210','620','621','623') and DETAIL.ENFC_YMD between #strFromDt# and #strToDt# /*화면인자값*/ and DETAIL.CFMTN_STTS_SECD != '0' and RELPSN.ACTN_RQT_KDCD in ('001','002','003','004','005','013','015') group by RELPSN.ACTN_RQT_KDCD ) AA, (select '001' AS CD,
    '파 면' AS NM,
    1
from dual union all select '002' AS CD,
    '해 임' AS NM,
    2
from dual union all select '013' AS CD,
    '강 등' AS NM,
    3
from dual union all select '003' AS CD,
    '정 직' AS NM,
    4
from dual union all select '004' AS CD,
    '경징계 이상' AS NM,
    5
from dual union all select '015' AS CD,
    '비 위 통 보' AS NM,
    6
from dual union all select '005' AS CD,
    '인사자료통보' AS NM,
    7
from dual ) BB where 1=1 and AA.ACTN_RQT_KDCD(+) = BB.CD order by bb.sort