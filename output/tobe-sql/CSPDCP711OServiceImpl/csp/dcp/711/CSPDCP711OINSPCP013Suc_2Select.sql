SELECT D1.TPOF_HMPG_APLY_NO /* 제보누리집신청번호 */,
    DECODE(D1.TPOF_CLMT_KDCD,'1',D1.TPOF_CVLPR_NM,'2',D1.TPOF_CVLPR_RPRSV_NM,'3',D1.TPOF_CVLPR_RPRSV_NM,'4',D1.TPOF_CVLPR_NM) AS TPOF_CLMT_KDCD /* 제보청구인종류코드 */,
    D1.TPOF_KDCD /* 제보종류코드 */,
    F_CODE_NM('1000047', D1.TPOF_KDCD) AS F_CODE_NM,
    D1.TPOF_CVLPR_TELNO /* 제보민원인전화번호 */,
    DECODE(D1.TPOF_CVLPR_EML_ID,NULL,'',D1.TPOF_CVLPR_EML_ID||'@'||D1.TPOF_CVLPR_EML_DMN_NM ) AS TPOF_CVLPR_EML_ID /* 제보민원인이메일아이디 */,
    D1.TPOF_CVLPR_MPNO /* 제보민원인휴대전화번호 */,
    D1.TPOF_CVLPR_ZIP /* 제보민원인우편번호 */,
    D1.TPOF_CVLPR_ADDR /* 제보민원인주소 */,
    D1.TPOF_CVLPR_DADDR /* 제보민원인상세주소 */,
    D1.TPOF_CVLPR_CONM_NM /* 제보민원인상호명 */,
    D1.TPOF_CVLPR_BRNO /* 제보민원인사업자등록번호 */,
    D2.TPOF_RPD_NM /* 제보피청구인명 */,
    D2.TPOF_TELNO /* 제보전화번호 */,
    D2.TPOF_ZIP /* 제보우편번호 */,
    D2.TPOF_CVLPR_ADDR /* 제보민원인주소 */,
    D2.TPOF_CVLPR_DADDR /* 제보민원인상세주소 */,
    TO_CHAR(D1.LAST_MDFCN_DT, 'YYYYMMDDHH24MISS') AS TO_CHAR,
    D1.TPOF_RCPT_YR /* 제보접수년도 */,
    D1.TPOF_ACTL_RCPT_NO /* 제보실제접수번호 */,
    D2.TPOF_OOFC_NM /* 제보근무처명 */,
    D1.TPOF_NM /* 제보명 */,
    D3.TPOF_CN /* 제보내용 */
FROM TB_CSPDCP101M D1 ,TB_CSPDCP103M D2 ,TB_CSPDCP102M D3 WHERE 1=1 AND D1.CLM_SECD = D2.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D2.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D2.TPOF_RCPT_YR(+) AND D1.CLM_SECD = #CLM_SECD# AND D1.CVLCPT_RCPT_RCPT = #CVLCPT_RCPT_RCPT# AND D1.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND D1.CLM_SECD = D3.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D3.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D3.TPOF_RCPT_YR(+) UNION ALL SELECT D1.CRU_HMPG_APLY_NO /* 부패누리집신청번호 */,
    DECODE(D1.SLCT_CLMT_KDCD,'1',D1.TPOF_CVLPR_NM,'2',D1.SLCT_CVLPR_RPRSV_NM,'3',D1.SLCT_CVLPR_RPRSV_NM,'4',D1.TPOF_CVLPR_NM) AS SLCT_CLMT_KDCD /* 청탁청구인종류코드 */,
    D1.CRU_KDCD /* 부패종류코드 */,
    F_CODE_NM('1000047', D1.CRU_KDCD) AS F_CODE_NM,
    D1.CRU_TELNO /* 부패전화번호 */,
    DECODE(D1.CLMT_EML_ADDR,NULL,'',D1.CLMT_EML_ADDR||'@'||D1.SLCT_CVLPR_EML_DMN_NM ) AS CLMT_EML_ADDR /* 청구인이메일주소 */,
    D1.SLCT_CVLPR_MPNO /* 청탁민원인휴대전화번호 */,
    D1.CRU_ZIP /* 부패우편번호 */,
    D1.OTSD_EXPRT_ADDR /* 외부전문가주소 */,
    D1.CRU_CVLPR_DADDR /* 부패민원인상세주소 */,
    D1.SLCT_CVLPR_CONM_NM /* 청탁민원인상호명 */,
    D1.PROF_RBPRSN_BRNO /* 증명책임자사업자등록번호 */,
    D2.TPOF_RPD_NM /* 제보피청구인명 */,
    D2.TPOF_TELNO /* 제보전화번호 */,
    D2.TPOF_ZIP /* 제보우편번호 */,
    D2.TPOF_CVLPR_ADDR /* 제보민원인주소 */,
    D2.TPOF_CVLPR_DADDR /* 제보민원인상세주소 */,
    TO_CHAR(D1.LAST_MDFCN_DT, 'YYYYMMDDHH24MISS') AS TO_CHAR,
    D1.CVLCPT_RCPT_YR /* 민원접수년도 */,
    D1.TPOF_ACTL_RCPT_NO /* 제보실제접수번호 */,
    D2.TPOF_OOFC_NM /* 제보근무처명 */,
    D1.RSCH_ASMT_TTL /* 연구과제제목 */,
    D3.TPOF_CN /* 제보내용 */
FROM TB_CSPDCP101M D1 ,TB_CSPDCP103M D2 ,TB_CSPDCP102M D3 WHERE 1=1 AND (D1.CLM_SECD, D1.CVLCPT_RCPT_YR, D1.CVLCPT_RCPT_RCPT) IN (SELECT Z.TPOF_MCA_CLM_SECD /* 제보합건청구구분코드 */,
    Z.TPOF_MCA_RCPT_YR /* 제보합건접수년도 */,
    Z.TPOF_MCA_CVLCPT_RCPT_NO /* 제보합건민원접수번호 */
FROM TB_CSPDCP105L Z WHERE Z.CLM_SECD = #CLM_SECD# AND Z.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND Z.CVLCPT_RCPT_RCPT = #CVLCPT_RCPT_RCPT# ) AND D1.CLM_SECD = D2.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D2.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D2.TPOF_RCPT_YR(+) AND D1.CLM_SECD = D3.CVLCPT_CLM_SECD(+) AND D1.CVLCPT_RCPT_RCPT = D3.TPOF_RCPT_NO(+) AND D1.CVLCPT_RCPT_YR = D3.TPOF_RCPT_YR(+)