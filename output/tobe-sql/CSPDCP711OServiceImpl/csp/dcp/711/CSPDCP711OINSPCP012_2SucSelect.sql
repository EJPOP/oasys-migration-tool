SELECT D1.CRU_HMPG_APLY_NO /* 부패누리집신청번호 */,
    D1.CVLCPT_RCPT_YR /* 민원접수년도 */,
    D1.TPOF_ACTL_RCPT_NO /* 제보실제접수번호 */,
    CASE WHEN D1.CRU_PRCS_PRCS_STTS = '70' THEN D1.CRU_PRCS_PRCS_STTS WHEN D2.TPOF_KND_SECD = '1' AND SLCT_PRCS_PRCS IN ('60') THEN '40' WHEN D2.TPOF_KND_SECD = '2' THEN '60' ELSE '60' END AS CRU_PRCS_PRCS_STTS /* 부패처리상태구분코드 */,
    F_CODE_NM('1000361',CASE WHEN D1.CRU_PRCS_PRCS_STTS = '70' THEN D1.CRU_PRCS_PRCS_STTS WHEN D2.TPOF_KND_SECD = '1' AND SLCT_PRCS_PRCS IN ('60') THEN '40' WHEN D2.TPOF_KND_SECD = '2' THEN '60' ELSE '60' END) AS F_CODE_NM,
    CASE WHEN SLCT_PRCS_PRCS NOT IN ('60') THEN TO_CHAR(D1.LAST_MDFCN_DT, 'YYYYMMDDHH24MISS') ELSE '' END AS SLCT_PRCS_PRCS /* 청탁처리구분코드 */,
    D2.TPOF_BKMK_ANS_CN /* 제보즐겨찾기답변내용 */,
    TO_CHAR(D2.LAST_MDFCN_DT, 'YYYYMMDD') AS TO_CHAR
FROM TB_CSPDCP101M D1 ,TB_CSPDCP201M D2 ,TB_CSPDCP205L D3 WHERE 1=1 AND (D1.CLM_SECD, D1.CVLCPT_RCPT_YR, D1.CVLCPT_RCPT_RCPT) IN (SELECT Z.TPOF_MCA_CLM_SECD /* 제보합건청구구분코드 */,
    Z.TPOF_MCA_RCPT_YR /* 제보합건접수년도 */,
    Z.TPOF_MCA_CVLCPT_RCPT_NO /* 제보합건민원접수번호 */
FROM TB_CSPDCP105L Z WHERE Z.CLM_SECD = #CLM_SECD# AND Z.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND Z.CVLCPT_RCPT_RCPT = #CVLCPT_RCPT_RCPT# ) AND D1.CLM_SECD = D2.CVLCPT_CLM_SECD AND D1.CVLCPT_RCPT_YR = D2.TPOF_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = D2.TPOF_RCPT_NO AND D1.CLM_SECD = D3.CLM_SECD AND D1.CVLCPT_RCPT_YR = D3.CVLCPT_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = D3.CVLCPT_RCPT_RCPT AND D1.CRU_RCPT_PATH_SECD <> '8' AND D3.FRS_MDM_SQNO = ( SELECT MIN(Z.TPOF_SQNO) AS TPOF_SQNO /* 제보순번 */
FROM TB_CSPDCP205L Z WHERE D1.CLM_SECD = Z.CLM_SECD AND D1.CVLCPT_RCPT_YR = Z.CVLCPT_RCPT_YR AND D1.CVLCPT_RCPT_RCPT = Z.CVLCPT_RCPT_RCPT )