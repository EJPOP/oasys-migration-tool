/* csp/oep/014/CSPOEP014QMainSelect */ SELECT ROWNUM,
    T.*
FROM ( SELECT A.NDTY_DT,
    A.NDTY_DVSN_CD,
    CASE WHEN TO_CHAR(TO_DATE(NDTY_DT,'YYYYMMDD'), 'DY') IN ('토','일') AND NDTY_DVSN_CD NOT IN ('04','05') THEN '주말/공휴일'||' '||F_CODE_NM('1000899', NDTY_DVSN_CD) WHEN TO_CHAR(TO_DATE(NDTY_DT,'YYYYMMDD'), 'DY') NOT IN ('토','일') AND NDTY_DVSN_CD NOT IN ('04','05') THEN '평일'||' '||F_CODE_NM('1000899', NDTY_DVSN_CD) ELSE F_CODE_NM('1000899', NDTY_DVSN_CD) END AS TO_CHAR,
    F_DPT_INFO(B.SRECS_DEPT_CD, '1') AS F_DPT_INFO,
    F_CODE_NM('1000173', B.JBGD_SECD) AS F_CODE_NM,
    B.USER_NM /* 사용자명 */,
    A.ATRZ_DOC_NO /* 결재문서번호 */,
    A.ATRZ_STTS_SECD /* 결재상태구분코드 */,
    A.NDTY_DTS,
    A.NDTY_DTE,
    TO_CHAR(TO_DATE(A.NDTY_DT,'YYYYMMDD'), 'DY') AS TO_CHAR,
    F_CODE_NM('1000333', A.ATRZ_STTS_SECD) AS F_CODE_NM,
    CASE WHEN (A.NDTY_DTS IS NULL OR A.NDTY_DTE IS NULL) THEN '' ELSE TRUNC(MOD((TO_DATE(A.NDTY_DTE, 'HH24:MI') - TO_DATE(A.NDTY_DTS, 'HH24:MI')),1)*24)||'시간 '|| TRUNC(MOD((TO_DATE(A.NDTY_DTE, 'HH24:MI') - TO_DATE(A.NDTY_DTS, 'HH24:MI'))*24,1)*60)||'분' END AS NDTY_DTS
FROM TBCSPOEP004M A, TBDCMACM001M B WHERE A.NDTY_DRTR_CNB = B.TRGT_NOP_ENO A.NDTY_DT &gt;= #strNDTY_DTS# A.NDTY_DT &lt;= #strNDTY_DTE# (A.NDTY_DRTR_CNB = #strCNB# OR A.NDTY_AST_CNB = #strCNB#) A.ATRZ_STTS_SECD = #ATRZ_STTS_SECD# A.ATRZ_STTS_SECD IN ('2','3', NULL) A.NDTY_DVSN_CD = #strNDTY_DVSN_CD# A.NDTY_DVSN_CD IN ('01','02') ORDER BY A.NDTY_DT DESC, A.NDTY_DVSN_CD ASC ) T