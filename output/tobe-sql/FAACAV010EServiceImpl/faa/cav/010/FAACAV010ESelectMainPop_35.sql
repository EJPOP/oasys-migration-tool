/* faa/cav/010/FAACAV010ESelectMainPop_35 */ SELECT CASE SUM_SE_ID WHEN '51' THEN '월계' WHEN '49' THEN '합계' ELSE SUM_SE_ID END AS SUM_SE_ID /* 합계구분아이디 */,
    ACNTG_SECD /* 회계구분코드 */,
    CASE WHEN PROF_YM < '201606' THEN DECODE(ACNTG_SECD, 'S01', '통합계정소계', 'S02', '특별회계소계', 'S03', '기금소계', 'S04', '특별계정소계', ACNTG_SECD) ELSE DECODE(ACNTG_SECD, 'S01', '통합계정소계', 'S02', '비통합계정소계', 'S03', '기금소계', 'S04', '기금성특별계정소계', 'S05', '특별계정소계', ACNTG_SECD) END AS ACNTG_SECD /* 회계구분코드 */,
    DECODE(ACNTG_SECD, 'S01', '', 'S02', '', 'S03', '', 'S04', '', 'S05', '', ACNTG_CDNM) AS ACNTG_CDNM /* 회계코드명 */,
    THYR_INCRS_PF_AMT /* 본년도증가권면금액 */,
    ANRVN_ACTOT_AMT /* 세입누계금액 */,
    TSMM_NBR_AMT /* 당월세입외금액 */,
    NBR_ACTOT_AMT /* 세입외누계금액 */,
    TSMM_AUEX_AMT /* 당월세출금액 */,
    AUEX_ACTOT_AMT /* 세출누계금액 */,
    TSMM_NBE_AMT /* 당월세출외금액 */,
    NBE_ACTOT_AMT /* 세출외누계금액 */,
    NTFND_BLNC /* 국고금잔액 */,
    CASE WHEN PROF_YM < '201606' THEN CASE WHEN SUBSTR(ACNTG_SECD,1,1) IN ('0','1','2','9') OR ACNTG_SECD='S01' OR SUBSTR(ACNTG_SECD,1,2)='31' OR SUBSTR(ACNTG_SECD,1,2) IN ('50','56') THEN '01' ELSE CASE WHEN SUBSTR(ACNTG_SECD,1,2) IN ('38','51','52') OR ACNTG_SECD='S02' THEN '02' ELSE CASE WHEN SUBSTR(ACNTG_SECD,1,1)='6' OR ACNTG_SECD='S03' THEN '03' ELSE CASE WHEN SUBSTR(ACNTG_SECD,1,1)='7' OR ACNTG_SECD='S05' THEN '04' END END END END ELSE CASE WHEN SUBSTR(ACNTG_SECD,1,1) IN ('0','1','2','9') OR ACNTG_SECD='S01' OR SUBSTR(ACNTG_SECD,1,2) IN ('31','33','34','35') OR SUBSTR(ACNTG_SECD,1,2) IN ('50','56') THEN '01' ELSE CASE WHEN SUBSTR(ACNTG_SECD,1,2) IN ('38','51','52') OR ACNTG_SECD='S02' THEN '02' ELSE CASE WHEN SUBSTR(ACNTG_SECD,1,1)='6' AND ACNTG_SECD NOT IN ('617','618') OR ACNTG_SECD='S03' THEN '03' ELSE CASE WHEN ACNTG_SECD IN ('617','618') OR ACNTG_SECD='S04' THEN '04' ELSE CASE WHEN SUBSTR(ACNTG_SECD,1,1)='7' OR ACNTG_SECD='S05' THEN '05' END END END END END END AS PROF_YM /* 증명연월 */,
    F_AV_BLL_COPT_CD_NM(JRSD_CD) AS JRSD_NM /* 소관명 */,
    F_AV_ACNT_CD_NM(ACNTG_CD) AS F_AV_ACNT_CD_NM,
    (SELECT AGGR_CONCAT (M.EAN_CD, ', ')
FROM (SELECT DGUARD.DECRYPT('TB_ENC', 'EAN', ACTNO_SCRTY) || '-' || ACNT_SBJCT_SECD AS DECRYPT
FROM TWFAACAV062L WHERE JRSD_CD = #JRSD_CD# AND ACNTG_CD = #ACNTG_CD# AND BLL_KDCD = #BLL_KDCD# AND PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND ACNTG_YR = SUBSTR(#PROF_YM#, 0, 4)) M ) AS ACNB_CD, F_AV_ACCMN_NM(JRSD_CD, ACNTG_CD, BLL_KDCD, PROF_RBPRSN_SQNO, GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO) AS PROF_RBPRSN_INST_NM, SUM_SE_ID, JRSD_CD, ACNTG_CD, BLL_KDCD, PROF_RBPRSN_SQNO, GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO, PROF_YM, ACNTG_SECD AS ACNT_DVSN_CD_1, ACNTG_CDNM AS ACNT_NM_1 FROM TWFAACAV063L WHERE JRSD_CD = #JRSD_CD# AND ACNTG_CD = #ACNTG_CD# AND BLL_KDCD = #BLL_KDCD# AND PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND PROF_YM = #PROF_YM# ORDER BY SUM_SE_ID DESC, SUB_SUM_ORDER, ACNTG_SECD