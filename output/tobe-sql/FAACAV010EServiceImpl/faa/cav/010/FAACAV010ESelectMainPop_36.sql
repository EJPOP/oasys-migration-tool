/* faa/cav/010/FAACAV010ESelectMainPop_36 */ SELECT A.ACNTG_CD || '(' || (SELECT AS ACNTG_CDNM /* 회계코드명 */
FROM TWFAACAV024C WHERE 1=1 AND ACNTG_SECD = '01' AND ACNTG_CD = A.ACNTG_CD) || ')' AS ACNTG_CD, (CASE WHEN SUM_SE_ID='51' THEN '월계' ELSE CASE WHEN SUM_SE_ID='49' THEN '합계' ELSE SUM_SE_ID END END) AS SUM_DVSN_NM, '본기분' as aa, TQR_RCVMT_AMT, TQR_RCVMT_OEPY_GVBK_AMT, TQR_RCVMT_SBTR_AMT, TQR_GIVE_CMD_AMT, TQR_GIVE_AMT, TQR_RTN_AMT, TQR_GIVE_SBTR_AMT, TQR_DTX_SBST_RMBR_NPS_AMT, TQR_BLNC, SUM_SE_ID, F_AV_BLL_COPT_CD_NM(JRSD_CD) AS JRSD_NM, F_AV_ACNT_CD_NM(ACNTG_CD) AS ACNT_NM2, (SELECT AGGR_CONCAT (M.EAN_CD,', ')
FROM (SELECT dguard.decrypt('TB_ENC','EAN',ACTNO_SCRTY) || '-' || ACNT_SBJCT_SECD AS DECRYPT
FROM TWFAACAV062L WHERE JRSD_CD = #JRSD_CD# AND ACNTG_CD = #ACNTG_CD# AND BLL_KDCD = #BLL_KDCD# AND PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND ACNTG_YR = SUBSTR(#strYm#,0,4)) M ) AS ACNB_CD, F_AV_ACCMN_NM(JRSD_CD,ACNTG_CD,BLL_KDCD,PROF_RBPRSN_SQNO,GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO) AS PROF_RBPRSN_INST_NM FROM TWFAACAV015L A WHERE JRSD_CD = #JRSD_CD# AND ACNTG_CD = #ACNTG_CD# AND BLL_KDCD = #BLL_KDCD# AND PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# UNION ALL SELECT A.ACNTG_CD || '(' || (SELECT AS ACNTG_CDNM /* 회계코드명 */
FROM TWFAACAV024C WHERE 1=1 AND ACNTG_SECD = '01' AND ACNTG_CD = A.ACNTG_CD) || ')', (CASE WHEN SUM_SE_ID='51' THEN '월계' ELSE CASE WHEN SUM_SE_ID='49' THEN '합계' ELSE SUM_SE_ID END END) AS SUM_DVSN_NM, '본기까지의 누계' as aa, TQR_RCVMT_ACTOT_AMT, TQR_OEPY_GVBK_RCVMT_AMT, TQR_RCVMT_SBTR_ACTOT_AMT, TQR_GIVE_CMD_ACTOT_AMT, TQR_RTN_ACTOT_AMT, TQR_GIVE_ACTOT_SBTR_AMT, TQR_GIVE_ACTOT_AMT, TQR_DTX_SBST_RMBR_ACTOT_AMT, TQR_BLNC_ACTOT_AMT, SUM_SE_ID, F_AV_BLL_COPT_CD_NM(JRSD_CD) AS JRSD_NM, F_AV_ACNT_CD_NM(ACNTG_CD) AS ACNT_NM2, (SELECT AGGR_CONCAT (M.EAN_CD,', ')
FROM (SELECT dguard.decrypt('TB_ENC','EAN',ACTNO_SCRTY) || '-' || ACNT_SBJCT_SECD AS DECRYPT
FROM TWFAACAV062L WHERE JRSD_CD = #JRSD_CD# AND ACNTG_CD = #ACNTG_CD# AND BLL_KDCD = #BLL_KDCD# AND PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND ACNTG_YR = SUBSTR(#strYm#,0,4)) M ) AS ACNB_CD, F_AV_ACCMN_NM(JRSD_CD,ACNTG_CD,BLL_KDCD,PROF_RBPRSN_SQNO,GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO) AS PROF_RBPRSN_INST_NM FROM TWFAACAV015L A WHERE JRSD_CD = #JRSD_CD# AND ACNTG_CD = #ACNTG_CD# AND BLL_KDCD = #BLL_KDCD# AND PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# ORDER BY AA DESC, SUM_SE_ID DESC