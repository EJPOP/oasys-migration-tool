/* faa/cav/010/FAACAV010ESelectMainPop_40 */ SELECT CASE WHEN SUM_SE_ID='51' THEN '월계' ELSE CASE WHEN SUM_SE_ID='49' THEN '합계' ELSE SUM_SE_ID END END AS SUM_SE_ID /* 합계구분아이디 */,
    JRSD_CD /* 소관코드 */,
    ACNTG_CD /* 회계코드 */,
    BLL_KDCD /* 계산서종류코드 */,
    PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    PROF_YM /* 증명연월 */,
    ACNTG_CD||'-'||CHIF_CD||'-'||SSEC_CD||'-'||DITM_CD||'-'||SITM_CD AS ACNTG_CD /* 계정코드 */,
    CASE WHEN length(ABS(TSMM_RCT_AMT)) > 3 THEN TO_CHAR(substr(TSMM_RCT_AMT, 0, length(TSMM_RCT_AMT) -3),'FM999,999,999,999,999') ||'.'||substr(TSMM_RCT_AMT,length(TSMM_RCT_AMT) -2) ELSE TO_CHAR(TSMM_RCT_AMT) END AS TSMM_RCT_AMT /* 당월영수금액 */,
    CASE WHEN length(ABS(PRVMM_RCT_ACTOT_AMT)) > 3 THEN TO_CHAR(substr(PRVMM_RCT_ACTOT_AMT, 0, length(PRVMM_RCT_ACTOT_AMT) -3),'FM999,999,999,999,999') ||'.'||substr(PRVMM_RCT_ACTOT_AMT,length(PRVMM_RCT_ACTOT_AMT) -2) ELSE TO_CHAR(PRVMM_RCT_ACTOT_AMT) END AS PRVMM_RCT_ACTOT_AMT /* 전월영수누계금액 */,
    CASE WHEN length(ABS(TSMM_RTN_RCT_AMT)) > 3 THEN TO_CHAR(substr(TSMM_RTN_RCT_AMT, 0, length(TSMM_RTN_RCT_AMT) -3),'FM999,999,999,999,999') ||'.'||substr(TSMM_RTN_RCT_AMT,length(TSMM_RTN_RCT_AMT) -2) ELSE TO_CHAR(TSMM_RTN_RCT_AMT) END AS TSMM_RTN_RCT_AMT /* 당월반납영수금액 */,
    CASE WHEN length(ABS(SBTR_RCT_ACTOT_AMT)) > 3 THEN TO_CHAR(substr(SBTR_RCT_ACTOT_AMT, 0, length(SBTR_RCT_ACTOT_AMT) -3),'FM999,999,999,999,999') ||'.'||substr(SBTR_RCT_ACTOT_AMT,length(SBTR_RCT_ACTOT_AMT) -2) ELSE TO_CHAR(SBTR_RCT_ACTOT_AMT) END AS SBTR_RCT_ACTOT_AMT /* 차감영수누계금액 */,
    CASE WHEN length(ABS(TSMM_GIVE_AMT)) > 3 THEN TO_CHAR(substr(TSMM_GIVE_AMT, 0, length(TSMM_GIVE_AMT) -3),'FM999,999,999,999,999') ||'.'||substr(TSMM_GIVE_AMT,length(TSMM_GIVE_AMT) -2) ELSE TO_CHAR(TSMM_GIVE_AMT) END AS TSMM_GIVE_AMT /* 당월지급금액 */,
    CASE WHEN length(ABS(PRVMM_GIVE_ACTOT_AMT)) > 3 THEN TO_CHAR(substr(PRVMM_GIVE_ACTOT_AMT, 0, length(PRVMM_GIVE_ACTOT_AMT) -3),'FM999,999,999,999,999') ||'.'||substr(PRVMM_GIVE_ACTOT_AMT,length(PRVMM_GIVE_ACTOT_AMT) -2) ELSE TO_CHAR(PRVMM_GIVE_ACTOT_AMT) END AS PRVMM_GIVE_ACTOT_AMT /* 전월지급누계금액 */,
    CASE WHEN length(ABS(TSMM_GIVE_GVBK_AMT)) > 3 THEN TO_CHAR(substr(TSMM_GIVE_GVBK_AMT, 0, length(TSMM_GIVE_GVBK_AMT) -3),'FM999,999,999,999,999') ||'.'||substr(TSMM_GIVE_GVBK_AMT,length(TSMM_GIVE_GVBK_AMT) -2) ELSE TO_CHAR(TSMM_GIVE_GVBK_AMT) END AS TSMM_GIVE_GVBK_AMT /* 당월지급반환금액 */,
    CASE WHEN length(ABS(TSMM_SBJCT_RCTF_GIVE_AMT)) > 3 THEN TO_CHAR(substr(TSMM_SBJCT_RCTF_GIVE_AMT, 0, length(TSMM_SBJCT_RCTF_GIVE_AMT) -3),'FM999,999,999,999,999') ||'.'||substr(TSMM_SBJCT_RCTF_GIVE_AMT,length(TSMM_SBJCT_RCTF_GIVE_AMT) -2) ELSE TO_CHAR(TSMM_SBJCT_RCTF_GIVE_AMT) END AS TSMM_SBJCT_RCTF_GIVE_AMT /* 당월과목경정지급금액 */,
    CASE WHEN length(ABS(SBTR_GIVE_ACTOT_AMT)) > 3 THEN TO_CHAR(substr(SBTR_GIVE_ACTOT_AMT, 0, length(SBTR_GIVE_ACTOT_AMT) -3),'FM999,999,999,999,999') ||'.'||substr(SBTR_GIVE_ACTOT_AMT,length(SBTR_GIVE_ACTOT_AMT) -2) ELSE TO_CHAR(SBTR_GIVE_ACTOT_AMT) END AS SBTR_GIVE_ACTOT_AMT /* 차감지급누계금액 */,
    CASE WHEN length(ABS(GIVE_BLNC)) > 3 THEN TO_CHAR(substr(GIVE_BLNC, 0, length(GIVE_BLNC) -3),'FM999,999,999,999,999') ||'.'||substr(GIVE_BLNC,length(GIVE_BLNC) -2) ELSE TO_CHAR(GIVE_BLNC) END AS GIVE_BLNC /* 지급잔액 */,
    F_AV_BLL_COPT_CD_NM(JRSD_CD) AS JRSD_NM /* 소관명 */,
    F_AV_ACNT_CD_NM(ACNTG_CD) AS ACNTG_CDNM /* 회계코드명 */,
    (SELECT AGGR_CONCAT (M.EAN_CD,', ')
FROM (SELECT dguard.decrypt('TB_ENC','EAN',ACTNO_SCRTY) || '-' || ACNT_SBJCT_SECD AS DECRYPT
FROM TWFAACAV062L WHERE JRSD_CD = #JRSD_CD# AND ACNTG_CD = #ACNTG_CD# AND BLL_KDCD = #BLL_KDCD# AND PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND ACNTG_YR = SUBSTR(#PROF_YM#,0,4)) M ) AS ACNB_CD ,F_AV_ACCMN_NM(JRSD_CD,ACNTG_CD,BLL_KDCD,PROF_RBPRSN_SQNO,GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO) AS PROF_RBPRSN_INST_NM ,SUM_SE_ID ,ACNT_CD, CHIF_CD,SSEC_CD,DITM_CD,SITM_CD FROM TWFAACAV028L WHERE JRSD_CD = #JRSD_CD# AND ACNTG_CD = #ACNTG_CD# AND BLL_KDCD = #BLL_KDCD# AND PROF_RBPRSN_SQNO = #PROF_RBPRSN_SQNO# AND GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO = #GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO# AND PROF_YM = #PROF_YM# ORDER BY SUM_SE_ID DESC, ACNT_CD, SSEC_CD, DITM_CD, SITM_CD