/************************************* * DVSN_CD : 구분코드 * 1 : 민원 * 2 : 국민 * 3 : 공익 * 4 : 국회 * 5 : 심사 * 6 : 재심 * 7 : 재심판정 * 8 : 손망실 * 9 : 판정청구 * 0 : 정보 * A : 특수관리 * C : 청금 - 20156.10.31 yyh **************************************/ SELECT T1.ADT_YR /* 감사년도 */,
    T1.ADT_NO /* 감사번호 */,
    T1.ACADT_DSCTN_SQNO /* 실지감사내역순번 */,
    T1.ADT_MTTR_SECD /* 감사사항구분코드 */,
    F_CODE_NM('1000742', T1.ADT_MTTR_SECD) AS SE_NM /* 구분명 */,
    T1.ACADT_DSCTN_NM_1 /* 실지감사내역명1 */,
    T1.ACADT_DSCTN_NM_2 /* 실지감사내역명2 */,
    T1.ACADT_DSCTN_NM_3 /* 실지감사내역명3 */,
    T1.ACADT_DSCTN_NM_4 /* 실지감사내역명4 */,
    CASE WHEN USER_HSTRY_SECD IN ('1','2','3') THEN (SELECT S1.CVLCPT_RCPT_YR||'-'||F_CODE_NM('1000740',S1.CLM_SECD)||'-'||S1.TPOF_ACTL_RCPT_NO AS CVLCPT_RCPT_YR /* 민원접수년도 */
FROM TB_CSPDCP101M S1 WHERE T1.ACADT_DSCTN_NM_1 = S1.CVLCPT_RCPT_YR AND T1.ACADT_DSCTN_NM_2 = S1.CLM_SECD AND T1.ACADT_DSCTN_NM_3 = S1.CVLCPT_RCPT_RCPT) /* 국회 로직추가 - 2016.12.08 yyh */ WHEN USER_HSTRY_SECD = '4' THEN T1.ACADT_DSCTN_NM_1 ||'-국회-'|| T1.ACADT_DSCTN_NM_3 WHEN USER_HSTRY_SECD IN ('5','6','7') THEN (SELECT CASE WHEN S1.SRECS_RCPT_YR >= '2016' THEN S1.SRECS_RCPT_YR || '-' || DECODE(S1.SRECS_RCPT_SECD,'1','심사','2','재심','3','재심판정') || '-' || S1.SRECS_RCPT_SQNO ELSE S1.SRECS_RCPT_YR || '-' || S1.SRECS_RCPT_SECD || '-' || S1.SRECS_RCPT_SQNO AS SRECS_RCPT_YR /* 심사재심의접수년도 */
FROM TB_BADFRE012M S1 WHERE T1.ACADT_DSCTN_NM_1 = S1.CVLCPT_RCPT_YR AND T1.ACADT_DSCTN_NM_2 = S1.SRECS_RCPT_SECD AND T1.ACADT_DSCTN_NM_3 = S1.SRECS_RCPT_SQNO AND T1.ACADT_DSCTN_NM_4 = S1.SRECS_DEPT_CD) WHEN USER_HSTRY_SECD IN ('8','9') THEN (SELECT CASE WHEN S1.OCRN_SECD = '6' THEN S1.NTFCTN_YR||'-판정청구-'||S1.NTFCTN_RCPT_SQNO ELSE S1.NTFCTN_YR||'-손망실-'||S1.NTFCTN_RCPT_SQNO AS OCRN_SECD /* 발생구분코드 */
FROM TB_BADGDA001M S1 WHERE T1.ACADT_DSCTN_NM_1 = S1.INST_CD AND T1.ACADT_DSCTN_NM_2 = S1.NTFCTN_SECD AND T1.ACADT_DSCTN_NM_3 = S1.NTFCTN_SQNO) WHEN USER_HSTRY_SECD = '0' THEN DSPS_RQT_NM_1 ||'-정보-'|| DSPS_RQT_NM_2 WHEN USER_HSTRY_SECD = 'A' THEN F_MNG_KND_AUDYRNO(DSPS_RQT_NM_1, DSPS_RQT_NM_2, (SELECT ADT_KDCD /* 감사종류코드 */
FROM TB_BADDED001M WHERE CVLCPT_ADT_YR = DSPS_RQT_NM_1 AND ADT_NO = DSPS_RQT_NM_2), '-') ||'-'|| DSPS_RQT_NM_3 ||'-'|| F_ORG_INFO(DSPS_RQT_NM_4,'1') WHEN USER_HSTRY_SECD = 'C' THEN DSPS_RQT_NM_2 || '-청금-' || (SELECT S1.SLCT_ACTL_RCPT_NO /* 청탁실제접수번호 */
FROM TB_CSPDCP811M S1 WHERE S1.CVLCPT_DCLR_SECD = DSPS_RQT_NM_1 AND S1.CVLCPT_RCPT_YR = DSPS_RQT_NM_2 AND S1.CVLCPT_DCLR_RCPT_NO = DSPS_RQT_NM_3 ) ELSE '' END AS EXEC_NO ,CASE WHEN USER_HSTRY_SECD IN ('1','2','3') THEN (SELECT S1.TPOF_NM /* 제보명 */
FROM TB_CSPDCP101M S1 WHERE T1.ACADT_DSCTN_NM_1 = S1.CVLCPT_RCPT_YR AND T1.ACADT_DSCTN_NM_2 = S1.CLM_SECD AND T1.ACADT_DSCTN_NM_3 = S1.CVLCPT_RCPT_RCPT) /* 국회 로직추가 - 2016.12.08 yyh */ WHEN USER_HSTRY_SECD = '4' THEN (SELECT S1.CLM_TTL /* 청구제목 */
FROM TB_CSPEAR007M S1 WHERE T1.ACADT_DSCTN_NM_1 = S1.CVLCPT_RCPT_YR AND T1.ACADT_DSCTN_NM_2 = S1.CLM_SECD AND T1.ACADT_DSCTN_NM_3 = S1.CVLCPT_RCPT_RCPT ) WHEN USER_HSTRY_SECD IN ('5','6','7') THEN (SELECT S1.SRECS_NM /* 심사재심의명 */
FROM TB_BADFRE012M S1 WHERE T1.ACADT_DSCTN_NM_1 = S1.CVLCPT_RCPT_YR AND T1.ACADT_DSCTN_NM_2 = S1.SRECS_RCPT_SECD AND T1.ACADT_DSCTN_NM_3 = S1.SRECS_RCPT_SQNO AND T1.ACADT_DSCTN_NM_4 = S1.SRECS_DEPT_CD) WHEN USER_HSTRY_SECD IN ('8','9') THEN (SELECT S1.NTFCTN_NM /* 통보명 */
FROM TB_BADGDA001M S1 WHERE T1.ACADT_DSCTN_NM_1 = S1.INST_CD AND T1.ACADT_DSCTN_NM_2 = S1.NTFCTN_SECD AND T1.ACADT_DSCTN_NM_3 = S1.NTFCTN_SQNO) WHEN USER_HSTRY_SECD = '0' THEN (SELECT DSPS_RQT_NM /* 처분요구명 */
FROM TB_CSPBII100M S1 WHERE S1.INFO_YR = T1.ACADT_DSCTN_NM_1 AND S1.FRS_MDM_SQNO = T1.ACADT_DSCTN_NM_2) WHEN USER_HSTRY_SECD = 'A' THEN (SELECT DSPS_RQT_NM /* 처분요구명 */
FROM TB_BADEAR001M S1 WHERE S1.CVLCPT_ADT_YR = T1.ACADT_DSCTN_NM_1 AND S1.ADT_NO = T1.ACADT_DSCTN_NM_2 AND S1.DSPS_RQT_SQNO = T1.ACADT_DSCTN_NM_3) WHEN USER_HSTRY_SECD = 'C' THEN (SELECT RSCH_ASMT_TTL /* 연구과제제목 */
FROM TB_CSPDCP811M S1 WHERE S1.CVLCPT_DCLR_SECD = T1.ACADT_DSCTN_NM_1 AND S1.CVLCPT_RCPT_YR = T1.ACADT_DSCTN_NM_2 AND S1.CVLCPT_DCLR_RCPT_NO = T1.ACADT_DSCTN_NM_3) ELSE '' END AS EXEC_TIT_NM FROM TB_BADDED030L T1 WHERE 1=1 AND T1.ADT_YR = #CVLCPT_ADT_YR# AND T1.ADT_NO = #ADT_NO# ORDER BY T1.ACADT_DSCTN_SQNO