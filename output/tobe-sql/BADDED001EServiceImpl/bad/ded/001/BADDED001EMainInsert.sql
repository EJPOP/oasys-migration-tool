DECLARE BEGIN INSERT INTO TB_BADDED001M (CVLCPT_ADT_YR, ADT_NO, ADT_GRNT_NO /* 감사부여번호 추가 - 2016.05.23 */, ADT_ASMT_SECD, INST_SECD, ADT_KDCD, SPRVSN_DEPT_CD, ADT_MTHD_SECD, ADT_MTTR_NM, ADT_SCL_SECD, TASK_SECD, EMPHS_ASMT_SECD, ADT_RBPRSN_ENO, WHOL_RBPRSN_JBGD_SECD, WHOL_RBPRSN_DEPT_CD, ADT_RPRS_INST_CD, SPVR_ENO, SPVR_DEPT_CD, SPVR_JBGD_SECD, ASTN_ENO, ASTN_DEPT_CD, ASTN_JBGD_SECD, PRGRS_STP_SECD, MNG_DEPT_CD, CVLCPT_RCPT_YR, CVLCPT_RCPT_RCPT, CLM_SECD, PRTTN_ADT_YR, PRTTN_ADT_NO, INTG_ADT_YR, INTG_ADT_NO, ADT_CNTRL_SECD /* 감사통제코드 추가 - 2016.06.03 yyh */, BZTRP_BGT_SECD /* 예산구분코드 - 2016.06.16 yyh */, FRST_USER_ID, LAST_USER_ID, LAST_PRCS_DEPT_CD, LAST_MENU_ID, FRST_REG_DT, LAST_MDFCN_DT) VALUES ( #AUD_YR# , #AUD_NO# , #AUD_GRN_NO# , #AUD_TASK_CD# , #ORG_DVSN_CD# , #AUD_KND_CD# , #SPV_BRDV_CD# , #AUD_WAY_CD# , #AUD_SBJ_NM# , #AUD_SCL_CD# , #TSK_CAT_CD# , #EPS_TASK_CD# , #AUD_TOT_DRTR_CNB# , #TOT_DRTR_RANK_CD# , #TOT_DRTR_BRDV_CD# , #AUD_RPST_ORG_CD# , #SPVR_CNB# , #SPVR_BRDV_CD# , #SPVR_RANK_CD# , #AST_CNB# , #AST_BRDV_CD# , #AST_RANK_CD# , #PRSS_STEP_CD# , #MNG_DPT_CD# , #ACP_YR# , #CVPT_ACP_NO# , #REQ_DVSN_CD# , #DVS_AUD_YR# , #DVS_AUD_NO# , #ITGT_AUD_YR# , #ITGT_AUD_NO# /* 감사통제코드 SET - 확인출장은 : 1(해당없음) - 확인출장 이외는 : 3(미통제상태) */ , (CASE WHEN SUBSTR(#AUD_KND_CD#,3,1) = '5' THEN '1' ELSE '3' END) , #BZT_BGT_DVSN_CD# , #FRT_USR_ID# , #FNL_USR_ID# , #FNL_DEAL_DPT_CD# , #FNL_MNU_ID# , SYSDATE , SYSDATE ) ; INSERT INTO TB_BADDED024H (LINK_NO, CVLCPT_ADT_YR, ADT_NO, LINK_STTS_SECD, USE_YN /* 사용여부 */, FRST_USER_ID, LAST_USER_ID, LAST_PRCS_DEPT_CD, LAST_MENU_ID, FRST_REG_DT, LAST_MDFCN_DT) VALUES( (SELECT NVL(MAX(LINK_NO),0)+1 AS LINK_NO /* 연계번호 */
FROM TB_BADDED024H) , #AUD_YR# , #AUD_NO# , 'C' , 'N' , #FRT_USR_ID# , #FNL_USR_ID# , #FNL_DEAL_DPT_CD# , #FNL_MNU_ID# , SYSDATE , SYSDATE ) ; END ;