SELECT NVL(F.USR_DPT_NM,'') AS USR_DPT_NM /* 소속부서명 */,
    NVL(F.USR_RANK_NM,'') AS USR_RANK_NM /* 직급명 */,
    NVL(F.USER_NM,'') AS USER_NM /* 사용자명 */,
    NVL(F.SYT_EVL_ADVL_VAL,'') AS SYT_EVL_ADVL_VAL /* 종합평가가중치 */,
    NVL(C.PJCD02,'') AS PJCD02 /* 감사준비 평가등급 */,
    NVL(C.PJCD01,'') AS PJCD01 /* 감사투입인력비용의적정성 평가등급 */,
    NVL(C.PJCD03,'') AS PJCD03 /* 감사난이도 평가등급 */,
    NVL(C.PJCD04,'') AS PJCD04 /* 지적사항 변경 불문정도 평가등급 */,
    NVL(C.PJCD05,'') AS PJCD05 /* 처리안 작성의 적정성 평가등급 */,
    NVL(C.PJCD06,'') AS PJCD06 /* 감사성과정도 평가등급 */
FROM ( SELECT MAX(B.PJCD02) AS PJCD02 /* 감사준비 */,
    MAX(B.PJCD01) AS PJCD01 /* 감사투입인력비용의적정성 */,
    MAX(B.PJCD03) AS PJCD03 /* 감사난이도 */,
    MAX(B.PJCD04) AS PJCD04 /* 지적사항 변경 불문정도 */,
    MAX(B.PJCD05) AS PJCD05 /* 처리안 작성의 적정성 */,
    MAX(B.PJCD06) AS PJCD06 /* 감사성과정도 */
FROM ( SELECT A.EVL_INDEX_CD /* 평가지표코드 */,
    A.EVL_INDEX_NM /* 평가지표명 */,
    CASE WHEN A.EVL_INDEX_CD = 'PJCD02' THEN A.EVL_RK_NM END AS EVL_INDEX_CD,
    CASE WHEN A.EVL_INDEX_CD = 'PJCD01' THEN A.EVL_RK_NM END AS EVL_INDEX_CD,
    CASE WHEN A.EVL_INDEX_CD = 'PJCD03' THEN A.EVL_RK_NM END AS EVL_INDEX_CD,
    CASE WHEN A.EVL_INDEX_CD = 'PJCD04' THEN A.EVL_RK_NM END AS EVL_INDEX_CD,
    CASE WHEN A.EVL_INDEX_CD = 'PJCD05' THEN A.EVL_RK_NM END AS EVL_INDEX_CD,
    CASE WHEN A.EVL_INDEX_CD = 'PJCD06' THEN A.EVL_RK_NM END AS EVL_INDEX_CD
FROM ( SELECT D1.EVL_INDEX_CD /* 평가지표코드 */,
    D1.EVL_INDEX_NM /* 평가지표명 */,
    F_CODE_NM('1000274', D2.EVL_RK_CD) AS F_CODE_NM /* 평가등급 */
FROM TBCSPAOE029M D3 , TBCSPAOE030M D2 , TBCSPAOE002M D1 WHERE D2.EVL_YR = D1.EVL_YR (+) AND D2.HLYR_DVSN_CD = D1.HLYR_DVSN_CD (+) AND D2.EVL_INDEX_CD = D1.EVL_INDEX_CD (+) AND D3.EVL_YR = D2.EVL_YR (+) AND D3.HLYR_DVSN_CD = D2.HLYR_DVSN_CD (+) AND D3.CVLCPT_TASK_SECD = D2.CVLCPT_TASK_SECD (+) AND D3.AUD_TSK_KND_CD = D2.AUD_TSK_KND_CD (+) AND D3.EVL_STEP_CD = D2.EVL_STEP_CD (+) AND D3.EVL_CMTR_CNB = D2.EVL_CMTR_CNB (+) AND D3.CVLCPT_ADT_YR = D2.CVLCPT_ADT_YR (+) AND D3.TSK_NO = D2.TSK_NO (+) AND D2.EVL_YR = #strEvlYr# AND D2.HLYR_DVSN_CD = #strHlyrDvsnCd# AND D2.CVLCPT_TASK_SECD = '10000' /*감사업무구분*/ AND D2.EVL_STEP_CD = '200' /*위원평가*/ AND D2.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D2.TSK_NO = #strTskNo# ) A ) B ) C /*평가지표별 평가등급*/ , ( SELECT DISTINCT F_DPT_INFO(F_USR_INFO(D3.EVL_CMTR_CNB, '5'), '1') AS F_DPT_INFO /* 평가자 소속부서 */,
    F_CODE_NM('1000173', F_USR_INFO(D3.EVL_CMTR_CNB, '3')) AS F_CODE_NM /* 평가자 직급 */,
    F_USR_INFO(D3.EVL_CMTR_CNB, '2') AS USER_NM /* 사용자명 */,
    D3.SYT_EVL_ADVL_VAL /* 종합가중치 */
FROM TBCSPAOE030M D2 , TBCSPAOE029M D3 WHERE D3.EVL_YR = D2.EVL_YR (+) AND D3.HLYR_DVSN_CD = D2.HLYR_DVSN_CD (+) AND D3.CVLCPT_TASK_SECD = D2.CVLCPT_TASK_SECD (+) AND D3.AUD_TSK_KND_CD = D2.AUD_TSK_KND_CD (+) AND D3.EVL_STEP_CD = D2.EVL_STEP_CD (+) AND D3.EVL_CMTR_CNB = D2.EVL_CMTR_CNB (+) AND D3.CVLCPT_ADT_YR = D2.CVLCPT_ADT_YR (+) AND D3.TSK_NO = D2.TSK_NO (+) AND D3.EVL_YR = #strEvlYr# AND D3.HLYR_DVSN_CD = #strHlyrDvsnCd# AND D3.CVLCPT_TASK_SECD = '10000' /*감사업무구분*/ AND D3.EVL_STEP_CD = '200' /*위원평가*/ AND D3.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND D3.TSK_NO = #strTskNo# ) F /*평가자정보*/