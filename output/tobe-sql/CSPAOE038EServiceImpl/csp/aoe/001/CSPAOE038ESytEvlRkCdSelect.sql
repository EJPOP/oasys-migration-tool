SELECT D1.RK_CD,
    F_CODE_NM('1000274', D1.RK_CD) AS F_CODE_NM
FROM ( SELECT RK_CD,
    RANK() OVER(ORDER BY IDVT_INDEX_VAL ASC) AS RANK
FROM TBCSPAOE010D WHERE EVL_YR = #strEvlYr# AND HLYR_DVSN_CD = #strHlyrDvsnCd# AND CVLCPT_TASK_SECD = #CVLCPT_TASK_SECD# AND AUD_TSK_KND_CD = #strAudKndCd# AND #strIdvtIndexVal# <= TO_NUMBER(ROUND(SUM_INDEX_VAL, 1)) ) D1 WHERE D1.RK_CD_RANK = 1