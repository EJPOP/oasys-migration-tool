UPDATE TB_CSPBII160L A SET QTR_GOAL_SCR = CASE WHEN (SELECT GEN_ADMN_DVSN_CD
FROM TBDCMACM001M S1 WHERE A.TRGT_NOP_ENO = S1.TRGT_NOP_ENO ) IN ('2','3') THEN 1 ELSE ( (NVL(SBMSN_DEPT_WORK_YN_1, 0) + NVL(SBMSN_DEPT_WORK_YN_2, 0) + NVL(SBMSN_DEPT_WORK_YN_3, 0) ) * 10 + NVL(QTR_SHFA_ADD_SCR, 0) + NVL(CASE WHEN TO_CHAR(SYSDATE,'YYYY') <> A.INFO_YR THEN 0 WHEN TO_CHAR(SYSDATE,'YYYY') = A.INFO_YR AND TO_CHAR(SYSDATE,'MM') BETWEEN '01' AND '03' AND INFO_MLG_QTR_SECD ='1' AND TO_CHAR(SYSDATE,'MM') = '01' THEN 30 WHEN TO_CHAR(SYSDATE,'YYYY') = A.INFO_YR AND TO_CHAR(SYSDATE,'MM') BETWEEN '01' AND '03' AND INFO_MLG_QTR_SECD ='1' AND TO_CHAR(SYSDATE,'MM') = '02' THEN 20 WHEN TO_CHAR(SYSDATE,'YYYY') = A.INFO_YR AND TO_CHAR(SYSDATE,'MM') BETWEEN '01' AND '03' AND INFO_MLG_QTR_SECD ='1' AND TO_CHAR(SYSDATE,'MM') = '03' THEN 10 WHEN TO_CHAR(SYSDATE,'YYYY') = A.INFO_YR AND TO_CHAR(SYSDATE,'MM') BETWEEN '04' AND '06' AND INFO_MLG_QTR_SECD ='2' AND TO_CHAR(SYSDATE,'MM') = '04' THEN 30 WHEN TO_CHAR(SYSDATE,'YYYY') = A.INFO_YR AND TO_CHAR(SYSDATE,'MM') BETWEEN '04' AND '06' AND INFO_MLG_QTR_SECD ='2' AND TO_CHAR(SYSDATE,'MM') = '05' THEN 20 WHEN TO_CHAR(SYSDATE,'YYYY') = A.INFO_YR AND TO_CHAR(SYSDATE,'MM') BETWEEN '04' AND '06' AND INFO_MLG_QTR_SECD ='2' AND TO_CHAR(SYSDATE,'MM') = '06' THEN 10 WHEN TO_CHAR(SYSDATE,'YYYY') = A.INFO_YR AND TO_CHAR(SYSDATE,'MM') BETWEEN '07' AND '09' AND INFO_MLG_QTR_SECD ='3' AND TO_CHAR(SYSDATE,'MM') = '07' THEN 30 WHEN TO_CHAR(SYSDATE,'YYYY') = A.INFO_YR AND TO_CHAR(SYSDATE,'MM') BETWEEN '07' AND '09' AND INFO_MLG_QTR_SECD ='3' AND TO_CHAR(SYSDATE,'MM') = '08' THEN 20 WHEN TO_CHAR(SYSDATE,'YYYY') = A.INFO_YR AND TO_CHAR(SYSDATE,'MM') BETWEEN '07' AND '09' AND INFO_MLG_QTR_SECD ='3' AND TO_CHAR(SYSDATE,'MM') = '09' THEN 10 WHEN TO_CHAR(SYSDATE,'YYYY') = A.INFO_YR AND TO_CHAR(SYSDATE,'MM') BETWEEN '10' AND '12' AND INFO_MLG_QTR_SECD ='4' AND TO_CHAR(SYSDATE,'MM') = '10' THEN 30 WHEN TO_CHAR(SYSDATE,'YYYY') = A.INFO_YR AND TO_CHAR(SYSDATE,'MM') BETWEEN '10' AND '12' AND INFO_MLG_QTR_SECD ='4' AND TO_CHAR(SYSDATE,'MM') = '11' THEN 20 WHEN TO_CHAR(SYSDATE,'YYYY') = A.INFO_YR AND TO_CHAR(SYSDATE,'MM') BETWEEN '10' AND '12' AND INFO_MLG_QTR_SECD ='4' AND TO_CHAR(SYSDATE,'MM') = '12' THEN 10 ELSE 0 END,0) ) END /* 분기목표점수 */,  LAST_USER_ID = #LAST_USER_ID# /* 최종사용자ID */ ,  LAST_PRCS_DEPT_CD = #LAST_PRCS_DEPT_CD# /* 최종거래부서코드 */ ,  LAST_MENU_ID = #LAST_MENU_ID# /* 최종메뉴ID */ ,  LAST_MDFCN_DT = SYSDATE /* 최종수정일시 */ WHERE INFO_YR = #INFO_YR# AND INFO_MLG_QTR_SECD = #INFO_MLG_QTR_SECD#