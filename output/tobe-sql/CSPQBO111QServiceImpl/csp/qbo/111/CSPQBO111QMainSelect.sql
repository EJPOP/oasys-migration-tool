SELECT A.BOO_NO /* 도서번호 */,
    A.BOO_NO||'-'||A.BOO_VLE_NO AS BOO_NO,
    SUBSTR(TRIM(0
FROM A.BOO_NO||'1'),0,LENGTH(TRIM(0 FROM A.BOO_NO||'1'))-1) AS BOO_NO_R , A.BOO_VLE_NO /*권번호*/ , A.CAT_SYM_NM /*분류기호명*/ , SUBSTR(A.CAT_SYM_NM,1,1)||'-'||SUBSTR(A.CAT_SYM_NM,2,3)||'-'||SUBSTR(A.CAT_SYM_NM,5,3) AS CAT_SYM_NM2 , CASE WHEN SUBSTR(A.CAT_SYM_NM,5,3) = '000' THEN SUBSTR(A.CAT_SYM_NM,2,3) ELSE SUBSTR(A.CAT_SYM_NM,2,3)||'.'||SUBSTR(TRIM(0 FROM '1'||SUBSTR(A.CAT_SYM_NM,5,3)),2) END AS CAT_SYM_NM_R , A.PBC_YR /*발행년도*/ , CASE WHEN A.BOO_KND_CD = '04' AND TRIM(A.MTRL_MNG_YR) IS NOT NULL THEN '['||A.MTRL_MNG_YR||'-'||A.MTRL_MNG_DVSN_NO||'-'||A.MTRL_MNG_NO||']'||A.BOO_TIT_NM WHEN A.BOO_KND_CD ='03' AND TRIM(A.DEG_NM) IS NOT NULL THEN '['||A.DEG_NM||']'||A.BOO_TIT_NM ELSE A.BOO_TIT_NM END BOO_TIT_NM /*도서제목명*/ , A.PBC_PLAC_NM /*발행처명*/ , A.RSCH_RPTP_AUT_NM /*저자명*/ , A.BOO_LEND_DVSN_CD /*도서대출구분코드*/ , A.BOO_KND_CD /*도서종류코드*/ , CASE WHEN (A.COPT_CAT_CD = '1' AND A.STC_BKS = 'Y') THEN '3' WHEN (A.COPT_CAT_CD = '1' AND A.STC_BKS IS NULL) THEN '1' ELSE '2' END COPT_CAT_CD ,(CASE WHEN A.BOO_LEND_DVSN_CD = '0' AND ( CNT = 0 OR CNT IS NULL ) AND (SELECT C.LAG_INV_CNB
FROM TBCSPQBO002H C WHERE A.COPT_CAT_CD = C.COPT_CAT_CD AND A.BOO_KND_CD = C.BOO_KND_CD AND A.BOO_NO = C.BOO_NO AND A.CAT_SYM_NM = C.CAT_SYM_NM AND A.BOO_VLE_NO = C.BOO_VLE_NO AND C.BOO_REN_YN_CD = '0') != #strCNB# AND (SELECT COUNT(*)
FROM TBCSPQBO003H C WHERE A.COPT_CAT_CD = C.COPT_CAT_CD AND A.BOO_KND_CD = C.BOO_KND_CD AND A.BOO_NO = C.BOO_NO AND A.CAT_SYM_NM = C.CAT_SYM_NM AND A.BOO_VLE_NO = C.BOO_VLE_NO AND C.LEND_BOKG_STA_CD = 'Y' ) AND A.COPT_CAT_CD = #strCOPT_CAT_CD# AND A.BOO_VLE_NO = 1 AND A.BOO_NO &gt;= #strBOO_NOS# AND A.BOO_NO &lt;= #strBOO_NOE# AND A.BAR_CD = #strBAR_CD# AND A.BOO_ACP_DT &gt;= #strBOO_ACP_DTS# AND A.BOO_ACP_DT &lt;= #strBOO_ACP_DTE# AND A.BOO_KND_CD IN (SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) AS SUBSTR
FROM DUAL A CROSS JOIN(SELECT ','|| #strBOO_KND_CD# ||',' AS #STRBOO_KND_CD#
FROM DUAL) B CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 ) AND A.CAT_SYM_NM &gt;= #strCAT_SYM_NMS1#||#strCAT_SYM_NMS2#||#strCAT_SYM_NMS3# AND A.CAT_SYM_NM &lt;= #strCAT_SYM_NME1#||#strCAT_SYM_NME2#||#strCAT_SYM_NME3# AND A.PBC_YR &gt;= #strPBC_YRS# AND A.PBC_YR &lt;= #strPBC_YRE# AND UPPER(A.PBC_PLAC_NM) like '%'||UPPER(#strPBC_PLAC_NM#)||'%' AND UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM1#)||'%' AND (UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM1#)||'%' AND UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM3#)||'%') AND (UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM1#)||'%' OR UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM3#)||'%') AND (UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM1#)||'%' AND UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM2#)||'%') AND (UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM1#)||'%' OR UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM2#)||'%') AND (UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM1#)||'%' AND UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM2#)||'%' AND UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM3#)||'%') AND (UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM1#)||'%' AND (UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM2#)||'%' OR UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM3#)||'%')) AND ( (UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM1#)||'%' OR UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM2#)||'%') A.AND UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM3#)||'%') AND (UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM1#)||'%' OR UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM2#)||'%' OR UPPER(A.BOO_TIT_NM) like '%'||UPPER(#strBOO_TIT_NM3#)||'%') AND UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM1#)||'%' AND (UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM1#)||'%' AND UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM3#)||'%') AND (UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM1#)||'%' OR UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM3#)||'%') AND (UPPER(A.KYWD_NM ) like '%'||UPPER(#strKYWD_NM1#)||'%' AND UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM2#)||'%') AND (UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM1#)||'%' OR UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM2#)||'%') AND (UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM1#)||'%' AND UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM2#)||'%' AND UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM3#)||'%') AND (UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM1#)||'%' AND (UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM2#)||'%' OR UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM3#)||'%')) AND ( (UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM1#)||'%' OR UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM2#)||'%') AND UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM3#)||'%') AND (UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM1#)||'%' OR UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM2#)||'%' OR UPPER(A.KYWD_NM) like '%'||UPPER(#strKYWD_NM3#)||'%') AND UPPER(A.RSCH_RPTP_AUT_NM) LIKE '%'||UPPER(#strATR_NM#)||'%' AND A.MTRL_MNG_YR &gt;=#strMTRL_MNG_YRS# AND A.MTRL_MNG_DVSN_NO &gt;=#strMTRL_MNG_DVSN_NOS# AND A.MTRL_MNG_NO &gt;=#strMTRL_MNG_NOS# AND A.MTRL_MNG_YR &lt;=#strMTRL_MNG_YRE# AND A.MTRL_MNG_DVSN_NO &lt;=#strMTRL_MNG_DVSN_NOE# AND A.MTRL_MNG_NO &lt;=#strMTRL_MNG_NOE# AND A.AVDOC_SHP_CD = #strAVDOC_SHP_CD# AND A.INTNA_STND_BOO_NO LIKE '%'||#strINTNA_STND_BOO_NO#||'%' AND UPPER(A.BOO_SYM_NM) LIKE '%'||UPPER(#strBOO_SYM_NM#)||'%' AND A.STC_BKS = #strSTC_BKS#