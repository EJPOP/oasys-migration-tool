SELECT B.USER_NM AS USR_NAME, /* 이름*/ F_CODE_NM('1000173', F_USR_INFO(A.TRN_PEN_CNB, '3')) AS JBGD_NM, /* 현직급 */ A.TRN_STR_DT, /* 시작기간 */ A.TRN_END_DT, /* 종료기간*/ TO_CHAR(TO_DATE(A.TRN_STR_DT), 'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(A.TRN_END_DT), 'YYYY-MM-DD') || ' (' || CASE WHEN TO_DATE(A.TRN_END_DT,'YYYYMMDD') - TO_DATE(A.TRN_STR_DT,'YYYYMMDD') AND #stdDt# BETWEEN A.TRN_STR_DT AND A.TRN_END_DT AND A.TRN_STR_DT &lt;= #strDt# AND A.TRN_STR_DT &gt;= #strDt# AND A.TRN_END_DT &lt;= #endDt# AND A.TRN_END_DT &gt;= #endDt# AND A.TRN_END_DT &gt; TO_CHAR(SYSDATE,'YYYYMMDD') /* 훈련중 */ AND A.TRN_END_DT &lt; TO_CHAR(SYSDATE,'YYYYMMDD') /* 훈련종료 */ AND C.SRECS_RPT_YMD IS NOT NULL /* 작성 */ AND C.SRECS_RPT_YMD IS NULL /* 미작성 */ AND A.GEN_MNG_TRN_DVSN_CD = #trnDvsnCd# /* 훈련구분 */ AND A.TRN_STR_DT &gt;= #fromYmd# AND A.TRN_END_DT &lt;= #toYmd# AND C.SRECS_RPT_YMD &gt;= #fromRptDt# AND C.SRECS_RPT_YMD &lt;= #toRptDt# AND #fromTrnDay# &lt; TO_DATE(A.TRN_END_DT,'YYYYMMDD') - TO_DATE(A.TRN_STR_DT,'YYYYMMDD') /* 훈련일수FROM */ AND #toTrnDay# &gt; TO_DATE(A.TRN_END_DT,'YYYYMMDD') - TO_DATE(A.TRN_STR_DT,'YYYYMMDD') /* 훈련일수TO */ AND (A.TRN_TXT LIKE '%' || #searchBox# || '%' OR F_CODE_NM('1000181', A.TRN_BR_CD_1) LIKE '%' || #searchBox# || '%' OR F_CODE_NM('1000181', A.TRN_BR_CD_2) LIKE '%' || #searchBox# || '%' OR F_CODE_NM('1000181', A.TRN_BR_CD_3) LIKE '%' || #searchBox# || '%' OR B.USER_NM LIKE '%' || #searchBox# || '%') ORDER BY A.TRN_END_DT DESC