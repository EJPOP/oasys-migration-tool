SELECT A.CVLCPT_ADT_YR /* 민원감사년도 */,
    A.ADT_NO /* 감사번호 */,
    F_MNG_KND_AUDYRNO(A.CVLCPT_ADT_YR, A.ADT_NO, A.ADT_KDCD, '-') AS F_MNG_KND_AUDYRNO /* 감사연번호 */,
    A.ADT_MTTR_NM /* 감사사항명 */,
    A.SPRVSN_DEPT_CD /* 주관부서코드 */
FROM TB_BADDED001M A WHERE NOT EXISTS ( SELECT B.CVLCPT_ADT_YR /* 민원감사년도 */,
    B.TSK_NO
FROM TBCSPAOE021M B WHERE A.CVLCPT_ADT_YR = B.CVLCPT_ADT_YR AND A.ADT_NO = B.TSK_NO AND LENGTH(B.TSK_NO) = 3) AND A.CVLCPT_ADT_YR = #CVLCPT_ADT_YR# AND SUBSTR(A.ADT_KDCD, -1) NOT IN ('5','8','9') A.ADT_MTTR_NM LIKE '%'||#strAudSbjNm#||'%' A.ADT_GRNT_NO = #ADT_GRNT_NO# SUBSTR(A.ADT_KDCD,3,1) = #strAudYrNoKndCd# ORDER BY A.CVLCPT_ADT_YR, A.ADT_NO