WITH BASE AS ( SELECT SUM(CASE WHEN DE04.CFMTN_STTS_SECD != '2' AND DE04.ENFC_YMD = C.FDATE THEN DE04.NOP_CONT ELSE 0 END) AS OVER_YEAR_PSON , SUM(CASE WHEN DE04.ENFC_YMD BETWEEN C.FDATE AND C.TDATE THEN DE04.NOP_CONT ELSE 0 END) AS NEW_OPER_PSON , SUM(CASE WHEN DE04.CFMTN_STTS_SECD = '2' AND DE04.IMPL_WHLS_CFMTN_YMD BETWEEN C.FDATE AND C.TDATE THEN DE04.NOP_CONT ELSE 0 END) AS ENFO_PSON , SUM(CASE WHEN DE04.CFMTN_STTS_SECD != '2' AND DE04.ENFC_YMD C.TDATE AND MAIN.DSPS_RQT_KDCD = '210' AND DE04.PRCS_TERM_YMD C.TDATE) OR MAIN.DSPS_RQT_KDCD LIKE '6%') THEN DE04.NOP_CONT WHEN DE04.CFMTN_STTS_SECD = '2' AND DE04.ENFC_YMD C.TDATE AND ((MAIN.DSPS_RQT_KDCD = '210' AND DE04.PRCS_TERM_YMD > C.TDATE) OR MAIN.DSPS_RQT_KDCD LIKE '6%') THEN DE04.NOP_CONT ELSE 0 END) AS NENFO_OUTDLINE_PSON FROM TB_BADEAR002D DE04, TB_BADEAR001M MAIN, (SELECT #strYear# || '0101' /*월일 0101고정*/ FDATE,
    TO_CHAR(LAST_DAY(TO_DATE(#strStartFromDt#,'YYYYMM')),'YYYYMMDD') /*해당년월의 마지막일자 산출*/ AS TO_CHAR
FROM DUAL) C WHERE 1=1 AND DE04.ADT_NO = MAIN.ADT_NO AND DE04.DSPS_RQT_SQNO = MAIN.DSPS_RQT_SQNO AND DE04.ADT_YR = MAIN.ADT_YR AND MAIN.DSPS_RQT_KDCD IN ('210', '620', '621', '623') AND DE04.CFMTN_STTS_SECD != '0' ) SELECT OVER_YEAR_PSON + NEW_OPER_PSON AS OVER_YEAR_PSON /* 인원 계 */,
    OVER_YEAR_PSON /* 인원 전년이월 */,
    NEW_OPER_PSON /* 인원 신규발생 */,
    ENFO_PSON /* 인원 ****년 **월 집행 */,
    NENFO_INDLINE_PSON + NENFO_OUTDLINE_PSON AS NENFO_INDLINE_PSON /* 인원 기한도래 + 기한미도래 */,
    NENFO_INDLINE_PSON /* 인원 기한도래 */,
    NENFO_OUTDLINE_PSON /* 인원 기한미도래 */
FROM BASE