WITH TMP_TIT_TXT AS ( SELECT 'A' AS GUBUN1,
    '합 계' AS GUBUN2,
    '000' AS A0
FROM DUAL UNION ALL SELECT 'B' AS GUBUN1,
    '회 계 사 항 계' AS GUBUN2,
    '000' AS A0
FROM DUAL UNION ALL SELECT 'C' AS GUBUN1,
    '세 입 소 계' AS GUBUN2,
    'C01' AS A0
FROM DUAL UNION ALL SELECT 'D' AS GUBUN1,
    '세 출 소 계' AS GUBUN2,
    'D01' AS A0
FROM DUAL UNION ALL SELECT 'E' AS GUBUN1,
    '재산관리소계' AS GUBUN2,
    'E01' AS A0
FROM DUAL UNION ALL SELECT 'F' AS GUBUN1,
    '기업 관리 소계' AS GUBUN2,
    'F01' AS A0
FROM DUAL UNION ALL SELECT 'G' AS GUBUN1,
    '계 산 증 명' AS GUBUN2,
    'G01' AS A0
FROM DUAL UNION ALL SELECT 'H' AS GUBUN1,
    '감 찰 사 항 계' AS GUBUN2,
    '000' AS A0
FROM DUAL UNION ALL SELECT 'I' AS GUBUN1,
    '기획 · 인사 · 조직' AS GUBUN2,
    'I01' AS A0
FROM DUAL UNION ALL SELECT 'I' AS GUBUN1,
    '문서 · 협조' AS GUBUN2,
    'I02' AS A0
FROM DUAL UNION ALL SELECT 'I' AS GUBUN1,
    '규 제 행 정' AS GUBUN2,
    'I03' AS A0
FROM DUAL UNION ALL SELECT 'I' AS GUBUN1,
    '검 사 검 정' AS GUBUN2,
    'I04' AS A0
FROM DUAL UNION ALL SELECT 'I' AS GUBUN1,
    '인.허 가 사 무' AS GUBUN2,
    'I05' AS A0
FROM DUAL ) SELECT TIT_TXT.GUBUN1 AS GUBUN1,
    TIT_TXT.GUBUN2 AS GUBUN2,
    TIT_TXT.A0 AS A0,
    NVL(MAIN.B1,0) AS B1,
    NVL(MAIN.B2,0) AS B2,
    NVL(MAIN.B3,0) AS B3,
    NVL(MAIN.B4,0) AS B4
FROM (SELECT (CASE WHEN SUBSTR(DETAIL.VIOL_TPCD, 1, 1) IN ('1', '2') THEN 'A' END) AS SUBSTR,
    (CASE WHEN SUBSTR(DETAIL.VIOL_TPCD, 1, 1) IN ('1', '2') THEN '000' END) AS SUBSTR,
    SUM(CASE WHEN SUBSTR(DETAIL.ENFC_YMD,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt# ,1,6) THEN 1 ELSE 0 END) AS SUBSTR,
    /* 처분요구종류코드 조건 추가 - 2015.07.30 yyh */ SUM(CASE WHEN SUBSTR(DETAIL.ENFC_YMD,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt# ,1,6) AND (MASTER.DSPS_RQT_KDCD = '110' OR SUBSTR(MASTER.DSPS_RQT_KDCD,1,1) = '3') THEN ROUND(DETAIL.PNRT_PRSRV_AMT/1000,1) ELSE 0 END) AS SUBSTR,
    SUM(CASE WHEN SUBSTR(DETAIL.ENFC_YMD,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt# ,1,6) AND (MASTER.DSPS_RQT_KDCD = '110' OR MASTER.DSPS_RQT_KDCD IN ('310','320','390','391','395','396')) THEN ROUND((NVL(DETAIL.RMBR_AMT,0)+NVL(DETAIL.SPLP_AMT,0))/1000,1) ELSE 0 END) AS SUBSTR,
    /* * 610 제외 - 2015.07.30 yyh * NOT IN -> IN 으로 변경 - 2016.01.29 yyh */ SUM(CASE WHEN SUBSTR(DETAIL.ENFC_YMD,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt# ,1,6) /* AND MASTER.DSP_RQ_KND_CD NOT IN ('110','310','320','390','391','410','490','510','520','530', */ /* '610','611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */ /* '611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */ AND MASTER.DSPS_RQT_KDCD IN ('210','620','621','710','720','730','623') THEN DETAIL.NOP_CONT ELSE 0 END) AS SUBSTR
FROM TBBADEAR002D DETAIL, TBBADEAR001M MASTER WHERE DETAIL.CVLCPT_ADT_YR = MASTER.CVLCPT_ADT_YR AND DETAIL.ADT_NO = MASTER.ADT_NO AND DETAIL.DSPS_RQT_SQNO = MASTER.DSPS_RQT_SQNO AND DETAIL.ENFC_YMD BETWEEN #strStartFromDt# AND #strStartToDt# AND MASTER.DSPS_RQT_KDCD IN 으로 변경 - 2016.01.29 yyh */ SUM(CASE WHEN SUBSTR(DETAIL.ENFC_YMD,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt# ,1,6) /* AND MASTER.DSP_RQ_KND_CD NOT IN ('110','310','320','390','391','410','490','510','520','530', */ /* '610','611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */ /* '611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */ AND MASTER.DSPS_RQT_KDCD IN ('210','620','621','710','720','730','623') THEN DETAIL.TPOF_NOPE ELSE 0 END) AS B4 FROM TBBADEAR002D DETAIL, TBBADEAR001M MASTER WHERE DETAIL.CVLCPT_ADT_YR = MASTER.CVLCPT_ADT_YR AND DETAIL.ADT_NO = MASTER.ADT_NO AND DETAIL.DSPS_RQT_SQNO = MASTER.DSPS_RQT_SQNO AND DETAIL.ENFC_YMD BETWEEN #strStartFromDt# AND #strStartToDt# AND MASTER.DSPS_RQT_KDCD IN 으로 변경 - 2016.01.29 yyh */ SUM(CASE WHEN SUBSTR(DETAIL.ENFC_YMD,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt# ,1,6) /* AND MASTER.DSP_RQ_KND_CD NOT IN ('110','310','320','390','391','410','490','510','520','530', */ /* '610','611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */ /* '611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */ AND MASTER.DSPS_RQT_KDCD IN ('210','620','621','710','720','730','623') THEN DETAIL.TPOF_NOPE ELSE 0 END) AS B4 FROM TBBADEAR002D DETAIL, TBBADEAR001M MASTER WHERE DETAIL.CVLCPT_ADT_YR = MASTER.CVLCPT_ADT_YR AND DETAIL.ADT_NO = MASTER.ADT_NO AND DETAIL.DSPS_RQT_SQNO = MASTER.DSPS_RQT_SQNO AND DETAIL.ENFC_YMD BETWEEN #strStartFromDt# AND #strStartToDt# AND MASTER.DSPS_RQT_KDCD IN 으로 변경 - 2016.01.29 yyh */ SUM(CASE WHEN SUBSTR(DETAIL.ENFC_YMD,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt# ,1,6) /* AND MASTER.DSP_RQ_KND_CD NOT IN ('110','310','320','390','391','410','490','510','520','530', */ /* '610','611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */ /* '611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */ AND MASTER.DSPS_RQT_KDCD IN ('210','620','621','710','720','730','623') THEN DETAIL.TPOF_NOPE ELSE 0 END) AS B4 FROM TBBADEAR002D DETAIL, TBBADEAR001M MASTER WHERE DETAIL.CVLCPT_ADT_YR = MASTER.CVLCPT_ADT_YR AND DETAIL.ADT_NO = MASTER.ADT_NO AND DETAIL.DSPS_RQT_SQNO = MASTER.DSPS_RQT_SQNO AND DETAIL.ENFC_YMD BETWEEN #strStartFromDt# AND #strStartToDt# AND MASTER.DSPS_RQT_KDCD < '800' AND DETAIL.CFMTN_STTS_SECD != '0' AND (CASE WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '1' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('011','012','013','014') THEN 'C' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '1' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('021','022','023','024','025','026','027','028') THEN 'D' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '1' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('041','031','032','033','042','043','044','045','046') THEN 'E' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '1' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('051','061','062','063','064','065','066','067','072','073','071','068') THEN 'F' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '2' THEN 'I' END) IS NOT NULL GROUP BY (CASE WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '1' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('011','012','013','014') THEN 'C' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '1' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('021','022','023','024','025','026','027','028') THEN 'D' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '1' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('041','031','032','033','042','043','044','045','046') THEN 'E' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '1' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('051','061','062','063','064','065','066','067','072','073','071','068') THEN 'F' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '2' THEN 'I' END), (CASE WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '2' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('011','012','014','021','022','024') THEN 'I01' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '2' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('013','015','023','025') THEN 'I02' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '2' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('016','026') THEN 'I03' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '2' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('017','027') THEN 'I04' WHEN SUBSTR(DETAIL.VIOL_TPCD,1,1) = '2' AND SUBSTR(DETAIL.VIOL_TPCD,2,3) IN ('018','019','028','029') THEN 'I05' END) ) MAIN, TMP_TIT_TXT DSPS_RQT_NM WHERE MAIN.GUBUN1(+) = TIT_TXT.GUBUN1 AND MAIN.A0 (+) = TIT_TXT.A0 ORDER BY TIT_TXT.GUBUN1, TIT_TXT.A0