SELECT SUM(A1 + B1 + C1 + D1 + D4 + E1 + E2 + F1 + G1 + H1 + I1 + J1 + K1 + L1 + M1 + N1) AS A1,
    SUM(A2 + C2 + D2 + D5 + J2 + N2) AS A2,
    SUM(B2 + K2 + L2 + M2) AS B2,
    SUM(A3 + C3 + D3 + D6 + J3 + N3) AS A3
FROM ( SELECT CASE WHEN SUBSTR(KIKGU, 1, 1) = '1' THEN '1' WHEN SUBSTR(KIKGU, 1, 1) = '2' THEN '2' WHEN SUBSTR(KIKGU, 1, 1) = '3' THEN '3' ELSE '4' END AS SUBSTR,
    SUM(CASE WHEN CHBCD = '110' THEN NVL(GUNSU,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD = '110' THEN NVL(AM1,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD = '110' THEN NVL(AM2,0) + NVL(AM3,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD = '210' THEN NVL(GUNSU,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD = '210' THEN NVL(MAN,0) ELSE 0 END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '310' THEN NVL(GUNSU,0) ELSE CASE WHEN CHBCD = '320' THEN NVL(GUNSU,0) ELSE 0 END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '310' THEN NVL(AM1,0) ELSE CASE WHEN CHBCD = '320' THEN NVL(AM1,0) ELSE 0 END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '310' THEN NVL(AM2,0) + NVL(AM3,0) ELSE CASE WHEN CHBCD = '320' THEN NVL(AM2,0) + NVL(AM3,0) ELSE 0 END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '390' THEN NVL(GUNSU,0) ELSE CASE WHEN CHBCD = '391' THEN NVL(GUNSU,0) ELSE 0 END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '390' THEN NVL(AM1,0) ELSE CASE WHEN CHBCD = '391' THEN NVL(AM1,0) ELSE 0 END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '390' THEN NVL(AM2,0) + NVL(AM3,0) ELSE CASE WHEN CHBCD = '391' THEN NVL(AM2,0) + NVL(AM3,0) ELSE 0 END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '395' THEN NVL(GUNSU,0) ELSE CASE WHEN CHBCD = '396' THEN NVL(GUNSU,0) ELSE 0 END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '395' THEN NVL(AM1,0) ELSE CASE WHEN CHBCD = '396' THEN NVL(AM1,0) ELSE 0 END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '395' THEN NVL(AM2,0) + NVL(AM3,0) ELSE CASE WHEN CHBCD = '396' THEN NVL(AM2,0) + NVL(AM3,0) ELSE 0 END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '410' THEN NVL(GUNSU,0) ELSE CASE WHEN CHBCD = '490' THEN NVL(GUNSU,0) ELSE 0 END END) AS CHBCD,
    SUM(CASE WHEN CHBCD = '495' THEN NVL(GUNSU,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD = '510' THEN NVL(GUNSU,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD = '520' THEN NVL(GUNSU,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD = '530' THEN NVL(GUNSU,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD = '611' THEN NVL(GUNSU,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD IN ('610','630') THEN NVL(GUNSU,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD IN ('610','630') THEN NVL(AM1,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD IN ('610','630') THEN NVL(AM2,0) + NVL(AM3,0) ELSE 0 END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '620' THEN NVL(GUNSU,0) ELSE CASE WHEN CHBCD = '621' THEN NVL(GUNSU,0) ELSE 0 END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '620' THEN NVL(MAN,0) ELSE CASE WHEN CHBCD = '621' THEN NVL(MAN,0) ELSE 0 END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '710' THEN NVL(GUNSU,0) ELSE CASE WHEN CHBCD = '720' THEN NVL(GUNSU,0) ELSE CASE WHEN CHBCD = '730' THEN NVL(GUNSU,0) ELSE 0 END END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '710' THEN NVL(MAN,0) ELSE CASE WHEN CHBCD = '720' THEN NVL(MAN,0) ELSE CASE WHEN CHBCD = '730' THEN NVL(MAN,0) ELSE 0 END END END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '623' THEN NVL(GUNSU,0) ELSE 0 END) AS CHBCD,
    SUM( CASE WHEN CHBCD = '623' THEN NVL(MAN,0) ELSE 0 END) AS CHBCD,
    /* 통보(시정완료):625 추가 - 2017.01.20 yyh*/ SUM(CASE WHEN CHBCD = '625' THEN NVL(GUNSU,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD = '625' THEN NVL(AM1,0) ELSE 0 END) AS CHBCD,
    SUM(CASE WHEN CHBCD = '625' THEN NVL(AM2,0) + NVL(AM3,0) ELSE 0 END) AS CHBCD
FROM (SELECT YYMM, KIKGU, SOKIK, (CASE WHEN CHB_CD 0 THEN '390' WHEN CHB_CD 0 THEN '395' WHEN CHB_CD 0 THEN 1 END),0) + NVL(SUM(CASE WHEN CHB_CD 0 THEN 1 END),0) + NVL(SUM(CASE WHEN CHB_CD 0 THEN '390' WHEN CHB_CD 0 THEN '395' WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0 THEN '391' WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0 THEN '396' ELSE NULL END) ) STKIKW_F GROUP BY (CASE WHEN SUBSTR(KIKGU, 1, 1) = '1' THEN '1' WHEN SUBSTR(KIKGU, 1, 1) = '2' THEN '2' WHEN SUBSTR(KIKGU, 1, 1) = '3' THEN '3' ELSE '4' END) ) STKIKW_F_SUM