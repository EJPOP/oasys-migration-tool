SELECT '3급 이상' AS JIKGUB,
    /*구분명칭*/ NVL(SUM(CASE WHEN AA.ACTN_RQT_KDCD = '001' THEN AA.C1 ELSE 0 END),0) AS ACTN_RQT_KDCD /* 조치요구종류코드 */,
    /*파면*/ NVL(SUM(CASE WHEN AA.ACTN_RQT_KDCD = '006' OR AA.ACTN_RQT_KDCD = '007' THEN C1 ELSE 0 END),0) AS ACTN_RQT_KDCD /* 조치요구종류코드 */,
    /*고발*/ NVL(SUM(CASE WHEN AA.ACTN_RQT_KDCD = '002' OR AA.ACTN_RQT_KDCD = '003' OR AA.ACTN_RQT_KDCD = '013' THEN C1 ELSE 0 END),0) AS ACTN_RQT_KDCD /* 조치요구종류코드 */,
    /*징계_지정*/ NVL(SUM(CASE WHEN AA.ACTN_RQT_KDCD = '004' THEN AA.C1 ELSE 0 END),0) AS ACTN_RQT_KDCD /* 조치요구종류코드 */,
    /*징계_부지정*/ NVL(SUM(CASE WHEN AA.ACTN_RQT_KDCD = '009' THEN AA.C1 ELSE 0 END),0) AS ACTN_RQT_KDCD /* 조치요구종류코드 */,
    /*수사요청*/ NVL(SUM(CASE WHEN AA.ACTN_RQT_KDCD = '005' THEN AA.C1 ELSE 0 END),0) AS ACTN_RQT_KDCD /* 조치요구종류코드 */,
    /*통보(인사자료)*/ NVL(SUM(CASE WHEN AA.ACTN_RQT_KDCD = '015' THEN AA.C1 ELSE 0 END),0) AS ACTN_RQT_KDCD /* 조치요구종류코드 */
FROM (SELECT B.ACTN_RQT_KDCD /* 조치요구종류코드 */,
    1
FROM TBBADEAR002D A ,TBBADEAR001M C ,TBBADEAR007M B WHERE (A.ENFC_YMD >= #ENFC_YMD# AND A.ENFC_YMD = #ENFC_YMD# AND A.ENFC_YMD <= #strStartToDt#) AND C.DSPS_RQT_KDCD NOT LIKE '8%' AND A.ADT_NO = C.ADT_NO AND A.DSPS_RQT_SQNO = C.DSPS_RQT_SQNO AND A.CVLCPT_ADT_YR = C.CVLCPT_ADT_YR AND A.ADT_NO = B.ADT_NO AND A.DSPS_RQT_SQNO = B.DSPS_RQT_SQNO AND A.CVLCPT_ADT_YR = B.CVLCPT_ADT_YR AND C.INST_SECD LIKE '10' AND (B.JBGD_SECD NOT IN ('01', '02', '03', '61', '62') OR B.JBGD_SECD IS NULL) /* null 체크 추가 - 2016.02.01 yyh */ AND A.CFMTN_STTS_SECD != '0' ) BB