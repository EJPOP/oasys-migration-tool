SELECT NVL(SUM(HAM1), 0) + NVL(SUM(HAM2), 0) + NVL(SUM(HAM3), 0) + NVL(SUM(HAM4), 0) + NVL(SUM(HAM5), 0) AS HAM1,
    NVL(SUM(HAM1), 0) AS HAM1,
    NVL(SUM(HAM2), 0) AS HAM2,
    NVL(SUM(HAM3), 0) AS HAM3,
    NVL(SUM(HAM4), 0) AS HAM4,
    NVL(SUM(HAM5), 0) AS HAM5
FROM ( SELECT DETAIL.ENFC_DEPT_CD /* 시행부서코드 */,
    NVL(DETAIL.BGT_RTRC_AMT , 0) AS BGT_RTRC_AMT /* 예산절감금액 */,
    NVL(DETAIL.INCM_INCRS_AMT , 0) AS INCM_INCRS_AMT /* 수입증가금액 */,
    NVL(DETAIL.PPL_BRDN_RDT_AMT , 0) AS PPL_BRDN_RDT_AMT /* 국민부담경감금액 */,
    NVL(DETAIL.PRPT_INCRS_AMT , 0) AS PRPT_INCRS_AMT /* 재산증가금액 */,
    NVL(DETAIL.EXPND_RATI_AMT , 0) AS EXPND_RATI_AMT /* 지출합리화금액 */
FROM TBBADEAR001M MASTER , TBBADEAR002D DETAIL WHERE MASTER.CVLCPT_ADT_YR = DETAIL.CVLCPT_ADT_YR AND MASTER.ADT_NO = DETAIL.ADT_NO AND MASTER.DSPS_RQT_SQNO = DETAIL.DSPS_RQT_SQNO AND DETAIL.ENFC_YMD IS NOT NULL AND substr(DETAIL.ENFC_YMD,1,6) BETWEEN #strStartFromDt# AND #strStartToDt# AND (DETAIL.EXPT_EFCT_AMT_STTS_SECD = '1' OR (SUBSTR(DETAIL.ENFC_YMD, 1, 6) >= '199701' AND DETAIL.CFMTN_STTS_SECD != '0')) ) APCHB0_F