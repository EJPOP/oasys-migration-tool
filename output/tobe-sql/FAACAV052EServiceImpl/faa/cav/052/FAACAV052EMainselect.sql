/* faa/cav/052/FAACAV052EMainselect */ select ROWNUM,
    B.JRSD_CD||'-'||B.ACNTG_CD||'-'||B.BLL_KDCD||'-'||B.PROF_RBPRSN_SQNO||'-'|| B.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS JRSD_CD /* 소관코드 */,
    B.JRSD_CD /* 소관코드 */,
    B.ACNTG_CD /* 회계코드 */,
    B.BLL_KDCD /* 계산서종류코드 */,
    B.PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    B.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    C.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    B.PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    B.PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    C.period,
    C.period_nm,
    C.SRECS_RCPT_SECD /* 심사재심의접수구분코드 */,
    C.ACNTG_CDNM /* 회계코드명 */,
    C.M1,
    C.M2,
    C.M3,
    C.M4,
    C.M5,
    C.M6,
    C.M7,
    C.M8,
    C.M9,
    C.M10,
    C.M11,
    C.M12,
    C.M13
from (SELECT MN.JRSD_CD /* 소관코드 */,
    MN.ACNTG_CD /* 회계코드 */,
    MN.BLL_KDCD /* 계산서종류코드 */,
    MN.PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    MN.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    MN.PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    MN.PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'01' then 'O' else '*' end else case when A.period='03' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'01' then 'O' else '*' end else case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'01' then 'O' else '*' end end end AS PERIOD,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'02' then 'O' else '*' end else case when A.period='03' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'04' then 'O' else '*' end end end AS PERIOD,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'03' then 'O' else '*' end else case when A.period='03' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'07' then 'O' else '*' end end end AS PERIOD,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'04' then 'O' else '*' end else case when A.period='03' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'10' then 'O' else '*' end end end AS PERIOD,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'05' then 'O' else '*' end end AS PERIOD,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'06' then 'O' else '*' end end AS PERIOD,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'07' then 'O' else '*' end end AS PERIOD,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'08' then 'O' else '*' end end AS PERIOD,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'09' then 'O' else '*' end end AS PERIOD,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'10' then 'O' else '*' end end AS PERIOD,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'11' then 'O' else '*' end end AS PERIOD,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'12' then 'O' else '*' end end AS PERIOD,
    case when A.period='01' then case when SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,6) = #PROF_YR# ||'12' then case when MN.BLL_KDCD='19' then '*' else 'O' end else '*' end end AS PERIOD
FROM TWFAACAV003M mn, (SELECT MN.JRSD_CD /* 소관코드 */,
    MN.ACNTG_CD /* 회계코드 */,
    MN.BLL_KDCD /* 계산서종류코드 */,
    MN.PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    MN.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    MN.PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    MN.PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    MN.PROF_RBPRSN_BLL_RCPT_SECD /* 증명책임자계산서접수구분코드 */,
    CD.ACNTG_CDNM /* 회계코드명 */,
    case when MN.BLL_KDCD in('22', '23', '24') and MN.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO <> '000' then '01' else SUBSTR(CD.RMRK_DTL_CN,1,2) end AS BLL_KDCD /* 계산서종류코드 */,
    case when MSTR.MN1_STTS_SECD not in ('*') then 'O' else MSTR.MN1_STTS_SECD end AS MN1_STTS_SECD /* 1월상태구분코드 */,
    case when MSTR.MN2_STTS_SECD not in('*') then 'O' else MSTR.MN2_STTS_SECD end AS MN2_STTS_SECD /* 2월상태구분코드 */,
    case when MSTR.MN3_STTS_SECD not in('*') then 'O' else MSTR.MN3_STTS_SECD end AS MN3_STTS_SECD /* 3월상태구분코드 */,
    case when MSTR.MN4_STTS_SECD not in('*') then 'O' else MSTR.MN4_STTS_SECD end AS MN4_STTS_SECD /* 4월상태구분코드 */,
    case when MSTR.MN5_STTS_SECD not in('*') then 'O' else MSTR.MN5_STTS_SECD end AS MN5_STTS_SECD /* 5월상태구분코드 */,
    case when MSTR.MN6_STTS_SECD not in('*') then 'O' else MSTR.MN6_STTS_SECD end AS MN6_STTS_SECD /* 6월상태구분코드 */,
    case when MSTR.MN7_STTS_SECD not in('*') then 'O' else MSTR.MN7_STTS_SECD end AS MN7_STTS_SECD /* 7월상태구분코드 */,
    case when MSTR.MN8_STTS_SECD not in('*') then 'O' else MSTR.MN8_STTS_SECD end AS MN8_STTS_SECD /* 8월상태구분코드 */,
    case when MSTR.MN9_STTS_SECD not in('*') then 'O' else MSTR.MN9_STTS_SECD end AS MN9_STTS_SECD /* 9월상태구분코드 */,
    case when MSTR.MN10_STTS_SECD not in('*') then 'O' else MSTR.MN10_STTS_SECD end AS MN10_STTS_SECD /* 10월상태구분코드 */,
    case when MSTR.MN11_STTS_SECD not in('*') then 'O' else MSTR.MN11_STTS_SECD end AS MN11_STTS_SECD /* 11월상태구분코드 */,
    case when MSTR.MN12_STTS_SECD not in('*') then 'O' else MSTR.MN12_STTS_SECD end AS MN12_STTS_SECD /* 12월상태구분코드 */,
    case when MSTR.MN13_STTS_SECD not in('*') then 'O' else MSTR.MN13_STTS_SECD end AS MN13_STTS_SECD /* 13월상태구분코드 */
FROM TWFAACAV003M mn,TWFAACAV007M mstr,TWFAACAV024C cd WHERE SUBSTR(MN.PROF_RBPRSN_ABL_YMD,1,4) >= #PROF_YR# AND SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,4) = #PROF_YR# AND SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,4) '000' then '01' else SUBSTR (CD.RMRK_DTL_CN,1,2) end period ,case when MN.BLL_KDCD in('22', '23', '24') and MN.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO <> '000' then'월' else SUBSTR(CD.RMRK_DTL_CN,3,4) end period_nm ,case when MSTR.MN1_STTS_SECD not in ('*') then 'O' else MSTR.MN1_STTS_SECD end M1 ,case when MSTR.MN2_STTS_SECD not in('*') then 'O' else MSTR.MN2_STTS_SECD end M2 ,case when MSTR.MN3_STTS_SECD not in('*') then 'O' else MSTR.MN3_STTS_SECD end M3 ,case when MSTR.MN4_STTS_SECD not in('*') then 'O' else MSTR.MN4_STTS_SECD end M4 ,case when MSTR.MN5_STTS_SECD not in('*') then 'O' else MSTR.MN5_STTS_SECD end M5 ,case when MSTR.MN6_STTS_SECD not in('*') then 'O' else MSTR.MN6_STTS_SECD end M6 ,case when MSTR.MN7_STTS_SECD not in('*') then 'O' else MSTR.MN7_STTS_SECD end M7 ,case when MSTR.MN8_STTS_SECD not in('*') then 'O' else MSTR.MN8_STTS_SECD end M8 ,case when MSTR.MN9_STTS_SECD not in('*') then 'O' else MSTR.MN9_STTS_SECD end M9 ,case when MSTR.MN10_STTS_SECD not in('*') then 'O' else MSTR.MN10_STTS_SECD end M10 ,case when MSTR.MN11_STTS_SECD not in('*') then 'O' else MSTR.MN11_STTS_SECD end M11 ,case when MSTR.MN12_STTS_SECD not in('*') then 'O' else MSTR.MN12_STTS_SECD end M12 ,case when MSTR.MN13_STTS_SECD not in('*') then 'O' else MSTR.MN13_STTS_SECD end M13 FROM TWFAACAV003M mn,TWFAACAV007M mstr,TWFAACAV024C cd WHERE SUBSTR(MN.PROF_RBPRSN_ABL_YMD,1,4) >= #PROF_YR# AND SUBSTR(MN.PROF_RBPRSN_CRT_YMD,1,4) C.M1 or B.M1<> C.M1 or B.M2<> C.M2 or B.M3<> C.M3 or B.M4<> C.M4 or B.M5<> C.M5 or B.M6<> C.M6 or B.M7<> C.M7 or B.M8<> C.M8 or B.M9<> C.M9 or B.M10<> C.M10 or B.M11<> C.M11 or B.M12<> C.M12 or B.M13 &lt;&gt; C.M13) ) UNION /* 증명자 부호는 없는데 마스터 테이블에는 값이 있는경우 처리 */ select ROWNUM,
    JRSD_CD||'-'||ACNTG_CD||'-'||BLL_KDCD||'-'||PROF_RBPRSN_SQNO||'-'|| GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS JRSD_CD /* 소관코드 */,
    JRSD_CD /* 소관코드 */,
    ACNTG_CD /* 회계코드 */,
    BLL_KDCD /* 계산서종류코드 */,
    PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    period,
    period_nm,
    SRECS_RCPT_SECD /* 심사재심의접수구분코드 */,
    ACNTG_CDNM /* 회계코드명 */,
    MN1_STTS_SECD /* 1월상태구분코드 */,
    MN2_STTS_SECD /* 2월상태구분코드 */,
    MN3_STTS_SECD /* 3월상태구분코드 */,
    MN4_STTS_SECD /* 4월상태구분코드 */,
    MN5_STTS_SECD /* 5월상태구분코드 */,
    MN2_STTS_SECD /* 2월상태구분코드 */,
    MN7_STTS_SECD /* 7월상태구분코드 */,
    MN8_STTS_SECD /* 8월상태구분코드 */,
    MN9_STTS_SECD /* 9월상태구분코드 */,
    MN10_STTS_SECD /* 10월상태구분코드 */,
    MN11_STTS_SECD /* 11월상태구분코드 */,
    MN12_STTS_SECD /* 12월상태구분코드 */,
    MN13_STTS_SECD /* 13월상태구분코드 */
from ( select B.JRSD_CD /* 소관코드 */,
    B.ACNTG_CD /* 회계코드 */,
    B.BLL_KDCD /* 계산서종류코드 */,
    B.PROF_RBPRSN_SQNO /* 증명책임자순번 */,
    B.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO /* 관서운영경비출납공무원순번 */,
    A.PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    A.PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    A.PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */,
    case when B.BLL_KDCD in('22', '23', '24') and B.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO <> '000' then '01' else SUBSTR (C.RMRK_DTL_CN,1,2) end AS BLL_KDCD /* 계산서종류코드 */,
    case when B.BLL_KDCD in('22', '23', '24') and B.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO <> '000' then '월' else SUBSTR(C.RMRK_DTL_CN,3,4) end AS BLL_KDCD /* 계산서종류코드 */,
    A.PROF_RBPRSN_BLL_RCPT_SECD /* 증명책임자계산서접수구분코드 */,
    C.ACNTG_CDNM /* 회계코드명 */,
    MN1_STTS_SECD /* 1월상태구분코드 */,
    MN2_STTS_SECD /* 2월상태구분코드 */,
    MN3_STTS_SECD /* 3월상태구분코드 */,
    MN4_STTS_SECD /* 4월상태구분코드 */,
    MN5_STTS_SECD /* 5월상태구분코드 */,
    MN6_STTS_SECD /* 6월상태구분코드 */,
    MN7_STTS_SECD /* 7월상태구분코드 */,
    MN8_STTS_SECD /* 8월상태구분코드 */,
    MN9_STTS_SECD /* 9월상태구분코드 */,
    MN10_STTS_SECD /* 10월상태구분코드 */,
    MN11_STTS_SECD /* 11월상태구분코드 */,
    MN12_STTS_SECD /* 12월상태구분코드 */,
    MN13_STTS_SECD /* 13월상태구분코드 */
from TWFAACAV003M A,TWFAACAV007M B, TWFAACAV024C C WHERE A.JRSD_CD(+) = B.JRSD_CD AND A.ACNTG_CD(+) = B.ACNTG_CD AND A.BLL_KDCD(+) = B.BLL_KDCD AND A.PROF_RBPRSN_SQNO(+) = B.PROF_RBPRSN_SQNO AND A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO(+) = B.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AND B.PROF_YR = #PROF_YR# AND C.ACNTG_SECD = '03' AND C.ACNTG_CD = B.BLL_KDCD ) A where A.PROF_RBPRSN_CRT_YMD is null ORDER BY KEY, PROF_DRTR_SG