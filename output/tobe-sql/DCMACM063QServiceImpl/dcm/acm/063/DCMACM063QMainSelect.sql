SELECT A.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    NULL AS TRGT_NOP_ENO,
    A.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    A.HIRK_DPT_CD,
    A.SRT_DESC,
    A.CD_DESC,
    LVL
FROM ( SELECT DISTINCT A.SRECS_DEPT_CD AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    A.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    CASE WHEN A.SRECS_DEPT_CD = A.HIRK_DPT_CD THEN NULL WHEN A.SRECS_DEPT_CD = #SRECS_DEPT_CD# THEN NULL ELSE A.HIRK_DPT_CD END AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    SYS_CONNECT_BY_PATH(LPAD(NVL(A.CRU_SORT_SQNO, 0), 3, '0'), '>') AS SYS_CONNECT_BY_PATH,
    SUBSTR(SYS_CONNECT_BY_PATH(A.SRECS_DEPT_CD, '>'), 2) AS SUBSTR,
    LEVEL
FROM TBDCMACM002M A WHERE 1=1 AND USE_YN = 'Y' START WITH A.SRECS_DEPT_CD = #SRECS_DEPT_CD# CONNECT BY PRIOR A.SRECS_DEPT_CD = HIRK_DPT_CD ) A UNION ALL SELECT A.TRGT_NOP_ENO AS TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    A.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    A.USER_NM AS USER_NM /* 사용자명 */,
    A.HIRK_DPT_CD,
    A.SRT_DESC,
    A.CD_DESC,
    LVL
FROM ( SELECT DISTINCT A.SRECS_DEPT_CD AS SRECS_DEPT_CD /* 심사재심의부서코드 */,
    A.CNSTN_MBCMT_DEPT_NM /* 자문위원부서명 */,
    A.SRECS_DEPT_CD /* 심사재심의부서코드 */,
    SYS_CONNECT_BY_PATH(LPAD(NVL(A.CRU_SORT_SQNO, 0), 3, '0'), '>') AS SYS_CONNECT_BY_PATH,
    SUBSTR(SYS_CONNECT_BY_PATH(A.SRECS_DEPT_CD, '>'), 2) AS SUBSTR,
    LEVEL,
    B.TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    B.USER_NM /* 사용자명 */
FROM TBDCMACM002M A ,TBDCMACM001M B WHERE 1=1 AND USE_YN = 'Y' AND A.SRECS_DEPT_CD =B.SRECS_DEPT_CD AND B.RQS_STA_CD ='3' AND B.USR_DVSN_CD = '1' AND B.TRGT_NOP_ENO < '5000' START WITH A.SRECS_DEPT_CD = #SRECS_DEPT_CD# CONNECT BY PRIOR A.SRECS_DEPT_CD = HIRK_DPT_CD ) A ORDER BY SRT_DESC