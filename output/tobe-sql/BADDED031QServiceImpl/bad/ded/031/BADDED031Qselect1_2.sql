SELECT SITU.BZTRP_YR||'-'||SITU.BZTRP_SQNO AS BZTRP_YR /* 출장년도 */,
    F_CODE_NM('1000021',SITU.GNRL_BZTRP_KDCD) AS F_CODE_NM,
    SITU.BZTRP_NM /* 출장명 */,
    TE.BZTRP_BGNG_YMD /* 출장시작일자 */,
    TE.BZTRP_END_YMD /* 출장종료일자 */,
    TE.BZTRP_DCN /* 출장일수 */,
    TE.LDG_DCN /* 숙박일수 */,
    TE.BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    TE.BTEXP_CRTR_AMT /* 출장비기준금액 */,
    TE.LDG_CST /* 숙박비용 */,
    NVL(TFD.RL_FARE_AMT, 0) + NVL(TE.CPRG_FARE_CST,0) AS RL_FARE_AMT /* 철도운임금액 */,
    '' AS STT_RMK_EXP,
    TE.BZTRP_TRVEXP_FDEXP + TE.BTEXP_CRTR_AMT + TE.LDG_CST + NVL(TFD.RL_FARE_AMT, 0) + NVL(TE.CPRG_FARE_CST,0) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */
FROM TB_BADDED002M SITU, (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    MIN(BZTRP_BGNG_YMD) AS BZTRP_BGNG_YMD /* 출장시작일자 */,
    MAX(BZTRP_END_YMD) AS BZTRP_END_YMD /* 출장종료일자 */,
    SUM(BZTRP_DCN) AS BZTRP_DCN /* 출장일수 */,
    SUM(LDG_DCN) AS LDG_DCN /* 숙박일수 */,
    SUM(BZTRP_TRVEXP_FDEXP) AS BZTRP_TRVEXP_FDEXP /* 출장여비식비 */,
    SUM(BTEXP_CRTR_AMT) AS BTEXP_CRTR_AMT /* 출장비기준금액 */,
    SUM(LDG_CST) AS LDG_CST /* 숙박비용 */,
    SUM(CPRG_FARE_CST) AS CPRG_FARE_CST /* 수도권운임비용 */
FROM TBBADDED011L WHERE 1=1 AND BZTRVR_ENO = #BZTRVR_ENO# /*전산번호*/ AND BZTRP_BGNG_YMD >= #strBztStrDt# /*화면 출장일자 FROM*/ AND BZTRP_END_YMD <= #strBztEndDt# /*화면 출장일자 TO*/ AND CMPTN_YN = 'Y' GROUP BY BZTRP_YR, BZTRP_SQNO, BZTRVR_ENO) TE, (SELECT BZTRP_YR /* 출장년도 */,
    BZTRP_SQNO /* 출장순번 */,
    BZTRVR_ENO /* 출장자직원전산번호 */,
    SUM(RL_FARE_AMT) AS RL_FARE_AMT /* 철도운임금액 */
FROM TBBADDED017L WHERE 1=1 AND BZTRVR_ENO = #BZTRVR_ENO# /*전산번호*/ AND CMPTN_YN = 'Y' GROUP BY BZTRP_YR, BZTRP_SQNO, BZTRVR_ENO) TFD WHERE 1=1 AND TE.BZTRVR_ENO = #BZTRVR_ENO# /*전산번호*/ AND TFD.BZTRP_YR(+) = TE.BZTRP_YR AND TFD.BZTRP_SQNO(+) = TE.BZTRP_SQNO AND TFD.BZTRVR_ENO (+) = TE.BZTRVR_ENO AND SITU.BZTRP_YR = TE.BZTRP_YR AND SITU.BZTRP_SQNO = TE.BZTRP_SQNO AND SITU.BZTRP_SECD = '2' /*일반출장*/