SELECT ROW_NUMBER() OVER(PARTITION BY A.INFO_YR, A.FRS_MDM_SQNO ORDER BY A.BZTRP_BGNG_YMD, A.BZTRP_END_YMD) AS ROW_NUMBER,
    TO_CHAR(TO_DATE(A.BZTRP_BGNG_YMD, 'YYYYMMDD'), 'MM.DD') || '~' || TO_CHAR(TO_DATE(A.BZTRP_END_YMD, 'YYYYMMDD'), 'MM.DD') || '/' || A.DSPS_RQT_NM || '/' || (SELECT B.PROF_RBPRSN_INST_NM AS BZTRP_BGNG_YMD /* 출장시작일자 */
FROM TBDCMACM015M B WHERE B.INST_CD = A.INST_CD) || CASE WHEN A.INST_CONT = 0 THEN NULL ELSE ' 외 ' || A.INST_CONT END AS BZT_SITU , A.INFO_YR , A.FRS_MDM_SQNO FROM (SELECT C.INFO_YR /* 정보년도 */,
    C.FRS_MDM_SQNO /* 포렌식매체순번 */,
    A.BZTRP_BGNG_YMD /* 출장시작일자 */,
    A.BZTRP_END_YMD /* 출장종료일자 */,
    B.BZTRP_NM /* 출장명 */,
    (SELECT MIN(D.INST_CD) AS INST_CD /* 기관코드 */
FROM TBBADDED008L D WHERE D.BZTRP_YR = A.BZTRP_YR AND D.BZTRP_SQNO = A.BZTRP_SQNO AND D.FT_SQNO = A.FT_SQNO) AS INST_CD , (SELECT COUNT(*) - 1
FROM TBBADDED008L D WHERE D.BZTRP_YR = A.BZTRP_YR AND D.BZTRP_SQNO = A.BZTRP_SQNO AND D.FT_SQNO = A.FT_SQNO) AS INST_CONT FROM TBBADDED005L A , TBBADDED002M B , TBCSPBII170M C WHERE A.BZTRP_YR = B.BZTRP_YR AND A.BZTRP_SQNO = B.BZTRP_SQNO AND A.BZTRVR_ENO = C.PRSNR_ENO AND A.BZTRP_BGNG_YMD >= TO_CHAR(ADD_MONTHS(TO_DATE(C.SBMSN_YMD, 'YYYYMMDD'), -3), 'YYYYMMDD') AND A.BZTRP_END_YMD AND C.NTFCTN_RCPT_YMD BETWEEN #strStrAcpDt# AND #strEndAcpDt# AND C.CRU_RCPT_DT BETWEEN #strStrAcpDh# AND #strEndAcpDh# AND C.HNDT_YMD BETWEEN #strStrAcpDt# AND #strEndAcpDt# AND (C.INFO_YR, C.FRS_MDM_SQNO) IN (SELECT REGEXP_SUBSTR(#strYeList#, '[^||]+', 1, LEVEL),
    REGEXP_SUBSTR(#strSrnoList#, '[^||]+', 1, LEVEL)
FROM DUAL CONNECT BY LEVEL &lt;= REGEXP_COUNT(#strYeList#, '[^|]+')) AND C.OVRL_PIC_ENO = #OVRL_PIC_ENO# AND C.INFO_YR = #INFO_YR# AND C.FRS_MDM_SQNO = #FRS_MDM_SQNO# ) A ORDER BY BZT_SITU_NO