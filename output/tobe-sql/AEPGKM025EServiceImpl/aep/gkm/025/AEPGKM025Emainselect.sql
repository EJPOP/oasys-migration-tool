SELECT D1.EVL_YR,
    D1.EVL_DVSN_CD,
    D1.EVL_STR_DT,
    D1.EVL_END_DT,
    D1.EVL_ACTV_STR_DT,
    D1.EVL_ACTV_END_DT,
    D1.EVL_USR_CNT,
    D1.CFMTN_YN /* 확정여부 */,
    DECODE(TRIM(D2.EVL_YR), '', 'N', 'Y') AS TRIM
FROM ( SELECT A.EVL_YR,
    A.EVL_DVSN_CD,
    EVL_STR_DT,
    EVL_END_DT,
    EVL_ACTV_STR_DT,
    EVL_ACTV_END_DT,
    COUNT(B.TRGT_NOP_ENO) AS TRGT_NOP_ENO /* 대상인원직원전산번호 */,
    CFMTN_YN /* 확정여부 */
FROM TBAEPGKM011M AS A, TBAEPGKM013L AS B WHERE 1=1 AND A.EVL_YR = B.EVL_YR(+) AND A.EVL_DVSN_CD = B.EVL_DVSN_CD(+) A.EVL_YR = #EVL_YR# A.EVL_DVSN_CD = #EVL_DVSN_CD# GROUP BY A.EVL_YR, A.EVL_DVSN_CD, EVL_STR_DT, EVL_END_DT, EVL_ACTV_STR_DT, EVL_ACTV_END_DT, CFMTN_YN ORDER BY EVL_YR DESC, EVL_DVSN_CD ) D1 , ( SELECT EVL_YR,
    EVL_DVSN_CD
FROM TBAEPGKM016L WHERE EVL_RK_CD IS NOT NULL GROUP BY EVL_YR,EVL_DVSN_CD ) D2 /*평가를 했냐 안했냐를 체크하기 위해서 추가함*/ WHERE D1.EVL_YR = D2.EVL_YR (+) AND D1.EVL_DVSN_CD = D2.EVL_DVSN_CD (+)