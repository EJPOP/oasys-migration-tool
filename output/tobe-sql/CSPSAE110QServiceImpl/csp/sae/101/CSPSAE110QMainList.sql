SELECT SUBSTR(D.EDU_BGNG_YMD, 0, 4) AS LINK_YR /* 연계년도 */,
    A.EDU_DVSN_CD,
    A.EDU_DVSN_NM,
    B.EDU_CAT_CD,
    B.EDU_CAT_NM,
    C.CRS_CD,
    C.CRS_NM /* 과정명 */,
    D.CRS_CDN /* 과정기수 */,
    D.EDU_BGNG_YMD /* 교육시작일자 */,
    D.EDU_END_YMD /* 교육종료일자 */,
    SUBSTR(D.EDU_BGNG_YMD, 0, 4)||'-'||SUBSTR(D.EDU_BGNG_YMD, 5, 2)||'-'||SUBSTR(D.EDU_BGNG_YMD, 7, 2)||' ~ '||SUBSTR(D.EDU_END_YMD, 0,4)||'-'||SUBSTR(D.EDU_END_YMD, 5,2)||'-'||SUBSTR(D.EDU_END_YMD, 7,2) AS SUBSTR,
    E.EDU_PRD_TXT,
    E.EDU_TG_TXT
FROM TBCSPSAE101C A , TBCSPSAE102C B , TBCSPSAE103C C , TBCSPSAE201D D , TBCSPSAE201M E , TBCSPSAE203D F WHERE B.EDU_DVSN_CD = A.EDU_DVSN_CD AND C.EDU_DVSN_CD = B.EDU_DVSN_CD AND C.EDU_CAT_CD = B.EDU_CAT_CD AND D.CRS_CD = C.CRS_CD AND E.LINK_YR = D.LINK_YR AND E.CRS_CD = D.CRS_CD AND F.LINK_YR = D.LINK_YR AND F.CRS_CD = D.CRS_CD AND F.CRS_CDN = D.CRS_CDN AND F.ASG_YN = 'Y' AND SUBSTR(D.EDU_BGNG_YMD, 0, 6) BETWEEN SUBSTR(#strFromYm#, 0, 6) AND SUBSTR(#strToYm#, 0, 6) AND A.EDU_DVSN_CD = #strEDU_DVSN_CD# AND B.EDU_CAT_CD = #strEDU_CAT_CD# AND C.CRS_CD = #strEDU_CRS_CD# AND D.CRS_CDN = #CRS_CDN# ORDER BY D.EDU_BGNG_YMD, A.EDU_DVSN_CD, B.EDU_CAT_CD, C.CRS_CD, D.CRS_CDN