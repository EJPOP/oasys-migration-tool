SELECT A.LINK_YR /* 연계년도 */,
    A.EDU_DVSN_CD,
    A.EDU_CAT_CD,
    A.CRS_CD,
    B.CRS_CDN /* 과정기수 */,
    B.EDU_BGNG_YMD /* 교육시작일자 */,
    B.EDU_END_YMD /* 교육종료일자 */
FROM ( SELECT LINK_YR /* 연계년도 */,
    EDU_DVSN_CD,
    EDU_CAT_CD,
    CRS_CD,
    CRS_CDN /* 과정기수 */
FROM ( SELECT D1.LINK_YR /* 연계년도 */,
    D1.CRS_CD,
    D1.CRS_CDN /* 과정기수 */,
    T1.EDU_DVSN_CD,
    T2.EDU_CAT_CD,
    TRUNC(TO_DATE(D1.EDU_BGNG_YMD, 'YYYYMMDD') - SYSDATE) AS TRUNC
FROM TBCSPSAE201D D1 , TBCSPSAE101C T1 , TBCSPSAE102C T2 , TBCSPSAE103C T3 WHERE D1.EDU_BGNG_YMD > TO_CHAR(SYSDATE, 'YYYYMMDD') AND T3.CRS_CD = D1.CRS_CD AND T2.EDU_CAT_CD = T3.EDU_CAT_CD AND T2.EDU_DVSN_CD = T3.EDU_DVSN_CD AND T1.EDU_DVSN_CD = T2.EDU_DVSN_CD ORDER BY DAY_C, CRS_CDN ) ) A , TBCSPSAE201D B WHERE B.LINK_YR = A.LINK_YR AND B.CRS_CD = A.CRS_CD AND A.CRS_CDN < B.CRS_CDN AND ROWNUM = 1