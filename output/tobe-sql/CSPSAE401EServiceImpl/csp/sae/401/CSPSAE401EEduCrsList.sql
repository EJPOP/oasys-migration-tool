SELECT A.EDU_DVSN_CD,
    A.EDU_DVSN_NM,
    A.EDU_CAT_CD,
    A.EDU_CAT_NM,
    A.CRS_CD,
    A.CRS_NM /* 과정명 */,
    A.USE_YN /* 사용여부 */,
    A.NEED_YN
FROM ( SELECT A.EDU_DVSN_CD,
    A.EDU_DVSN_NM,
    B.EDU_CAT_CD,
    B.EDU_CAT_NM,
    C.CRS_CD,
    C.CRS_NM /* 과정명 */,
    C.USE_YN /* 사용여부 */,
    C.NEED_YN
FROM TBCSPSAE101C A , TBCSPSAE102C B , TBCSPSAE103C C WHERE 1=1 AND B.EDU_DVSN_CD = A.EDU_DVSN_CD AND C.EDU_DVSN_CD = A.EDU_DVSN_CD AND C.EDU_CAT_CD = B.EDU_CAT_CD UNION SELECT A.EDU_DVSN_CD,
    A.EDU_DVSN_NM,
    B.EDU_CAT_CD,
    B.EDU_CAT_NM,
    '' AS CRS_CD,
    '' AS CRS_NM /* 과정명 */,
    'N' AS USE_YN /* 사용여부 */,
    'N' AS NEED_YN
FROM TBCSPSAE101C A , TBCSPSAE102C B WHERE 1=1 AND B.EDU_DVSN_CD = A.EDU_DVSN_CD AND B.EDU_CAT_CD NOT IN (SELECT C.EDU_CAT_CD
FROM TBCSPSAE103C C WHERE C.EDU_DVSN_CD = A.EDU_DVSN_CD AND C.EDU_CAT_CD = B.EDU_CAT_CD)) A WHERE 1=1 AND A.EDU_DVSN_CD = #strEDU_DVSN_CD# AND A.EDU_CAT_CD = #strEDU_CAT_CD# AND A.CRS_NM LIKE '%' || #strCRS_CD# || '%' ORDER BY A.EDU_DVSN_CD, A.EDU_CAT_CD, A.CRS_CD