SELECT T1.USER_HSTRY_SECD /* 사용자이력구분코드 */,
    T1.FRS_MDM_SQNO /* 포렌식매체순번 */,
    T1.KEY1,
    T1.KEY2,
    T1.KEY3,
    T1.KEY4,
    T1.TITLE
FROM ( SELECT A.CVLCPT_CLM_SECD AS CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    A.TPOF_RCPT_YR||'-'||F_CODE_NM('1000740',A.CVLCPT_CLM_SECD)||'-'||A.TPOF_ACTL_RCPT_NO AS FRS_MDM_SQNO /* 포렌식매체순번 */,
    A.TPOF_RCPT_YR /* 제보접수년도 */,
    A.CVLCPT_CLM_SECD /* 민원청구구분코드 */,
    A.TPOF_RCPT_NO /* 제보접수번호 */,
    '' AS KEY4,
    A.TPOF_NM /* 제보명 */
FROM TBCSPDCP101M A WHERE 1 = 1 AND A.CRU_PRCS_PRCS_STTS NOT IN ('10') AND A.TPOF_ACTL_RCPT_NO IS NOT NULL AND TO_CHAR(A.CRU_RCPT_DT,'YYYYMMDD') BETWEEN NVL(#strACP_DHS#,'19000101') AND NVL(#strACP_DHE#,'99991231') AND 1 = CASE WHEN #CLM_SECD# IN ('1','2','3') THEN 1 ELSE 0 END AND A.CLM_SECD = #CLM_SECD# AND A.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND A.TPOF_ACTL_RCPT_NO = #CRU_ACTL_RCPT_NO# AND A.TPOF_CVLPR_NM LIKE '%' || #strCVPTR_NM# || '%' AND A.RSCH_ASMT_TTL LIKE '%' || #strTIT_NM# || '%' UNION ALL SELECT A.CLM_SECD AS CLM_SECD /* 청구구분코드 */,
    A.CLM_YR||'-국회-'||A.CLM_RCPT_NO AS FRS_MDM_SQNO /* 포렌식매체순번 */,
    A.CLM_YR /* 청구년도 */,
    A.CLM_SECD /* 청구구분코드 */,
    A.CLM_RCPT_NO /* 청구접수번호 */,
    '' AS KEY4,
    A.CLM_TTL /* 청구제목 */
FROM TBCSPEAR007M A WHERE 1=1 AND A.CLM_YMD BETWEEN NVL(#strACP_DHS#,'19000101') AND NVL(#strACP_DHE#,'99991231') AND A.CLM_SECD = #CLM_SECD# AND A.CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND A.CVLCPT_RCPT_RCPT = #CRU_ACTL_RCPT_NO# AND A.PIC_NM LIKE '%' || #strCVPTR_NM# || '%' AND A.CLM_TTL LIKE '%' || #strTIT_NM# || '%' UNION ALL SELECT '0' AS USER_HSTRY_SECD /* 사용자이력구분코드 */,
    A.INFO_YR||'-정보-'||A.INFO_SQNO AS FRS_MDM_SQNO /* 포렌식매체순번 */,
    A.INFO_YR /* 정보년도 */,
    TO_CHAR(A.INFO_SQNO) AS TO_CHAR,
    '' AS KEY3,
    '' AS KEY4,
    A.INFO_NM /* 정보명 */
FROM TBCSPBII100M A WHERE 1=1 AND A.NTFCTN_RCPT_YMD BETWEEN NVL(#strACP_DHS#,'19000101') AND NVL(#strACP_DHE#,'99991231') AND '0' = #CLM_SECD# AND A.INFO_YR = #CVLCPT_RCPT_YR# AND A.FRS_MDM_SQNO = #CRU_ACTL_RCPT_NO# AND A.DSPS_RQT_NM LIKE '%' || #strTIT_NM# || '%' UNION ALL SELECT CASE WHEN SRECS_RCPT_SECD = '1' THEN '5' WHEN SRECS_RCPT_SECD = '2' THEN '6' WHEN SRECS_RCPT_SECD = '3' THEN '7' END AS USER_HSTRY_SECD /* 사용자이력구분코드 */,
    CASE WHEN CVLCPT_RCPT_YR >= '2016' THEN CVLCPT_RCPT_YR || '-' || DECODE(SRECS_RCPT_SECD,'1','심사','2','재심','3','재심판정') || '-' || SRECS_RCPT_SQNO ELSE CVLCPT_RCPT_YR || '-' || SRECS_RCPT_SECD || '-' || SRECS_RCPT_SQNO END AS FRS_MDM_SQNO /* 포렌식매체순번 */,
    CVLCPT_RCPT_YR /* 민원접수년도 */,
    SRECS_RCPT_SECD /* 심사재심의접수구분코드 */,
    TO_CHAR(SRECS_RCPT_SQNO) AS TO_CHAR,
    SRECS_DEPT_CD /* 심사재심의부서코드 */,
    RSCH_ASMT_TTL /* 연구과제제목 */
FROM TBBADFRE012M WHERE 1 = 1 AND NTFCTN_RCPT_YMD BETWEEN NVL(#strACP_DHS#,'19000101') AND NVL(#strACP_DHE#,'99991231') AND 1 = CASE WHEN #CLM_SECD# IN ('5','6','7') THEN 1 ELSE 0 END AND SRECS_RCPT_SECD = CASE WHEN #CLM_SECD# = '5' THEN '1' WHEN #CLM_SECD# = '6' THEN '2' WHEN #CLM_SECD# = '7' THEN '3' END AND CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND SRECS_RCPT_SQNO = #CRU_ACTL_RCPT_NO# AND SRECS_CLMT_NM LIKE '%' || #strCVPTR_NM# || '%' AND RSCH_ASMT_TTL LIKE '%' || #strTIT_NM# || '%' UNION ALL SELECT '8' AS USER_HSTRY_SECD /* 사용자이력구분코드 */,
    T1.LINK_YR||'-손망-'||T1.NTFCTN_RCPT_SQNO AS FRS_MDM_SQNO /* 포렌식매체순번 */,
    T1.INST_CD /* 기관코드 */,
    T1.NTFCTN_SECD /* 통보구분코드 */,
    T1.NTFCTN_SQNO /* 통보순번 */,
    '' AS KEY4,
    T1.RSCH_ASMT_TTL /* 연구과제제목 */
FROM TBBADGDA001M T1 WHERE 1=1 AND T1.NTFCTN_RCPT_YMD BETWEEN NVL(#strACP_DHS#,'19000101') AND NVL(#strACP_DHE#,'99991231') AND T1.NTFCTN_SECD = '2' AND T1.OCRN_SECD IN ('3','4','5') AND '8' = #CLM_SECD# AND T1.LINK_YR = #CVLCPT_RCPT_YR# AND T1.NTFCTN_RCPT_SQNO = #CRU_ACTL_RCPT_NO# AND EXISTS (SELECT 1
FROM TBBADGDA001L WHERE INST_CD = T1.INST_CD AND NTFCTN_SECD = T1.NTFCTN_SECD AND NTFCTN_SQNO = T1.NTFCTN_SQNO AND RLPR_NM LIKE '%' || #strCVPTR_NM# || '%') AND T1.RSCH_ASMT_TTL LIKE '%' || #strTIT_NM# || '%' UNION ALL SELECT '9' AS USER_HSTRY_SECD /* 사용자이력구분코드 */,
    T1.LINK_YR||'-판청-'||T1.NTFCTN_RCPT_SQNO AS FRS_MDM_SQNO /* 포렌식매체순번 */,
    T1.INST_CD /* 기관코드 */,
    T1.NTFCTN_SECD /* 통보구분코드 */,
    T1.NTFCTN_SQNO /* 통보순번 */,
    '' AS KEY4,
    T1.RSCH_ASMT_TTL /* 연구과제제목 */
FROM TBBADGDA001M T1 WHERE 1=1 AND T1.NTFCTN_RCPT_YMD BETWEEN NVL(#strACP_DHS#,'19000101') AND NVL(#strACP_DHE#,'99991231') AND T1.NTFCTN_SECD = '2' AND T1.OCRN_SECD = '6' AND '9' = #CLM_SECD# AND T1.LINK_YR = #CVLCPT_RCPT_YR# AND T1.NTFCTN_RCPT_SQNO = #CRU_ACTL_RCPT_NO# AND EXISTS (SELECT 1
FROM TBBADGDA001L WHERE INST_CD = T1.INST_CD AND NTFCTN_SECD = T1.NTFCTN_SECD AND NTFCTN_SQNO = T1.NTFCTN_SQNO AND RLPR_NM LIKE '%' || #strCVPTR_NM# || '%') AND T1.RSCH_ASMT_TTL LIKE '%' || #strTIT_NM# || '%' UNION ALL SELECT 'A' AS USER_HSTRY_SECD /* 사용자이력구분코드 */,
    F_MNG_KND_AUDYRNO(A.CVLCPT_ADT_YR, A.ADT_NO, C.ADT_KDCD, '-') ||'-'|| A.DSPS_RQT_SQNO ||'-'|| F_ORG_INFO(B.REL_INST_CD,'1') AS FRS_MDM_SQNO /* 포렌식매체순번 */,
    A.CVLCPT_ADT_YR /* 민원감사년도 */,
    A.ADT_NO /* 감사번호 */,
    TO_CHAR(A.DSPS_RQT_SQNO) AS TO_CHAR,
    B.REL_INST_CD /* 관계기관코드 */,
    A.DSPS_RQT_NM /* 처분요구명 */
FROM TBBADEAR001M A ,TBBADFRE011M B ,TBBADDED001M C WHERE 1=1 AND A.CVLCPT_ADT_YR = B.CVLCPT_ADT_YR AND A.ADT_NO = B.ADT_NO AND A.DSPS_RQT_SQNO = B.DSPS_RQT_SQNO AND B.MNG_SQNO = (SELECT MIN(MNG_SQNO) AS MNG_SQNO /* 관리순번 */
FROM TBBADFRE011M WHERE CVLCPT_ADT_YR = B.CVLCPT_ADT_YR AND ADT_NO = B.ADT_NO AND DSPS_RQT_SQNO = B.DSPS_RQT_SQNO AND SRECS_REL_INST_CD = B.SRECS_REL_INST_CD) AND A.CVLCPT_ADT_YR = C.CVLCPT_ADT_YR AND A.ADT_NO = C.ADT_NO AND NVL(B.DSGN_YMD,'19000101') BETWEEN NVL(#strACP_DHS#,'19000101') AND NVL(#strACP_DHE#,'99991231') AND 'A' = #CLM_SECD# AND A.CVLCPT_ADT_YR = #CVLCPT_RCPT_YR# AND A.DSPS_RQT_SQNO = #CRU_ACTL_RCPT_NO# AND A.DSPS_RQT_NM LIKE '%' || #strTIT_NM# || '%' UNION ALL SELECT 'C' AS USER_HSTRY_SECD /* 사용자이력구분코드 */,
    CVLCPT_RCPT_YR || '-청금-' || CRU_ACTL_RCPT_NO AS FRS_MDM_SQNO /* 포렌식매체순번 */,
    CVLCPT_DCLR_SECD /* 민원신고구분코드 */,
    CVLCPT_RCPT_YR /* 민원접수년도 */,
    CVLCPT_DCLR_RCPT_NO /* 민원신고접수번호 */,
    '' AS KEY4,
    RSCH_ASMT_TTL /* 연구과제제목 */
FROM TBCSPDCP811M WHERE 1=1 AND CVLCPT_DCLR_SECD = '1' /* 청금 */ AND CRU_ACTL_RCPT_NO IS NOT NULL AND CRU_DEL_DT IS NULL AND TO_CHAR(CRU_RCPT_DT, 'YYYYMMDD') BETWEEN NVL(#strACP_DHS#,'19000101') AND NVL(#strACP_DHE#,'99991231') AND 'C' = #CLM_SECD# AND CVLCPT_RCPT_YR = #CVLCPT_RCPT_YR# AND CRU_ACTL_RCPT_NO = #CRU_ACTL_RCPT_NO# AND INFO_RLPR_NM LIKE '%' || #strCVPTR_NM# || '%' AND RSCH_ASMT_TTL LIKE '%' || #strTIT_NM# || '%' ) T1 ,TBDCMACM013C T2 WHERE T2.CMM_CD_DVSN_CD = '1000742' AND T2.CD != '000000000' AND T1.USER_HSTRY_SECD = T2.CD AND T2.USR_DFN_TXT_3 IN ('10','11') AND T2.USR_DFN_TXT_3 IN ('01','11')