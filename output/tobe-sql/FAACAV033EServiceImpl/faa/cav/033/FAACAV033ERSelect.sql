/* faa/cav/033/FAACAV033ERSelect */ SELECT A.DOC_ENFC_NO||DOC_ENFC_YMD AS DOC_ENFC_NO /* 문서시행번호 */,
    D.PROF_RBPRSN_INST_NM AS 증명기관명 AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    CASE A.MDFCN_SECD WHEN 'C' THEN '지정' WHEN 'U' THEN '변경' WHEN 'N' THEN '폐지' WHEN 'p' THEN '공문변경' WHEN 's' THEN '단순변경' WHEN 'D' THEN '지정취소' ELSE A.MDFCN_SECD END AS 구분 AS MDFCN_SECD /* 수정구분코드 */,
    B.ACNTG_CDNM AS 소관명 AS ACNTG_CDNM /* 회계코드명 */,
    C.ACNTG_CDNM AS 회계명 AS ACNTG_CDNM /* 회계코드명 */,
    NVL(case when (A.BLL_KDCD='17' and A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO <> '000' ) or (A.BLL_KDCD='18' and A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO <> '000' ) then '관서운영경비출납계산서' else case when (A.BLL_KDCD='22' and A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO <> '000' ) or (A.BLL_KDCD='23' and A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO <> '000' ) or (A.BLL_KDCD='24' and A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO <> '000' ) then '기금관서운영경비출납계산서' else case when (A.BLL_KDCD='19' and A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO <> '000' ) then '선사용자금관서운영경비출납계산서' else F.ACNTG_CDNM end end end ,' ') AS 계산서종류 AS BLL_KDCD /* 계산서종류코드 */,
    E.PROF_RBPRSN_INST_NM AS 소속중앙관서 AS PROF_RBPRSN_INST_NM /* 증명책임자기관명 */,
    A.JBPS_NM AS 직위명 AS JBPS_NM /* 직위명 */,
    A.JRSD_CD||'-'||A.ACNTG_CD||'-'||A.BLL_KDCD||'-'||A.PROF_RBPRSN_SQNO||'-'||A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO AS 증명책임자부호 AS JRSD_CD /* 소관코드 */,
    CASE WHEN SUBSTRING(A.PROF_RBPRSN_CRT_YMD,1,4) = '0000' THEN ' ' ELSE SUBSTRING (A.PROF_RBPRSN_CRT_YMD,1,4) || '.' || SUBSTRING (A.PROF_RBPRSN_CRT_YMD,5,2) || '.' END AS 지정월 AS PROF_RBPRSN_CRT_YMD /* 증명책임자생성일자 */,
    CASE WHEN SUBSTRING(A.PROF_RBPRSN_ABL_YMD,1,4) = '9999' THEN ' ' ELSE SUBSTRING (A.PROF_RBPRSN_ABL_YMD,1,4) || '.' || SUBSTRING (A.PROF_RBPRSN_ABL_YMD,5,2) || '.' END AS 폐지월 AS PROF_RBPRSN_ABL_YMD /* 증명책임자폐지일자 */
FROM TWFAACAV024C F, TBDCMACM015M E, TBDCMACM015M D, TWFAACAV024C C, TWFAACAV024C B, TWFAACAV003M A WHERE A.JRSD_CD in ( SELECT NVL(A.JRSD_CD,'') AS GPCD_JRSD_SECD /* 정부구매카드소관구분코드 */
FROM TWFAACAV003M A, TWFAACAV024C B WHERE A.JRSD_CD BETWEEN #strCoptCdFrom# AND #strCoptCdTo# AND A.MDFCN_YMD BETWEEN #strYrFrom#||#strMmFrom#||#strDdFrom# AND #strYrTo#||#strMmTo#||#strDdTo# AND DOC_ENFC_YMD IS NOT NULL AND B.ACNTG_SECD = '02' AND A.JRSD_CD = B.ACNTG_CD GROUP BY DOC_ENFC_NO, DOC_ENFC_YMD, JRSD_CD ) AND (A.MDFCN_YMD BETWEEN #strYrFrom#||#strMmFrom#||#strDdFrom# AND #strYrTo#||#strMmTo#||#strDdTo# AND A.DOC_ENFC_NO in ( SELECT NVL(A.PROF_RBPRSN_OFDOC_ENFC_NO,'') AS PROF_RBPRSN_OFDOC_ENFC_NO /* 증명책임자공문시행번호 */
FROM TWFAACAV003M A, TWFAACAV024C B WHERE A.JRSD_CD BETWEEN #strCoptCdFrom# AND #strCoptCdTo# AND A.MDFCN_YMD BETWEEN #strYrFrom#||#strMmFrom#||#strDdFrom# AND #strYrTo#||#strMmTo#||#strDdTo# AND DOC_ENFC_YMD IS NOT NULL AND B.ACNTG_SECD = '02' AND A.JRSD_CD = B.ACNTG_CD GROUP BY DOC_ENFC_NO, DOC_ENFC_YMD, JRSD_CD ) AND A.DOC_ENFC_YMD in ( SELECT NVL(A.PROF_RBPRSN_OFDOC_ENFC_YMD,'') AS PROF_RBPRSN_OFDOC_ENFC_YMD /* 증명책임자공문시행일자 */
FROM TWFAACAV003M A, TWFAACAV024C B WHERE A.JRSD_CD BETWEEN #strCoptCdFrom# AND #strCoptCdTo# AND A.MDFCN_YMD BETWEEN #strYrFrom#||#strMmFrom#||#strDdFrom# AND #strYrTo#||#strMmTo#||#strDdTo# AND DOC_ENFC_YMD IS NOT NULL AND B.ACNTG_SECD = '02' AND A.JRSD_CD = B.ACNTG_CD GROUP BY DOC_ENFC_NO, DOC_ENFC_YMD, JRSD_CD ) AND B.ACNTG_SECD = '02' AND A.JRSD_CD = B.ACNTG_CD AND C.ACNTG_SECD = '01' AND C.ACNTG_CD = A.ACNTG_CD AND F.ACNTG_SECD = '03' AND F.ACNTG_CD = A.BLL_KDCD AND A.INST_CD = D.INST_CD AND SUBSTRING(A.INST_CD,1,3)||'000000000' = E.INST_CD(+)) ORDER BY GUBUN, A.MDFCN_SECD, A.JRSD_CD, A.ACNTG_CD, A.BLL_KDCD, A.PROF_RBPRSN_SQNO, A.GVMNFC_OPER_EPS_RCDB_PBOFC_SQNO ASC