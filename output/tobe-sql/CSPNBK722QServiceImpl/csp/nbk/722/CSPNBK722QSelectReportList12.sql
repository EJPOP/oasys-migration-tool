SELECT CASE SUBSTR(B.MNST_CLU_CD, 0, 1) WHEN '1' THEN B.DSPS_RQT_AMT ELSE CASE SUBSTR(B.MNST_CLU_CD, 0, 1) WHEN '5' THEN B.DSPS_RQT_AMT ELSE 0 END END AS SUBSTR,
    B.YRLY_DS_AGG_AM AS YRLY_DS_AGG_AM,
    A.ACCT_NM,
    B.YRLY_CRDT_AGG_AM AS YRLY_CRDT_AGG_AM,
    CASE SUBSTR(B.MNST_CLU_CD, 0, 1) WHEN '2' THEN B.DSPS_RQT_AMT ELSE CASE SUBSTR(B.MNST_CLU_CD, 0, 1) WHEN '3' THEN B.DSPS_RQT_AMT ELSE CASE SUBSTR(B.MNST_CLU_CD, 0, 1) WHEN '4' THEN B.DSPS_RQT_AMT ELSE 0 END END END AS SUBSTR
FROM TBCSPNBK501M A , ( SELECT MNST_CLU_CD,
    SUM(DSPS_RQT_AMT) AS DSPS_RQT_AMT /* 처분요구금액 */,
    SUM(YRLY_DS_AGG_AM) AS YRLY_DS_AGG_AM,
    SUM(YRLY_CRDT_AGG_AM) AS YRLY_CRDT_AGG_AM
FROM TBCSPNBK502M WHERE DEAL_DT = #settleYr#||'1231' GROUP BY MNST_CLU_CD ) B WHERE A.MNST_CLU_CD = B.MNST_CLU_CD AND A.TAXR_SITM_SECD = '0' AND SUBSTR(A.MNST_CLU_CD, LENGTH(A.MNST_CLU_CD), 1) <> '0' AND ( B.DSPS_RQT_AMT <> 0 OR B.YRLY_CRDT_AGG_AM <> 0 OR B.YRLY_DS_AGG_AM <> 0 ) ORDER BY A.MNST_CLU_CD