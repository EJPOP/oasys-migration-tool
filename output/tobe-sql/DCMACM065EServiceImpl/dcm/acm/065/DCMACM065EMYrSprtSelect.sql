SELECT SPH,
    SPRT_AM,
    SPRT_RT,
    KBN
FROM TBDCMACM065D1 WHERE 1=1 AND KBN = ( NVL((SELECT KBN
FROM TBDCMACM065D3 WHERE TRGT_NOP_ENO = #TRGT_NOP_ENO#), DECODE((SELECT COUNT(TRGT_NOP_ENO) AS TRGT_NOP_ENO /* 대상인원직원전산번호 */
FROM TBDCMACM001M WHERE INSD_JBGD_SECD BETWEEN '14' AND '30' AND USR_DVSN_CD='1' AND SRECS_DEPT_CD != '880880' AND USER_ID NOT LIKE 'test%' AND TRGT_NOP_ENO = #TRGT_NOP_ENO#),'0','1','6')) ) AND TO_CHAR(SYSDATE,'YYYY') = LINK_YR ORDER BY SPH