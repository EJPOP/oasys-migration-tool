SELECT (SELECT AS CD_NM
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000312' AND CD = E.PFSR_DVSN_CD) AS PFSR_DVSN_NM , I.CRS_NM , A.CRS_CDN , E.INFO_RLPR_NM , D.BLL_SBJCT_NM ,(SELECT CD_NM
FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000317' AND CD = A.SV_DVSN_CD) AS SV_DVSN_NM , NVL(A.EDU_STFT_TXT_1, 0) || ' (' || DECODE(B.TOT_STFT, 0, 0, ROUND(A.EDU_STFT_TXT_1 / B.TOT_STFT * 100, 0)) || '%)' AS EDU_STFT_TXT_1 , NVL(A.EDU_STFT_TXT_2, 0) || ' (' || DECODE(B.TOT_STFT, 0, 0, ROUND(A.EDU_STFT_TXT_2 / B.TOT_STFT * 100, 0)) || '%)' AS EDU_STFT_TXT_2 , NVL(A.EDU_STFT_TXT_3, 0) || ' (' || DECODE(B.TOT_STFT, 0, 0, ROUND(A.EDU_STFT_TXT_3 / B.TOT_STFT * 100, 0)) || '%)' AS EDU_STFT_TXT_3 , NVL(A.EDU_STFT_TXT_4, 0) || ' (' || DECODE(B.TOT_STFT, 0, 0, ROUND(A.EDU_STFT_TXT_4 / B.TOT_STFT * 100, 0)) || '%)' AS EDU_STFT_TXT_4 , NVL(A.EDU_STFT_TXT_5, 0) || ' (' || DECODE(B.TOT_STFT, 0, 0, ROUND(A.EDU_STFT_TXT_5 / B.TOT_STFT * 100, 0)) || '%)' AS EDU_STFT_TXT_5 , C.TOT_SCORE FROM TBCSPSAE304D A , ( SELECT EDU_STFT_TXT_1 + EDU_STFT_TXT_2 + EDU_STFT_TXT_3 + EDU_STFT_TXT_4 + EDU_STFT_TXT_5 AS EDU_STFT_TXT_1,
    LINK_YR /* 연계년도 */,
    CRS_CD,
    CRS_CDN /* 과정기수 */,
    SUBJ_CD,
    SV_DVSN_CD
FROM TBCSPSAE304D ) B , ( SELECT ROUND(SUM( (DECODE( (EDU_STFT_TXT_1 + EDU_STFT_TXT_2 + EDU_STFT_TXT_3 + EDU_STFT_TXT_4 + EDU_STFT_TXT_5), 0, 0, ROUND(EDU_STFT_TXT_1 / (EDU_STFT_TXT_1 + EDU_STFT_TXT_2 + EDU_STFT_TXT_3 + EDU_STFT_TXT_4 + EDU_STFT_TXT_5) * 100, 0) ) *1) + (DECODE( (EDU_STFT_TXT_1 + EDU_STFT_TXT_2 + EDU_STFT_TXT_3 + EDU_STFT_TXT_4 + EDU_STFT_TXT_5), 0, 0, ROUND(EDU_STFT_TXT_2 / (EDU_STFT_TXT_1 + EDU_STFT_TXT_2 + EDU_STFT_TXT_3 + EDU_STFT_TXT_4 + EDU_STFT_TXT_5) * 100, 0) ) *0.8) + (DECODE( (EDU_STFT_TXT_1 + EDU_STFT_TXT_2 + EDU_STFT_TXT_3 + EDU_STFT_TXT_4 + EDU_STFT_TXT_5), 0, 0, ROUND(EDU_STFT_TXT_3 / (EDU_STFT_TXT_1 + EDU_STFT_TXT_2 + EDU_STFT_TXT_3 + EDU_STFT_TXT_4 + EDU_STFT_TXT_5) * 100, 0) ) *0.6) + (DECODE( (EDU_STFT_TXT_1 + EDU_STFT_TXT_2 + EDU_STFT_TXT_3 + EDU_STFT_TXT_4 + EDU_STFT_TXT_5), 0, 0, ROUND(EDU_STFT_TXT_4 / (EDU_STFT_TXT_1 + EDU_STFT_TXT_2 + EDU_STFT_TXT_3 + EDU_STFT_TXT_4 + EDU_STFT_TXT_5) * 100, 0) ) *0.4) + (DECODE( (EDU_STFT_TXT_1 + EDU_STFT_TXT_2 + EDU_STFT_TXT_3 + EDU_STFT_TXT_4 + EDU_STFT_TXT_5), 0, 0, ROUND(EDU_STFT_TXT_5 / (EDU_STFT_TXT_1 + EDU_STFT_TXT_2 + EDU_STFT_TXT_3 + EDU_STFT_TXT_4 + EDU_STFT_TXT_5) * 100, 0) ) *0.2) ) /3, 0) AS ROUND,
    LINK_YR /* 연계년도 */,
    CRS_CD,
    CRS_CDN /* 과정기수 */,
    SUBJ_CD
FROM TBCSPSAE304D GROUP BY LINK_YR, CRS_CD, CRS_CDN, SUBJ_CD ) C , TBCSPSAE101M D , TBCSPSAE109M E , TBCSPSAE201D F , TBCSPSAE101C G , TBCSPSAE102C H , TBCSPSAE103C I WHERE 1=1 AND B.LINK_YR = A.LINK_YR AND B.CRS_CD = A.CRS_CD AND B.CRS_CDN = A.CRS_CDN AND B.SUBJ_CD = A.SUBJ_CD AND B.SV_DVSN_CD = A.SV_DVSN_CD AND C.LINK_YR = A.LINK_YR AND C.CRS_CD = A.CRS_CD AND C.CRS_CDN = A.CRS_CDN AND C.SUBJ_CD = A.SUBJ_CD AND D.SUBJ_CD = A.SUBJ_CD AND F.LINK_YR = A.LINK_YR AND F.CRS_CD = A.CRS_CD AND F.CRS_CDN = A.CRS_CDN AND E.PFSR_ID = A.PFSR_ID AND I.CRS_CD = A.CRS_CD AND H.EDU_CAT_CD = I.EDU_CAT_CD AND G.EDU_DVSN_CD = H.EDU_DVSN_CD AND G.EDU_DVSN_CD = I.EDU_DVSN_CD AND SUBSTR(F.EDU_BGNG_YMD, 0, 6) BETWEEN SUBSTR(#strFromYm#, 0, 6) AND SUBSTR(#strToYm#, 0, 6) AND G.EDU_DVSN_CD = #strEDU_DVSN_CD# AND H.EDU_CAT_CD = #strEDU_CAT_CD# AND A.CRS_CD = #strEDU_CRS_CD# AND A.CRS_CDN = #CRS_CDN# AND E.PFSR_DVSN_CD = #strPFSR_DVSN_CD# AND E.INFO_RLPR_NM LIKE '%' || #strNAM# || '%' ORDER BY E.PFSR_DVSN_CD, I.CRS_NM, A.CRS_CDN, E.INFO_RLPR_NM, A.SUBJ_CD, A.SV_DVSN_CD